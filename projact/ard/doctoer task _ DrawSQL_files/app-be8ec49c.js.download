import{e as Td,r as jv,m as kn,i as Wv,w as Ad,a as Yv,b as Jl,c as Xv,t as pS,h as gS,g as mS,o as vS,n as yS,d as bS,f as qv,j as Gr,k as xi,l as xS,O as wS,p as _S,q as SS,_ as qt}from"./index.esm-4dcaccf3.js";var ES=!1;function TS(){return Kv().__VUE_DEVTOOLS_GLOBAL_HOOK__}function Kv(){return typeof navigator<"u"&&typeof window<"u"?window:typeof global<"u"?global:{}}const AS=typeof Proxy=="function",CS="devtools-plugin:setup",PS="plugin:settings:set";let Cs,Eh;function IS(){var t;return Cs!==void 0||(typeof window<"u"&&window.performance?(Cs=!0,Eh=window.performance):typeof global<"u"&&(!((t=global.perf_hooks)===null||t===void 0)&&t.performance)?(Cs=!0,Eh=global.perf_hooks.performance):Cs=!1),Cs}function OS(){return IS()?Eh.now():Date.now()}class kS{constructor(e,n){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=n;const i={};if(e.settings)for(const o in e.settings){const a=e.settings[o];i[o]=a.defaultValue}const r=`__vue-devtools-plugin-settings__${e.id}`;let s=Object.assign({},i);try{const o=localStorage.getItem(r),a=JSON.parse(o);Object.assign(s,a)}catch{}this.fallbacks={getSettings(){return s},setSettings(o){try{localStorage.setItem(r,JSON.stringify(o))}catch{}s=o},now(){return OS()}},n&&n.on(PS,(o,a)=>{o===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(o,a)=>this.target?this.target.on[a]:(...l)=>{this.onQueue.push({method:a,args:l})}}),this.proxiedTarget=new Proxy({},{get:(o,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...l)=>(this.targetQueue.push({method:a,args:l,resolve:()=>{}}),this.fallbacks[a](...l)):(...l)=>new Promise(c=>{this.targetQueue.push({method:a,args:l,resolve:c})})})}async setRealTarget(e){this.target=e;for(const n of this.onQueue)this.target.on[n.method](...n.args);for(const n of this.targetQueue)n.resolve(await this.target[n.method](...n.args))}}function LS(t,e){const n=t,i=Kv(),r=TS(),s=AS&&n.enableEarlyProxy;if(r&&(i.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!s))r.emit(CS,t,e);else{const o=s?new kS(n,r):null;(i.__VUE_DEVTOOLS_PLUGINS__=i.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:n,setupFn:e,proxy:o}),o&&e(o.proxiedTarget)}}/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let Zv;const Cc=t=>Zv=t,Jv=Symbol();function Th(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var sa;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(sa||(sa={}));function MS(){const t=Td(!0),e=t.run(()=>jv({}));let n=[],i=[];const r=kn({install(s){Cc(r),r._a=s,s.provide(Jv,r),s.config.globalProperties.$pinia=r,i.forEach(o=>n.push(o)),i=[]},use(s){return!this._a&&!ES?i.push(s):n.push(s),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return r}const Qv=()=>{};function Bp(t,e,n,i=Qv){t.push(e);const r=()=>{const s=t.indexOf(e);s>-1&&(t.splice(s,1),i())};return!n&&mS()&&vS(r),r}function Ps(t,...e){t.slice().forEach(n=>{n(...e)})}const DS=t=>t();function Ah(t,e){t instanceof Map&&e instanceof Map&&e.forEach((n,i)=>t.set(i,n)),t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const n in e){if(!e.hasOwnProperty(n))continue;const i=e[n],r=t[n];Th(r)&&Th(i)&&t.hasOwnProperty(n)&&!Jl(i)&&!Xv(i)?t[n]=Ah(r,i):t[n]=i}return t}const NS=Symbol();function RS(t){return!Th(t)||!t.hasOwnProperty(NS)}const{assign:xr}=Object;function $S(t){return!!(Jl(t)&&t.effect)}function BS(t,e,n,i){const{state:r,actions:s,getters:o}=e,a=n.state.value[t];let l;function c(){a||(n.state.value[t]=r?r():{});const h=bS(n.state.value[t]);return xr(h,s,Object.keys(o||{}).reduce((u,d)=>(u[d]=kn(qv(()=>{Cc(n);const f=n._s.get(t);return o[d].call(f,f)})),u),{}))}return l=ty(t,c,e,n,i,!0),l}function ty(t,e,n={},i,r,s){let o;const a=xr({actions:{}},n),l={deep:!0};let c,h,u=[],d=[],f;const p=i.state.value[t];!s&&!p&&(i.state.value[t]={}),jv({});let g;function v(b){let w;c=h=!1,typeof b=="function"?(b(i.state.value[t]),w={type:sa.patchFunction,storeId:t,events:f}):(Ah(i.state.value[t],b),w={type:sa.patchObject,payload:b,storeId:t,events:f});const A=g=Symbol();yS().then(()=>{g===A&&(c=!0)}),h=!0,Ps(u,w,i.state.value[t])}const x=s?function(){const{state:w}=n,A=w?w():{};this.$patch(E=>{xr(E,A)})}:Qv;function S(){o.stop(),u=[],d=[],i._s.delete(t)}function C(b,w){return function(){Cc(i);const A=Array.from(arguments),E=[],M=[];function $(R){E.push(R)}function F(R){M.push(R)}Ps(d,{args:A,name:b,store:O,after:$,onError:F});let j;try{j=w.apply(this&&this.$id===t?this:O,A)}catch(R){throw Ps(M,R),R}return j instanceof Promise?j.then(R=>(Ps(E,R),R)).catch(R=>(Ps(M,R),Promise.reject(R))):(Ps(E,j),j)}}const P={_p:i,$id:t,$onAction:Bp.bind(null,d),$patch:v,$reset:x,$subscribe(b,w={}){const A=Bp(u,b,w.detached,()=>E()),E=o.run(()=>Ad(()=>i.state.value[t],M=>{(w.flush==="sync"?h:c)&&b({storeId:t,type:sa.direct,events:f},M)},xr({},l,w)));return A},$dispose:S},O=Yv(P);i._s.set(t,O);const m=(i._a&&i._a.runWithContext||DS)(()=>i._e.run(()=>(o=Td()).run(e)));for(const b in m){const w=m[b];if(Jl(w)&&!$S(w)||Xv(w))s||(p&&RS(w)&&(Jl(w)?w.value=p[b]:Ah(w,p[b])),i.state.value[t][b]=w);else if(typeof w=="function"){const A=C(b,w);m[b]=A,a.actions[b]=w}}return xr(O,m),xr(pS(O),m),Object.defineProperty(O,"$state",{get:()=>i.state.value[t],set:b=>{v(w=>{xr(w,b)})}}),i._p.forEach(b=>{xr(O,o.run(()=>b({store:O,app:i._a,pinia:i,options:a})))}),p&&s&&n.hydrate&&n.hydrate(O.$state,p),c=!0,h=!0,O}function Mr(t,e,n){let i,r;const s=typeof e=="function";typeof t=="string"?(i=t,r=s?n:e):(r=t,i=t.id);function o(a,l){const c=gS();return a=a||(c?Wv(Jv,null):null),a&&Cc(a),a=Zv,a._s.has(i)||(s?ty(i,e,r,a):BS(i,r,a)),a._s.get(i)}return o.$id=i,o}function FS(t){return{all:t=t||new Map,on:function(e,n){var i=t.get(e);i?i.push(n):t.set(e,[n])},off:function(e,n){var i=t.get(e);i&&(n?i.splice(i.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var i=t.get(e);i&&i.slice().map(function(r){r(n)}),(i=t.get("*"))&&i.slice().map(function(r){r(e,n)})}}}let cl;const VS=new Uint8Array(16);function zS(){if(!cl&&(cl=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!cl))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return cl(VS)}const US=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function HS(t){return typeof t=="string"&&US.test(t)}const mn=[];for(let t=0;t<256;++t)mn.push((t+256).toString(16).slice(1));function GS(t,e=0){return mn[t[e+0]]+mn[t[e+1]]+mn[t[e+2]]+mn[t[e+3]]+"-"+mn[t[e+4]]+mn[t[e+5]]+"-"+mn[t[e+6]]+mn[t[e+7]]+"-"+mn[t[e+8]]+mn[t[e+9]]+"-"+mn[t[e+10]]+mn[t[e+11]]+mn[t[e+12]]+mn[t[e+13]]+mn[t[e+14]]+mn[t[e+15]]}const jS=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Fp={randomUUID:jS};function ki(t,e,n){if(Fp.randomUUID&&!e&&!t)return Fp.randomUUID();t=t||{};const i=t.random||(t.rng||zS)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){n=n||0;for(let r=0;r<16;++r)e[n+r]=i[r];return e}return GS(i)}//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var ey;function vt(){return ey.apply(null,arguments)}function WS(t){ey=t}function yi(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Qr(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function de(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Cd(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(de(t,e))return!1;return!0}function Un(t){return t===void 0}function sr(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function Ia(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function ny(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function Ar(t,e){for(var n in e)de(e,n)&&(t[n]=e[n]);return de(e,"toString")&&(t.toString=e.toString),de(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Di(t,e,n,i){return Ty(t,e,n,i,!0).utc()}function YS(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ut(t){return t._pf==null&&(t._pf=YS()),t._pf}var Ch;Array.prototype.some?Ch=Array.prototype.some:Ch=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function Pd(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=Ut(t),n=Ch.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function Pc(t){var e=Di(NaN);return t!=null?Ar(Ut(e),t):Ut(e).userInvalidated=!0,e}var Vp=vt.momentProperties=[],Ru=!1;function Id(t,e){var n,i,r,s=Vp.length;if(Un(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Un(e._i)||(t._i=e._i),Un(e._f)||(t._f=e._f),Un(e._l)||(t._l=e._l),Un(e._strict)||(t._strict=e._strict),Un(e._tzm)||(t._tzm=e._tzm),Un(e._isUTC)||(t._isUTC=e._isUTC),Un(e._offset)||(t._offset=e._offset),Un(e._pf)||(t._pf=Ut(e)),Un(e._locale)||(t._locale=e._locale),s>0)for(n=0;n<s;n++)i=Vp[n],r=e[i],Un(r)||(t[i]=r);return t}function Oa(t){Id(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Ru===!1&&(Ru=!0,vt.updateOffset(this),Ru=!1)}function bi(t){return t instanceof Oa||t!=null&&t._isAMomentObject!=null}function iy(t){vt.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function ci(t,e){var n=!0;return Ar(function(){if(vt.deprecationHandler!=null&&vt.deprecationHandler(null,t),n){var i=[],r,s,o,a=arguments.length;for(s=0;s<a;s++){if(r="",typeof arguments[s]=="object"){r+=`
[`+s+"] ";for(o in arguments[0])de(arguments[0],o)&&(r+=o+": "+arguments[0][o]+", ");r=r.slice(0,-2)}else r=arguments[s];i.push(r)}iy(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var zp={};function ry(t,e){vt.deprecationHandler!=null&&vt.deprecationHandler(t,e),zp[t]||(iy(e),zp[t]=!0)}vt.suppressDeprecationWarnings=!1;vt.deprecationHandler=null;function Ni(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function XS(t){var e,n;for(n in t)de(t,n)&&(e=t[n],Ni(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Ph(t,e){var n=Ar({},t),i;for(i in e)de(e,i)&&(Qr(t[i])&&Qr(e[i])?(n[i]={},Ar(n[i],t[i]),Ar(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)de(t,i)&&!de(e,i)&&Qr(t[i])&&(n[i]=Ar({},n[i]));return n}function Od(t){t!=null&&this.set(t)}var Ih;Object.keys?Ih=Object.keys:Ih=function(t){var e,n=[];for(e in t)de(t,e)&&n.push(e);return n};var qS={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function KS(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return Ni(i)?i.call(e,n):i}function Li(t,e,n){var i=""+Math.abs(t),r=e-i.length,s=t>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var kd=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,ul=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,$u={},Gs={};function It(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(Gs[t]=r),e&&(Gs[e[0]]=function(){return Li(r.apply(this,arguments),e[1],e[2])}),n&&(Gs[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function ZS(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function JS(t){var e=t.match(kd),n,i;for(n=0,i=e.length;n<i;n++)Gs[e[n]]?e[n]=Gs[e[n]]:e[n]=ZS(e[n]);return function(r){var s="",o;for(o=0;o<i;o++)s+=Ni(e[o])?e[o].call(r,t):e[o];return s}}function Fl(t,e){return t.isValid()?(e=sy(e,t.localeData()),$u[e]=$u[e]||JS(e),$u[e](t)):t.localeData().invalidDate()}function sy(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(ul.lastIndex=0;n>=0&&ul.test(t);)t=t.replace(ul,i),ul.lastIndex=0,n-=1;return t}var QS={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function t1(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(kd).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var e1="Invalid date";function n1(){return this._invalidDate}var i1="%d",r1=/\d{1,2}/;function s1(t){return this._ordinal.replace("%d",t)}var o1={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function a1(t,e,n,i){var r=this._relativeTime[n];return Ni(r)?r(t,e,n,i):r.replace(/%d/i,t)}function l1(t,e){var n=this._relativeTime[t>0?"future":"past"];return Ni(n)?n(e):n.replace(/%s/i,e)}var Up={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function ui(t){return typeof t=="string"?Up[t]||Up[t.toLowerCase()]:void 0}function Ld(t){var e={},n,i;for(i in t)de(t,i)&&(n=ui(i),n&&(e[n]=t[i]));return e}var c1={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function u1(t){var e=[],n;for(n in t)de(t,n)&&e.push({unit:n,priority:c1[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var oy=/\d/,Kn=/\d\d/,ay=/\d{3}/,Md=/\d{4}/,Ic=/[+-]?\d{6}/,$e=/\d\d?/,ly=/\d\d\d\d?/,cy=/\d\d\d\d\d\d?/,Oc=/\d{1,3}/,Dd=/\d{1,4}/,kc=/[+-]?\d{1,6}/,go=/\d+/,Lc=/[+-]?\d+/,h1=/Z|[+-]\d\d:?\d\d/gi,Mc=/Z|[+-]\d\d(?::?\d\d)?/gi,d1=/[+-]?\d+(\.\d{1,3})?/,ka=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,mo=/^[1-9]\d?/,Nd=/^([1-9]\d|\d)/,Ql;Ql={};function wt(t,e,n){Ql[t]=Ni(e)?e:function(i,r){return i&&n?n:e}}function f1(t,e){return de(Ql,t)?Ql[t](e._strict,e._locale):new RegExp(p1(t))}function p1(t){return er(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,s){return n||i||r||s}))}function er(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Qn(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function ee(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Qn(e)),n}var Oh={};function xe(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),sr(e)&&(i=function(s,o){o[e]=ee(s)}),r=t.length,n=0;n<r;n++)Oh[t[n]]=i}function La(t,e){xe(t,function(n,i,r,s){r._w=r._w||{},e(n,r._w,r,s)})}function g1(t,e,n){e!=null&&de(Oh,t)&&Oh[t](e,n._a,n,t)}function Dc(t){return t%4===0&&t%100!==0||t%400===0}var An=0,Ki=1,Ci=2,dn=3,pi=4,Zi=5,jr=6,m1=7,v1=8;It("Y",0,0,function(){var t=this.year();return t<=9999?Li(t,4):"+"+t});It(0,["YY",2],0,function(){return this.year()%100});It(0,["YYYY",4],0,"year");It(0,["YYYYY",5],0,"year");It(0,["YYYYYY",6,!0],0,"year");wt("Y",Lc);wt("YY",$e,Kn);wt("YYYY",Dd,Md);wt("YYYYY",kc,Ic);wt("YYYYYY",kc,Ic);xe(["YYYYY","YYYYYY"],An);xe("YYYY",function(t,e){e[An]=t.length===2?vt.parseTwoDigitYear(t):ee(t)});xe("YY",function(t,e){e[An]=vt.parseTwoDigitYear(t)});xe("Y",function(t,e){e[An]=parseInt(t,10)});function oa(t){return Dc(t)?366:365}vt.parseTwoDigitYear=function(t){return ee(t)+(ee(t)>68?1900:2e3)};var uy=vo("FullYear",!0);function y1(){return Dc(this.year())}function vo(t,e){return function(n){return n!=null?(hy(this,t,n),vt.updateOffset(this,e),this):ha(this,t)}}function ha(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function hy(t,e,n){var i,r,s,o,a;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}s=n,o=t.month(),a=t.date(),a=a===29&&o===1&&!Dc(s)?28:a,r?i.setUTCFullYear(s,o,a):i.setFullYear(s,o,a)}}function b1(t){return t=ui(t),Ni(this[t])?this[t]():this}function x1(t,e){if(typeof t=="object"){t=Ld(t);var n=u1(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=ui(t),Ni(this[t]))return this[t](e);return this}function w1(t,e){return(t%e+e)%e}var Ke;Array.prototype.indexOf?Ke=Array.prototype.indexOf:Ke=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Rd(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=w1(e,12);return t+=(e-n)/12,n===1?Dc(t)?29:28:31-n%7%2}It("M",["MM",2],"Mo",function(){return this.month()+1});It("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});It("MMMM",0,0,function(t){return this.localeData().months(this,t)});wt("M",$e,mo);wt("MM",$e,Kn);wt("MMM",function(t,e){return e.monthsShortRegex(t)});wt("MMMM",function(t,e){return e.monthsRegex(t)});xe(["M","MM"],function(t,e){e[Ki]=ee(t)-1});xe(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[Ki]=r:Ut(n).invalidMonth=t});var _1="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),dy="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),fy=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,S1=ka,E1=ka;function T1(t,e){return t?yi(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||fy).test(e)?"format":"standalone"][t.month()]:yi(this._months)?this._months:this._months.standalone}function A1(t,e){return t?yi(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[fy.test(e)?"format":"standalone"][t.month()]:yi(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function C1(t,e,n){var i,r,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)s=Di([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(s,"").toLocaleLowerCase();return n?e==="MMM"?(r=Ke.call(this._shortMonthsParse,o),r!==-1?r:null):(r=Ke.call(this._longMonthsParse,o),r!==-1?r:null):e==="MMM"?(r=Ke.call(this._shortMonthsParse,o),r!==-1?r:(r=Ke.call(this._longMonthsParse,o),r!==-1?r:null)):(r=Ke.call(this._longMonthsParse,o),r!==-1?r:(r=Ke.call(this._shortMonthsParse,o),r!==-1?r:null))}function P1(t,e,n){var i,r,s;if(this._monthsParseExact)return C1.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=Di([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(s="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(s.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function py(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=ee(e);else if(e=t.localeData().monthsParse(e),!sr(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,Rd(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function gy(t){return t!=null?(py(this,t),vt.updateOffset(this,!0),this):ha(this,"Month")}function I1(){return Rd(this.year(),this.month())}function O1(t){return this._monthsParseExact?(de(this,"_monthsRegex")||my.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(de(this,"_monthsShortRegex")||(this._monthsShortRegex=S1),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function k1(t){return this._monthsParseExact?(de(this,"_monthsRegex")||my.call(this),t?this._monthsStrictRegex:this._monthsRegex):(de(this,"_monthsRegex")||(this._monthsRegex=E1),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function my(){function t(l,c){return c.length-l.length}var e=[],n=[],i=[],r,s,o,a;for(r=0;r<12;r++)s=Di([2e3,r]),o=er(this.monthsShort(s,"")),a=er(this.months(s,"")),e.push(o),n.push(a),i.push(a),i.push(o);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function L1(t,e,n,i,r,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,i,r,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,i,r,s,o),a}function da(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function tc(t,e,n){var i=7+e-n,r=(7+da(t,0,i).getUTCDay()-e)%7;return-r+i-1}function vy(t,e,n,i,r){var s=(7+n-i)%7,o=tc(t,i,r),a=1+7*(e-1)+s+o,l,c;return a<=0?(l=t-1,c=oa(l)+a):a>oa(t)?(l=t+1,c=a-oa(t)):(l=t,c=a),{year:l,dayOfYear:c}}function fa(t,e,n){var i=tc(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,s,o;return r<1?(o=t.year()-1,s=r+nr(o,e,n)):r>nr(t.year(),e,n)?(s=r-nr(t.year(),e,n),o=t.year()+1):(o=t.year(),s=r),{week:s,year:o}}function nr(t,e,n){var i=tc(t,e,n),r=tc(t+1,e,n);return(oa(t)-i+r)/7}It("w",["ww",2],"wo","week");It("W",["WW",2],"Wo","isoWeek");wt("w",$e,mo);wt("ww",$e,Kn);wt("W",$e,mo);wt("WW",$e,Kn);La(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=ee(t)});function M1(t){return fa(t,this._week.dow,this._week.doy).week}var D1={dow:0,doy:6};function N1(){return this._week.dow}function R1(){return this._week.doy}function $1(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function B1(t){var e=fa(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}It("d",0,"do","day");It("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});It("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});It("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});It("e",0,0,"weekday");It("E",0,0,"isoWeekday");wt("d",$e);wt("e",$e);wt("E",$e);wt("dd",function(t,e){return e.weekdaysMinRegex(t)});wt("ddd",function(t,e){return e.weekdaysShortRegex(t)});wt("dddd",function(t,e){return e.weekdaysRegex(t)});La(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:Ut(n).invalidWeekday=t});La(["d","e","E"],function(t,e,n,i){e[i]=ee(t)});function F1(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function V1(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function $d(t,e){return t.slice(e,7).concat(t.slice(0,e))}var z1="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),yy="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),U1="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),H1=ka,G1=ka,j1=ka;function W1(t,e){var n=yi(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?$d(n,this._week.dow):t?n[t.day()]:n}function Y1(t){return t===!0?$d(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function X1(t){return t===!0?$d(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function q1(t,e,n){var i,r,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)s=Di([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(s,"").toLocaleLowerCase();return n?e==="dddd"?(r=Ke.call(this._weekdaysParse,o),r!==-1?r:null):e==="ddd"?(r=Ke.call(this._shortWeekdaysParse,o),r!==-1?r:null):(r=Ke.call(this._minWeekdaysParse,o),r!==-1?r:null):e==="dddd"?(r=Ke.call(this._weekdaysParse,o),r!==-1||(r=Ke.call(this._shortWeekdaysParse,o),r!==-1)?r:(r=Ke.call(this._minWeekdaysParse,o),r!==-1?r:null)):e==="ddd"?(r=Ke.call(this._shortWeekdaysParse,o),r!==-1||(r=Ke.call(this._weekdaysParse,o),r!==-1)?r:(r=Ke.call(this._minWeekdaysParse,o),r!==-1?r:null)):(r=Ke.call(this._minWeekdaysParse,o),r!==-1||(r=Ke.call(this._weekdaysParse,o),r!==-1)?r:(r=Ke.call(this._shortWeekdaysParse,o),r!==-1?r:null))}function K1(t,e,n){var i,r,s;if(this._weekdaysParseExact)return q1.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=Di([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(s="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(s.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function Z1(t){if(!this.isValid())return t!=null?this:NaN;var e=ha(this,"Day");return t!=null?(t=F1(t,this.localeData()),this.add(t-e,"d")):e}function J1(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Q1(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=V1(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function tE(t){return this._weekdaysParseExact?(de(this,"_weekdaysRegex")||Bd.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(de(this,"_weekdaysRegex")||(this._weekdaysRegex=H1),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function eE(t){return this._weekdaysParseExact?(de(this,"_weekdaysRegex")||Bd.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(de(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=G1),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function nE(t){return this._weekdaysParseExact?(de(this,"_weekdaysRegex")||Bd.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(de(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=j1),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Bd(){function t(h,u){return u.length-h.length}var e=[],n=[],i=[],r=[],s,o,a,l,c;for(s=0;s<7;s++)o=Di([2e3,1]).day(s),a=er(this.weekdaysMin(o,"")),l=er(this.weekdaysShort(o,"")),c=er(this.weekdays(o,"")),e.push(a),n.push(l),i.push(c),r.push(a),r.push(l),r.push(c);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Fd(){return this.hours()%12||12}function iE(){return this.hours()||24}It("H",["HH",2],0,"hour");It("h",["hh",2],0,Fd);It("k",["kk",2],0,iE);It("hmm",0,0,function(){return""+Fd.apply(this)+Li(this.minutes(),2)});It("hmmss",0,0,function(){return""+Fd.apply(this)+Li(this.minutes(),2)+Li(this.seconds(),2)});It("Hmm",0,0,function(){return""+this.hours()+Li(this.minutes(),2)});It("Hmmss",0,0,function(){return""+this.hours()+Li(this.minutes(),2)+Li(this.seconds(),2)});function by(t,e){It(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}by("a",!0);by("A",!1);function xy(t,e){return e._meridiemParse}wt("a",xy);wt("A",xy);wt("H",$e,Nd);wt("h",$e,mo);wt("k",$e,mo);wt("HH",$e,Kn);wt("hh",$e,Kn);wt("kk",$e,Kn);wt("hmm",ly);wt("hmmss",cy);wt("Hmm",ly);wt("Hmmss",cy);xe(["H","HH"],dn);xe(["k","kk"],function(t,e,n){var i=ee(t);e[dn]=i===24?0:i});xe(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});xe(["h","hh"],function(t,e,n){e[dn]=ee(t),Ut(n).bigHour=!0});xe("hmm",function(t,e,n){var i=t.length-2;e[dn]=ee(t.substr(0,i)),e[pi]=ee(t.substr(i)),Ut(n).bigHour=!0});xe("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[dn]=ee(t.substr(0,i)),e[pi]=ee(t.substr(i,2)),e[Zi]=ee(t.substr(r)),Ut(n).bigHour=!0});xe("Hmm",function(t,e,n){var i=t.length-2;e[dn]=ee(t.substr(0,i)),e[pi]=ee(t.substr(i))});xe("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[dn]=ee(t.substr(0,i)),e[pi]=ee(t.substr(i,2)),e[Zi]=ee(t.substr(r))});function rE(t){return(t+"").toLowerCase().charAt(0)==="p"}var sE=/[ap]\.?m?\.?/i,oE=vo("Hours",!0);function aE(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var wy={calendar:qS,longDateFormat:QS,invalidDate:e1,ordinal:i1,dayOfMonthOrdinalParse:r1,relativeTime:o1,months:_1,monthsShort:dy,week:D1,weekdays:z1,weekdaysMin:U1,weekdaysShort:yy,meridiemParse:sE},Ve={},zo={},pa;function lE(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function Hp(t){return t&&t.toLowerCase().replace("_","-")}function cE(t){for(var e=0,n,i,r,s;e<t.length;){for(s=Hp(t[e]).split("-"),n=s.length,i=Hp(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=Nc(s.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&lE(s,i)>=n-1)break;n--}e++}return pa}function uE(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Nc(t){var e=null,n;if(Ve[t]===void 0&&typeof module<"u"&&module&&module.exports&&uE(t))try{e=pa._abbr,n=require,n("./locale/"+t),Ir(e)}catch{Ve[t]=null}return Ve[t]}function Ir(t,e){var n;return t&&(Un(e)?n=cr(t):n=Vd(t,e),n?pa=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),pa._abbr}function Vd(t,e){if(e!==null){var n,i=wy;if(e.abbr=t,Ve[t]!=null)ry("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=Ve[t]._config;else if(e.parentLocale!=null)if(Ve[e.parentLocale]!=null)i=Ve[e.parentLocale]._config;else if(n=Nc(e.parentLocale),n!=null)i=n._config;else return zo[e.parentLocale]||(zo[e.parentLocale]=[]),zo[e.parentLocale].push({name:t,config:e}),null;return Ve[t]=new Od(Ph(i,e)),zo[t]&&zo[t].forEach(function(r){Vd(r.name,r.config)}),Ir(t),Ve[t]}else return delete Ve[t],null}function hE(t,e){if(e!=null){var n,i,r=wy;Ve[t]!=null&&Ve[t].parentLocale!=null?Ve[t].set(Ph(Ve[t]._config,e)):(i=Nc(t),i!=null&&(r=i._config),e=Ph(r,e),i==null&&(e.abbr=t),n=new Od(e),n.parentLocale=Ve[t],Ve[t]=n),Ir(t)}else Ve[t]!=null&&(Ve[t].parentLocale!=null?(Ve[t]=Ve[t].parentLocale,t===Ir()&&Ir(t)):Ve[t]!=null&&delete Ve[t]);return Ve[t]}function cr(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return pa;if(!yi(t)){if(e=Nc(t),e)return e;t=[t]}return cE(t)}function dE(){return Ih(Ve)}function zd(t){var e,n=t._a;return n&&Ut(t).overflow===-2&&(e=n[Ki]<0||n[Ki]>11?Ki:n[Ci]<1||n[Ci]>Rd(n[An],n[Ki])?Ci:n[dn]<0||n[dn]>24||n[dn]===24&&(n[pi]!==0||n[Zi]!==0||n[jr]!==0)?dn:n[pi]<0||n[pi]>59?pi:n[Zi]<0||n[Zi]>59?Zi:n[jr]<0||n[jr]>999?jr:-1,Ut(t)._overflowDayOfYear&&(e<An||e>Ci)&&(e=Ci),Ut(t)._overflowWeeks&&e===-1&&(e=m1),Ut(t)._overflowWeekday&&e===-1&&(e=v1),Ut(t).overflow=e),t}var fE=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,pE=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gE=/Z|[+-]\d\d(?::?\d\d)?/,hl=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Bu=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],mE=/^\/?Date\((-?\d+)/i,vE=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,yE={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function _y(t){var e,n,i=t._i,r=fE.exec(i)||pE.exec(i),s,o,a,l,c=hl.length,h=Bu.length;if(r){for(Ut(t).iso=!0,e=0,n=c;e<n;e++)if(hl[e][1].exec(r[1])){o=hl[e][0],s=hl[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(r[3]){for(e=0,n=h;e<n;e++)if(Bu[e][1].exec(r[3])){a=(r[2]||" ")+Bu[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(r[4])if(gE.exec(r[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),Hd(t)}else t._isValid=!1}function bE(t,e,n,i,r,s){var o=[xE(t),dy.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return s&&o.push(parseInt(s,10)),o}function xE(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function wE(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function _E(t,e,n){if(t){var i=yy.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return Ut(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function SE(t,e,n){if(t)return yE[t];if(e)return 0;var i=parseInt(n,10),r=i%100,s=(i-r)/100;return s*60+r}function Sy(t){var e=vE.exec(wE(t._i)),n;if(e){if(n=bE(e[4],e[3],e[2],e[5],e[6],e[7]),!_E(e[1],n,t))return;t._a=n,t._tzm=SE(e[8],e[9],e[10]),t._d=da.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),Ut(t).rfc2822=!0}else t._isValid=!1}function EE(t){var e=mE.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(_y(t),t._isValid===!1)delete t._isValid;else return;if(Sy(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:vt.createFromInputFallback(t)}vt.createFromInputFallback=ci("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Rs(t,e,n){return t??e??n}function TE(t){var e=new Date(vt.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Ud(t){var e,n,i=[],r,s,o;if(!t._d){for(r=TE(t),t._w&&t._a[Ci]==null&&t._a[Ki]==null&&AE(t),t._dayOfYear!=null&&(o=Rs(t._a[An],r[An]),(t._dayOfYear>oa(o)||t._dayOfYear===0)&&(Ut(t)._overflowDayOfYear=!0),n=da(o,0,t._dayOfYear),t._a[Ki]=n.getUTCMonth(),t._a[Ci]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[dn]===24&&t._a[pi]===0&&t._a[Zi]===0&&t._a[jr]===0&&(t._nextDay=!0,t._a[dn]=0),t._d=(t._useUTC?da:L1).apply(null,i),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[dn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(Ut(t).weekdayMismatch=!0)}}function AE(t){var e,n,i,r,s,o,a,l,c;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,n=Rs(e.GG,t._a[An],fa(Re(),1,4).year),i=Rs(e.W,1),r=Rs(e.E,1),(r<1||r>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,c=fa(Re(),s,o),n=Rs(e.gg,t._a[An],c.year),i=Rs(e.w,c.week),e.d!=null?(r=e.d,(r<0||r>6)&&(l=!0)):e.e!=null?(r=e.e+s,(e.e<0||e.e>6)&&(l=!0)):r=s),i<1||i>nr(n,s,o)?Ut(t)._overflowWeeks=!0:l!=null?Ut(t)._overflowWeekday=!0:(a=vy(n,i,r,s,o),t._a[An]=a.year,t._dayOfYear=a.dayOfYear)}vt.ISO_8601=function(){};vt.RFC_2822=function(){};function Hd(t){if(t._f===vt.ISO_8601){_y(t);return}if(t._f===vt.RFC_2822){Sy(t);return}t._a=[],Ut(t).empty=!0;var e=""+t._i,n,i,r,s,o,a=e.length,l=0,c,h;for(r=sy(t._f,t._locale).match(kd)||[],h=r.length,n=0;n<h;n++)s=r[n],i=(e.match(f1(s,t))||[])[0],i&&(o=e.substr(0,e.indexOf(i)),o.length>0&&Ut(t).unusedInput.push(o),e=e.slice(e.indexOf(i)+i.length),l+=i.length),Gs[s]?(i?Ut(t).empty=!1:Ut(t).unusedTokens.push(s),g1(s,i,t)):t._strict&&!i&&Ut(t).unusedTokens.push(s);Ut(t).charsLeftOver=a-l,e.length>0&&Ut(t).unusedInput.push(e),t._a[dn]<=12&&Ut(t).bigHour===!0&&t._a[dn]>0&&(Ut(t).bigHour=void 0),Ut(t).parsedDateParts=t._a.slice(0),Ut(t).meridiem=t._meridiem,t._a[dn]=CE(t._locale,t._a[dn],t._meridiem),c=Ut(t).era,c!==null&&(t._a[An]=t._locale.erasConvertYear(c,t._a[An])),Ud(t),zd(t)}function CE(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function PE(t){var e,n,i,r,s,o,a=!1,l=t._f.length;if(l===0){Ut(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<l;r++)s=0,o=!1,e=Id({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],Hd(e),Pd(e)&&(o=!0),s+=Ut(e).charsLeftOver,s+=Ut(e).unusedTokens.length*10,Ut(e).score=s,a?s<i&&(i=s,n=e):(i==null||s<i||o)&&(i=s,n=e,o&&(a=!0));Ar(t,n||e)}function IE(t){if(!t._d){var e=Ld(t._i),n=e.day===void 0?e.date:e.day;t._a=ny([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),Ud(t)}}function OE(t){var e=new Oa(zd(Ey(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Ey(t){var e=t._i,n=t._f;return t._locale=t._locale||cr(t._l),e===null||n===void 0&&e===""?Pc({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),bi(e)?new Oa(zd(e)):(Ia(e)?t._d=e:yi(n)?PE(t):n?Hd(t):kE(t),Pd(t)||(t._d=null),t))}function kE(t){var e=t._i;Un(e)?t._d=new Date(vt.now()):Ia(e)?t._d=new Date(e.valueOf()):typeof e=="string"?EE(t):yi(e)?(t._a=ny(e.slice(0),function(n){return parseInt(n,10)}),Ud(t)):Qr(e)?IE(t):sr(e)?t._d=new Date(e):vt.createFromInputFallback(t)}function Ty(t,e,n,i,r){var s={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(Qr(t)&&Cd(t)||yi(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=r,s._l=n,s._i=t,s._f=e,s._strict=i,OE(s)}function Re(t,e,n,i){return Ty(t,e,n,i,!1)}var LE=ci("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Re.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Pc()}),ME=ci("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Re.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Pc()});function Ay(t,e){var n,i;if(e.length===1&&yi(e[0])&&(e=e[0]),!e.length)return Re();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function DE(){var t=[].slice.call(arguments,0);return Ay("isBefore",t)}function NE(){var t=[].slice.call(arguments,0);return Ay("isAfter",t)}var RE=function(){return Date.now?Date.now():+new Date},Uo=["year","quarter","month","week","day","hour","minute","second","millisecond"];function $E(t){var e,n=!1,i,r=Uo.length;for(e in t)if(de(t,e)&&!(Ke.call(Uo,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[Uo[i]]){if(n)return!1;parseFloat(t[Uo[i]])!==ee(t[Uo[i]])&&(n=!0)}return!0}function BE(){return this._isValid}function FE(){return wi(NaN)}function Rc(t){var e=Ld(t),n=e.year||0,i=e.quarter||0,r=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,c=e.second||0,h=e.millisecond||0;this._isValid=$E(e),this._milliseconds=+h+c*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+r+i*3+n*12,this._data={},this._locale=cr(),this._bubble()}function Vl(t){return t instanceof Rc}function kh(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function VE(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),s=0,o;for(o=0;o<i;o++)(n&&t[o]!==e[o]||!n&&ee(t[o])!==ee(e[o]))&&s++;return s+r}function Cy(t,e){It(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+Li(~~(n/60),2)+e+Li(~~n%60,2)})}Cy("Z",":");Cy("ZZ","");wt("Z",Mc);wt("ZZ",Mc);xe(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Gd(Mc,t)});var zE=/([\+\-]|\d\d)/gi;function Gd(t,e){var n=(e||"").match(t),i,r,s;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(zE)||["-",0,0],s=+(r[1]*60)+ee(r[2]),s===0?0:r[0]==="+"?s:-s)}function jd(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(bi(t)||Ia(t)?t.valueOf():Re(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),vt.updateOffset(n,!1),n):Re(t).local()}function Lh(t){return-Math.round(t._d.getTimezoneOffset())}vt.updateOffset=function(){};function UE(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=Gd(Mc,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=Lh(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?Oy(this,wi(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,vt.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:Lh(this)}function HE(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function GE(t){return this.utcOffset(0,t)}function jE(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Lh(this),"m")),this}function WE(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=Gd(h1,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function YE(t){return this.isValid()?(t=t?Re(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function XE(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function qE(){if(!Un(this._isDSTShifted))return this._isDSTShifted;var t={},e;return Id(t,this),t=Ey(t),t._a?(e=t._isUTC?Di(t._a):Re(t._a),this._isDSTShifted=this.isValid()&&VE(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function KE(){return this.isValid()?!this._isUTC:!1}function ZE(){return this.isValid()?this._isUTC:!1}function Py(){return this.isValid()?this._isUTC&&this._offset===0:!1}var JE=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,QE=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function wi(t,e){var n=t,i=null,r,s,o;return Vl(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:sr(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=JE.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:ee(i[Ci])*r,h:ee(i[dn])*r,m:ee(i[pi])*r,s:ee(i[Zi])*r,ms:ee(kh(i[jr]*1e3))*r}):(i=QE.exec(t))?(r=i[1]==="-"?-1:1,n={y:Br(i[2],r),M:Br(i[3],r),w:Br(i[4],r),d:Br(i[5],r),h:Br(i[6],r),m:Br(i[7],r),s:Br(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(o=tT(Re(n.from),Re(n.to)),n={},n.ms=o.milliseconds,n.M=o.months),s=new Rc(n),Vl(t)&&de(t,"_locale")&&(s._locale=t._locale),Vl(t)&&de(t,"_isValid")&&(s._isValid=t._isValid),s}wi.fn=Rc.prototype;wi.invalid=FE;function Br(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Gp(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function tT(t,e){var n;return t.isValid()&&e.isValid()?(e=jd(e,t),t.isBefore(e)?n=Gp(t,e):(n=Gp(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Iy(t,e){return function(n,i){var r,s;return i!==null&&!isNaN(+i)&&(ry(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=n,n=i,i=s),r=wi(n,i),Oy(this,r,t),this}}function Oy(t,e,n,i){var r=e._milliseconds,s=kh(e._days),o=kh(e._months);t.isValid()&&(i=i??!0,o&&py(t,ha(t,"Month")+o*n),s&&hy(t,"Date",ha(t,"Date")+s*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&vt.updateOffset(t,s||o))}var eT=Iy(1,"add"),nT=Iy(-1,"subtract");function ky(t){return typeof t=="string"||t instanceof String}function iT(t){return bi(t)||Ia(t)||ky(t)||sr(t)||sT(t)||rT(t)||t===null||t===void 0}function rT(t){var e=Qr(t)&&!Cd(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,s,o=i.length;for(r=0;r<o;r+=1)s=i[r],n=n||de(t,s);return e&&n}function sT(t){var e=yi(t),n=!1;return e&&(n=t.filter(function(i){return!sr(i)&&ky(t)}).length===0),e&&n}function oT(t){var e=Qr(t)&&!Cd(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,s;for(r=0;r<i.length;r+=1)s=i[r],n=n||de(t,s);return e&&n}function aT(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function lT(t,e){arguments.length===1&&(arguments[0]?iT(arguments[0])?(t=arguments[0],e=void 0):oT(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Re(),i=jd(n,this).startOf("day"),r=vt.calendarFormat(this,i)||"sameElse",s=e&&(Ni(e[r])?e[r].call(this,n):e[r]);return this.format(s||this.localeData().calendar(r,this,Re(n)))}function cT(){return new Oa(this)}function uT(t,e){var n=bi(t)?t:Re(t);return this.isValid()&&n.isValid()?(e=ui(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function hT(t,e){var n=bi(t)?t:Re(t);return this.isValid()&&n.isValid()?(e=ui(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function dT(t,e,n,i){var r=bi(t)?t:Re(t),s=bi(e)?e:Re(e);return this.isValid()&&r.isValid()&&s.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(s,n):!this.isAfter(s,n))):!1}function fT(t,e){var n=bi(t)?t:Re(t),i;return this.isValid()&&n.isValid()?(e=ui(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function pT(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function gT(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function mT(t,e,n){var i,r,s;if(!this.isValid())return NaN;if(i=jd(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=ui(e),e){case"year":s=zl(this,i)/12;break;case"month":s=zl(this,i);break;case"quarter":s=zl(this,i)/3;break;case"second":s=(this-i)/1e3;break;case"minute":s=(this-i)/6e4;break;case"hour":s=(this-i)/36e5;break;case"day":s=(this-i-r)/864e5;break;case"week":s=(this-i-r)/6048e5;break;default:s=this-i}return n?s:Qn(s)}function zl(t,e){if(t.date()<e.date())return-zl(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,s;return e-i<0?(r=t.clone().add(n-1,"months"),s=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),s=(e-i)/(r-i)),-(n+s)||0}vt.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";vt.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function vT(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function yT(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Fl(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ni(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Fl(n,"Z")):Fl(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function bT(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(n+i+r+s)}function xT(t){t||(t=this.isUtc()?vt.defaultFormatUtc:vt.defaultFormat);var e=Fl(this,t);return this.localeData().postformat(e)}function wT(t,e){return this.isValid()&&(bi(t)&&t.isValid()||Re(t).isValid())?wi({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function _T(t){return this.from(Re(),t)}function ST(t,e){return this.isValid()&&(bi(t)&&t.isValid()||Re(t).isValid())?wi({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function ET(t){return this.to(Re(),t)}function Ly(t){var e;return t===void 0?this._locale._abbr:(e=cr(t),e!=null&&(this._locale=e),this)}var My=ci("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function Dy(){return this._locale}var ec=1e3,js=60*ec,nc=60*js,Ny=(365*400+97)*24*nc;function Ws(t,e){return(t%e+e)%e}function Ry(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-Ny:new Date(t,e,n).valueOf()}function $y(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-Ny:Date.UTC(t,e,n)}function TT(t){var e,n;if(t=ui(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?$y:Ry,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Ws(e+(this._isUTC?0:this.utcOffset()*js),nc);break;case"minute":e=this._d.valueOf(),e-=Ws(e,js);break;case"second":e=this._d.valueOf(),e-=Ws(e,ec);break}return this._d.setTime(e),vt.updateOffset(this,!0),this}function AT(t){var e,n;if(t=ui(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?$y:Ry,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=nc-Ws(e+(this._isUTC?0:this.utcOffset()*js),nc)-1;break;case"minute":e=this._d.valueOf(),e+=js-Ws(e,js)-1;break;case"second":e=this._d.valueOf(),e+=ec-Ws(e,ec)-1;break}return this._d.setTime(e),vt.updateOffset(this,!0),this}function CT(){return this._d.valueOf()-(this._offset||0)*6e4}function PT(){return Math.floor(this.valueOf()/1e3)}function IT(){return new Date(this.valueOf())}function OT(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function kT(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function LT(){return this.isValid()?this.toISOString():null}function MT(){return Pd(this)}function DT(){return Ar({},Ut(this))}function NT(){return Ut(this).overflow}function RT(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}It("N",0,0,"eraAbbr");It("NN",0,0,"eraAbbr");It("NNN",0,0,"eraAbbr");It("NNNN",0,0,"eraName");It("NNNNN",0,0,"eraNarrow");It("y",["y",1],"yo","eraYear");It("y",["yy",2],0,"eraYear");It("y",["yyy",3],0,"eraYear");It("y",["yyyy",4],0,"eraYear");wt("N",Wd);wt("NN",Wd);wt("NNN",Wd);wt("NNNN",YT);wt("NNNNN",XT);xe(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?Ut(n).era=r:Ut(n).invalidEra=t});wt("y",go);wt("yy",go);wt("yyy",go);wt("yyyy",go);wt("yo",qT);xe(["y","yy","yyy","yyyy"],An);xe(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[An]=n._locale.eraYearOrdinalParse(t,r):e[An]=parseInt(t,10)});function $T(t,e){var n,i,r,s=this._eras||cr("en")._eras;for(n=0,i=s.length;n<i;++n){switch(typeof s[n].since){case"string":r=vt(s[n].since).startOf("day"),s[n].since=r.valueOf();break}switch(typeof s[n].until){case"undefined":s[n].until=1/0;break;case"string":r=vt(s[n].until).startOf("day").valueOf(),s[n].until=r.valueOf();break}}return s}function BT(t,e,n){var i,r,s=this.eras(),o,a,l;for(t=t.toUpperCase(),i=0,r=s.length;i<r;++i)if(o=s[i].name.toUpperCase(),a=s[i].abbr.toUpperCase(),l=s[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[i];break;case"NNNN":if(o===t)return s[i];break;case"NNNNN":if(l===t)return s[i];break}else if([o,a,l].indexOf(t)>=0)return s[i]}function FT(t,e){var n=t.since<=t.until?1:-1;return e===void 0?vt(t.since).year():vt(t.since).year()+(e-t.offset)*n}function VT(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function zT(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function UT(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function HT(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-vt(r[t].since).year())*n+r[t].offset;return this.year()}function GT(t){return de(this,"_erasNameRegex")||Yd.call(this),t?this._erasNameRegex:this._erasRegex}function jT(t){return de(this,"_erasAbbrRegex")||Yd.call(this),t?this._erasAbbrRegex:this._erasRegex}function WT(t){return de(this,"_erasNarrowRegex")||Yd.call(this),t?this._erasNarrowRegex:this._erasRegex}function Wd(t,e){return e.erasAbbrRegex(t)}function YT(t,e){return e.erasNameRegex(t)}function XT(t,e){return e.erasNarrowRegex(t)}function qT(t,e){return e._eraYearOrdinalRegex||go}function Yd(){var t=[],e=[],n=[],i=[],r,s,o,a,l,c=this.eras();for(r=0,s=c.length;r<s;++r)o=er(c[r].name),a=er(c[r].abbr),l=er(c[r].narrow),e.push(o),t.push(a),n.push(l),i.push(o),i.push(a),i.push(l);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}It(0,["gg",2],0,function(){return this.weekYear()%100});It(0,["GG",2],0,function(){return this.isoWeekYear()%100});function $c(t,e){It(0,[t,t.length],0,e)}$c("gggg","weekYear");$c("ggggg","weekYear");$c("GGGG","isoWeekYear");$c("GGGGG","isoWeekYear");wt("G",Lc);wt("g",Lc);wt("GG",$e,Kn);wt("gg",$e,Kn);wt("GGGG",Dd,Md);wt("gggg",Dd,Md);wt("GGGGG",kc,Ic);wt("ggggg",kc,Ic);La(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=ee(t)});La(["gg","GG"],function(t,e,n,i){e[i]=vt.parseTwoDigitYear(t)});function KT(t){return By.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function ZT(t){return By.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function JT(){return nr(this.year(),1,4)}function QT(){return nr(this.isoWeekYear(),1,4)}function tA(){var t=this.localeData()._week;return nr(this.year(),t.dow,t.doy)}function eA(){var t=this.localeData()._week;return nr(this.weekYear(),t.dow,t.doy)}function By(t,e,n,i,r){var s;return t==null?fa(this,i,r).year:(s=nr(t,i,r),e>s&&(e=s),nA.call(this,t,e,n,i,r))}function nA(t,e,n,i,r){var s=vy(t,e,n,i,r),o=da(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}It("Q",0,"Qo","quarter");wt("Q",oy);xe("Q",function(t,e){e[Ki]=(ee(t)-1)*3});function iA(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}It("D",["DD",2],"Do","date");wt("D",$e,mo);wt("DD",$e,Kn);wt("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});xe(["D","DD"],Ci);xe("Do",function(t,e){e[Ci]=ee(t.match($e)[0])});var Fy=vo("Date",!0);It("DDD",["DDDD",3],"DDDo","dayOfYear");wt("DDD",Oc);wt("DDDD",ay);xe(["DDD","DDDD"],function(t,e,n){n._dayOfYear=ee(t)});function rA(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}It("m",["mm",2],0,"minute");wt("m",$e,Nd);wt("mm",$e,Kn);xe(["m","mm"],pi);var sA=vo("Minutes",!1);It("s",["ss",2],0,"second");wt("s",$e,Nd);wt("ss",$e,Kn);xe(["s","ss"],Zi);var oA=vo("Seconds",!1);It("S",0,0,function(){return~~(this.millisecond()/100)});It(0,["SS",2],0,function(){return~~(this.millisecond()/10)});It(0,["SSS",3],0,"millisecond");It(0,["SSSS",4],0,function(){return this.millisecond()*10});It(0,["SSSSS",5],0,function(){return this.millisecond()*100});It(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});It(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});It(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});It(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});wt("S",Oc,oy);wt("SS",Oc,Kn);wt("SSS",Oc,ay);var Cr,Vy;for(Cr="SSSS";Cr.length<=9;Cr+="S")wt(Cr,go);function aA(t,e){e[jr]=ee(("0."+t)*1e3)}for(Cr="S";Cr.length<=9;Cr+="S")xe(Cr,aA);Vy=vo("Milliseconds",!1);It("z",0,0,"zoneAbbr");It("zz",0,0,"zoneName");function lA(){return this._isUTC?"UTC":""}function cA(){return this._isUTC?"Coordinated Universal Time":""}var lt=Oa.prototype;lt.add=eT;lt.calendar=lT;lt.clone=cT;lt.diff=mT;lt.endOf=AT;lt.format=xT;lt.from=wT;lt.fromNow=_T;lt.to=ST;lt.toNow=ET;lt.get=b1;lt.invalidAt=NT;lt.isAfter=uT;lt.isBefore=hT;lt.isBetween=dT;lt.isSame=fT;lt.isSameOrAfter=pT;lt.isSameOrBefore=gT;lt.isValid=MT;lt.lang=My;lt.locale=Ly;lt.localeData=Dy;lt.max=ME;lt.min=LE;lt.parsingFlags=DT;lt.set=x1;lt.startOf=TT;lt.subtract=nT;lt.toArray=OT;lt.toObject=kT;lt.toDate=IT;lt.toISOString=yT;lt.inspect=bT;typeof Symbol<"u"&&Symbol.for!=null&&(lt[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});lt.toJSON=LT;lt.toString=vT;lt.unix=PT;lt.valueOf=CT;lt.creationData=RT;lt.eraName=VT;lt.eraNarrow=zT;lt.eraAbbr=UT;lt.eraYear=HT;lt.year=uy;lt.isLeapYear=y1;lt.weekYear=KT;lt.isoWeekYear=ZT;lt.quarter=lt.quarters=iA;lt.month=gy;lt.daysInMonth=I1;lt.week=lt.weeks=$1;lt.isoWeek=lt.isoWeeks=B1;lt.weeksInYear=tA;lt.weeksInWeekYear=eA;lt.isoWeeksInYear=JT;lt.isoWeeksInISOWeekYear=QT;lt.date=Fy;lt.day=lt.days=Z1;lt.weekday=J1;lt.isoWeekday=Q1;lt.dayOfYear=rA;lt.hour=lt.hours=oE;lt.minute=lt.minutes=sA;lt.second=lt.seconds=oA;lt.millisecond=lt.milliseconds=Vy;lt.utcOffset=UE;lt.utc=GE;lt.local=jE;lt.parseZone=WE;lt.hasAlignedHourOffset=YE;lt.isDST=XE;lt.isLocal=KE;lt.isUtcOffset=ZE;lt.isUtc=Py;lt.isUTC=Py;lt.zoneAbbr=lA;lt.zoneName=cA;lt.dates=ci("dates accessor is deprecated. Use date instead.",Fy);lt.months=ci("months accessor is deprecated. Use month instead",gy);lt.years=ci("years accessor is deprecated. Use year instead",uy);lt.zone=ci("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",HE);lt.isDSTShifted=ci("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",qE);function uA(t){return Re(t*1e3)}function hA(){return Re.apply(null,arguments).parseZone()}function zy(t){return t}var fe=Od.prototype;fe.calendar=KS;fe.longDateFormat=t1;fe.invalidDate=n1;fe.ordinal=s1;fe.preparse=zy;fe.postformat=zy;fe.relativeTime=a1;fe.pastFuture=l1;fe.set=XS;fe.eras=$T;fe.erasParse=BT;fe.erasConvertYear=FT;fe.erasAbbrRegex=jT;fe.erasNameRegex=GT;fe.erasNarrowRegex=WT;fe.months=T1;fe.monthsShort=A1;fe.monthsParse=P1;fe.monthsRegex=k1;fe.monthsShortRegex=O1;fe.week=M1;fe.firstDayOfYear=R1;fe.firstDayOfWeek=N1;fe.weekdays=W1;fe.weekdaysMin=X1;fe.weekdaysShort=Y1;fe.weekdaysParse=K1;fe.weekdaysRegex=tE;fe.weekdaysShortRegex=eE;fe.weekdaysMinRegex=nE;fe.isPM=rE;fe.meridiem=aE;function ic(t,e,n,i){var r=cr(),s=Di().set(i,e);return r[n](s,t)}function Uy(t,e,n){if(sr(t)&&(e=t,t=void 0),t=t||"",e!=null)return ic(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=ic(t,i,n,"month");return r}function Xd(t,e,n,i){typeof t=="boolean"?(sr(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,sr(e)&&(n=e,e=void 0),e=e||"");var r=cr(),s=t?r._week.dow:0,o,a=[];if(n!=null)return ic(e,(n+s)%7,i,"day");for(o=0;o<7;o++)a[o]=ic(e,(o+s)%7,i,"day");return a}function dA(t,e){return Uy(t,e,"months")}function fA(t,e){return Uy(t,e,"monthsShort")}function pA(t,e,n){return Xd(t,e,n,"weekdays")}function gA(t,e,n){return Xd(t,e,n,"weekdaysShort")}function mA(t,e,n){return Xd(t,e,n,"weekdaysMin")}Ir("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=ee(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});vt.lang=ci("moment.lang is deprecated. Use moment.locale instead.",Ir);vt.langData=ci("moment.langData is deprecated. Use moment.localeData instead.",cr);var Hi=Math.abs;function vA(){var t=this._data;return this._milliseconds=Hi(this._milliseconds),this._days=Hi(this._days),this._months=Hi(this._months),t.milliseconds=Hi(t.milliseconds),t.seconds=Hi(t.seconds),t.minutes=Hi(t.minutes),t.hours=Hi(t.hours),t.months=Hi(t.months),t.years=Hi(t.years),this}function Hy(t,e,n,i){var r=wi(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function yA(t,e){return Hy(this,t,e,1)}function bA(t,e){return Hy(this,t,e,-1)}function jp(t){return t<0?Math.floor(t):Math.ceil(t)}function xA(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,s,o,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=jp(Mh(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=Qn(t/1e3),i.seconds=r%60,s=Qn(r/60),i.minutes=s%60,o=Qn(s/60),i.hours=o%24,e+=Qn(o/24),l=Qn(Gy(e)),n+=l,e-=jp(Mh(l)),a=Qn(n/12),n%=12,i.days=e,i.months=n,i.years=a,this}function Gy(t){return t*4800/146097}function Mh(t){return t*146097/4800}function wA(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=ui(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+Gy(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(Mh(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function ur(t){return function(){return this.as(t)}}var jy=ur("ms"),_A=ur("s"),SA=ur("m"),EA=ur("h"),TA=ur("d"),AA=ur("w"),CA=ur("M"),PA=ur("Q"),IA=ur("y"),OA=jy;function kA(){return wi(this)}function LA(t){return t=ui(t),this.isValid()?this[t+"s"]():NaN}function hs(t){return function(){return this.isValid()?this._data[t]:NaN}}var MA=hs("milliseconds"),DA=hs("seconds"),NA=hs("minutes"),RA=hs("hours"),$A=hs("days"),BA=hs("months"),FA=hs("years");function VA(){return Qn(this.days()/7)}var ji=Math.round,Vs={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function zA(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function UA(t,e,n,i){var r=wi(t).abs(),s=ji(r.as("s")),o=ji(r.as("m")),a=ji(r.as("h")),l=ji(r.as("d")),c=ji(r.as("M")),h=ji(r.as("w")),u=ji(r.as("y")),d=s<=n.ss&&["s",s]||s<n.s&&["ss",s]||o<=1&&["m"]||o<n.m&&["mm",o]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||h<=1&&["w"]||h<n.w&&["ww",h]),d=d||c<=1&&["M"]||c<n.M&&["MM",c]||u<=1&&["y"]||["yy",u],d[2]=e,d[3]=+t>0,d[4]=i,zA.apply(null,d)}function HA(t){return t===void 0?ji:typeof t=="function"?(ji=t,!0):!1}function GA(t,e){return Vs[t]===void 0?!1:e===void 0?Vs[t]:(Vs[t]=e,t==="s"&&(Vs.ss=e-1),!0)}function jA(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=Vs,r,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},Vs,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),s=UA(this,!n,i,r),n&&(s=r.pastFuture(+this,s)),r.postformat(s)}var Fu=Math.abs;function Is(t){return(t>0)-(t<0)||+t}function Bc(){if(!this.isValid())return this.localeData().invalidDate();var t=Fu(this._milliseconds)/1e3,e=Fu(this._days),n=Fu(this._months),i,r,s,o,a=this.asSeconds(),l,c,h,u;return a?(i=Qn(t/60),r=Qn(i/60),t%=60,i%=60,s=Qn(n/12),n%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",c=Is(this._months)!==Is(a)?"-":"",h=Is(this._days)!==Is(a)?"-":"",u=Is(this._milliseconds)!==Is(a)?"-":"",l+"P"+(s?c+s+"Y":"")+(n?c+n+"M":"")+(e?h+e+"D":"")+(r||i||t?"T":"")+(r?u+r+"H":"")+(i?u+i+"M":"")+(t?u+o+"S":"")):"P0D"}var le=Rc.prototype;le.isValid=BE;le.abs=vA;le.add=yA;le.subtract=bA;le.as=wA;le.asMilliseconds=jy;le.asSeconds=_A;le.asMinutes=SA;le.asHours=EA;le.asDays=TA;le.asWeeks=AA;le.asMonths=CA;le.asQuarters=PA;le.asYears=IA;le.valueOf=OA;le._bubble=xA;le.clone=kA;le.get=LA;le.milliseconds=MA;le.seconds=DA;le.minutes=NA;le.hours=RA;le.days=$A;le.weeks=VA;le.months=BA;le.years=FA;le.humanize=jA;le.toISOString=Bc;le.toString=Bc;le.toJSON=Bc;le.locale=Ly;le.localeData=Dy;le.toIsoString=ci("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Bc);le.lang=My;It("X",0,0,"unix");It("x",0,0,"valueOf");wt("x",Lc);wt("X",d1);xe("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});xe("x",function(t,e,n){n._d=new Date(ee(t))});//! moment.js
vt.version="2.30.1";WS(Re);vt.fn=lt;vt.min=DE;vt.max=NE;vt.now=RE;vt.utc=Di;vt.unix=uA;vt.months=dA;vt.isDate=Ia;vt.locale=Ir;vt.invalid=Pc;vt.duration=wi;vt.isMoment=bi;vt.weekdays=pA;vt.parseZone=hA;vt.localeData=cr;vt.isDuration=Vl;vt.monthsShort=fA;vt.weekdaysMin=mA;vt.defineLocale=Vd;vt.updateLocale=hE;vt.locales=dE;vt.weekdaysShort=gA;vt.normalizeUnits=ui;vt.relativeTimeRounding=HA;vt.relativeTimeThreshold=GA;vt.calendarFormat=aT;vt.prototype=lt;vt.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function Wp(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Wy(t,e,n){return e&&Wp(t.prototype,e),n&&Wp(t,n),t}function gi(){return gi=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},gi.apply(this,arguments)}function qd(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function rs(t){return!!(t&&typeof t.hasOwnProperty=="function"&&(t.hasOwnProperty("__ownerID")||t._map&&t._map.hasOwnProperty("__ownerID")))}function Yy(t,e,n){return Object.keys(t).reduce(function(i,r){var s=""+r;return i.has(s)?i.set(s,n(i.get(s),t[s])):i},e)}var WA=function(e){return function(n){return rs(n)?n.get(e):n[e]}},Kd=function(){function t(n,i,r){if(i===void 0&&(i={}),r===void 0&&(r={}),!n||typeof n!="string")throw new Error("Expected a string key for Entity, but found "+n+".");var s=r,o=s.idAttribute,a=o===void 0?"id":o,l=s.mergeStrategy,c=l===void 0?function(p,g){return gi({},p,g)}:l,h=s.processStrategy,u=h===void 0?function(p){return gi({},p)}:h,d=s.fallbackStrategy,f=d===void 0?function(p,g){}:d;this._key=n,this._getId=typeof a=="function"?a:WA(a),this._idAttribute=a,this._mergeStrategy=c,this._processStrategy=u,this._fallbackStrategy=f,this.define(i)}var e=t.prototype;return e.define=function(i){this.schema=Object.keys(i).reduce(function(r,s){var o,a=i[s];return gi({},r,(o={},o[s]=a,o))},this.schema||{})},e.getId=function(i,r,s){return this._getId(i,r,s)},e.merge=function(i,r){return this._mergeStrategy(i,r)},e.fallback=function(i,r){return this._fallbackStrategy(i,r)},e.normalize=function(i,r,s,o,a,l){var c=this,h=this.getId(i,r,s),u=this.key;if(u in l||(l[u]={}),h in l[u]||(l[u][h]=[]),l[u][h].some(function(f){return f===i}))return h;l[u][h].push(i);var d=this._processStrategy(i,r,s);return Object.keys(this.schema).forEach(function(f){if(d.hasOwnProperty(f)&&typeof d[f]=="object"){var p=c.schema[f],g=typeof p=="function"?p(i):p;d[f]=o(d[f],d,f,g,a,l)}}),a(this,d,i,r,s),h},e.denormalize=function(i,r){var s=this;return rs(i)?Yy(this.schema,i,r):(Object.keys(this.schema).forEach(function(o){if(i.hasOwnProperty(o)){var a=s.schema[o];i[o]=r(i[o],a)}}),i)},Wy(t,[{key:"key",get:function(){return this._key}},{key:"idAttribute",get:function(){return this._idAttribute}}]),t}(),Zd=function(){function t(n,i){i&&(this._schemaAttribute=typeof i=="string"?function(r){return r[i]}:i),this.define(n)}var e=t.prototype;return e.define=function(i){this.schema=i},e.getSchemaAttribute=function(i,r,s){return!this.isSingleSchema&&this._schemaAttribute(i,r,s)},e.inferSchema=function(i,r,s){if(this.isSingleSchema)return this.schema;var o=this.getSchemaAttribute(i,r,s);return this.schema[o]},e.normalizeValue=function(i,r,s,o,a,l){var c=this.inferSchema(i,r,s);if(!c)return i;var h=o(i,r,s,c,a,l);return this.isSingleSchema||h===void 0||h===null?h:{id:h,schema:this.getSchemaAttribute(i,r,s)}},e.denormalizeValue=function(i,r){var s=rs(i)?i.get("schema"):i.schema;if(!this.isSingleSchema&&!s)return i;var o=this.isSingleSchema?void 0:rs(i)?i.get("id"):i.id,a=this.isSingleSchema?this.schema:this.schema[s];return r(o||i,a)},Wy(t,[{key:"isSingleSchema",get:function(){return!this._schemaAttribute}}]),t}(),YA=function(t){qd(e,t);function e(i,r){if(!r)throw new Error('Expected option "schemaAttribute" not found on UnionSchema.');return t.call(this,i,r)||this}var n=e.prototype;return n.normalize=function(r,s,o,a,l,c){return this.normalizeValue(r,s,o,a,l,c)},n.denormalize=function(r,s){return this.denormalizeValue(r,s)},e}(Zd),XA=function(t){qd(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;return n.normalize=function(r,s,o,a,l,c){var h=this;return Object.keys(r).reduce(function(u,d,f){var p,g=r[d];return g!=null?gi({},u,(p={},p[d]=h.normalizeValue(g,r,d,a,l,c),p)):u},{})},n.denormalize=function(r,s){var o=this;return Object.keys(r).reduce(function(a,l){var c,h=r[l];return gi({},a,(c={},c[l]=o.denormalizeValue(h,s),c))},{})},e}(Zd),Xy=function(e){var n=Array.isArray(e);if(n&&e.length>1)throw new Error("Expected schema definition to be a single schema, but found "+e.length+".");return e[0]},qy=function(e){return Array.isArray(e)?e:Object.keys(e).map(function(n){return e[n]})},qA=function(e,n,i,r,s,o,a){e=Xy(e);var l=qy(n);return l.map(function(c,h){return s(c,i,r,e,o,a)})},KA=function(e,n,i){return e=Xy(e),n&&n.map?n.map(function(r){return i(r,e)}):n},ZA=function(t){qd(e,t);function e(){return t.apply(this,arguments)||this}var n=e.prototype;return n.normalize=function(r,s,o,a,l,c){var h=this,u=qy(r);return u.map(function(d,f){return h.normalizeValue(d,s,o,a,l,c)}).filter(function(d){return d!=null})},n.denormalize=function(r,s){var o=this;return r&&r.map?r.map(function(a){return o.denormalizeValue(a,s)}):r},e}(Zd),Ky=function(e,n,i,r,s,o,a){var l=gi({},n);return Object.keys(e).forEach(function(c){var h=e[c],u=typeof h=="function"?h(n):h,d=s(n[c],n,c,u,o,a);d==null?delete l[c]:l[c]=d}),l},Zy=function(e,n,i){if(rs(n))return Yy(e,n,i);var r=gi({},n);return Object.keys(e).forEach(function(s){r[s]!=null&&(r[s]=i(r[s],e[s]))}),r},JA=function(){function t(n){this.define(n)}var e=t.prototype;return e.define=function(i){this.schema=Object.keys(i).reduce(function(r,s){var o,a=i[s];return gi({},r,(o={},o[s]=a,o))},this.schema||{})},e.normalize=function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Ky.apply(void 0,[this.schema].concat(r))},e.denormalize=function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Zy.apply(void 0,[this.schema].concat(r))},t}(),QA=function t(e,n,i,r,s,o){if(typeof e!="object"||!e)return e;if(typeof r=="object"&&(!r.normalize||typeof r.normalize!="function")){var a=Array.isArray(r)?qA:Ky;return a(r,e,n,i,t,s,o)}return r.normalize(e,n,i,t,s,o)},tC=function(e){return function(n,i,r,s,o){var a=n.key,l=n.getId(r,s,o);a in e||(e[a]={});var c=e[a][l];c?e[a][l]=n.merge(c,i):e[a][l]=i}},yo={Array:ZA,Entity:Kd,Object:JA,Union:YA,Values:XA},eC=function(e,n){if(!e||typeof e!="object")throw new Error('Unexpected input given to normalize. Expected type to be "object", found "'+(e===null?"null":typeof e)+'".');var i={},r=tC(i),s={},o=QA(e,e,null,n,r,s);return{entities:i,result:o}},nC=function(e,n,i,r,s){var o=r(e,n);if(o===void 0&&n instanceof Kd&&(o=n.fallback(e,n)),typeof o!="object"||o===null)return o;if(s[n.key]||(s[n.key]={}),!s[n.key][e]){var a=rs(o)?o:gi({},o);s[n.key][e]=a,s[n.key][e]=n.denormalize(a,i)}return s[n.key][e]},iC=function(e){var n={},i=rC(e);return function r(s,o){if(typeof o=="object"&&(!o.denormalize||typeof o.denormalize!="function")){var a=Array.isArray(o)?KA:Zy;return a(o,s,r)}return s==null?s:o instanceof Kd?nC(s,o,r,i,n):o.denormalize(s,r)}},rC=function(e){var n=rs(e);return function(i,r){var s=r.key;return typeof i=="object"?i:n?e.getIn([s,i.toString()]):e[s]&&e[s][i]}},sC=function(e,n,i){if(typeof e<"u")return iC(i)(e,n)},oC=typeof Gr=="object"&&Gr&&Gr.Object===Object&&Gr,Jy=oC,aC=Jy,lC=typeof self=="object"&&self&&self.Object===Object&&self,cC=aC||lC||Function("return this")(),Ri=cC,uC=Ri,hC=uC.Symbol,Ma=hC,Yp=Ma,Qy=Object.prototype,dC=Qy.hasOwnProperty,fC=Qy.toString,Ho=Yp?Yp.toStringTag:void 0;function pC(t){var e=dC.call(t,Ho),n=t[Ho];try{t[Ho]=void 0;var i=!0}catch{}var r=fC.call(t);return i&&(e?t[Ho]=n:delete t[Ho]),r}var gC=pC,mC=Object.prototype,vC=mC.toString;function yC(t){return vC.call(t)}var bC=yC,Xp=Ma,xC=gC,wC=bC,_C="[object Null]",SC="[object Undefined]",qp=Xp?Xp.toStringTag:void 0;function EC(t){return t==null?t===void 0?SC:_C:qp&&qp in Object(t)?xC(t):wC(t)}var Da=EC;function TC(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var ds=TC,AC=Da,CC=ds,PC="[object AsyncFunction]",IC="[object Function]",OC="[object GeneratorFunction]",kC="[object Proxy]";function LC(t){if(!CC(t))return!1;var e=AC(t);return e==IC||e==OC||e==PC||e==kC}var tb=LC,MC=Ri,DC=MC["__core-js_shared__"],NC=DC,Vu=NC,Kp=function(){var t=/[^.]+$/.exec(Vu&&Vu.keys&&Vu.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function RC(t){return!!Kp&&Kp in t}var $C=RC,BC=Function.prototype,FC=BC.toString;function VC(t){if(t!=null){try{return FC.call(t)}catch{}try{return t+""}catch{}}return""}var eb=VC,zC=tb,UC=$C,HC=ds,GC=eb,jC=/[\\^$.*+?()[\]{}|]/g,WC=/^\[object .+?Constructor\]$/,YC=Function.prototype,XC=Object.prototype,qC=YC.toString,KC=XC.hasOwnProperty,ZC=RegExp("^"+qC.call(KC).replace(jC,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function JC(t){if(!HC(t)||UC(t))return!1;var e=zC(t)?ZC:WC;return e.test(GC(t))}var QC=JC;function tP(t,e){return t==null?void 0:t[e]}var eP=tP,nP=QC,iP=eP;function rP(t,e){var n=iP(t,e);return nP(n)?n:void 0}var fs=rP,sP=fs,oP=function(){try{var t=sP(Object,"defineProperty");return t({},"",{}),t}catch{}}(),aP=oP,Zp=aP;function lP(t,e,n){e=="__proto__"&&Zp?Zp(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var Jd=lP;function cP(t){return function(e,n,i){for(var r=-1,s=Object(e),o=i(e),a=o.length;a--;){var l=o[t?a:++r];if(n(s[l],l,s)===!1)break}return e}}var uP=cP,hP=uP,dP=hP(),fP=dP;function pP(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var gP=pP;function mP(t){return t!=null&&typeof t=="object"}var ps=mP,vP=Da,yP=ps,bP="[object Arguments]";function xP(t){return yP(t)&&vP(t)==bP}var wP=xP,Jp=wP,_P=ps,nb=Object.prototype,SP=nb.hasOwnProperty,EP=nb.propertyIsEnumerable,TP=Jp(function(){return arguments}())?Jp:function(t){return _P(t)&&SP.call(t,"callee")&&!EP.call(t,"callee")},Qd=TP,AP=Array.isArray,Rn=AP,rc={exports:{}};function CP(){return!1}var PP=CP;rc.exports;(function(t,e){var n=Ri,i=PP,r=e&&!e.nodeType&&e,s=r&&!0&&t&&!t.nodeType&&t,o=s&&s.exports===r,a=o?n.Buffer:void 0,l=a?a.isBuffer:void 0,c=l||i;t.exports=c})(rc,rc.exports);var Fc=rc.exports,IP=9007199254740991,OP=/^(?:0|[1-9]\d*)$/;function kP(t,e){var n=typeof t;return e=e??IP,!!e&&(n=="number"||n!="symbol"&&OP.test(t))&&t>-1&&t%1==0&&t<e}var ib=kP,LP=9007199254740991;function MP(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=LP}var tf=MP,DP=Da,NP=tf,RP=ps,$P="[object Arguments]",BP="[object Array]",FP="[object Boolean]",VP="[object Date]",zP="[object Error]",UP="[object Function]",HP="[object Map]",GP="[object Number]",jP="[object Object]",WP="[object RegExp]",YP="[object Set]",XP="[object String]",qP="[object WeakMap]",KP="[object ArrayBuffer]",ZP="[object DataView]",JP="[object Float32Array]",QP="[object Float64Array]",tI="[object Int8Array]",eI="[object Int16Array]",nI="[object Int32Array]",iI="[object Uint8Array]",rI="[object Uint8ClampedArray]",sI="[object Uint16Array]",oI="[object Uint32Array]",De={};De[JP]=De[QP]=De[tI]=De[eI]=De[nI]=De[iI]=De[rI]=De[sI]=De[oI]=!0;De[$P]=De[BP]=De[KP]=De[FP]=De[ZP]=De[VP]=De[zP]=De[UP]=De[HP]=De[GP]=De[jP]=De[WP]=De[YP]=De[XP]=De[qP]=!1;function aI(t){return RP(t)&&NP(t.length)&&!!De[DP(t)]}var lI=aI;function cI(t){return function(e){return t(e)}}var Vc=cI,sc={exports:{}};sc.exports;(function(t,e){var n=Jy,i=e&&!e.nodeType&&e,r=i&&!0&&t&&!t.nodeType&&t,s=r&&r.exports===i,o=s&&n.process,a=function(){try{var l=r&&r.require&&r.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();t.exports=a})(sc,sc.exports);var ef=sc.exports,uI=lI,hI=Vc,Qp=ef,tg=Qp&&Qp.isTypedArray,dI=tg?hI(tg):uI,nf=dI,fI=gP,pI=Qd,gI=Rn,mI=Fc,vI=ib,yI=nf,bI=Object.prototype,xI=bI.hasOwnProperty;function wI(t,e){var n=gI(t),i=!n&&pI(t),r=!n&&!i&&mI(t),s=!n&&!i&&!r&&yI(t),o=n||i||r||s,a=o?fI(t.length,String):[],l=a.length;for(var c in t)(e||xI.call(t,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||vI(c,l)))&&a.push(c);return a}var rb=wI,_I=Object.prototype;function SI(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||_I;return t===n}var zc=SI;function EI(t,e){return function(n){return t(e(n))}}var sb=EI,TI=sb,AI=TI(Object.keys,Object),CI=AI,PI=zc,II=CI,OI=Object.prototype,kI=OI.hasOwnProperty;function LI(t){if(!PI(t))return II(t);var e=[];for(var n in Object(t))kI.call(t,n)&&n!="constructor"&&e.push(n);return e}var ob=LI,MI=tb,DI=tf;function NI(t){return t!=null&&DI(t.length)&&!MI(t)}var bo=NI,RI=rb,$I=ob,BI=bo;function FI(t){return BI(t)?RI(t):$I(t)}var xo=FI,VI=fP,zI=xo;function UI(t,e){return t&&VI(t,e,zI)}var ab=UI;function HI(){this.__data__=[],this.size=0}var GI=HI;function jI(t,e){return t===e||t!==t&&e!==e}var rf=jI,WI=rf;function YI(t,e){for(var n=t.length;n--;)if(WI(t[n][0],e))return n;return-1}var Uc=YI,XI=Uc,qI=Array.prototype,KI=qI.splice;function ZI(t){var e=this.__data__,n=XI(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():KI.call(e,n,1),--this.size,!0}var JI=ZI,QI=Uc;function tO(t){var e=this.__data__,n=QI(e,t);return n<0?void 0:e[n][1]}var eO=tO,nO=Uc;function iO(t){return nO(this.__data__,t)>-1}var rO=iO,sO=Uc;function oO(t,e){var n=this.__data__,i=sO(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}var aO=oO,lO=GI,cO=JI,uO=eO,hO=rO,dO=aO;function wo(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}wo.prototype.clear=lO;wo.prototype.delete=cO;wo.prototype.get=uO;wo.prototype.has=hO;wo.prototype.set=dO;var Hc=wo,fO=Hc;function pO(){this.__data__=new fO,this.size=0}var gO=pO;function mO(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var vO=mO;function yO(t){return this.__data__.get(t)}var bO=yO;function xO(t){return this.__data__.has(t)}var wO=xO,_O=fs,SO=Ri,EO=_O(SO,"Map"),sf=EO,TO=fs,AO=TO(Object,"create"),Gc=AO,eg=Gc;function CO(){this.__data__=eg?eg(null):{},this.size=0}var PO=CO;function IO(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var OO=IO,kO=Gc,LO="__lodash_hash_undefined__",MO=Object.prototype,DO=MO.hasOwnProperty;function NO(t){var e=this.__data__;if(kO){var n=e[t];return n===LO?void 0:n}return DO.call(e,t)?e[t]:void 0}var RO=NO,$O=Gc,BO=Object.prototype,FO=BO.hasOwnProperty;function VO(t){var e=this.__data__;return $O?e[t]!==void 0:FO.call(e,t)}var zO=VO,UO=Gc,HO="__lodash_hash_undefined__";function GO(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=UO&&e===void 0?HO:e,this}var jO=GO,WO=PO,YO=OO,XO=RO,qO=zO,KO=jO;function _o(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}_o.prototype.clear=WO;_o.prototype.delete=YO;_o.prototype.get=XO;_o.prototype.has=qO;_o.prototype.set=KO;var ZO=_o,ng=ZO,JO=Hc,QO=sf;function tk(){this.size=0,this.__data__={hash:new ng,map:new(QO||JO),string:new ng}}var ek=tk;function nk(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var ik=nk,rk=ik;function sk(t,e){var n=t.__data__;return rk(e)?n[typeof e=="string"?"string":"hash"]:n.map}var jc=sk,ok=jc;function ak(t){var e=ok(this,t).delete(t);return this.size-=e?1:0,e}var lk=ak,ck=jc;function uk(t){return ck(this,t).get(t)}var hk=uk,dk=jc;function fk(t){return dk(this,t).has(t)}var pk=fk,gk=jc;function mk(t,e){var n=gk(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}var vk=mk,yk=ek,bk=lk,xk=hk,wk=pk,_k=vk;function So(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}So.prototype.clear=yk;So.prototype.delete=bk;So.prototype.get=xk;So.prototype.has=wk;So.prototype.set=_k;var of=So,Sk=Hc,Ek=sf,Tk=of,Ak=200;function Ck(t,e){var n=this.__data__;if(n instanceof Sk){var i=n.__data__;if(!Ek||i.length<Ak-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Tk(i)}return n.set(t,e),this.size=n.size,this}var Pk=Ck,Ik=Hc,Ok=gO,kk=vO,Lk=bO,Mk=wO,Dk=Pk;function Eo(t){var e=this.__data__=new Ik(t);this.size=e.size}Eo.prototype.clear=Ok;Eo.prototype.delete=kk;Eo.prototype.get=Lk;Eo.prototype.has=Mk;Eo.prototype.set=Dk;var af=Eo,Nk="__lodash_hash_undefined__";function Rk(t){return this.__data__.set(t,Nk),this}var $k=Rk;function Bk(t){return this.__data__.has(t)}var Fk=Bk,Vk=of,zk=$k,Uk=Fk;function oc(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Vk;++e<n;)this.add(t[e])}oc.prototype.add=oc.prototype.push=zk;oc.prototype.has=Uk;var Hk=oc;function Gk(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var jk=Gk;function Wk(t,e){return t.has(e)}var Yk=Wk,Xk=Hk,qk=jk,Kk=Yk,Zk=1,Jk=2;function Qk(t,e,n,i,r,s){var o=n&Zk,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),h=s.get(e);if(c&&h)return c==e&&h==t;var u=-1,d=!0,f=n&Jk?new Xk:void 0;for(s.set(t,e),s.set(e,t);++u<a;){var p=t[u],g=e[u];if(i)var v=o?i(g,p,u,e,t,s):i(p,g,u,t,e,s);if(v!==void 0){if(v)continue;d=!1;break}if(f){if(!qk(e,function(x,S){if(!Kk(f,S)&&(p===x||r(p,x,n,i,s)))return f.push(S)})){d=!1;break}}else if(!(p===g||r(p,g,n,i,s))){d=!1;break}}return s.delete(t),s.delete(e),d}var lb=Qk,t2=Ri,e2=t2.Uint8Array,cb=e2;function n2(t){var e=-1,n=Array(t.size);return t.forEach(function(i,r){n[++e]=[r,i]}),n}var i2=n2;function r2(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}var s2=r2,ig=Ma,rg=cb,o2=rf,a2=lb,l2=i2,c2=s2,u2=1,h2=2,d2="[object Boolean]",f2="[object Date]",p2="[object Error]",g2="[object Map]",m2="[object Number]",v2="[object RegExp]",y2="[object Set]",b2="[object String]",x2="[object Symbol]",w2="[object ArrayBuffer]",_2="[object DataView]",sg=ig?ig.prototype:void 0,zu=sg?sg.valueOf:void 0;function S2(t,e,n,i,r,s,o){switch(n){case _2:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case w2:return!(t.byteLength!=e.byteLength||!s(new rg(t),new rg(e)));case d2:case f2:case m2:return o2(+t,+e);case p2:return t.name==e.name&&t.message==e.message;case v2:case b2:return t==e+"";case g2:var a=l2;case y2:var l=i&u2;if(a||(a=c2),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;i|=h2,o.set(t,e);var h=a2(a(t),a(e),i,r,s,o);return o.delete(t),h;case x2:if(zu)return zu.call(t)==zu.call(e)}return!1}var E2=S2;function T2(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}var ub=T2,A2=ub,C2=Rn;function P2(t,e,n){var i=e(t);return C2(t)?i:A2(i,n(t))}var hb=P2;function I2(t,e){for(var n=-1,i=t==null?0:t.length,r=0,s=[];++n<i;){var o=t[n];e(o,n,t)&&(s[r++]=o)}return s}var db=I2;function O2(){return[]}var fb=O2,k2=db,L2=fb,M2=Object.prototype,D2=M2.propertyIsEnumerable,og=Object.getOwnPropertySymbols,N2=og?function(t){return t==null?[]:(t=Object(t),k2(og(t),function(e){return D2.call(t,e)}))}:L2,lf=N2,R2=hb,$2=lf,B2=xo;function F2(t){return R2(t,B2,$2)}var pb=F2,ag=pb,V2=1,z2=Object.prototype,U2=z2.hasOwnProperty;function H2(t,e,n,i,r,s){var o=n&V2,a=ag(t),l=a.length,c=ag(e),h=c.length;if(l!=h&&!o)return!1;for(var u=l;u--;){var d=a[u];if(!(o?d in e:U2.call(e,d)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var g=!0;s.set(t,e),s.set(e,t);for(var v=o;++u<l;){d=a[u];var x=t[d],S=e[d];if(i)var C=o?i(S,x,d,e,t,s):i(x,S,d,t,e,s);if(!(C===void 0?x===S||r(x,S,n,i,s):C)){g=!1;break}v||(v=d=="constructor")}if(g&&!v){var P=t.constructor,O=e.constructor;P!=O&&"constructor"in t&&"constructor"in e&&!(typeof P=="function"&&P instanceof P&&typeof O=="function"&&O instanceof O)&&(g=!1)}return s.delete(t),s.delete(e),g}var G2=H2,j2=fs,W2=Ri,Y2=j2(W2,"DataView"),X2=Y2,q2=fs,K2=Ri,Z2=q2(K2,"Promise"),J2=Z2,Q2=fs,tL=Ri,eL=Q2(tL,"Set"),nL=eL,iL=fs,rL=Ri,sL=iL(rL,"WeakMap"),oL=sL,Dh=X2,Nh=sf,Rh=J2,$h=nL,Bh=oL,gb=Da,To=eb,lg="[object Map]",aL="[object Object]",cg="[object Promise]",ug="[object Set]",hg="[object WeakMap]",dg="[object DataView]",lL=To(Dh),cL=To(Nh),uL=To(Rh),hL=To($h),dL=To(Bh),Ur=gb;(Dh&&Ur(new Dh(new ArrayBuffer(1)))!=dg||Nh&&Ur(new Nh)!=lg||Rh&&Ur(Rh.resolve())!=cg||$h&&Ur(new $h)!=ug||Bh&&Ur(new Bh)!=hg)&&(Ur=function(t){var e=gb(t),n=e==aL?t.constructor:void 0,i=n?To(n):"";if(i)switch(i){case lL:return dg;case cL:return lg;case uL:return cg;case hL:return ug;case dL:return hg}return e});var Na=Ur,Uu=af,fL=lb,pL=E2,gL=G2,fg=Na,pg=Rn,gg=Fc,mL=nf,vL=1,mg="[object Arguments]",vg="[object Array]",dl="[object Object]",yL=Object.prototype,yg=yL.hasOwnProperty;function bL(t,e,n,i,r,s){var o=pg(t),a=pg(e),l=o?vg:fg(t),c=a?vg:fg(e);l=l==mg?dl:l,c=c==mg?dl:c;var h=l==dl,u=c==dl,d=l==c;if(d&&gg(t)){if(!gg(e))return!1;o=!0,h=!1}if(d&&!h)return s||(s=new Uu),o||mL(t)?fL(t,e,n,i,r,s):pL(t,e,l,n,i,r,s);if(!(n&vL)){var f=h&&yg.call(t,"__wrapped__"),p=u&&yg.call(e,"__wrapped__");if(f||p){var g=f?t.value():t,v=p?e.value():e;return s||(s=new Uu),r(g,v,n,i,s)}}return d?(s||(s=new Uu),gL(t,e,n,i,r,s)):!1}var xL=bL,wL=xL,bg=ps;function mb(t,e,n,i,r){return t===e?!0:t==null||e==null||!bg(t)&&!bg(e)?t!==t&&e!==e:wL(t,e,n,i,mb,r)}var vb=mb,_L=af,SL=vb,EL=1,TL=2;function AL(t,e,n,i){var r=n.length,s=r,o=!i;if(t==null)return!s;for(t=Object(t);r--;){var a=n[r];if(o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<s;){a=n[r];var l=a[0],c=t[l],h=a[1];if(o&&a[2]){if(c===void 0&&!(l in t))return!1}else{var u=new _L;if(i)var d=i(c,h,l,t,e,u);if(!(d===void 0?SL(h,c,EL|TL,i,u):d))return!1}}return!0}var CL=AL,PL=ds;function IL(t){return t===t&&!PL(t)}var yb=IL,OL=yb,kL=xo;function LL(t){for(var e=kL(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,OL(r)]}return e}var ML=LL;function DL(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}var bb=DL,NL=CL,RL=ML,$L=bb;function BL(t){var e=RL(t);return e.length==1&&e[0][2]?$L(e[0][0],e[0][1]):function(n){return n===t||NL(n,t,e)}}var FL=BL,VL=Da,zL=ps,UL="[object Symbol]";function HL(t){return typeof t=="symbol"||zL(t)&&VL(t)==UL}var Ra=HL,GL=Rn,jL=Ra,WL=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,YL=/^\w*$/;function XL(t,e){if(GL(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||jL(t)?!0:YL.test(t)||!WL.test(t)||e!=null&&t in Object(e)}var cf=XL,xb=of,qL="Expected a function";function uf(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(qL);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var o=t.apply(this,i);return n.cache=s.set(r,o)||s,o};return n.cache=new(uf.Cache||xb),n}uf.Cache=xb;var wb=uf;const HY=xi(wb);var KL=wb,ZL=500;function JL(t){var e=KL(t,function(i){return n.size===ZL&&n.clear(),i}),n=e.cache;return e}var QL=JL,tM=QL,eM=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,nM=/\\(\\)?/g,iM=tM(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(eM,function(n,i,r,s){e.push(r?s.replace(nM,"$1"):i||n)}),e}),rM=iM;function sM(t,e){for(var n=-1,i=t==null?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}var hf=sM,xg=Ma,oM=hf,aM=Rn,lM=Ra,cM=1/0,wg=xg?xg.prototype:void 0,_g=wg?wg.toString:void 0;function _b(t){if(typeof t=="string")return t;if(aM(t))return oM(t,_b)+"";if(lM(t))return _g?_g.call(t):"";var e=t+"";return e=="0"&&1/t==-cM?"-0":e}var uM=_b,hM=uM;function dM(t){return t==null?"":hM(t)}var fM=dM,pM=Rn,gM=cf,mM=rM,vM=fM;function yM(t,e){return pM(t)?t:gM(t,e)?[t]:mM(vM(t))}var Sb=yM,bM=Ra,xM=1/0;function wM(t){if(typeof t=="string"||bM(t))return t;var e=t+"";return e=="0"&&1/t==-xM?"-0":e}var Wc=wM,_M=Sb,SM=Wc;function EM(t,e){e=_M(e,t);for(var n=0,i=e.length;t!=null&&n<i;)t=t[SM(e[n++])];return n&&n==i?t:void 0}var df=EM,TM=df;function AM(t,e,n){var i=t==null?void 0:TM(t,e);return i===void 0?n:i}var CM=AM;function PM(t,e){return t!=null&&e in Object(t)}var IM=PM,OM=Sb,kM=Qd,LM=Rn,MM=ib,DM=tf,NM=Wc;function RM(t,e,n){e=OM(e,t);for(var i=-1,r=e.length,s=!1;++i<r;){var o=NM(e[i]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++i!=r?s:(r=t==null?0:t.length,!!r&&DM(r)&&MM(o,r)&&(LM(t)||kM(t)))}var $M=RM,BM=IM,FM=$M;function VM(t,e){return t!=null&&FM(t,e,BM)}var zM=VM,UM=vb,HM=CM,GM=zM,jM=cf,WM=yb,YM=bb,XM=Wc,qM=1,KM=2;function ZM(t,e){return jM(t)&&WM(e)?YM(XM(t),e):function(n){var i=HM(n,t);return i===void 0&&i===e?GM(n,t):UM(e,i,qM|KM)}}var JM=ZM;function QM(t){return t}var ff=QM;function tD(t){return function(e){return e==null?void 0:e[t]}}var eD=tD,nD=df;function iD(t){return function(e){return nD(e,t)}}var rD=iD,sD=eD,oD=rD,aD=cf,lD=Wc;function cD(t){return aD(t)?sD(lD(t)):oD(t)}var uD=cD,hD=FL,dD=JM,fD=ff,pD=Rn,gD=uD;function mD(t){return typeof t=="function"?t:t==null?fD:typeof t=="object"?pD(t)?dD(t[0],t[1]):hD(t):gD(t)}var Ao=mD,vD=Jd,yD=ab,bD=Ao;function xD(t,e){var n={};return e=bD(e),yD(t,function(i,r,s){vD(n,r,e(i,r,s))}),n}var wD=xD;const Eb=xi(wD),{round:_D,floor:SD,PI:Tb}=Math,qe={linear:function(t,e,n){var i=t[1]-t[0],r=e[1]-e[0];return(n-t[0])/i*r+e[0]||0}},Qe=function(t){return t%360+(t<0?360:0)},ii=function(t,e){return e*_D(t/e)},Yc=function(t){return 180*t/Tb%360},an=function(t,e){return e=e||!1,t=e?t:t%360,t*Tb/180},ga=function(t,e){if(e===void 0)e=t===void 0?1:t,t=0;else if(e<t){const n=t;t=e,e=n}return SD(Math.random()*(e-t+1)+t)},{cos:fl,sin:Hu,atan2:ED}=Math,Ab=function(t,e){var n=an(t.y),i=an(e.y),r=t.x,s=e.x,o=an(s-r),a=Hu(o)*fl(i),l=fl(n)*Hu(i)-Hu(n)*fl(i)*fl(o),c=Yc(ED(a,l)),h=["NE","E","SE","S","SW","W","NW","N"],u=c-22.5;return u<0&&(u+=360),u=parseInt(u/45),h[u]},pf=function(t,e){var n=t.x,i=t.y,r=e.x,s=e.y;return(n-=r)*n+(i-=s)*i},Cb=function(t,e){return Math.sqrt(pf(t,e))},zt={Point:1,Line:2,Ellipse:3,Rect:4,Polyline:5,Polygon:6,Curve:7,Path:8},{abs:ac,cos:Fh,sin:Vh,sqrt:Sg,min:Eg,max:Tg,atan2:TD,round:Ag,pow:AD,PI:Cg}=Math,L=function(t,e){if(!(this instanceof L))return new L(t,e);if(typeof t=="string"){var n=t.split(t.indexOf("@")===-1?" ":"@");t=parseFloat(n[0]),e=parseFloat(n[1])}else Object(t)===t&&(e=t.y,t=t.x);this.x=t===void 0?0:t,this.y=e===void 0?0:e};L.fromPolar=function(t,e,n){n=new L(n);var i=ac(t*Fh(e)),r=ac(t*Vh(e)),s=Qe(Yc(e));return s<90?r=-r:s<180?(i=-i,r=-r):s<270&&(i=-i),new L(n.x+i,n.y+r)};L.random=function(t,e,n,i){return new L(ga(t,e),ga(n,i))};L.prototype={type:zt.Point,chooseClosest:function(t){var e=t.length;if(e===1)return new L(t[0]);for(var n=null,i=1/0,r=0;r<e;r++){var s=new L(t[r]),o=this.squaredDistance(s);o<i&&(n=s,i=o)}return n},adhereToRect:function(t){return t.containsPoint(this)?this:(this.x=Eg(Tg(this.x,t.x),t.x+t.width),this.y=Eg(Tg(this.y,t.y),t.y+t.height),this)},angleBetween:function(t,e){var n=this.equals(t)||this.equals(e)?NaN:this.theta(e)-this.theta(t);return n<0&&(n+=360),n},bearing:function(t){return Ab(this,t)},changeInAngle:function(t,e,n){return this.clone().offset(-t,-e).theta(n)-this.theta(n)},clone:function(){return new L(this)},cross:function(t,e){return t&&e?(e.x-this.x)*(t.y-this.y)-(e.y-this.y)*(t.x-this.x):NaN},difference:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),new L(this.x-(t||0),this.y-(e||0))},distance:function(t){return Cb(this,t)},dot:function(t){return t?this.x*t.x+this.y*t.y:NaN},equals:function(t){return!!t&&this.x===t.x&&this.y===t.y},lerp:function(t,e){var n=this.x,i=this.y;return new L((1-e)*n+e*t.x,(1-e)*i+e*t.y)},magnitude:function(){return Sg(this.x*this.x+this.y*this.y)||.01},manhattanDistance:function(t){return ac(t.x-this.x)+ac(t.y-this.y)},move:function(t,e){var n=an(new L(t).theta(this)),i=this.offset(Fh(n)*e,-Vh(n)*e);return i},normalize:function(t){var e=(t||1)/this.magnitude();return this.scale(e,e)},offset:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),this.x+=t||0,this.y+=e||0,this},reflection:function(t){return new L(t).move(this,this.distance(t))},rotate:function(t,e){if(e===0)return this;t=t||new L(0,0),e=an(Qe(-e));var n=Fh(e),i=Vh(e),r=n*(this.x-t.x)-i*(this.y-t.y)+t.x,s=i*(this.x-t.x)+n*(this.y-t.y)+t.y;return this.x=r,this.y=s,this},round:function(t){let e=1;if(t)switch(t){case 1:e=10;break;case 2:e=100;break;case 3:e=1e3;break;default:e=AD(10,t);break}return this.x=Ag(this.x*e)/e,this.y=Ag(this.y*e)/e,this},scale:function(t,e,n){return n=n&&new L(n)||new L(0,0),this.x=n.x+t*(this.x-n.x),this.y=n.y+e*(this.y-n.y),this},snapToGrid:function(t,e){return this.x=ii(this.x,t),this.y=ii(this.y,e||t),this},squaredDistance:function(t){return pf(this,t)},theta:function(t){t=new L(t);var e=-(t.y-this.y),n=t.x-this.x,i=TD(e,n);return i<0&&(i=2*Cg+i),180*i/Cg},toJSON:function(){return{x:this.x,y:this.y}},toPolar:function(t){t=t&&new L(t)||new L(0,0);var e=this.x,n=this.y;return this.x=Sg((e-t.x)*(e-t.x)+(n-t.y)*(n-t.y)),this.y=an(t.theta(new L(e,n))),this},toString:function(){return this.x+"@"+this.y},serialize:function(){return this.x+","+this.y},update:function(t,e){return Object(t)===t&&(e=t.y,t=t.x),this.x=t||0,this.y=e||0,this},vectorAngle:function(t){var e=new L(0,0);return e.angleBetween(this,t)}};L.prototype.translate=L.prototype.offset;const re=L,{max:Gu,min:ju}=Math,pt=function(t,e){if(!(this instanceof pt))return new pt(t,e);if(t instanceof pt)return new pt(t.start,t.end);this.start=new L(t),this.end=new L(e)};pt.prototype={type:zt.Line,angle:function(){var t=new L(this.start.x+1,this.start.y);return this.start.angleBetween(this.end,t)},bbox:function(){var t=ju(this.start.x,this.end.x),e=ju(this.start.y,this.end.y),n=Gu(this.start.x,this.end.x),i=Gu(this.start.y,this.end.y);return new J(t,e,n-t,i-e)},bearing:function(){return Ab(this.start,this.end)},clone:function(){return new pt(this.start,this.end)},closestPoint:function(t){return this.pointAt(this.closestPointNormalizedLength(t))},closestPointLength:function(t){return this.closestPointNormalizedLength(t)*this.length()},closestPointNormalizedLength:function(t){var e=this.vector().dot(new pt(this.start,t).vector()),n=ju(1,Gu(0,e/this.squaredLength()));return n!==n?0:n},closestPointTangent:function(t){return this.tangentAt(this.closestPointNormalizedLength(t))},containsPoint:function(t){var e=this.start,n=this.end;if(e.cross(t,n)!==0)return!1;var i=this.length();return!(new pt(e,t).length()>i||new pt(t,n).length()>i)},divideAt:function(t){var e=this.pointAt(t);return[new pt(this.start,e),new pt(e,this.end)]},divideAtLength:function(t){var e=this.pointAtLength(t);return[new pt(this.start,e),new pt(e,this.end)]},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.end.x===t.end.x&&this.end.y===t.end.y},intersect:function(t,e){if(t&&t.intersectionWithLine){var n=t.intersectionWithLine(this,e);return n&&t instanceof pt&&(n=n[0]),n}return null},intersectionWithLine:function(t){var e=new L(this.end.x-this.start.x,this.end.y-this.start.y),n=new L(t.end.x-t.start.x,t.end.y-t.start.y),i=e.x*n.y-e.y*n.x,r=new L(t.start.x-this.start.x,t.start.y-this.start.y),s=r.x*n.y-r.y*n.x,o=r.x*e.y-r.y*e.x;if(i===0||s*i<0||o*i<0)return null;if(i>0){if(s>i||o>i)return null}else if(s<i||o<i)return null;return[new L(this.start.x+s*e.x/i,this.start.y+s*e.y/i)]},isDifferentiable:function(){return!this.start.equals(this.end)},length:function(){return Cb(this.start,this.end)},midpoint:function(){return new L((this.start.x+this.end.x)/2,(this.start.y+this.end.y)/2)},parallel:function(t){const e=this.clone();if(!this.isDifferentiable())return e;const{start:n,end:i}=e,r=n.clone().rotate(i,270),s=i.clone().rotate(n,90);return n.move(s,t),i.move(r,t),e},pointAt:function(t){var e=this.start,n=this.end;return t<=0?e.clone():t>=1?n.clone():e.lerp(n,t)},pointAtLength:function(t){var e=this.start,n=this.end,i=!0;t<0&&(i=!1,t=-t);var r=this.length();return t>=r?i?n.clone():e.clone():this.pointAt((i?t:r-t)/r)},pointOffset:function(t){t=new L(t);var e=this.start,n=this.end,i=(n.x-e.x)*(t.y-e.y)-(n.y-e.y)*(t.x-e.x);return i/this.length()},rotate:function(t,e){return this.start.rotate(t,e),this.end.rotate(t,e),this},round:function(t){return this.start.round(t),this.end.round(t),this},scale:function(t,e,n){return this.start.scale(t,e,n),this.end.scale(t,e,n),this},setLength:function(t){var e=this.length();if(!e)return this;var n=t/e;return this.scale(n,n,this.start)},squaredLength:function(){return pf(this.start,this.end)},tangentAt:function(t){if(!this.isDifferentiable())return null;var e=this.start,n=this.end,i=this.pointAt(t),r=new pt(e,n);return r.translate(i.x-e.x,i.y-e.y),r},tangentAtLength:function(t){if(!this.isDifferentiable())return null;var e=this.start,n=this.end,i=this.pointAtLength(t),r=new pt(e,n);return r.translate(i.x-e.x,i.y-e.y),r},toString:function(){return this.start.toString()+" "+this.end.toString()},serialize:function(){return this.start.serialize()+" "+this.end.serialize()},translate:function(t,e){return this.start.translate(t,e),this.end.translate(t,e),this},vector:function(){return new L(this.end.x-this.start.x,this.end.y-this.start.y)}};pt.prototype.intersection=pt.prototype.intersect;const ts=pt,{sqrt:Pg,round:pl,pow:CD}=Math,Ln=function(t,e,n){if(!(this instanceof Ln))return new Ln(t,e,n);if(t instanceof Ln)return new Ln(new L(t.x,t.y),t.a,t.b);t=new L(t),this.x=t.x,this.y=t.y,this.a=e,this.b=n};Ln.fromRect=function(t){return t=new J(t),new Ln(t.center(),t.width/2,t.height/2)};Ln.prototype={type:zt.Ellipse,bbox:function(){return new J(this.x-this.a,this.y-this.b,2*this.a,2*this.b)},center:function(){return new L(this.x,this.y)},clone:function(){return new Ln(this)},containsPoint:function(t){return this.normalizedDistance(t)<=1},equals:function(t){return!!t&&t.x===this.x&&t.y===this.y&&t.a===this.a&&t.b===this.b},inflate:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.a+=2*t,this.b+=2*e,this},intersectionWithLine:function(t){var e=[],n=t.start,i=t.end,r=this.a,s=this.b,o=t.vector(),a=n.difference(new L(this)),l=new L(o.x/(r*r),o.y/(s*s)),c=new L(a.x/(r*r),a.y/(s*s)),h=o.dot(l),u=o.dot(c),d=a.dot(c)-1,f=u*u-h*d;if(f<0)return null;if(f>0){var p=Pg(f),g=(-u-p)/h,v=(-u+p)/h;if((g<0||1<g)&&(v<0||1<v))return null;0<=g&&g<=1&&e.push(n.lerp(i,g)),0<=v&&v<=1&&e.push(n.lerp(i,v))}else{var x=-u/h;if(0<=x&&x<=1)e.push(n.lerp(i,x));else return null}return e},intersectionWithLineFromCenterToPoint:function(t,e){t=new L(t),e&&t.rotate(new L(this.x,this.y),e);var n=t.x-this.x,i=t.y-this.y,r;if(n===0)return r=this.bbox().pointNearestToPoint(t),e?r.rotate(new L(this.x,this.y),-e):r;var s=i/n,o=s*s,a=this.a*this.a,l=this.b*this.b,c=Pg(1/(1/a+o/l));c=n<0?-c:c;var h=s*c;return r=new L(this.x+c,this.y+h),e?r.rotate(new L(this.x,this.y),-e):r},normalizedDistance:function(t){var e=t.x,n=t.y,i=this.a,r=this.b,s=this.x,o=this.y;return(e-s)*(e-s)/(i*i)+(n-o)*(n-o)/(r*r)},round:function(t){let e=1;if(t)switch(t){case 1:e=10;break;case 2:e=100;break;case 3:e=1e3;break;default:e=CD(10,t);break}return this.x=pl(this.x*e)/e,this.y=pl(this.y*e)/e,this.a=pl(this.a*e)/e,this.b=pl(this.b*e)/e,this},tangentTheta:function(t){var e=30,n=t.x,i=t.y,r=this.a,s=this.b,o=this.bbox().center(),a=o.x,l=o.y,c=n>o.x+r/2,h=n<o.x-r/2,u,d;return c||h?(u=n>o.x?i-e:i+e,d=r*r/(n-a)-r*r*(i-l)*(u-l)/(s*s*(n-a))+a):(d=i>o.y?n+e:n-e,u=s*s/(i-l)-s*s*(n-a)*(d-a)/(r*r*(i-l))+l),new L(d,u).theta(t)},toString:function(){return new L(this.x,this.y).toString()+" "+this.a+" "+this.b}};const PD=Ln,{abs:Ig,cos:ID,sin:OD,min:Go,max:Og,round:gl,pow:kD}=Math,J=function(t,e,n,i){if(!(this instanceof J))return new J(t,e,n,i);Object(t)===t&&(e=t.y,n=t.width,i=t.height,t=t.x),this.x=t===void 0?0:t,this.y=e===void 0?0:e,this.width=n===void 0?0:n,this.height=i===void 0?0:i};J.fromEllipse=function(t){return t=new Ln(t),new J(t.x-t.a,t.y-t.b,2*t.a,2*t.b)};J.fromPointUnion=function(...t){if(t.length===0)return null;const e=new L;let n,i,r,s;n=i=1/0,r=s=-1/0;for(let o=0;o<t.length;o++){e.update(t[o]);const a=e.x,l=e.y;a<n&&(n=a),a>r&&(r=a),l<i&&(i=l),l>s&&(s=l)}return new J(n,i,r-n,s-i)};J.fromRectUnion=function(...t){if(t.length===0)return null;const e=new J;let n,i,r,s;n=i=1/0,r=s=-1/0;for(let o=0;o<t.length;o++){e.update(t[o]);const a=e.x,l=e.y,c=a+e.width,h=l+e.height;a<n&&(n=a),c>r&&(r=c),l<i&&(i=l),h>s&&(s=h)}return new J(n,i,r-n,s-i)};J.prototype={type:zt.Rect,bbox:function(t){return this.clone().rotateAroundCenter(t)},rotateAroundCenter:function(t){if(!t)return this;const{width:e,height:n}=this,i=an(t),r=Ig(OD(i)),s=Ig(ID(i)),o=e*s+n*r,a=e*r+n*s;return this.x+=(e-o)/2,this.y+=(n-a)/2,this.width=o,this.height=a,this},bottomLeft:function(){return new L(this.x,this.y+this.height)},bottomLine:function(){return new pt(this.bottomLeft(),this.bottomRight())},bottomMiddle:function(){return new L(this.x+this.width/2,this.y+this.height)},center:function(){return new L(this.x+this.width/2,this.y+this.height/2)},clone:function(){return new J(this)},containsPoint:function(t){return t instanceof L||(t=new L(t)),t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height},containsRect:function(t){var e=new J(this).normalize(),n=new J(t).normalize(),i=e.width,r=e.height,s=n.width,o=n.height;if(!i||!r||!s||!o)return!1;var a=e.x,l=e.y,c=n.x,h=n.y;return s+=c,i+=a,o+=h,r+=l,a<=c&&s<=i&&l<=h&&o<=r},corner:function(){return new L(this.x+this.width,this.y+this.height)},equals:function(t){var e=new J(this).normalize(),n=new J(t).normalize();return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height},inflate:function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},intersect:function(t){var e=this.origin(),n=this.corner(),i=t.origin(),r=t.corner();if(r.x<=e.x||r.y<=e.y||i.x>=n.x||i.y>=n.y)return null;var s=Og(e.x,i.x),o=Og(e.y,i.y);return new J(s,o,Go(n.x,r.x)-s,Go(n.y,r.y)-o)},intersectionWithLine:function(t){var e=this,n=[e.topLine(),e.rightLine(),e.bottomLine(),e.leftLine()],i=[],r=[],s,o,a=n.length;for(o=0;o<a;o++)s=t.intersect(n[o]),s!==null&&r.indexOf(s.toString())<0&&(i.push(s),r.push(s.toString()));return i.length>0?i:null},intersectionWithLineFromCenterToPoint:function(t,e){t=new L(t);var n=new L(this.x+this.width/2,this.y+this.height/2),i;e&&t.rotate(n,e);for(var r=[this.topLine(),this.rightLine(),this.bottomLine(),this.leftLine()],s=new pt(n,t),o=r.length-1;o>=0;--o){var a=r[o].intersection(s);if(a!==null){i=a;break}}return i&&e&&i.rotate(n,-e),i},leftLine:function(){return new pt(this.topLeft(),this.bottomLeft())},leftMiddle:function(){return new L(this.x,this.y+this.height/2)},maxRectScaleToFit:function(t,e){t=new J(t),e||(e=t.center());var n,i,r,s,o,a,l,c,h=e.x,u=e.y;n=i=r=s=o=a=l=c=1/0;var d=t.topLeft();d.x<h&&(n=(this.x-h)/(d.x-h)),d.y<u&&(o=(this.y-u)/(d.y-u));var f=t.bottomRight();f.x>h&&(i=(this.x+this.width-h)/(f.x-h)),f.y>u&&(a=(this.y+this.height-u)/(f.y-u));var p=t.topRight();p.x>h&&(r=(this.x+this.width-h)/(p.x-h)),p.y<u&&(l=(this.y-u)/(p.y-u));var g=t.bottomLeft();return g.x<h&&(s=(this.x-h)/(g.x-h)),g.y>u&&(c=(this.y+this.height-u)/(g.y-u)),{sx:Go(n,i,r,s),sy:Go(o,a,l,c)}},maxRectUniformScaleToFit:function(t,e){var n=this.maxRectScaleToFit(t,e);return Go(n.sx,n.sy)},moveAndExpand:function(t){return this.x+=t.x||0,this.y+=t.y||0,this.width+=t.width||0,this.height+=t.height||0,this},normalize:function(){var t=this.x,e=this.y,n=this.width,i=this.height;return this.width<0&&(t=this.x+this.width,n=-this.width),this.height<0&&(e=this.y+this.height,i=-this.height),this.x=t,this.y=e,this.width=n,this.height=i,this},offset:function(t,e){return L.prototype.offset.call(this,t,e)},origin:function(){return new L(this.x,this.y)},pointNearestToPoint:function(t){if(t=new L(t),this.containsPoint(t)){var e=this.sideNearestToPoint(t);switch(e){case"right":return new L(this.x+this.width,t.y);case"left":return new L(this.x,t.y);case"bottom":return new L(t.x,this.y+this.height);case"top":return new L(t.x,this.y)}}return t.adhereToRect(this)},rightLine:function(){return new pt(this.topRight(),this.bottomRight())},rightMiddle:function(){return new L(this.x+this.width,this.y+this.height/2)},round:function(t){let e=1;if(t)switch(t){case 1:e=10;break;case 2:e=100;break;case 3:e=1e3;break;default:e=kD(10,t);break}return this.x=gl(this.x*e)/e,this.y=gl(this.y*e)/e,this.width=gl(this.width*e)/e,this.height=gl(this.height*e)/e,this},scale:function(t,e,n){return n=this.origin().scale(t,e,n),this.x=n.x,this.y=n.y,this.width*=t,this.height*=e,this},sideNearestToPoint:function(t){t=new L(t);var e=t.x-this.x,n=this.x+this.width-t.x,i=t.y-this.y,r=this.y+this.height-t.y,s=e,o="left";return n<s&&(s=n,o="right"),i<s&&(s=i,o="top"),r<s&&(o="bottom"),o},snapToGrid:function(t,e){var n=this.origin().snapToGrid(t,e),i=this.corner().snapToGrid(t,e);return this.x=n.x,this.y=n.y,this.width=i.x-n.x,this.height=i.y-n.y,this},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},topLine:function(){return new pt(this.topLeft(),this.topRight())},topMiddle:function(){return new L(this.x+this.width/2,this.y)},topRight:function(){return new L(this.x+this.width,this.y)},toString:function(){return this.origin().toString()+" "+this.corner().toString()},union:function(t){return J.fromRectUnion(this,t)},update:function(t,e,n,i){return Object(t)===t&&(e=t.y,n=t.width,i=t.height,t=t.x),this.x=t||0,this.y=e||0,this.width=n||0,this.height=i||0,this}};J.prototype.bottomRight=J.prototype.corner;J.prototype.topLeft=J.prototype.origin;J.prototype.translate=J.prototype.offset;const Ji=J;function Pb(t){const e=t.trim();if(e==="")return[];const n=[],i=e.split(/\b\s*,\s*|,\s*|\s+/),r=i.length;for(let s=0;s<r;s+=2)n.push({x:+i[s],y:+i[s+1]});return n}function Ib(t){const e=t.length;if(e===0)return[];const n=[];for(let i=0;i<e;i++){const r=t[i].clone();n.push(r)}return n}function Ob(t){const{abs:e}=Math;var n,i,r=t.length;if(r===0)return[];var s;for(n=0;n<r;n++)(s===void 0||t[n].y<s.y||t[n].y===s.y&&t[n].x>s.x)&&(s=t[n]);var o=[];for(n=0;n<r;n++){var a=s.theta(t[n]);a===0&&(a=360);var l=[t[n],n,a];o.push(l)}if(o.sort(function($,F){var j=$[2]-F[2];return j===0&&(j=F[1]-$[1]),j}),o.length>2){var c=o[o.length-1];o.unshift(c)}for(var h={},u=[],d,f,p,g,v,x;o.length!==0;)if(d=o.pop(),f=d[0],!h.hasOwnProperty(d[0]+"@@"+d[1]))for(var S=!1;!S;)if(u.length<2)u.push(d),S=!0;else{p=u.pop(),g=p[0],v=u.pop(),x=v[0];var C=x.cross(g,f);if(C<0)u.push(v),u.push(p),u.push(d),S=!0;else if(C===0){var P=1e-10,O=g.angleBetween(x,f);e(O-180)<P||g.equals(f)||x.equals(g)?(h[p[0]+"@@"+p[1]]=g,u.push(v)):e((O+1)%360-1)<P&&(u.push(v),o.push(p))}else h[p[0]+"@@"+p[1]]=g,u.push(v)}u.length>2&&u.pop();var N,m=-1;for(i=u.length,n=0;n<i;n++){var b=u[n][1];(N===void 0||b<N)&&(N=b,m=n)}var w=[];if(m>0){var A=u.slice(m),E=u.slice(0,m);w=A.concat(E)}else w=u;var M=[];for(i=w.length,n=0;n<i;n++)M.push(w[n][0]);return M}const Ae=function(t){if(!(this instanceof Ae))return new Ae(t);if(typeof t=="string")return new Ae.parse(t);this.points=Array.isArray(t)?t.map(L):[]};Ae.parse=function(t){return new Ae(Pb(t))};Ae.fromRect=function(t){return new Ae([t.topLeft(),t.topRight(),t.bottomRight(),t.bottomLeft(),t.topLeft()])};Ae.prototype={type:zt.Polyline,bbox:function(){var t=1/0,e=-1/0,n=1/0,i=-1/0,r=this.points,s=r.length;if(s===0)return null;for(var o=0;o<s;o++){var a=r[o],l=a.x,c=a.y;l<t&&(t=l),l>e&&(e=l),c<n&&(n=c),c>i&&(i=c)}return new J(t,n,e-t,i-n)},clone:function(){return new Ae(Ib(this.points))},closestPoint:function(t){var e=this.closestPointLength(t);return this.pointAtLength(e)},closestPointLength:function(t){var e=this.lengthPoints(),n=e.length;if(n===0||n===1)return 0;for(var i,r=1/0,s=0,o=n-1,a=0;a<o;a++){var l=new pt(e[a],e[a+1]),c=l.length(),h=l.closestPointNormalizedLength(t),u=l.pointAt(h),d=u.squaredDistance(t);d<r&&(r=d,i=s+h*c),s+=c}return i},closestPointNormalizedLength:function(t){var e=this.closestPointLength(t);if(e===0)return 0;var n=this.length();return n===0?0:e/n},closestPointTangent:function(t){var e=this.closestPointLength(t);return this.tangentAtLength(e)},containsPoint:function(t){var e=this.points,n=e.length;if(n===0)return!1;for(var i=t.x,r=t.y,s=n-1,o=0,a=0,l=new pt,c=new pt,h=new L;o<n;o++){var u=e[s],d=e[o];if(t.equals(u)||(l.start=u,l.end=d,l.containsPoint(t)))return!0;if(r<=u.y&&r>d.y||r>u.y&&r<=d.y){var f=u.x-i>d.x-i?u.x-i:d.x-i;f>=0&&(h.x=i+f,h.y=r,c.start=t,c.end=h,l.intersect(c)&&a++)}s=o}return a%2===1},close:function(){const{start:t,end:e,points:n}=this;return t&&e&&!t.equals(e)&&n.push(t.clone()),this},lengthPoints:function(){return this.points},convexHull:function(){return new Ae(Ob(this.points))},equals:function(t){if(!t)return!1;var e=this.points,n=t.points,i=e.length;if(n.length!==i)return!1;for(var r=0;r<i;r++){var s=e[r],o=t.points[r];if(!s.equals(o))return!1}return!0},intersectionWithLine:function(t){for(var e=new pt(t),n=[],i=this.lengthPoints(),r=new pt,s=0,o=i.length-1;s<o;s++){r.start=i[s],r.end=i[s+1];var a=e.intersectionWithLine(r);a&&n.push(a[0])}return n.length>0?n:null},isDifferentiable:function(){var t=this.points,e=t.length;if(e===0)return!1;for(var n=new pt,i=e-1,r=0;r<i;r++)if(n.start=t[r],n.end=t[r+1],n.isDifferentiable())return!0;return!1},length:function(){var t=this.lengthPoints(),e=t.length;if(e===0)return 0;for(var n=0,i=e-1,r=0;r<i;r++)n+=t[r].distance(t[r+1]);return n},pointAt:function(t){var e=this.lengthPoints(),n=e.length;if(n===0)return null;if(n===1||t<=0)return e[0].clone();if(t>=1)return e[n-1].clone();var i=this.length(),r=i*t;return this.pointAtLength(r)},pointAtLength:function(t){var e=this.lengthPoints(),n=e.length;if(n===0)return null;if(n===1)return e[0].clone();var i=!0;t<0&&(i=!1,t=-t);for(var r=0,s=n-1,o=0;o<s;o++){var a=i?o:s-1-o,l=e[a],c=e[a+1],h=new pt(l,c),u=l.distance(c);if(t<=r+u)return h.pointAtLength((i?1:-1)*(t-r));r+=u}var d=i?e[n-1]:e[0];return d.clone()},round:function(t){for(var e=this.points,n=e.length,i=0;i<n;i++)e[i].round(t);return this},scale:function(t,e,n){for(var i=this.points,r=i.length,s=0;s<r;s++)i[s].scale(t,e,n);return this},simplify:function(t={}){const e=this.points;if(e.length<3)return this;const n=t.threshold||1e-10;let i=0;for(;e[i+2];){const r=i,s=i+1,o=i+2,a=e[r],l=e[s],c=e[o];new pt(a,c).closestPoint(l).distance(l)<=n?e.splice(s,1):i+=1}return this},tangentAt:function(t){var e=this.lengthPoints(),n=e.length;if(n===0||n===1)return null;t<0&&(t=0),t>1&&(t=1);var i=this.length(),r=i*t;return this.tangentAtLength(r)},tangentAtLength:function(t){var e=this.lengthPoints(),n=e.length;if(n===0||n===1)return null;var i=!0;t<0&&(i=!1,t=-t);for(var r,s=0,o=n-1,a=0;a<o;a++){var l=i?a:o-1-a,c=e[l],h=e[l+1],u=new pt(c,h),d=c.distance(h);if(u.isDifferentiable()){if(t<=s+d)return u.tangentAtLength((i?1:-1)*(t-s));r=u}s+=d}if(r){var f=i?1:0;return r.tangentAt(f)}return null},toString:function(){return this.points+""},translate:function(t,e){for(var n=this.points,i=n.length,r=0;r<i;r++)n[r].translate(t,e);return this},serialize:function(){var t=this.points,e=t.length;if(e===0)return"";for(var n="",i=0;i<e;i++){var r=t[i];n+=r.x+","+r.y+" "}return n.trim()}};Object.defineProperty(Ae.prototype,"start",{configurable:!0,enumerable:!0,get:function(){var t=this.points,e=t.length;return e===0?null:this.points[0]}});Object.defineProperty(Ae.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.points,e=t.length;return e===0?null:this.points[e-1]}});const{abs:ml,sqrt:LD,min:kg,max:Lg,pow:Wu}=Math,oe=function(t,e,n,i){if(!(this instanceof oe))return new oe(t,e,n,i);if(t instanceof oe)return new oe(t.start,t.controlPoint1,t.controlPoint2,t.end);this.start=new L(t),this.controlPoint1=new L(e),this.controlPoint2=new L(n),this.end=new L(i)};oe.throughPoints=function(){function t(n){var i=[],r=[],s=n.length-1,o;if(s==1)return i[0]=new L((2*n[0].x+n[1].x)/3,(2*n[0].y+n[1].y)/3),r[0]=new L(2*i[0].x-n[0].x,2*i[0].y-n[0].y),[i,r];var a=[];for(o=1;o<s-1;o++)a[o]=4*n[o].x+2*n[o+1].x;a[0]=n[0].x+2*n[1].x,a[s-1]=(8*n[s-1].x+n[s].x)/2;var l=e(a);for(o=1;o<s-1;++o)a[o]=4*n[o].y+2*n[o+1].y;a[0]=n[0].y+2*n[1].y,a[s-1]=(8*n[s-1].y+n[s].y)/2;var c=e(a);for(o=0;o<s;o++)i.push(new L(l[o],c[o])),o<s-1?r.push(new L(2*n[o+1].x-l[o+1],2*n[o+1].y-c[o+1])):r.push(new L((n[s].x+l[s-1])/2,(n[s].y+c[s-1])/2));return[i,r]}function e(n){var i=n.length,r=[],s=[],o=2;r[0]=n[0]/o;for(var a=1;a<i;a++)s[a]=1/o,o=(a<i-1?4:3.5)-s[a],r[a]=(n[a]-r[a-1])/o;for(a=1;a<i;a++)r[i-a-1]-=s[i-a]*r[i-a];return r}return function(n){if(!n||Array.isArray(n)&&n.length<2)throw new Error("At least 2 points are required");for(var i=t(n),r=[],s=i[0].length,o=0;o<s;o++){var a=new L(i[0][o].x,i[0][o].y),l=new L(i[1][o].x,i[1][o].y);r.push(new oe(n[o],a,l,n[o+1]))}return r}}();oe.prototype={type:zt.Curve,bbox:function(){for(var t=this.start,e=this.controlPoint1,n=this.controlPoint2,i=this.end,r=t.x,s=t.y,o=e.x,a=e.y,l=n.x,c=n.y,h=i.x,u=i.y,d=new Array,f=new Array,p=[new Array,new Array],g,v,x,S,C,P,O,N,m=0;m<2;++m){if(m===0?(v=6*r-12*o+6*l,g=-3*r+9*o-9*l+3*h,x=3*o-3*r):(v=6*s-12*a+6*c,g=-3*s+9*a-9*c+3*u,x=3*a-3*s),ml(g)<1e-12){if(ml(v)<1e-12)continue;S=-x/v,0<S&&S<1&&f.push(S);continue}O=v*v-4*x*g,N=LD(O),!(O<0)&&(C=(-v+N)/(2*g),0<C&&C<1&&f.push(C),P=(-v-N)/(2*g),0<P&&P<1&&f.push(P))}for(var b=f.length,w=b,A,E,M;b--;)S=f[b],A=1-S,E=A*A*A*r+3*A*A*S*o+3*A*S*S*l+S*S*S*h,p[0][b]=E,M=A*A*A*s+3*A*A*S*a+3*A*S*S*c+S*S*S*u,p[1][b]=M,d[b]={X:E,Y:M};f[w]=0,f[w+1]=1,d[w]={X:r,Y:s},d[w+1]={X:h,Y:u},p[0][w]=r,p[1][w]=s,p[0][w+1]=h,p[1][w+1]=u,f.length=w+2,p[0].length=w+2,p[1].length=w+2,d.length=w+2;var $=kg.apply(null,p[0]),F=kg.apply(null,p[1]),j=Lg.apply(null,p[0]),R=Lg.apply(null,p[1]);return new J($,F,j-$,R-F)},clone:function(){return new oe(this.start,this.controlPoint1,this.controlPoint2,this.end)},closestPoint:function(t,e){return this.pointAtT(this.closestPointT(t,e))},closestPointLength:function(t,e){e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,i=e.subdivisions===void 0?this.getSubdivisions({precision:n}):e.subdivisions,r={precision:n,subdivisions:i};return this.lengthAtT(this.closestPointT(t,r),r)},closestPointNormalizedLength:function(t,e){e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,i=e.subdivisions===void 0?this.getSubdivisions({precision:n}):e.subdivisions,r={precision:n,subdivisions:i},s=this.closestPointLength(t,r);if(!s)return 0;var o=this.length(r);return o===0?0:s/o},closestPointT:function(t,e){e=e||{};for(var n=e.precision===void 0?this.PRECISION:e.precision,i=e.subdivisions===void 0?this.getSubdivisions({precision:n}):e.subdivisions,r,s,o,a,l,c,h,u=i.length,d=u?1/u:0,f=0;f<u;f++){var p=i[f],g=p.start.distance(t),v=p.end.distance(t),x=g+v;(!h||x<h)&&(r=p,s=f*d,o=(f+1)*d,a=g,l=v,c=p.start.distance(p.end),h=x)}for(var S=Wu(10,-n);;){var C=a?ml(a-l)/a:0,P=l?ml(a-l)/l:0,O=C<S||P<S,N=a?a<c*S:!0,m=l?l<c*S:!0,b=N||m;if(O||b)return a<=l?s:o;var w=r.divide(.5);d/=2;var A=w[0].start.distance(t),E=w[0].end.distance(t),M=A+E,$=w[1].start.distance(t),F=w[1].end.distance(t),j=$+F;M<=j?(r=w[0],o-=d,a=A,l=E):(r=w[1],s+=d,a=$,l=F)}},closestPointTangent:function(t,e){return this.tangentAtT(this.closestPointT(t,e))},containsPoint:function(t,e){var n=this.toPolyline(e);return n.containsPoint(t)},divideAt:function(t,e){if(t<=0)return this.divideAtT(0);if(t>=1)return this.divideAtT(1);var n=this.tAt(t,e);return this.divideAtT(n)},divideAtLength:function(t,e){var n=this.tAtLength(t,e);return this.divideAtT(n)},divideAtT:function(t){var e=this.start,n=this.controlPoint1,i=this.controlPoint2,r=this.end;if(t<=0)return[new oe(e,e,e,e),new oe(e,n,i,r)];if(t>=1)return[new oe(e,n,i,r),new oe(r,r,r,r)];var s=this.getSkeletonPoints(t),o=s.startControlPoint1,a=s.startControlPoint2,l=s.divider,c=s.dividerControlPoint1,h=s.dividerControlPoint2;return[new oe(e,o,a,l),new oe(l,c,h,r)]},endpointDistance:function(){return this.start.distance(this.end)},equals:function(t){return!!t&&this.start.x===t.start.x&&this.start.y===t.start.y&&this.controlPoint1.x===t.controlPoint1.x&&this.controlPoint1.y===t.controlPoint1.y&&this.controlPoint2.x===t.controlPoint2.x&&this.controlPoint2.y===t.controlPoint2.y&&this.end.x===t.end.x&&this.end.y===t.end.y},getSkeletonPoints:function(t){var e=this.start,n=this.controlPoint1,i=this.controlPoint2,r=this.end;if(t<=0)return{startControlPoint1:e.clone(),startControlPoint2:e.clone(),divider:e.clone(),dividerControlPoint1:n.clone(),dividerControlPoint2:i.clone()};if(t>=1)return{startControlPoint1:n.clone(),startControlPoint2:i.clone(),divider:r.clone(),dividerControlPoint1:r.clone(),dividerControlPoint2:r.clone()};var s=new pt(e,n).pointAt(t),o=new pt(n,i).pointAt(t),a=new pt(i,r).pointAt(t),l=new pt(s,o).pointAt(t),c=new pt(o,a).pointAt(t),h=new pt(l,c).pointAt(t),u={startControlPoint1:s,startControlPoint2:l,divider:h,dividerControlPoint1:c,dividerControlPoint2:a};return u},getSubdivisions:function(t){t=t||{};var e=t.precision===void 0?this.PRECISION:t.precision,n=this.start,i=this.controlPoint1,r=this.controlPoint2,s=this.end,o=[new oe(n,i,r,s)];if(e===0)return o;var a=!this.isDifferentiable();if(a)return o;var l=this.endpointDistance(),c=Wu(10,-e),h=2,u=i.cross(n,s)===0&&r.cross(n,s)===0;u&&(h=2*e);for(var d=0;;){d+=1;for(var f=[],p=o.length,g=0;g<p;g++){var v=o[g],x=v.divide(.5);f.push(x[0],x[1])}for(var S=0,C=f.length,P=0;P<C;P++){var O=f[P];S+=O.endpointDistance()}if(d>=h){var N=S!==0?(S-l)/S:0;if(N<c)return f}o=f,l=S}},isDifferentiable:function(){var t=this.start,e=this.controlPoint1,n=this.controlPoint2,i=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(i))},length:function(t){t=t||{};for(var e=t.precision===void 0?this.PRECISION:t.precision,n=t.subdivisions===void 0?this.getSubdivisions({precision:e}):t.subdivisions,i=0,r=n.length,s=0;s<r;s++){var o=n[s];i+=o.endpointDistance()}return i},lengthAtT:function(t,e){if(t<=0)return 0;e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,i=this.divide(t)[0],r=i.length({precision:n});return r},pointAt:function(t,e){if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();var n=this.tAt(t,e);return this.pointAtT(n)},pointAtLength:function(t,e){var n=this.tAtLength(t,e);return this.pointAtT(n)},pointAtT:function(t){return t<=0?this.start.clone():t>=1?this.end.clone():this.getSkeletonPoints(t).divider},PRECISION:3,round:function(t){return this.start.round(t),this.controlPoint1.round(t),this.controlPoint2.round(t),this.end.round(t),this},scale:function(t,e,n){return this.start.scale(t,e,n),this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this},tangentAt:function(t,e){if(!this.isDifferentiable())return null;t<0?t=0:t>1&&(t=1);var n=this.tAt(t,e);return this.tangentAtT(n)},tangentAtLength:function(t,e){if(!this.isDifferentiable())return null;var n=this.tAtLength(t,e);return this.tangentAtT(n)},tangentAtT:function(t){if(!this.isDifferentiable())return null;t<0?t=0:t>1&&(t=1);var e=this.getSkeletonPoints(t),n=e.startControlPoint2,i=e.dividerControlPoint1,r=e.divider,s=new pt(n,i);return s.translate(r.x-n.x,r.y-n.y),s},tAt:function(t,e){if(t<=0)return 0;if(t>=1)return 1;e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,i=e.subdivisions===void 0?this.getSubdivisions({precision:n}):e.subdivisions,r={precision:n,subdivisions:i},s=this.length(r),o=s*t;return this.tAtLength(o,r)},tAtLength:function(t,e){var n=!0;t<0&&(n=!1,t=-t),e=e||{};for(var i=e.precision===void 0?this.PRECISION:e.precision,r=e.subdivisions===void 0?this.getSubdivisions({precision:i}):e.subdivisions,s={precision:i,subdivisions:r},o,a,l,c,h,u=0,d=r.length,f=1/d,p=0;p<d;p++){var g=n?p:d-1-p,v=r[p],x=v.endpointDistance();if(t<=u+x){o=v,a=g*f,l=(g+1)*f,c=n?t-u:x+u-t,h=n?x+u-t:t-u;break}u+=x}if(!o)return n?1:0;for(var S=this.length(s),C=Wu(10,-i);;){var P;if(P=S!==0?c/S:0,P<C)return a;if(P=S!==0?h/S:0,P<C)return l;var O,N,m=o.divide(.5);f/=2;var b=m[0].endpointDistance(),w=m[1].endpointDistance();c<=b?(o=m[0],l-=f,O=c,N=b-O):(o=m[1],a+=f,O=c-b,N=w-O),c=O,h=N}},toPoints:function(t){t=t||{};for(var e=t.precision===void 0?this.PRECISION:t.precision,n=t.subdivisions===void 0?this.getSubdivisions({precision:e}):t.subdivisions,i=[n[0].start.clone()],r=n.length,s=0;s<r;s++){var o=n[s];i.push(o.end.clone())}return i},toPolyline:function(t){return new Ae(this.toPoints(t))},toString:function(){return this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.start.translate(t,e),this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}};oe.prototype.divide=oe.prototype.divideAtT;function $a(t){var e,n,i=[];for(n=arguments.length,e=1;e<n;e++)i.push(arguments[e]);if(!t)throw new Error("Missing a parent object.");var r=Object.create(t);for(n=i.length,e=0;e<n;e++){var s=i[e],o,a;for(a in s)s.hasOwnProperty(a)&&(delete r[a],o=Object.getOwnPropertyDescriptor(s,a),Object.defineProperty(r,a,o))}return r}const K=function(t){if(!(this instanceof K))return new K(t);if(typeof t=="string")return new K.parse(t);this.segments=[];var e,n;if(t)if(Array.isArray(t)&&t.length!==0)if(t=t.reduce(function(a,l){return a.concat(l)},[]),n=t.length,t[0].isSegment)for(e=0;e<n;e++){var i=t[e];this.appendSegment(i)}else{var r=null;for(e=0;e<n;e++){var s=t[e];if(!(s instanceof pt||s instanceof oe))throw new Error("Cannot construct a path segment from the provided object.");e===0&&this.appendSegment(K.createSegment("M",s.start)),r&&!r.end.equals(s.start)&&this.appendSegment(K.createSegment("M",s.start)),s instanceof pt?this.appendSegment(K.createSegment("L",s.end)):s instanceof oe&&this.appendSegment(K.createSegment("C",s.controlPoint1,s.controlPoint2,s.end)),r=s}}else if(t.isSegment)this.appendSegment(t);else if(t instanceof pt)this.appendSegment(K.createSegment("M",t.start)),this.appendSegment(K.createSegment("L",t.end));else if(t instanceof oe)this.appendSegment(K.createSegment("M",t.start)),this.appendSegment(K.createSegment("C",t.controlPoint1,t.controlPoint2,t.end));else if(t instanceof Ae){if(!(t.points&&t.points.length!==0))return;for(n=t.points.length,e=0;e<n;e++){var o=t.points[e];e===0?this.appendSegment(K.createSegment("M",o)):this.appendSegment(K.createSegment("L",o))}}else throw new Error("Cannot construct a path from the provided object.")};K.parse=function(t){if(!t)return new K;for(var e=new K,n=/(?:[a-zA-Z] *)(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)? *,? *)|(?:-?\.\d+ *,? *))+|(?:[a-zA-Z] *)(?! |\d|-|\.)/g,i=t.match(n),r=i.length,s=0;s<r;s++){var o=i[s],a=/(?:[a-zA-Z])|(?:(?:-?\d+(?:\.\d+)?(?:e[-+]?\d+)?))|(?:(?:-?\.\d+))/g,l=o.match(a),c=K.createSegment.apply(this,l);e.appendSegment(c)}return e};K.createSegment=function(t){if(!t)throw new Error("Type must be provided.");var e=K.segmentTypes[t];if(!e)throw new Error(t+" is not a recognized path segment type.");for(var n=[],i=arguments.length,r=1;r<i;r++)n.push(arguments[r]);return Oi(e,n)};K.prototype={type:zt.Path,appendSegment:function(t){var e=this.segments,n=e.length,i,r=n!==0?e[n-1]:null,s=null;if(Array.isArray(t)){if(t=t.reduce(function(c,h){return c.concat(h)},[]),!t[0].isSegment)throw new Error("Segments required.");for(var o=t.length,a=0;a<o;a++){var l=t[a];i=this.prepareSegment(l,r,s),e.push(i),r=i}}else{if(!t||!t.isSegment)throw new Error("Segment required.");i=this.prepareSegment(t,r,s),e.push(i)}},bbox:function(){var t=this.segments,e=t.length;if(e===0)return null;for(var n,i=0;i<e;i++){var r=t[i];if(r.isVisible){var s=r.bbox();n=n?n.union(s):s}}if(n)return n;var o=t[e-1];return new J(o.end.x,o.end.y,0,0)},clone:function(){for(var t=this.segments,e=t.length,n=new K,i=0;i<e;i++){var r=t[i].clone();n.appendSegment(r)}return n},closestPoint:function(t,e){var n=this.closestPointT(t,e);return n?this.pointAtT(n):null},closestPointLength:function(t,e){e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,i=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions,r={precision:n,segmentSubdivisions:i},s=this.closestPointT(t,r);return s?this.lengthAtT(s,r):0},closestPointNormalizedLength:function(t,e){e=e||{};var n=e.precision===void 0?this.PRECISION:e.precision,i=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:n}):e.segmentSubdivisions,r={precision:n,segmentSubdivisions:i},s=this.closestPointLength(t,r);if(s===0)return 0;var o=this.length(r);return o===0?0:s/o},closestPointT:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;e=e||{};for(var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o,a=1/0,l=0;l<i;l++){var c=n[l],h=s[l];if(c.isVisible){var u=c.closestPointT(t,{precision:r,subdivisions:h}),d=c.pointAtT(u),f=new pt(d,t).squaredLength();f<a&&(o={segmentIndex:l,value:u},a=f)}}return o||{segmentIndex:i-1,value:1}},closestPointTangent:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;e=e||{};for(var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o,a=1/0,l=0;l<i;l++){var c=n[l],h=s[l];if(c.isDifferentiable()){var u=c.closestPointT(t,{precision:r,subdivisions:h}),d=c.pointAtT(u),f=new pt(d,t).squaredLength();f<a&&(o=c.tangentAtT(u),a=f)}}return o||null},containsPoint:function(t,e){var n=this.toPolylines(e);if(!n)return!1;for(var i=n.length,r=0,s=0;s<i;s++){var o=n[s];o.containsPoint(t)&&r++}return r%2===1},divideAt:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;t<0&&(t=0),t>1&&(t=1),e=e||{};var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o={precision:r,segmentSubdivisions:s},a=this.length(o),l=a*t;return this.divideAtLength(l,o)},divideAtLength:function(t,e){var n=this.segments.length;if(n===0)return null;var i=!0;t<0&&(i=!1,t=-t),e=e||{};var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o,a,l=0,c,h,u,d,f;for(o=0;o<n;o++){var p=i?o:n-1-o;a=this.getSegment(p);var g=s[p],v=a.length({precision:r,subdivisions:g});if(a.isDifferentiable()&&(u=a,d=p,t<=l+v)){h=p,c=a.divideAtLength((i?1:-1)*(t-l),{precision:r,subdivisions:g});break}l+=v}if(!u)return null;c||(h=d,f=i?1:0,c=u.divideAtT(f));var x=this.clone();x.replaceSegment(h,c);var S=h,C=h+1,P=h+2;c[0].isDifferentiable()||(x.removeSegment(S),C-=1,P-=1);var O=x.getSegment(C).start;x.insertSegment(C,K.createSegment("M",O)),P+=1,c[1].isDifferentiable()||(x.removeSegment(P-1),P-=1);var N=P-S-1;for(o=P;o<x.segments.length;o++){var m=this.getSegment(o-N);if(a=x.getSegment(o),a.type==="Z"&&!m.subpathStartSegment.end.equals(a.subpathStartSegment.end)){var b=K.createSegment("L",m.end);x.replaceSegment(o,b)}}var w=new K(x.segments.slice(0,C)),A=new K(x.segments.slice(C));return[w,A]},equals:function(t){if(!t)return!1;var e=this.segments,n=t.segments,i=e.length;if(n.length!==i)return!1;for(var r=0;r<i;r++){var s=e[r],o=n[r];if(s.type!==o.type||!s.equals(o))return!1}return!0},getSegment:function(t){var e=this.segments,n=e.length;if(n===0)throw new Error("Path has no segments.");if(t<0&&(t=n+t),t>=n||t<0)throw new Error("Index out of range.");return e[t]},getSegmentSubdivisions:function(t){var e=this.segments,n=e.length;t=t||{};for(var i=t.precision===void 0?this.PRECISION:t.precision,r=[],s=0;s<n;s++){var o=e[s],a=o.getSubdivisions({precision:i});r.push(a)}return r},getSubpaths:function(){const e=this.clone().validate().segments,n=e.length,i=[];for(let r=0;r<n;r++){const s=e[r];s.isSubpathStart?i.push(new K(s)):i[i.length-1].appendSegment(s)}return i},insertSegment:function(t,e){var n=this.segments,i=n.length;if(t<0&&(t=i+t+1),t>i||t<0)throw new Error("Index out of range.");var r,s=null,o=null;if(i!==0&&(t>=1?(s=n[t-1],o=s.nextSegment):o=n[0]),Array.isArray(e)){if(e=e.reduce(function(h,u){return h.concat(u)},[]),!e[0].isSegment)throw new Error("Segments required.");for(var a=e.length,l=0;l<a;l++){var c=e[l];r=this.prepareSegment(c,s,o),n.splice(t+l,0,r),s=r}}else{if(!e||!e.isSegment)throw new Error("Segment required.");r=this.prepareSegment(e,s,o),n.splice(t,0,r)}},intersectionWithLine:function(t,e){var n=null,i=this.toPolylines(e);if(!i)return null;for(var r=0,s=i.length;r<s;r++){var o=i[r],a=t.intersect(o);a&&(n||(n=[]),Array.isArray(a)?Array.prototype.push.apply(n,a):n.push(a))}return n},isDifferentiable:function(){for(var t=this.segments,e=t.length,n=0;n<e;n++){var i=t[n];if(i.isDifferentiable())return!0}return!1},isValid:function(){var t=this.segments,e=t.length===0||t[0].type==="M";return e},length:function(t){var e=this.segments,n=e.length;if(n===0)return 0;t=t||{};for(var i=t.precision===void 0?this.PRECISION:t.precision,r=t.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:i}):t.segmentSubdivisions,s=0,o=0;o<n;o++){var a=e[o],l=r[o];s+=a.length({subdivisions:l})}return s},lengthAtT:function(t,e){var n=this.segments,i=n.length;if(i===0)return 0;var r=t.segmentIndex;if(r<0)return 0;var s=t.value;r>=i?(r=i-1,s=1):s<0?s=0:s>1&&(s=1),e=e||{};for(var o=e.precision===void 0?this.PRECISION:e.precision,a=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:o}):e.segmentSubdivisions,l,c=0,h=0;h<r;h++){var u=n[h];l=a[h],c+=u.length({precisison:o,subdivisions:l})}return u=n[r],l=a[r],c+=u.lengthAtT(s,{precisison:o,subdivisions:l}),c},pointAt:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;if(t<=0)return this.start.clone();if(t>=1)return this.end.clone();e=e||{};var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o={precision:r,segmentSubdivisions:s},a=this.length(o),l=a*t;return this.pointAtLength(l,o)},pointAtLength:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;if(t===0)return this.start.clone();var r=!0;t<0&&(r=!1,t=-t),e=e||{};for(var s=e.precision===void 0?this.PRECISION:e.precision,o=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:s}):e.segmentSubdivisions,a,l=0,c=0;c<i;c++){var h=r?c:i-1-c,u=n[h],d=o[h],f=u.length({precision:s,subdivisions:d});if(u.isVisible){if(t<=l+f)return u.pointAtLength((r?1:-1)*(t-l),{precision:s,subdivisions:d});a=u}l+=f}if(a)return r?a.end:a.start;var p=n[i-1];return p.end.clone()},pointAtT:function(t){var e=this.segments,n=e.length;if(n===0)return null;var i=t.segmentIndex;if(i<0)return e[0].pointAtT(0);if(i>=n)return e[n-1].pointAtT(1);var r=t.value;return r<0?r=0:r>1&&(r=1),e[i].pointAtT(r)},PRECISION:3,prepareSegment:function(t,e,n){t.previousSegment=e,t.nextSegment=n,e&&(e.nextSegment=t),n&&(n.previousSegment=t);var i=t;return t.isSubpathStart&&(t.subpathStartSegment=t,i=n),i&&this.updateSubpathStartSegment(i),t},removeSegment:function(t){var e=this.segments,n=e.length;if(n===0)throw new Error("Path has no segments.");if(t<0&&(t=n+t),t>=n||t<0)throw new Error("Index out of range.");var i=e.splice(t,1)[0],r=i.previousSegment,s=i.nextSegment;r&&(r.nextSegment=s),s&&(s.previousSegment=r),i.isSubpathStart&&s&&this.updateSubpathStartSegment(s)},replaceSegment:function(t,e){var n=this.segments,i=n.length;if(i===0)throw new Error("Path has no segments.");if(t<0&&(t=i+t),t>=i||t<0)throw new Error("Index out of range.");var r,s=n[t],o=s.previousSegment,a=s.nextSegment,l=s.isSubpathStart;if(Array.isArray(e)){if(e=e.reduce(function(d,f){return d.concat(f)},[]),!e[0].isSegment)throw new Error("Segments required.");n.splice(t,1);for(var c=e.length,h=0;h<c;h++){var u=e[h];r=this.prepareSegment(u,o,a),n.splice(t+h,0,r),o=r,l&&r.isSubpathStart&&(l=!1)}}else{if(!e||!e.isSegment)throw new Error("Segment required.");r=this.prepareSegment(e,o,a),n.splice(t,1,r),l&&r.isSubpathStart&&(l=!1)}l&&a&&this.updateSubpathStartSegment(a)},round:function(t){for(var e=this.segments,n=e.length,i=0;i<n;i++){var r=e[i];r.round(t)}return this},scale:function(t,e,n){for(var i=this.segments,r=i.length,s=0;s<r;s++){var o=i[s];o.scale(t,e,n)}return this},segmentAt:function(t,e){var n=this.segmentIndexAt(t,e);return n?this.getSegment(n):null},segmentAtLength:function(t,e){var n=this.segmentIndexAtLength(t,e);return n?this.getSegment(n):null},segmentIndexAt:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;t<0&&(t=0),t>1&&(t=1),e=e||{};var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o={precision:r,segmentSubdivisions:s},a=this.length(o),l=a*t;return this.segmentIndexAtLength(l,o)},segmentIndexAtLength:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;var r=!0;t<0&&(r=!1,t=-t),e=e||{};for(var s=e.precision===void 0?this.PRECISION:e.precision,o=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:s}):e.segmentSubdivisions,a=null,l=0,c=0;c<i;c++){var h=r?c:i-1-c,u=n[h],d=o[h],f=u.length({precision:s,subdivisions:d});if(u.isVisible){if(t<=l+f)return h;a=h}l+=f}return a},serialize:function(){if(!this.isValid())throw new Error("Invalid path segments.");return this.toString()},tangentAt:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;t<0&&(t=0),t>1&&(t=1),e=e||{};var r=e.precision===void 0?this.PRECISION:e.precision,s=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:r}):e.segmentSubdivisions,o={precision:r,segmentSubdivisions:s},a=this.length(o),l=a*t;return this.tangentAtLength(l,o)},tangentAtLength:function(t,e){var n=this.segments,i=n.length;if(i===0)return null;var r=!0;t<0&&(r=!1,t=-t),e=e||{};for(var s=e.precision===void 0?this.PRECISION:e.precision,o=e.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:s}):e.segmentSubdivisions,a,l=0,c=0;c<i;c++){var h=r?c:i-1-c,u=n[h],d=o[h],f=u.length({precision:s,subdivisions:d});if(u.isDifferentiable()){if(t<=l+f)return u.tangentAtLength((r?1:-1)*(t-l),{precision:s,subdivisions:d});a=u}l+=f}if(a){var p=r?1:0;return a.tangentAtT(p)}return null},tangentAtT:function(t){var e=this.segments,n=e.length;if(n===0)return null;var i=t.segmentIndex;if(i<0)return e[0].tangentAtT(0);if(i>=n)return e[n-1].tangentAtT(1);var r=t.value;return r<0?r=0:r>1&&(r=1),e[i].tangentAtT(r)},toPoints:function(t){var e=this.segments,n=e.length;if(n===0)return null;t=t||{};for(var i=t.precision===void 0?this.PRECISION:t.precision,r=t.segmentSubdivisions===void 0?this.getSegmentSubdivisions({precision:i}):t.segmentSubdivisions,s=[],o=[],a=0;a<n;a++){var l=e[a];if(l.isVisible){var c=r[a];if(c.length>0){var h=c.map(function(u){return u.start});Array.prototype.push.apply(o,h)}else o.push(l.start)}else o.length>0&&(o.push(e[a-1].end),s.push(o),o=[])}return o.length>0&&(o.push(this.end),s.push(o)),s},toPolylines:function(t){var e=[],n=this.toPoints(t);if(!n)return null;for(var i=0,r=n.length;i<r;i++)e.push(new Ae(n[i]));return e},toString:function(){for(var t=this.segments,e=t.length,n="",i=0;i<e;i++){var r=t[i];n+=r.serialize()+" "}return n.trim()},translate:function(t,e){for(var n=this.segments,i=n.length,r=0;r<i;r++){var s=n[r];s.translate(t,e)}return this},updateSubpathStartSegment:function(t){for(var e=t.previousSegment;t&&!t.isSubpathStart;)e?t.subpathStartSegment=e.subpathStartSegment:t.subpathStartSegment=null,e=t,t=t.nextSegment},validate:function(){return this.isValid()||this.insertSegment(0,K.createSegment("M",0,0)),this}};Object.defineProperty(K.prototype,"start",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(e===0)return null;for(var n=0;n<e;n++){var i=t[n];if(i.isVisible)return i.start}return t[e-1].end}});Object.defineProperty(K.prototype,"end",{configurable:!0,enumerable:!0,get:function(){var t=this.segments,e=t.length;if(e===0)return null;for(var n=e-1;n>=0;n--){var i=t[n];if(i.isVisible)return i.end}return t[e-1].end}});function Oi(t,e){return e.unshift(null),new(Function.prototype.bind.apply(t,e))}var gs={bbox:function(){throw new Error("Declaration missing for virtual function.")},clone:function(){throw new Error("Declaration missing for virtual function.")},closestPoint:function(){throw new Error("Declaration missing for virtual function.")},closestPointLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointNormalizedLength:function(){throw new Error("Declaration missing for virtual function.")},closestPointT:function(t){if(this.closestPointNormalizedLength)return this.closestPointNormalizedLength(t);throw new Error("Neither closestPointT() nor closestPointNormalizedLength() function is implemented.")},closestPointTangent:function(){throw new Error("Declaration missing for virtual function.")},divideAt:function(){throw new Error("Declaration missing for virtual function.")},divideAtLength:function(){throw new Error("Declaration missing for virtual function.")},divideAtT:function(t){if(this.divideAt)return this.divideAt(t);throw new Error("Neither divideAtT() nor divideAt() function is implemented.")},equals:function(){throw new Error("Declaration missing for virtual function.")},getSubdivisions:function(){throw new Error("Declaration missing for virtual function.")},isDifferentiable:function(){throw new Error("Declaration missing for virtual function.")},isSegment:!0,isSubpathStart:!1,isVisible:!0,length:function(){throw new Error("Declaration missing for virtual function.")},lengthAtT:function(t){if(t<=0)return 0;var e=this.length();return t>=1?e:e*t},nextSegment:null,pointAt:function(){throw new Error("Declaration missing for virtual function.")},pointAtLength:function(){throw new Error("Declaration missing for virtual function.")},pointAtT:function(t){if(this.pointAt)return this.pointAt(t);throw new Error("Neither pointAtT() nor pointAt() function is implemented.")},previousSegment:null,round:function(){throw new Error("Declaration missing for virtual function.")},subpathStartSegment:null,scale:function(){throw new Error("Declaration missing for virtual function.")},serialize:function(){throw new Error("Declaration missing for virtual function.")},tangentAt:function(){throw new Error("Declaration missing for virtual function.")},tangentAtLength:function(){throw new Error("Declaration missing for virtual function.")},tangentAtT:function(t){if(this.tangentAt)return this.tangentAt(t);throw new Error("Neither tangentAtT() nor tangentAt() function is implemented.")},toString:function(){throw new Error("Declaration missing for virtual function.")},translate:function(){throw new Error("Declaration missing for virtual function.")}};Object.defineProperty(gs,"end",{configurable:!0,enumerable:!0,writable:!0});Object.defineProperty(gs,"start",{configurable:!0,enumerable:!0,get:function(){if(!this.previousSegment)throw new Error("Missing previous segment. (This segment cannot be the first segment of a path; OR segment has not yet been added to a path.)");return this.previousSegment.end}});Object.defineProperty(gs,"type",{configurable:!0,enumerable:!0,get:function(){throw new Error("Bad segment declaration. No type specified.")}});var bn=function(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);if(!(this instanceof bn))return Oi(bn,t);if(e===0)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates (none provided).");var i;if(t[0]instanceof pt){if(e===1)return this.end=t[0].end.clone(),this;throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+e+" lines provided).")}else if(typeof t[0]=="string"||typeof t[0]=="number"){if(e===2)return this.end=new L(+t[0],+t[1]),this;if(e<2)throw new Error("Lineto constructor expects a line, 1 point, or 2 coordinates ("+e+" coordinates provided).");var r;for(i=[],n=0;n<e;n+=2)r=t.slice(n,n+2),i.push(Oi(bn,r));return i}else{if(e===1)return this.end=new L(t[0]),this;var s;for(i=[],n=0;n<e;n+=1)s=t[n],i.push(new bn(s));return i}},kb={clone:function(){return new bn(this.end)},divideAt:function(t){var e=new pt(this.start,this.end),n=e.divideAt(t);return[new bn(n[0]),new bn(n[1])]},divideAtLength:function(t){var e=new pt(this.start,this.end),n=e.divideAtLength(t);return[new bn(n[0]),new bn(n[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return this.previousSegment?!this.start.equals(this.end):!1},round:function(t){return this.end.round(t),this},scale:function(t,e,n){return this.end.scale(t,e,n),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}};Object.defineProperty(kb,"type",{configurable:!0,enumerable:!0,value:"L"});bn.prototype=$a(gs,pt.prototype,kb);var Xn=function(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);if(!(this instanceof Xn))return Oi(Xn,t);if(e===0)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates (none provided).");var i;if(t[0]instanceof oe){if(e===1)return this.controlPoint1=t[0].controlPoint1.clone(),this.controlPoint2=t[0].controlPoint2.clone(),this.end=t[0].end.clone(),this;throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+e+" curves provided).")}else if(typeof t[0]=="string"||typeof t[0]=="number"){if(e===6)return this.controlPoint1=new L(+t[0],+t[1]),this.controlPoint2=new L(+t[2],+t[3]),this.end=new L(+t[4],+t[5]),this;if(e<6)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+e+" coordinates provided).");var r;for(i=[],n=0;n<e;n+=6)r=t.slice(n,n+6),i.push(Oi(Xn,r));return i}else{if(e===3)return this.controlPoint1=new L(t[0]),this.controlPoint2=new L(t[1]),this.end=new L(t[2]),this;if(e<3)throw new Error("Curveto constructor expects a curve, 3 points, or 6 coordinates ("+e+" points provided).");var s;for(i=[],n=0;n<e;n+=3)s=t.slice(n,n+3),i.push(Oi(Xn,s));return i}},Lb={clone:function(){return new Xn(this.controlPoint1,this.controlPoint2,this.end)},divideAt:function(t,e){var n=new oe(this.start,this.controlPoint1,this.controlPoint2,this.end),i=n.divideAt(t,e);return[new Xn(i[0]),new Xn(i[1])]},divideAtLength:function(t,e){var n=new oe(this.start,this.controlPoint1,this.controlPoint2,this.end),i=n.divideAtLength(t,e);return[new Xn(i[0]),new Xn(i[1])]},divideAtT:function(t){var e=new oe(this.start,this.controlPoint1,this.controlPoint2,this.end),n=e.divideAtT(t);return[new Xn(n[0]),new Xn(n[1])]},isDifferentiable:function(){if(!this.previousSegment)return!1;var t=this.start,e=this.controlPoint1,n=this.controlPoint2,i=this.end;return!(t.equals(e)&&e.equals(n)&&n.equals(i))},round:function(t){return this.controlPoint1.round(t),this.controlPoint2.round(t),this.end.round(t),this},scale:function(t,e,n){return this.controlPoint1.scale(t,e,n),this.controlPoint2.scale(t,e,n),this.end.scale(t,e,n),this},serialize:function(){var t=this.controlPoint1,e=this.controlPoint2,n=this.end;return this.type+" "+t.x+" "+t.y+" "+e.x+" "+e.y+" "+n.x+" "+n.y},toString:function(){return this.type+" "+this.start+" "+this.controlPoint1+" "+this.controlPoint2+" "+this.end},translate:function(t,e){return this.controlPoint1.translate(t,e),this.controlPoint2.translate(t,e),this.end.translate(t,e),this}};Object.defineProperty(Lb,"type",{configurable:!0,enumerable:!0,value:"C"});Xn.prototype=$a(gs,oe.prototype,Lb);var Wr=function(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);if(!(this instanceof Wr))return Oi(Wr,t);if(e===0)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates (none provided).");var i;if(t[0]instanceof pt){if(e===1)return this.end=t[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+e+" lines provided).")}else if(t[0]instanceof oe){if(e===1)return this.end=t[0].end.clone(),this;throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+e+" curves provided).")}else if(typeof t[0]=="string"||typeof t[0]=="number"){if(e===2)return this.end=new L(+t[0],+t[1]),this;if(e<2)throw new Error("Moveto constructor expects a line, a curve, 1 point, or 2 coordinates ("+e+" coordinates provided).");var r;for(i=[],n=0;n<e;n+=2)r=t.slice(n,n+2),n===0?i.push(Oi(Wr,r)):i.push(Oi(bn,r));return i}else{if(e===1)return this.end=new L(t[0]),this;var s;for(i=[],n=0;n<e;n+=1)s=t[n],n===0?i.push(new Wr(s)):i.push(new bn(s));return i}},gf={bbox:function(){return null},clone:function(){return new Wr(this.end)},closestPoint:function(){return this.end.clone()},closestPointNormalizedLength:function(){return 0},closestPointLength:function(){return 0},closestPointT:function(){return 1},closestPointTangent:function(){return null},divideAt:function(){return[this.clone(),this.clone()]},divideAtLength:function(){return[this.clone(),this.clone()]},equals:function(t){return this.end.equals(t.end)},getSubdivisions:function(){return[]},isDifferentiable:function(){return!1},isSubpathStart:!0,isVisible:!1,length:function(){return 0},lengthAtT:function(){return 0},pointAt:function(){return this.end.clone()},pointAtLength:function(){return this.end.clone()},pointAtT:function(){return this.end.clone()},round:function(t){return this.end.round(t),this},scale:function(t,e,n){return this.end.scale(t,e,n),this},serialize:function(){var t=this.end;return this.type+" "+t.x+" "+t.y},tangentAt:function(){return null},tangentAtLength:function(){return null},tangentAtT:function(){return null},toString:function(){return this.type+" "+this.end},translate:function(t,e){return this.end.translate(t,e),this}};Object.defineProperty(gf,"start",{configurable:!0,enumerable:!0,get:function(){throw new Error("Illegal access. Moveto segments should not need a start property.")}});Object.defineProperty(gf,"type",{configurable:!0,enumerable:!0,value:"M"});Wr.prototype=$a(gs,gf);var to=function(){for(var t=[],e=arguments.length,n=0;n<e;n++)t.push(arguments[n]);if(!(this instanceof to))return Oi(to,t);if(e>0)throw new Error("Closepath constructor expects no arguments.");return this},mf={clone:function(){return new to},divideAt:function(t){var e=new pt(this.start,this.end),n=e.divideAt(t);return[n[1].isDifferentiable()?new bn(n[0]):this.clone(),new bn(n[1])]},divideAtLength:function(t){var e=new pt(this.start,this.end),n=e.divideAtLength(t);return[n[1].isDifferentiable()?new bn(n[0]):this.clone(),new bn(n[1])]},getSubdivisions:function(){return[]},isDifferentiable:function(){return!this.previousSegment||!this.subpathStartSegment?!1:!this.start.equals(this.end)},round:function(){return this},scale:function(){return this},serialize:function(){return this.type},toString:function(){return this.type+" "+this.start+" "+this.end},translate:function(){return this}};Object.defineProperty(mf,"end",{configurable:!0,enumerable:!0,get:function(){if(!this.subpathStartSegment)throw new Error("Missing subpath start segment. (This segment needs a subpath start segment (e.g. Moveto); OR segment has not yet been added to a path.)");return this.subpathStartSegment.end}});Object.defineProperty(mf,"type",{configurable:!0,enumerable:!0,value:"Z"});to.prototype=$a(gs,pt.prototype,mf);var MD=K.segmentTypes={L:bn,C:Xn,M:Wr,Z:to,z:to};K.regexSupportedData=new RegExp("^[\\s\\d"+Object.keys(MD).join("")+",.]*$");K.isDataSupported=function(t){return typeof t!="string"?!1:this.regexSupportedData.test(t)};const DD={curveThroughPoints:function(t){return console.warn("deprecated"),new K(oe.throughPoints(t)).serialize()},getCurveControlPoints:function(t){console.warn("deprecated");var e=[],n=[],i=t.length-1,r;if(i==1)return e[0]=new L((2*t[0].x+t[1].x)/3,(2*t[0].y+t[1].y)/3),n[0]=new L(2*e[0].x-t[0].x,2*e[0].y-t[0].y),[e,n];var s=[];for(r=1;r<i-1;r++)s[r]=4*t[r].x+2*t[r+1].x;s[0]=t[0].x+2*t[1].x,s[i-1]=(8*t[i-1].x+t[i].x)/2;var o=this.getFirstControlPoints(s);for(r=1;r<i-1;++r)s[r]=4*t[r].y+2*t[r+1].y;s[0]=t[0].y+2*t[1].y,s[i-1]=(8*t[i-1].y+t[i].y)/2;var a=this.getFirstControlPoints(s);for(r=0;r<i;r++)e.push(new L(o[r],a[r])),r<i-1?n.push(new L(2*t[r+1].x-o[r+1],2*t[r+1].y-a[r+1])):n.push(new L((t[i].x+o[i-1])/2,(t[i].y+a[i-1])/2));return[e,n]},getCurveDivider:function(t,e,n,i){console.warn("deprecated");var r=new oe(t,e,n,i);return function(o){var a=r.divide(o);return[{p0:a[0].start,p1:a[0].controlPoint1,p2:a[0].controlPoint2,p3:a[0].end},{p0:a[1].start,p1:a[1].controlPoint1,p2:a[1].controlPoint2,p3:a[1].end}]}},getFirstControlPoints:function(t){console.warn("deprecated");var e=t.length,n=[],i=[],r=2;n[0]=t[0]/r;for(var s=1;s<e;s++)i[s]=1/r,r=(s<e-1?4:3.5)-i[s],n[s]=(t[s]-n[s-1])/r;for(s=1;s<e;s++)n[e-s-1]-=i[e-s]*n[e-s];return n},getInversionSolver:function(t,e,n,i){console.warn("deprecated");var r=new oe(t,e,n,i);return function(o){return r.closestPointT(o)}}},Gn=function(t){if(!(this instanceof Gn))return new Gn(t);if(typeof t=="string")return new Gn.parse(t);this.points=Array.isArray(t)?t.map(L):[]};Gn.parse=function(t){return new Gn(Pb(t))};Gn.fromRect=function(t){return new Gn([t.topLeft(),t.topRight(),t.bottomRight(),t.bottomLeft()])};Gn.prototype=$a(Ae.prototype,{type:zt.Polygon,clone:function(){return new Gn(Ib(this.points))},convexHull:function(){return new Gn(Ob(this.points))},lengthPoints:function(){const{start:t,end:e,points:n}=this;return n.length<=1||t.equals(e)?n:[...n,t.clone()]}});function Mb(t,e,n,i){switch(t.type){case zt.Line:{switch(e.type){case zt.Line:return Yr(t,e)}break}case zt.Ellipse:{switch(e.type){case zt.Line:return vf(t,e);case zt.Ellipse:return Db(t,e)}break}case zt.Rect:{switch(e.type){case zt.Line:return Nb(t,e);case zt.Ellipse:return Rb(t,e);case zt.Rect:return yf(t,e)}break}case zt.Polyline:{switch(e.type){case zt.Line:return Xc(t,e);case zt.Ellipse:return bf(t,e);case zt.Rect:return $b(t,e);case zt.Polyline:return Bb(t,e)}break}case zt.Polygon:{switch(e.type){case zt.Line:return xf(t,e);case zt.Ellipse:return qc(t,e);case zt.Rect:return Fb(t,e);case zt.Polyline:return Vb(t,e);case zt.Polygon:return zb(t,e)}break}case zt.Path:{switch(e.type){case zt.Line:return Ub(t,e,n);case zt.Ellipse:return Hb(t,e,n);case zt.Rect:return Gb(t,e,n);case zt.Polyline:return wf(t,e,n);case zt.Polygon:return Kc(t,e,n);case zt.Path:return jb(t,e,n,i)}break}}switch(e.type){case zt.Ellipse:case zt.Rect:case zt.Polyline:case zt.Polygon:case zt.Path:return Mb(e,t,i,n);default:throw Error(`The intersection for ${t} and ${e} could not be found.`)}}function Yr(t,e){const n=t.start.x,i=t.start.y,r=t.end.x,s=t.end.y,o=e.start.x,a=e.start.y,l=e.end.x,c=e.end.y,h=r-n,u=s-i,d=l-o,f=c-a,p=n-o,g=i-a,v=h*f-d*u,x=(h*g-u*p)/v,S=(d*g-f*p)/v;return x>=0&&x<=1&&S>=0&&S<=1}function vf(t,e){const n=t.a,i=t.b,r=t.x,s=t.y,o=e.start.x-r,a=e.end.x-r,l=e.start.y-s,c=e.end.y-s,h=n*n,u=i*i,d=a-o,f=c-l,p=d*d/h+f*f/u,g=2*o*d/h+2*l*f/u,v=o*o/h+l*l/u-1,x=g*g-4*p*v;if(x===0){const S=-g/2/p;return S>=0&&S<=1}else if(x>0){const S=Math.sqrt(x),C=(-g+S)/2/p,P=(-g-S)/2/p;return C>=0&&C<=1||P>=0&&P<=1}return!1}function Db(t,e){return ND(t,0,e,0)}function Nb(t,e){const{start:n,end:i}=e,{x:r,y:s,width:o,height:a}=t;return n.x>r+o&&i.x>r+o||n.x<r&&i.x<r||n.y>s+a&&i.y>s+a||n.y<s&&i.y<s?!1:t.containsPoint(e.start)||t.containsPoint(e.end)?!0:Yr(t.topLine(),e)||Yr(t.rightLine(),e)||Yr(t.bottomLine(),e)||Yr(t.leftLine(),e)}function Rb(t,e){return yf(t,J.fromEllipse(e))?qc(Gn.fromRect(t),e):!1}function yf(t,e){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}function Xc(t,e){return Wb(t,e,{interior:!1})}function bf(t,e){return Yb(t,e,{interior:!1})}function $b(t,e){return Xb(t,e,{interior:!1})}function Bb(t,e){return Zc(t,e,{interior:!1})}function xf(t,e){return Wb(t,e,{interior:!0})}function qc(t,e){return Yb(t,e,{interior:!0})}function Fb(t,e){return Xb(t,e,{interior:!0})}function Vb(t,e){return Zc(t,e,{interior:!0})}function zb(t,e){return _f(t,e,{interior:!0})}function Ub(t,e,n){return t.getSubpaths().some(i=>{const[r]=i.toPolylines(n),{type:s}=i.getSegment(-1);return s==="Z"?xf(r,e):Xc(r,e)})}function Hb(t,e,n){return t.getSubpaths().some(i=>{const[r]=i.toPolylines(n),{type:s}=i.getSegment(-1);return s==="Z"?qc(r,e):bf(r,e)})}function Gb(t,e,n){return Kc(t,Gn.fromRect(e),n)}function wf(t,e,n){return qb(t,e,n,{interior:!1})}function Kc(t,e,n){return qb(t,e,n,{interior:!0})}function jb(t,e,n,i){return t.getSubpaths().some(r=>{const[s]=r.toPolylines(n),{type:o}=r.getSegment(-1);return o==="Z"?Kc(e,s,i):wf(e,s,i)})}function Wb(t,e,n={}){const{interior:i=!1}=n;let r;if(i){if(t.containsPoint(e.start))return!0;const{start:a,end:l,points:c}=t;r=l.equals(a)?c:[...c,a]}else r=t.points;const{length:s}=r,o=new pt;for(let a=0;a<s-1;a++)if(o.start=r[a],o.end=r[a+1],Yr(e,o))return!0;return!1}function Yb(t,e,n={}){const{start:i,end:r,points:s}=t;if(e.containsPoint(i))return!0;let o;const{interior:a=!1}=n;if(a){if(t.containsPoint(e.center()))return!0;o=r.equals(i)?s:[...s,i]}else o=s;const{length:l}=o,c=new pt;for(let h=0;h<l-1;h++)if(c.start=o[h],c.end=o[h+1],vf(e,c))return!0;return!1}function Xb(t,e,n){const i=Gn.fromRect(e);return _f(t,i,n)}function qb(t,e,n,i){return t.getSubpaths().some(r=>{const[s]=r.toPolylines(n),{type:o}=r.getSegment(-1);return o==="Z"?_f(e,s,i):Zc(e,s,i)})}function Zc(t,e,n={}){const{interior:i=!1}=n;let r;if(i){const{start:l}=e;if(t.containsPoint(l))return!0;r=t.clone().close()}else r=t;const s=e.points,{length:o}=s,a=new pt;for(let l=0;l<o-1;l++)if(a.start=s[l],a.end=s[l+1],Xc(r,a))return!0;return!1}function _f(t,e,n){return e.containsPoint(t.start)||Zc(t,e.clone().close(),n)}function ND(t,e,n,i){const{cos:r,sin:s}=Math,o=s(e),a=r(e),l=s(i),c=r(i),h=o*o,u=a*a,d=o*a,f=l*l,p=c*c,g=l*c,v=t.a*t.a,x=t.b*t.b,S=n.a*n.a,C=n.b*n.b,P=v*h+x*u,O=S*f+C*p,N=v*u+x*h,m=S*p+C*f;let b=2*(x-v)*d,w=2*(C-S)*g,A=-2*P*t.x-b*t.y,E=-2*O*n.x-w*n.y,M=-b*t.x-2*N*t.y,$=-w*n.x-2*m*n.y;const F=P*t.x*t.x+N*t.y*t.y+b*t.x*t.y-v*x,j=O*n.x*n.x+m*n.y*n.y+w*n.x*n.y-S*C;b=b/2,w=w/2,A=A/2,E=E/2,M=M/2,$=$/2;const R=mr([[P,b,A],[b,N,M],[A,M,F]]),H=mr([[O,w,E],[w,m,$],[E,$,j]]),z=.33333333*(mr([[O,b,A],[w,N,M],[E,M,F]])+mr([[P,w,A],[b,m,M],[A,$,F]])+mr([[P,b,E],[b,N,$],[A,M,j]])),B=.33333333*(mr([[P,w,E],[b,m,$],[A,$,j]])+mr([[O,b,E],[w,N,$],[E,M,j]])+mr([[O,w,A],[w,m,M],[E,$,F]])),_t=vl([[R,z],[z,B]]),gt=vl([[R,B],[z,H]]),Rt=vl([[z,B],[B,H]]);return!(vl([[2*_t,gt],[gt,2*Rt]])>0&&(B>0||z>0))}function vl(t){return t[0][0]*t[1][1]-t[0][1]*t[1][0]}function mr(t){return t[0][0]*t[1][1]*t[2][2]-t[0][0]*t[1][2]*t[2][1]-t[0][1]*t[1][0]*t[2][2]+t[0][1]*t[1][2]*t[2][0]+t[0][2]*t[1][0]*t[2][1]-t[0][2]*t[1][1]*t[2][0]}const RD=Object.freeze(Object.defineProperty({__proto__:null,ellipseWithEllipse:Db,ellipseWithLine:vf,exists:Mb,lineWithLine:Yr,pathWithEllipse:Hb,pathWithLine:Ub,pathWithPath:jb,pathWithPolygon:Kc,pathWithPolyline:wf,pathWithRect:Gb,polygonWithEllipse:qc,polygonWithLine:xf,polygonWithPolygon:zb,polygonWithPolyline:Vb,polygonWithRect:Fb,polylineWithEllipse:bf,polylineWithLine:Xc,polylineWithPolyline:Bb,polylineWithRect:$b,rectWithEllipse:Rb,rectWithLine:Nb,rectWithRect:yf},Symbol.toStringTag,{value:"Module"})),$D=RD,BD=Object.freeze(Object.defineProperty({__proto__:null,Curve:oe,Ellipse:Ln,Line:pt,Path:K,Point:L,Polygon:Gn,Polyline:Ae,Rect:J,bezier:DD,ellipse:PD,intersection:$D,line:ts,normalizeAngle:Qe,point:re,random:ga,rect:Ji,scale:qe,snapToGrid:ii,toDeg:Yc,toRad:an,types:zt},Symbol.toStringTag,{value:"Module"})),FD=function(){var t=typeof window=="object"&&!!window.SVGAngle;if(!t)return function(){throw new Error("SVG is required to use Vectorizer.")};var e={svg:"http://www.w3.org/2000/svg",xmlns:"http://www.w3.org/2000/xmlns/",xml:"http://www.w3.org/XML/1998/namespace",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},n="1.1",i=Math,r=i.PI,s=i.atan2,o=i.sqrt,a=i.min,l=i.max,c=i.cos,h=i.sin,u=function(m,b,w){if(!(this instanceof u))return u.apply(Object.create(u.prototype),arguments);if(m){if(u.isV(m)&&(m=m.node),b=b||{},u.isString(m)){if(m=m.trim(),m.toLowerCase()==="svg")m=u.createSvgDocument();else if(m[0]==="<"){var A=u.createSvgDocument(m);if(A.childNodes.length>1){var E=[],M,$;for(M=0,$=A.childNodes.length;M<$;M++){var F=A.childNodes[M];E.push(new u(document.importNode(F,!0)))}return E}m=document.importNode(A.firstChild,!0)}else m=document.createElementNS(e.svg,m);u.ensureId(m)}return this.node=m,this.setAttributes(b),w&&this.append(w),this}},d=u.prototype;Object.defineProperty(d,"id",{enumerable:!0,get:function(){return this.node.id},set:function(m){this.node.id=m}}),d.getTransformToElement=function(m){var b=this.node;if(u.isSVGGraphicsElement(m)&&u.isSVGGraphicsElement(b)){var w=u.toNode(m).getScreenCTM(),A=b.getScreenCTM();if(w&&A)return w.inverse().multiply(A)}return u.createSVGMatrix()},d.transform=function(m,b){var w=this.node;if(u.isUndefined(m))return u.transformStringToMatrix(this.attr("transform"));if(b&&b.absolute)return this.attr("transform",u.matrixToTransformString(m));var A=u.createSVGTransform(m);return w.transform.baseVal.appendItem(A),this},d.translate=function(m,b,w){w=w||{},b=b||0;var A=this.attr("transform")||"",E=u.parseTransformString(A);if(A=E.value,u.isUndefined(m))return E.translate;A=A.replace(/translate\([^)]*\)/g,"").trim();var M=w.absolute?m:E.translate.tx+m,$=w.absolute?b:E.translate.ty+b,F="translate("+M+","+$+")";return this.attr("transform",(F+" "+A).trim()),this},d.rotate=function(m,b,w,A){A=A||{};var E=this.attr("transform")||"",M=u.parseTransformString(E);if(E=M.value,u.isUndefined(m))return M.rotate;E=E.replace(/rotate\([^)]*\)/g,"").trim(),m%=360;var $=A.absolute?m:M.rotate.angle+m,F=b!==void 0&&w!==void 0?","+b+","+w:"",j="rotate("+$+F+")";return this.attr("transform",(E+" "+j).trim()),this},d.scale=function(m,b){b=u.isUndefined(b)?m:b;var w=this.attr("transform")||"",A=u.parseTransformString(w);if(w=A.value,u.isUndefined(m))return A.scale;w=w.replace(/scale\([^)]*\)/g,"").trim();var E="scale("+m+","+b+")";return this.attr("transform",(w+" "+E).trim()),this},d.bbox=function(m,b){var w,A=this.node,E=A.ownerSVGElement;if(!E)return new J(0,0,0,0);try{w=A.getBBox()}catch{w={x:A.clientLeft,y:A.clientTop,width:A.clientWidth,height:A.clientHeight}}if(m)return new J(w);var M=this.getTransformToElement(b||E);return u.transformRect(w,M)},d.getBBox=function(m){var b={},w,A=this.node,E=A.ownerSVGElement;if(!E||!u.isSVGGraphicsElement(A))return new J(0,0,0,0);if(m&&(m.target&&(b.target=u.toNode(m.target)),m.recursive&&(b.recursive=m.recursive)),b.recursive){var $=this.children(),F=$.length;if(F===0)return this.getBBox({target:b.target,recursive:!1});b.target||(b.target=this);for(var j=0;j<F;j++){var R=$[j],H;R.children().length===0?H=R.getBBox({target:b.target,recursive:!1}):H=R.getBBox({target:b.target,recursive:!0}),w?w=w.union(H):w=H}return w}else{try{w=A.getBBox()}catch{w={x:A.clientLeft,y:A.clientTop,width:A.clientWidth,height:A.clientHeight}}if(b.target){var M=this.getTransformToElement(b.target);return u.transformRect(w,M)}else return new J(w)}};function f(m,b){m||(m={});var w=u("textPath"),A=m.d;if(A&&m["xlink:href"]===void 0){var E=u("path").attr("d",A).appendTo(b.defs());w.attr("xlink:href","#"+E.id)}return u.isObject(m)&&w.attr(m),w.node}function p(m,b,w){w||(w={});for(var A=w.includeAnnotationIndices,E=w.eol,M=w.lineHeight,$=w.baseSize,F=0,j={},R=b.length-1,H=0;H<=R;H++){var z=b[H],B=null;if(u.isObject(z)){var _t=z.attrs,gt=u("tspan",_t),Rt=gt.node,ne=z.t;E&&H===R&&(ne+=E),Rt.textContent=ne;var bt=_t.class;bt&&gt.addClass(bt),A&&gt.attr("annotations",z.annotations),B=parseFloat(_t["font-size"]),isFinite(B)||(B=$),B&&B>F&&(F=B)}else E&&H===R&&(z+=E),Rt=document.createTextNode(z||" "),$&&$>F&&(F=$);m.appendChild(Rt)}return F&&(j.maxFontSize=F),M?j.lineHeight=M:F&&(j.lineHeight=F*1.2),j}var g=/em$/;function v(m,b){var w=parseFloat(m);return g.test(m)?w*b:w}function x(m,b,w,A){if(!Array.isArray(b))return 0;var E=b.length;if(!E)return 0;for(var M=b[0],$=v(M.maxFontSize,w)||w,F=0,j=v(A,w),R=1;R<E;R++){M=b[R];var H=v(M.lineHeight,w)||j;F+=H}var z=v(M.maxFontSize,w)||w,B;switch(m){case"middle":B=$/2-.15*z-F/2;break;case"bottom":B=-(.25*z)-F;break;default:case"top":B=.8*$;break}return B}d.text=function(m,b){if(m&&typeof m!="string")throw new Error("Vectorizer: text() expects the first argument to be a string.");m=u.sanitizeText(m),b||(b={});var w=b.displayEmpty,A=b.eol,E=b.textPath,M=b.textVerticalAnchor,$=M==="middle"||M==="bottom"||M==="top",F=b.x;F===void 0&&(F=this.attr("x")||0);var j=b.includeAnnotationIndices,R=b.annotations;R&&!u.isArray(R)&&(R=[R]);var H=b.lineHeight,z=H==="auto",B=z?"1.5em":H||"1em";this.empty(),this.attr({"xml:space":"preserve",display:m||w?null:"none"});var _t=parseFloat(this.attr("font-size"));_t||(_t=16,($||R)&&this.attr("font-size",_t));var gt=document,Rt;E?(typeof E=="string"&&(E={d:E}),Rt=f(E,this)):Rt=gt.createDocumentFragment();for(var ne=0,bt=m.split(`
`),St=[],Y,W=0,Q=bt.length-1;W<=Q;W++){var $t=B,Bt="v-line",kt=gt.createElementNS(e.svg,"tspan"),Ce=bt[W],Wt;if(Ce)if(R){var Dt=u.annotateString(Ce,R,{offset:-ne,includeAnnotationIndices:j});Wt=p(kt,Dt,{includeAnnotationIndices:j,eol:W!==Q&&A,lineHeight:z?null:B,baseSize:_t});var ie=Wt.lineHeight;ie&&z&&W!==0&&($t=ie),W===0&&(Y=Wt.maxFontSize*.8)}else A&&W!==Q&&(Ce+=A),kt.textContent=Ce;else{kt.textContent="-",Bt+=" v-empty-line";var Pt=kt.style;if(Pt.fillOpacity=0,Pt.strokeOpacity=0,R){Wt={},Dt=u.findAnnotationsAtIndex(R,ne);let Le=_t;for(let He=Dt.length;He>0;He--){const ce=Dt[He-1].attrs;if(!ce||!("font-size"in ce))continue;const Fi=parseFloat(ce["font-size"]);if(isFinite(Fi)){Le=Fi;break}}z&&(W>0?$t=Le*1.2:Y=Le*.8),kt.setAttribute("font-size",Le),Wt.maxFontSize=Le}}Wt&&St.push(Wt),W>0&&kt.setAttribute("dy",$t),(W>0||E)&&kt.setAttribute("x",F),kt.className.baseVal=Bt,Rt.appendChild(kt),ne+=Ce.length+1}if($)if(R)$t=x(M,St,_t,B);else if(M==="top")$t="0.8em";else{var mt;switch(Q>0?(mt=parseFloat(B)||1,mt*=Q,g.test(B)||(mt/=_t)):mt=0,M){case"middle":$t=.3-mt/2+"em";break;case"bottom":$t=-mt-.3+"em";break}}else M===0?$t="0em":M?$t=M:($t=0,this.attr("y")===null&&this.attr("y",Y||"0.8em"));return Rt.firstChild.setAttribute("dy",$t),this.append(Rt),this},d.removeAttr=function(m){const b=O[m],{ns:w,local:A}=u.qualifyAttr(b),E=this.node;return w?E.hasAttributeNS(w,A)&&E.removeAttributeNS(w,A):E.hasAttribute(b)&&E.removeAttribute(b),this},d.attr=function(m,b){if(u.isUndefined(m)){for(var w=this.node.attributes,A={},E=0;E<w.length;E++)A[w[E].name]=w[E].value;return A}if(u.isString(m)&&u.isUndefined(b))return this.node.getAttribute(O[m]);if(typeof m=="object")for(var M in m)m.hasOwnProperty(M)&&this.setAttribute(M,m[M]);else this.setAttribute(m,b);return this},d.normalizePath=function(){var m=this.tagName();return m==="PATH"&&this.attr("d",u.normalizePathData(this.attr("d"))),this},d.remove=function(){return this.node.parentNode&&this.node.parentNode.removeChild(this.node),this},d.empty=function(){for(;this.node.firstChild;)this.node.removeChild(this.node.firstChild);return this},d.setAttributes=function(m){for(var b in m)m.hasOwnProperty(b)&&this.setAttribute(b,m[b]);return this},d.append=function(m){u.isArray(m)||(m=[m]);for(var b=0,w=m.length;b<w;b++)this.node.appendChild(u.toNode(m[b]));return this},d.prepend=function(m){var b=this.node.firstChild;return b?u(b).before(m):this.append(m)},d.before=function(m){var b=this.node,w=b.parentNode;if(w){u.isArray(m)||(m=[m]);for(var A=0,E=m.length;A<E;A++)w.insertBefore(u.toNode(m[A]),b)}return this},d.appendTo=function(m){return u.toNode(m).appendChild(this.node),this},d.svg=function(){return this.node instanceof window.SVGSVGElement?this:u(this.node.ownerSVGElement)},d.tagName=function(){return this.node.tagName.toUpperCase()},d.defs=function(){var m=this.svg()||this,b=m.node.getElementsByTagName("defs")[0];return b?u(b):u("defs").appendTo(m)},d.clone=function(){var m=u(this.node.cloneNode(!0));return m.node.id=u.uniqueId(),m},d.findOne=function(m){var b=this.node.querySelector(m);return b?u(b):void 0},d.find=function(m){var b=[],w=this.node.querySelectorAll(m);if(w)for(var A=0;A<w.length;A++)b.push(u(w[A]));return b},d.children=function(){for(var m=this.node.childNodes,b=[],w=0;w<m.length;w++){var A=m[w];A.nodeType===1&&b.push(u(m[w]))}return b},d.parent=function(){return u(this.node.parentNode)||null},d.index=function(){for(var m=0,b=this.node.previousSibling;b;)b.nodeType===1&&m++,b=b.previousSibling;return m},d.findParentByClass=function(m,b){for(var w=this.node.ownerSVGElement,A=this.node.parentNode;A&&A!==b&&A!==w;){var E=u(A);if(E.hasClass(m))return E;A=A.parentNode}return null},d.contains=function(m){var b=this.node,w=u.toNode(m),A=w&&w.parentNode;return b===A||!!(A&&A.nodeType===1&&b.compareDocumentPosition(A)&16)},d.toLocalPoint=function(m,b){var w=this.svg().node,A=w.createSVGPoint();A.x=m,A.y=b;try{var E=A.matrixTransform(w.getScreenCTM().inverse()),M=this.getTransformToElement(w).inverse()}catch{return A}return E.matrixTransform(M)},d.translateCenterToPoint=function(m){var b=this.getBBox({target:this.svg()}),w=b.center();return this.translate(m.x-w.x,m.y-w.y),this},d.translateAndAutoOrient=function(m,b,w){m=new L(m),b=new L(b),w||(w=this.svg());var A=this.scale();this.attr("transform","");var E=this.getBBox({target:w}).scale(A.sx,A.sy),M=u.createSVGTransform();M.setTranslate(-E.x-E.width/2,-E.y-E.height/2);var $=u.createSVGTransform(),F=m.angleBetween(b,m.clone().offset(1,0));F&&$.setRotate(F,0,0);var j=u.createSVGTransform(),R=m.clone().move(b,E.width/2);j.setTranslate(2*m.x-R.x,2*m.y-R.y);var H=this.getTransformToElement(w),z=u.createSVGTransform();return z.setMatrix(j.matrix.multiply($.matrix.multiply(M.matrix.multiply(H.scale(A.sx,A.sy))))),this.attr("transform",u.matrixToTransformString(z.matrix)),this},d.animateAlongPath=function(m,b){b=u.toNode(b);var w=u.ensureId(b),A=u("animateMotion",m),E=u("mpath",{"xlink:href":"#"+w});A.append(E),this.append(A);try{A.node.beginElement()}catch{if(document.documentElement.getAttribute("smiling")==="fake"){var M=A.node;M.animators=[];var $=M.getAttribute("id");$&&(id2anim[$]=M);for(var F=getTargets(M),j=0,R=F.length;j<R;j++){var H=F[j],z=new Animator(M,H,j);animators.push(z),M.animators[j]=z,z.register()}}}return this};const S=/[^\x20\t\r\n\f]+/g;function C(m){return u.isString(m)?m.trim().match(S)||[]:[]}d.hasClass=function(m){return u.isString(m)?this.node.classList.contains(m.trim()):!1},d.addClass=function(m){return this.node.classList.add(...C(m)),this},d.removeClass=function(m){return this.node.classList.remove(...C(m)),this},d.toggleClass=function(m,b){const w=C(m);for(let A=0;A<w.length;A++)this.node.classList.toggle(w[A],b);return this},d.sample=function(m){m=m||1;for(var b=this.node,w=b.getTotalLength(),A=[],E=0,M;E<w;)M=b.getPointAtLength(E),A.push({x:M.x,y:M.y,distance:E}),E+=m;return A},d.convertToPath=function(){var m=u("path");m.attr(this.attr());var b=this.convertToPathData();return b&&m.attr("d",b),m},d.convertToPathData=function(){var m=this.tagName();switch(m){case"PATH":return this.attr("d");case"LINE":return u.convertLineToPathData(this.node);case"POLYGON":return u.convertPolygonToPathData(this.node);case"POLYLINE":return u.convertPolylineToPathData(this.node);case"ELLIPSE":return u.convertEllipseToPathData(this.node);case"CIRCLE":return u.convertCircleToPathData(this.node);case"RECT":return u.convertRectToPathData(this.node)}throw new Error(m+" cannot be converted to PATH.")},u.prototype.toGeometryShape=function(){var m,b,w,A,E,M,$,F,j,R,H,z,B,_t,gt;switch(this.tagName()){case"RECT":return m=parseFloat(this.attr("x"))||0,b=parseFloat(this.attr("y"))||0,w=parseFloat(this.attr("width"))||0,A=parseFloat(this.attr("height"))||0,new J(m,b,w,A);case"CIRCLE":return E=parseFloat(this.attr("cx"))||0,M=parseFloat(this.attr("cy"))||0,$=parseFloat(this.attr("r"))||0,new Ln({x:E,y:M},$,$);case"ELLIPSE":return E=parseFloat(this.attr("cx"))||0,M=parseFloat(this.attr("cy"))||0,F=parseFloat(this.attr("rx"))||0,j=parseFloat(this.attr("ry"))||0,new Ln({x:E,y:M},F,j);case"POLYLINE":return R=u.getPointsFromSvgNode(this),new Ae(R);case"POLYGON":return R=u.getPointsFromSvgNode(this),R.length>1&&R.push(R[0]),new Ae(R);case"PATH":return H=this.attr("d"),K.isDataSupported(H)||(H=u.normalizePathData(H)),new K(H);case"LINE":return z=parseFloat(this.attr("x1"))||0,_t=parseFloat(this.attr("y1"))||0,B=parseFloat(this.attr("x2"))||0,gt=parseFloat(this.attr("y2"))||0,new pt({x:z,y:_t},{x:B,y:gt})}return this.getBBox()},d.findIntersection=function(m,b){var w=this.svg().node;b=b||w;var A=this.getBBox({target:b}),E=A.center();if(A.intersectionWithLineFromCenterToPoint(m)){var M,$=this.tagName();if($==="RECT"){var F=new J(parseFloat(this.attr("x")||0),parseFloat(this.attr("y")||0),parseFloat(this.attr("width")),parseFloat(this.attr("height"))),j=this.getTransformToElement(b),R=u.decomposeMatrix(j),H=w.createSVGTransform();H.setRotate(-R.rotation,E.x,E.y);var z=u.transformRect(F,H.matrix.multiply(j));M=new J(z).intersectionWithLineFromCenterToPoint(m,R.rotation)}else if($==="PATH"||$==="POLYGON"||$==="POLYLINE"||$==="CIRCLE"||$==="ELLIPSE"){var B=$==="PATH"?this:this.convertToPath(),_t=B.sample(),gt=1/0,Rt=[],ne,bt,St,Y,W,Q;for(ne=0;ne<_t.length;ne++)bt=_t[ne],St=u.createSVGPoint(bt.x,bt.y),St=St.matrixTransform(this.getTransformToElement(b)),bt=new L(St),Y=bt.distance(E),W=bt.distance(m)*1.1,Q=Y+W,Q<gt?(gt=Q,Rt=[{sample:bt,refDistance:W}]):Q<gt+1&&Rt.push({sample:bt,refDistance:W});Rt.sort(function($t,Bt){return $t.refDistance-Bt.refDistance}),Rt[0]&&(M=Rt[0].sample)}return M}},d.setAttribute=function(m,b){const w=this.node;if(b===null)return this.removeAttr(m),this;const A=O[m],{ns:E}=u.qualifyAttr(A);return E?w.setAttributeNS(E,A,b):A==="id"?w.id=b:w.setAttribute(A,b),this},u.createSvgDocument=function(m){if(m){const w=`<svg xmlns="${e.svg}" xmlns:xlink="${e.xlink}" version="${n}">${m}</svg>`,{documentElement:A}=u.parseXML(w,{async:!1});return A}const b=document.createElementNS(e.svg,"svg");return b.setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),b.setAttribute("version",n),b},u.createSVGStyle=function(m){const{node:b}=u("style",{type:"text/css"},[u.createCDATASection(m)]);return b},u.createCDATASection=function(m=""){return document.implementation.createDocument(null,"xml",null).createCDATASection(m)},u.idCounter=0,u.uniqueId=function(){return"v-"+ ++u.idCounter},u.toNode=function(m){return u.isV(m)?m.node:m.nodeName&&m||m[0]},u.ensureId=function(m){return m=u.toNode(m),m.id||(m.id=u.uniqueId())},u.sanitizeText=function(m){return(m||"").replace(/ /g," ")},u.isUndefined=function(m){return typeof m>"u"},u.isString=function(m){return typeof m=="string"},u.isObject=function(m){return m&&typeof m=="object"},u.isArray=Array.isArray,u.parseXML=function(m,b){b=b||{};var w;try{var A=new DOMParser;u.isUndefined(b.async)||(A.async=b.async),w=A.parseFromString(m,"text/xml")}catch{w=void 0}if(!w||w.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+m);return w};const P=Object.create(null);["baseFrequency","baseProfile","clipPathUnits","contentScriptType","contentStyleType","diffuseConstant","edgeMode","externalResourcesRequired","filterRes","filterUnits","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].forEach(m=>P[m]=m),P.xlinkShow="xlink:show",P.xlinkRole="xlink:role",P.xlinkActuate="xlink:actuate",P.xlinkHref="xlink:href",P.xlinkType="xlink:type",P.xlinkTitle="xlink:title",P.xmlBase="xml:base",P.xmlLang="xml:lang",P.xmlSpace="xml:space";const O=new Proxy(P,{get(m,b){return u.supportCamelCaseAttributes?b in m?m[b]:m[b]=b.replace(/[A-Z]/g,"-$&").toLowerCase():b}});Object.defineProperty(u,"attributeNames",{enumerable:!0,value:O,writable:!1}),Object.defineProperty(u,"supportCamelCaseAttributes",{enumerable:!0,value:!0,writable:!0}),u.qualifyAttr=function(m){if(m.indexOf(":")!==-1){var b=m.split(":");return{ns:e[b[0]],local:b[1]}}return{ns:null,local:m}},u.transformSeparatorRegex=/[ ,]+/,u.transformRegex=/\b\w+\([^()]+\)/g,u.transformFunctionRegex=/\b(\w+)\(([^()]+)\)/,u.transformTranslateRegex=/\btranslate\(([^()]+)\)/,u.transformRotateRegex=/\brotate\(([^()]+)\)/,u.transformScaleRegex=/\bscale\(([^()]+)\)/,u.transformStringToMatrix=function(m){let b=u.createSVGMatrix();const w=m&&m.match(u.transformRegex);if(!w)return b;const A=w.length;for(let E=0;E<A;E++){const $=w[E].match(u.transformFunctionRegex);if($){let F,j,R,H,z,B=u.createSVGMatrix();const _t=$[1].toLowerCase(),gt=$[2].split(u.transformSeparatorRegex);switch(_t){case"scale":F=parseFloat(gt[0]),j=gt[1]===void 0?F:parseFloat(gt[1]),B=B.scaleNonUniform(F,j);break;case"translate":R=parseFloat(gt[0]),H=parseFloat(gt[1]),B=B.translate(R,H);break;case"rotate":z=parseFloat(gt[0]),R=parseFloat(gt[1])||0,H=parseFloat(gt[2])||0,R!==0||H!==0?B=B.translate(R,H).rotate(z).translate(-R,-H):B=B.rotate(z);break;case"skewx":z=parseFloat(gt[0]),B=B.skewX(z);break;case"skewy":z=parseFloat(gt[0]),B=B.skewY(z);break;case"matrix":B.a=parseFloat(gt[0]),B.b=parseFloat(gt[1]),B.c=parseFloat(gt[2]),B.d=parseFloat(gt[3]),B.e=parseFloat(gt[4]),B.f=parseFloat(gt[5]);break;default:continue}b=b.multiply(B)}}return b},u.matrixToTransformString=function(m){return m||(m=!0),"matrix("+(m.a!==void 0?m.a:1)+","+(m.b!==void 0?m.b:0)+","+(m.c!==void 0?m.c:0)+","+(m.d!==void 0?m.d:1)+","+(m.e!==void 0?m.e:0)+","+(m.f!==void 0?m.f:0)+")"},u.parseTransformString=function(m){var b,w,A;if(m){var E=u.transformSeparatorRegex;if(m.trim().indexOf("matrix")>=0){var M=u.transformStringToMatrix(m),$=u.decomposeMatrix(M);b=[$.translateX,$.translateY],A=[$.scaleX,$.scaleY],w=[$.rotation];var F=[];(b[0]!==0||b[1]!==0)&&F.push("translate("+b+")"),(A[0]!==1||A[1]!==1)&&F.push("scale("+A+")"),w[0]!==0&&F.push("rotate("+w+")"),m=F.join(" ")}else{const R=m.match(u.transformTranslateRegex);R&&(b=R[1].split(E));const H=m.match(u.transformRotateRegex);H&&(w=H[1].split(E));const z=m.match(u.transformScaleRegex);z&&(A=z[1].split(E))}}var j=A&&A[0]?parseFloat(A[0]):1;return{value:m,translate:{tx:b&&b[0]?parseInt(b[0],10):0,ty:b&&b[1]?parseInt(b[1],10):0},rotate:{angle:w&&w[0]?parseInt(w[0],10):0,cx:w&&w[1]?parseInt(w[1],10):void 0,cy:w&&w[2]?parseInt(w[2],10):void 0},scale:{sx:j,sy:A&&A[1]?parseFloat(A[1]):j}}},u.deltaTransformPoint=function(m,b){var w=b.x*m.a+b.y*m.c+0,A=b.x*m.b+b.y*m.d+0;return{x:w,y:A}},u.decomposeMatrix=function(m){var b=u.deltaTransformPoint(m,{x:0,y:1}),w=u.deltaTransformPoint(m,{x:1,y:0}),A=180/r*s(b.y,b.x)-90,E=180/r*s(w.y,w.x);return{translateX:m.e,translateY:m.f,scaleX:o(m.a*m.a+m.b*m.b),scaleY:o(m.c*m.c+m.d*m.d),skewX:A,skewY:E,rotation:A}},u.matrixToScale=function(m){var b,w,A,E;return m?(b=u.isUndefined(m.a)?1:m.a,E=u.isUndefined(m.d)?1:m.d,w=m.b,A=m.c):b=E=1,{sx:w?o(b*b+w*w):b,sy:A?o(A*A+E*E):E}},u.matrixToRotate=function(m){var b={x:0,y:1};return m&&(b=u.deltaTransformPoint(m,b)),{angle:Qe(Yc(s(b.y,b.x))-90)}},u.matrixToTranslate=function(m){return{tx:m&&m.e||0,ty:m&&m.f||0}},u.isV=function(m){return m instanceof u},u.isVElement=u.isV,u.isSVGGraphicsElement=function(m){return m?(m=u.toNode(m),m instanceof SVGElement&&typeof m.getScreenCTM=="function"):!1};var N=u("svg").node;return u.createSVGMatrix=function(m){var b=N.createSVGMatrix();for(var w in m)b[w]=m[w];return b},u.createSVGTransform=function(m){return u.isUndefined(m)?N.createSVGTransform():(m instanceof SVGMatrix||(m=u.createSVGMatrix(m)),N.createSVGTransformFromMatrix(m))},u.createSVGPoint=function(m,b){var w=N.createSVGPoint();return w.x=m,w.y=b,w},u.transformRect=function(m,b){var w=N.createSVGPoint();w.x=m.x,w.y=m.y;var A=w.matrixTransform(b);w.x=m.x+m.width,w.y=m.y;var E=w.matrixTransform(b);w.x=m.x+m.width,w.y=m.y+m.height;var M=w.matrixTransform(b);w.x=m.x,w.y=m.y+m.height;var $=w.matrixTransform(b),F=a(A.x,E.x,M.x,$.x),j=l(A.x,E.x,M.x,$.x),R=a(A.y,E.y,M.y,$.y),H=l(A.y,E.y,M.y,$.y);return new J(F,R,j-F,H-R)},u.transformPoint=function(m,b){return new L(u.createSVGPoint(m.x,m.y).matrixTransform(b))},u.transformLine=function(m,b){return new pt(u.transformPoint(m.start,b),u.transformPoint(m.end,b))},u.transformPolyline=function(m,b){var w=m instanceof Ae?m.points:m;u.isArray(w)||(w=[]);for(var A=[],E=0,M=w.length;E<M;E++)A[E]=u.transformPoint(w[E],b);return new Ae(A)},u.styleToObject=function(m){for(var b={},w=m.split(";"),A=0;A<w.length;A++){var E=w[A],M=E.split("=");b[M[0].trim()]=M[1].trim()}return b},u.createSlicePathData=function(m,b,w,A){var E=2*r-1e-6,M=m,$=b,F=w,j=A,R=(j<F&&(R=F,F=j,j=R),j-F),H=R<r?"0":"1",z=c(F),B=h(F),_t=c(j),gt=h(j);return R>=E?M?"M0,"+$+"A"+$+","+$+" 0 1,1 0,"+-$+"A"+$+","+$+" 0 1,1 0,"+$+"M0,"+M+"A"+M+","+M+" 0 1,0 0,"+-M+"A"+M+","+M+" 0 1,0 0,"+M+"Z":"M0,"+$+"A"+$+","+$+" 0 1,1 0,"+-$+"A"+$+","+$+" 0 1,1 0,"+$+"Z":M?"M"+$*z+","+$*B+"A"+$+","+$+" 0 "+H+",1 "+$*_t+","+$*gt+"L"+M*_t+","+M*gt+"A"+M+","+M+" 0 "+H+",0 "+M*z+","+M*B+"Z":"M"+$*z+","+$*B+"A"+$+","+$+" 0 "+H+",1 "+$*_t+","+$*gt+"L0,0Z"},u.mergeAttrs=function(m,b){for(var w in b)w==="class"?m[w]=m[w]?m[w]+" "+b[w]:b[w]:w==="style"?u.isObject(m[w])&&u.isObject(b[w])?m[w]=u.mergeAttrs(m[w],b[w]):u.isObject(m[w])?m[w]=u.mergeAttrs(m[w],u.styleToObject(b[w])):u.isObject(b[w])?m[w]=u.mergeAttrs(u.styleToObject(m[w]),b[w]):m[w]=u.mergeAttrs(u.styleToObject(m[w]),u.styleToObject(b[w])):m[w]=b[w];return m},u.annotateString=function(m,b,w){b=b||[],w=w||{};for(var A=w.offset||0,E=[],M,$=[],F,j,R=0;R<m.length;R++){F=$[R]=m[R];for(var H=0;H<b.length;H++){var z=b[H],B=z.start+A,_t=z.end+A;R>=B&&R<_t&&(u.isObject(F)?F.attrs=u.mergeAttrs(u.mergeAttrs({},F.attrs),z.attrs):F=$[R]={t:m[R],attrs:z.attrs},w.includeAnnotationIndices&&(F.annotations||(F.annotations=[])).push(H))}j=$[R-1],j?u.isObject(F)&&u.isObject(j)?JSON.stringify(F.attrs)===JSON.stringify(j.attrs)?M.t+=F.t:(E.push(M),M=F):u.isObject(F)||u.isObject(j)?(E.push(M),M=F):M=(M||"")+F:M=F}return M&&E.push(M),E},u.findAnnotationsAtIndex=function(m,b){var w=[];return m&&m.forEach(function(A){A.start<b&&b<=A.end&&w.push(A)}),w},u.findAnnotationsBetweenIndexes=function(m,b,w){var A=[];return m&&m.forEach(function(E){(b>=E.start&&b<E.end||w>E.start&&w<=E.end||E.start>=b&&E.end<w)&&A.push(E)}),A},u.shiftAnnotations=function(m,b,w){return m&&m.forEach(function(A){A.start<b&&A.end>=b?A.end+=w:A.start>=b&&(A.start+=w,A.end+=w)}),m},u.convertLineToPathData=function(m){m=u(m);var b=["M",m.attr("x1"),m.attr("y1"),"L",m.attr("x2"),m.attr("y2")].join(" ");return b},u.convertPolygonToPathData=function(m){var b=u.getPointsFromSvgNode(m);return b.length===0?null:u.svgPointsToPath(b)+" Z"},u.convertPolylineToPathData=function(m){var b=u.getPointsFromSvgNode(m);return b.length===0?null:u.svgPointsToPath(b)},u.svgPointsToPath=function(m){for(var b=0,w=m.length;b<w;b++)m[b]=m[b].x+" "+m[b].y;return"M "+m.join(" L")},u.getPointsFromSvgNode=function(m){m=u.toNode(m);var b=[],w=m.points;if(w)for(var A=0,E=w.numberOfItems;A<E;A++)b.push(w.getItem(A));return b},u.KAPPA=.551784,u.convertCircleToPathData=function(m){m=u(m);var b=parseFloat(m.attr("cx"))||0,w=parseFloat(m.attr("cy"))||0,A=parseFloat(m.attr("r")),E=A*u.KAPPA,M=["M",b,w-A,"C",b+E,w-A,b+A,w-E,b+A,w,"C",b+A,w+E,b+E,w+A,b,w+A,"C",b-E,w+A,b-A,w+E,b-A,w,"C",b-A,w-E,b-E,w-A,b,w-A,"Z"].join(" ");return M},u.convertEllipseToPathData=function(m){m=u(m);var b=parseFloat(m.attr("cx"))||0,w=parseFloat(m.attr("cy"))||0,A=parseFloat(m.attr("rx")),E=parseFloat(m.attr("ry"))||A,M=A*u.KAPPA,$=E*u.KAPPA,F=["M",b,w-E,"C",b+M,w-E,b+A,w-$,b+A,w,"C",b+A,w+$,b+M,w+E,b,w+E,"C",b-M,w+E,b-A,w+$,b-A,w,"C",b-A,w-$,b-M,w-E,b,w-E,"Z"].join(" ");return F},u.convertRectToPathData=function(m){return m=u(m),u.rectToPath({x:parseFloat(m.attr("x"))||0,y:parseFloat(m.attr("y"))||0,width:parseFloat(m.attr("width"))||0,height:parseFloat(m.attr("height"))||0,rx:parseFloat(m.attr("rx"))||0,ry:parseFloat(m.attr("ry"))||0})},u.rectToPath=function(m){var b,w=m.x,A=m.y,E=m.width,M=m.height,$=a(m.rx||m["top-rx"]||0,E/2),F=a(m.rx||m["bottom-rx"]||0,E/2),j=a(m.ry||m["top-ry"]||0,M/2),R=a(m.ry||m["bottom-ry"]||0,M/2);return $||F||j||R?b=["M",w,A+j,"v",M-j-R,"a",F,R,0,0,0,F,R,"h",E-2*F,"a",F,R,0,0,0,F,-R,"v",-(M-R-j),"a",$,j,0,0,0,-$,-j,"h",-(E-2*$),"a",$,j,0,0,0,-$,j,"Z"]:b=["M",w,A,"H",w+E,"V",A+M,"H",w,"V",A,"Z"],b.join(" ")},u.normalizePathData=function(){var m=`	
\v\f\r   ᠎             　\u2028\u2029`,b=new RegExp("([a-z])["+m+",]*((-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?["+m+"]*,?["+m+"]*)+)","ig"),w=new RegExp("(-?\\d*\\.?\\d*(?:e[\\-+]?\\d+)?)["+m+"]*,?["+m+"]*","ig"),A=Math,E=A.PI,M=A.sin,$=A.cos,F=A.tan,j=A.asin,R=A.sqrt,H=A.abs;function z(bt,St,Y,W,Q,$t){var Bt=.3333333333333333,kt=2/3;return[Bt*bt+kt*Y,Bt*St+kt*W,Bt*Q+kt*Y,Bt*$t+kt*W,Q,$t]}function B(bt,St,Y){var W=bt*$(Y)-St*M(Y),Q=bt*M(Y)+St*$(Y);return{x:W,y:Q}}function _t(bt,St,Y,W,Q,$t,Bt,kt,Ce,Wt){var Dt=E*120/180,ie=E/180*(+Q||0),Pt=[],mt;if(Wt)cn=Wt[0],ze=Wt[1],$r=Wt[2],gr=Wt[3];else{mt=B(bt,St,-ie),bt=mt.x,St=mt.y,mt=B(kt,Ce,-ie),kt=mt.x,Ce=mt.y;var Le=(bt-kt)/2,He=(St-Ce)/2,ce=Le*Le/(Y*Y)+He*He/(W*W);ce>1&&(ce=R(ce),Y=ce*Y,W=ce*W);var Fi=Y*Y,As=W*W,Ja=($t==Bt?-1:1)*R(H((Fi*As-Fi*He*He-As*Le*Le)/(Fi*He*He+As*Le*Le))),$r=Ja*Y*He/W+(bt+kt)/2,gr=Ja*-W*Le/Y+(St+Ce)/2,cn=j(((St-gr)/W).toFixed(9)),ze=j(((Ce-gr)/W).toFixed(9));cn=bt<$r?E-cn:cn,ze=kt<$r?E-ze:ze,cn<0&&(cn=E*2+cn),ze<0&&(ze=E*2+ze),Bt&&cn>ze&&(cn=cn-E*2),!Bt&&ze>cn&&(ze=ze-E*2)}var Do=ze-cn;if(H(Do)>Dt){var Au=ze,Qa=kt,tl=Ce;ze=cn+Dt*(Bt&&ze>cn?1:-1),kt=$r+Y*$(ze),Ce=gr+W*M(ze),Pt=_t(kt,Ce,Y,W,Q,0,Bt,Qa,tl,[ze,Au,$r,gr])}Do=ze-cn;var el=$(cn),nl=M(cn),No=$(ze),Cu=M(ze),il=F(Do/4),Ro=4/3*(Y*il),rl=4/3*(W*il),sl=[bt,St],en=[bt+Ro*nl,St-rl*el],$o=[kt+Ro*Cu,Ce-rl*No],Bo=[kt,Ce];if(en[0]=2*sl[0]-en[0],en[1]=2*sl[1]-en[1],Wt)return[en,$o,Bo].concat(Pt);Pt=[en,$o,Bo].concat(Pt).join().split(",");for(var Fo=[],Pu=Pt.length,Si=0;Si<Pu;Si++)Fo[Si]=Si%2?B(Pt[Si-1],Pt[Si],ie).y:B(Pt[Si],Pt[Si+1],ie).x;return Fo}function gt(bt){if(!bt)return null;var St={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},Y=[];return String(bt).replace(b,function(W,Q,$t){var Bt=[],kt=Q.toLowerCase();for($t.replace(w,function(Ce,Wt){Wt&&Bt.push(+Wt)}),kt==="m"&&Bt.length>2&&(Y.push([Q].concat(Bt.splice(0,2))),kt="l",Q=Q==="m"?"l":"L");Bt.length>=St[kt]&&(Y.push([Q].concat(Bt.splice(0,St[kt]))),!!St[kt]););}),Y}function Rt(bt){if((!Array.isArray(bt)||!Array.isArray(bt&&bt[0]))&&(bt=gt(bt)),!bt||!bt.length)return[["M",0,0]];for(var St=[],Y=0,W=0,Q=0,$t=0,Bt=0,kt,Ce=bt.length,Wt=Bt;Wt<Ce;Wt++){var Dt=[];St.push(Dt);var ie=bt[Wt];if(kt=ie[0],kt!=kt.toUpperCase()){Dt[0]=kt.toUpperCase();var Pt,mt;switch(Dt[0]){case"A":Dt[1]=ie[1],Dt[2]=ie[2],Dt[3]=ie[3],Dt[4]=ie[4],Dt[5]=ie[5],Dt[6]=+ie[6]+Y,Dt[7]=+ie[7]+W;break;case"V":Dt[1]=+ie[1]+W;break;case"H":Dt[1]=+ie[1]+Y;break;case"M":for(Q=+ie[1]+Y,$t=+ie[2]+W,Pt=ie.length,mt=1;mt<Pt;mt++)Dt[mt]=+ie[mt]+(mt%2?Y:W);break;default:for(Pt=ie.length,mt=1;mt<Pt;mt++)Dt[mt]=+ie[mt]+(mt%2?Y:W);break}}else for(var Le=ie.length,He=0;He<Le;He++)Dt[He]=ie[He];switch(Dt[0]){case"Z":Y=+Q,W=+$t;break;case"H":Y=Dt[1];break;case"V":W=Dt[1];break;case"M":Q=Dt[Dt.length-2],$t=Dt[Dt.length-1],Y=Dt[Dt.length-2],W=Dt[Dt.length-1];break;default:Y=Dt[Dt.length-2],W=Dt[Dt.length-1];break}}return St}function ne(bt){var St=Rt(bt),Y={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};function W(Pt,mt,Le){var He,ce;if(!Pt)return["C",mt.x,mt.y,mt.x,mt.y,mt.x,mt.y];switch(Pt[0]in{T:1,Q:1}||(mt.qx=null,mt.qy=null),Pt[0]){case"M":mt.X=Pt[1],mt.Y=Pt[2];break;case"A":parseFloat(Pt[1])===0||parseFloat(Pt[2])===0?Pt=["L",Pt[6],Pt[7]]:Pt=["C"].concat(_t.apply(0,[mt.x,mt.y].concat(Pt.slice(1))));break;case"S":Le==="C"||Le==="S"?(He=mt.x*2-mt.bx,ce=mt.y*2-mt.by):(He=mt.x,ce=mt.y),Pt=["C",He,ce].concat(Pt.slice(1));break;case"T":Le==="Q"||Le==="T"?(mt.qx=mt.x*2-mt.qx,mt.qy=mt.y*2-mt.qy):(mt.qx=mt.x,mt.qy=mt.y),Pt=["C"].concat(z(mt.x,mt.y,mt.qx,mt.qy,Pt[1],Pt[2]));break;case"Q":mt.qx=Pt[1],mt.qy=Pt[2],Pt=["C"].concat(z(mt.x,mt.y,Pt[1],Pt[2],Pt[3],Pt[4]));break;case"H":Pt=["L"].concat(Pt[1],mt.y);break;case"V":Pt=["L"].concat(mt.x,Pt[1]);break}return Pt}function Q(Pt,mt){if(Pt[mt].length>7){Pt[mt].shift();for(var Le=Pt[mt];Le.length;)$t[mt]="A",Pt.splice(mt++,0,["C"].concat(Le.splice(0,6)));Pt.splice(mt,1),Ce=St.length}}for(var $t=[],Bt="",kt="",Ce=St.length,Wt=0;Wt<Ce;Wt++){St[Wt]&&(Bt=St[Wt][0]),Bt!=="C"&&($t[Wt]=Bt,Wt>0&&(kt=$t[Wt-1])),St[Wt]=W(St[Wt],Y,kt),$t[Wt]!=="A"&&Bt==="C"&&($t[Wt]="C"),Q(St,Wt);var Dt=St[Wt],ie=Dt.length;Y.x=Dt[ie-2],Y.y=Dt[ie-1],Y.bx=parseFloat(Dt[ie-4])||Y.x,Y.by=parseFloat(Dt[ie-3])||Y.y}return(!St[0][0]||St[0][0]!=="M")&&St.unshift(["M",0,0]),St}return function(bt){return ne(bt).join(",").split(",").join(" ")}}(),u.namespace=e,u.g=BD,u}(),k=FD,ma="[object Arguments]",zh="[object Array]",Jc="[object Boolean]",Sf="[object Date]",Kb="[object Error]",VD="[object Function]",Ba="[object Map]",Qc="[object Number]",zD="[object Null]",zs="[object Object]",Ef="[object RegExp]",Fa="[object Set]",tu="[object String]",eu="[object Symbol]",UD="[object Undefined]",HD="[object WeakMap]",Tf="[object ArrayBuffer]",Af="[object DataView]",Zb="[object Float32Array]",Jb="[object Float64Array]",Qb="[object Int8Array]",t0="[object Int16Array]",e0="[object Int32Array]",n0="[object Uint8Array]",i0="[object Uint8ClampedArray]",r0="[object Uint16Array]",s0="[object Uint32Array]",GD={[ma]:!0,[zh]:!0,[Tf]:!0,[Af]:!0,[Jc]:!0,[Sf]:!0,[Zb]:!0,[Jb]:!0,[Qb]:!0,[t0]:!0,[e0]:!0,[Ba]:!0,[Qc]:!0,[zs]:!0,[Ef]:!0,[Fa]:!0,[tu]:!0,[eu]:!0,[n0]:!0,[i0]:!0,[r0]:!0,[s0]:!0,[Kb]:!1,[VD]:!1,[HD]:!1},Cf="\\ud800-\\udfff",jD="\\u0300-\\u036f",WD="\\ufe20-\\ufe2f",YD="\\u20d0-\\u20ff",XD="\\u1ab0-\\u1aff",qD="\\u1dc0-\\u1dff",KD=jD+WD+YD+XD+qD,o0="\\u2700-\\u27bf",a0="a-z\\xdf-\\xf6\\xf8-\\xff",ZD="\\xac\\xb1\\xd7\\xf7",JD="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",QD="\\u2000-\\u206f",tN=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",l0="A-Z\\xc0-\\xd6\\xd8-\\xde",eN="\\ufe0e\\ufe0f",c0=ZD+JD+QD+tN,u0="['’]",Mg=`[${c0}]`,Pf=`[${KD}]`,h0="\\d",nN=`[${o0}]`,d0=`[${a0}]`,f0=`[^${Cf}${c0+h0+o0+a0+l0}]`,Uh="\\ud83c[\\udffb-\\udfff]",iN=`(?:${Pf}|${Uh})`,p0=`[^${Cf}]`,If="(?:\\ud83c[\\udde6-\\uddff]){2}",Of="[\\ud800-\\udbff][\\udc00-\\udfff]",$s=`[${l0}]`,rN="\\u200d",Dg=`(?:${d0}|${f0})`,sN=`(?:${$s}|${f0})`,Ng=`(?:${u0}(?:d|ll|m|re|s|t|ve))?`,Rg=`(?:${u0}(?:D|LL|M|RE|S|T|VE))?`,g0=`${iN}?`,m0=`[${eN}]?`,oN=`(?:${rN}(?:${[p0,If,Of].join("|")})${m0+g0})*`,aN="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",lN="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",v0=m0+g0+oN,cN=`(?:${[nN,If,Of].join("|")})${v0}`,uN=RegExp([`${$s}?${d0}+${Ng}(?=${[Mg,$s,"$"].join("|")})`,`${sN}+${Rg}(?=${[Mg,$s+Dg,"$"].join("|")})`,`${$s}?${Dg}+${Ng}`,`${$s}+${Rg}`,lN,aN,`${h0}+`,cN].join("|"),"g"),kf=200,Hh="__hash_undefined__",hN=/^\[object (?:Float(?:32|64)|(?:Int|Uint)(?:8|16|32)|Uint8Clamped)Array\]$/,dN=`[${Cf}]`,fN=`${p0}${Pf}?`,pN=`(?:${[fN,Pf,If,Of,dN].join("|")})`,y0=RegExp(`${Uh}(?=${Uh})|${pN+v0}`,"g"),gN=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mN=/^\w*$/,vN=".".charCodeAt(0),yN=/\\(\\)?/g,bN=RegExp(`[^.[\\]]+|\\[(?:([^"'][^[]*)|(["'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))`,"g"),xN=/^(?:0|[1-9]\d*)$/,wN=RegExp.prototype.test.bind(/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/),_N=4294967295-1,SN=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,b0=t=>y0.test(t),EN=t=>t.match(y0)||[],TN=t=>t.split(""),x0=t=>b0(t)?EN(t):TN(t),AN=t=>t==null?[]:Va(t).map(e=>t[e]),Va=t=>Zn(t)?w0(t):Object.keys(Object(t)),CN=t=>{if(!nu(t))return Object.keys(t);var e=[];for(var n in Object(t))hasOwnProperty.call(t,n)&&n!="constructor"&&e.push(n);return e},w0=(t,e)=>{const n=Array.isArray(t),i=!n&&oi(t)&&ai(t)===ma,r=!n&&!i&&Ua(t),s=n||i||r,o=t.length,a=new Array(s?o:0);let l=s?-1:o;for(;++l<o;)a[l]=`${l}`;for(const c in t)(e||hasOwnProperty.call(t,c))&&!(s&&(c==="length"||Rf(c,o)))&&a.push(c);return a},yl=(t,e)=>{let{length:n}=t;for(;n--;)if(Co(t[n][0],e))return n;return-1},Co=(t,e)=>t===e||t!==t&&e!==e,oi=t=>t!=null&&typeof t=="object",lc=(t,e,n)=>{if(!Nt(n))return!1;const i=typeof e;return(i=="number"?Zn(n)&&e>-1&&e<n.length:i=="string"&&e in n)?Co(n[e],t):!1},PN=t=>oi(t)&&ai(t)==Fa,IN=t=>oi(t)&&ai(t)==Ba,nu=t=>{const e=t&&t.constructor,n=typeof e=="function"&&e.prototype||Object.prototype;return t===n},ms=(t,e,n)=>{const i=t[e];(!(hasOwnProperty.call(t,e)&&Co(i,n))||n===void 0&&!(e in t))&&(t[e]=n)},za=(t,e,n)=>{let i=-1;const r=e.length;for(;++i<r;){const s=e[i];ms(n,s,t[s])}return n},Zn=t=>t!=null&&typeof t!="function"&&typeof t.length=="number"&&t.length>-1&&t.length%1===0,eo=t=>typeof t=="symbol"||oi(t)&&ai(t)===eu,ON=t=>{const e=t.length;let n=new t.constructor(e);return e&&typeof t[0]=="string"&&hasOwnProperty.call(t,"index")&&(n.index=t.index,n.input=t.input),n},Lf=(t,e)=>{let n=-1;const i=t.length;for(e||(e=new Array(i));++n<i;)e[n]=t[n];return e},ai=t=>t==null?t===void 0?UD:zD:Object.prototype.toString.call(t),Mf=t=>{const e=new t.constructor(t.byteLength);return new Uint8Array(e).set(new Uint8Array(t)),e},_0=(t,e)=>{const n=e?Mf(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)},kN=t=>{const e=new t.constructor(t.source,/\w*$/.exec(t));return e.lastIndex=t.lastIndex,e},S0=t=>typeof t.constructor=="function"&&!nu(t)?Object.create(Object.getPrototypeOf(t)):{},Df=t=>t==null?[]:(t=Object(t),Object.getOwnPropertySymbols(t).filter(n=>propertyIsEnumerable.call(t,n))),LN=(t,e)=>za(t,Df(t),e);function MN(t,e){const n=e?Mf(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}const DN=(t,e,n)=>{const i=t.constructor;switch(e){case Tf:return Mf(t);case Jc:case Sf:return new i(+t);case Af:return MN(t,n);case Zb:case Jb:case Qb:case t0:case e0:case n0:case i0:case r0:case s0:return _0(t,n);case Ba:return new i(t);case Qc:case tu:return new i(t);case Ef:return kN(t);case Fa:return new i;case eu:return Symbol.prototype.valueOf?Object(Symbol.prototype.valueOf.call(t)):{}}},Ua=t=>oi(t)&&hN.test(ai(t)),Gh=t=>{const e=Object.keys(t);return!Array.isArray(t)&&t!=null&&e.push(...Df(Object(t))),e},E0=t=>{const e=[];for(;t;)e.push(...Df(t)),t=Object.getPrototypeOf(Object(t));return e},T0=t=>{const e=[];for(const n in t)e.push(n);return Array.isArray(t)||e.push(...E0(t)),e},bl=({__data__:t},e)=>{const n=t;return YN(e)?n[typeof e=="string"?"string":"hash"]:n.map},NN=(t,e,n,i)=>{const r=Gh(t),s=r.length,a=Gh(e).length;if(s!=a)return!1;let l,c=s;for(;c--;)if(l=r[c],!hasOwnProperty.call(e,l))return!1;const h=i.get(t),u=i.get(e);if(h&&u)return h==e&&u==t;let d=!0;i.set(t,e),i.set(e,t);let f;for(;++c<s;){l=r[c];const p=t[l],g=e[l];if(!(p===g||n(p,g,i))){d=!1;break}f||(f=l=="constructor")}if(d&&!f){const p=t.constructor,g=e.constructor;p!=g&&"constructor"in t&&"constructor"in e&&!(typeof p=="function"&&p instanceof p&&typeof g=="function"&&g instanceof g)&&(d=!1)}return i.delete(t),i.delete(e),d},iu=(t,e,n)=>t===e?!0:t==null||e==null||!oi(t)&&!oi(e)?t!==t&&e!==e:RN(t,e,iu,n),RN=(t,e,n,i)=>{let r=Array.isArray(t);const s=Array.isArray(e);let o=r?zh:ai(t),a=s?zh:ai(e);o=o==ma?zs:o,a=a==ma?zs:a;let l=o==zs;const c=a==zs,h=o==a;if(h&&!l)return i||(i=new Ys),r||Ua(t)?A0(t,e,!1,n,i):FN(t,e,o,n,i);const u=l&&hasOwnProperty.call(t,"__wrapped__"),d=c&&hasOwnProperty.call(e,"__wrapped__");if(u||d){const f=u?t.value():t,p=d?e.value():e;return i||(i=new Ys),n(f,p,i)}return h?(i||(i=new Ys),NN(t,e,n,i)):!1},A0=(t,e,n,i,r)=>{const o=t.length,a=e.length;if(o!=a)return!1;const l=r.get(t),c=r.get(e);if(l&&c)return l==e&&c==t;let h=-1,u=!0;const d=n?new no:void 0;for(r.set(t,e),r.set(e,t);++h<o;){const f=t[h],p=e[h];if(d){if(!$N(e,(g,v)=>{if(!BN(d,v)&&(f===g||i(f,g,r)))return d.push(v)})){u=!1;break}}else if(!(f===p||i(f,p,r))){u=!1;break}}return r.delete(t),r.delete(e),u},$N=(t,e)=>{let n=-1;const i=t==null?0:t.length;for(;++n<i;)if(e(t[n],n,t))return!0;return!1},BN=(t,e)=>t.has(e),$g=(t,e,n,i)=>!(t.byteLength!=e.byteLength||!n(new Uint8Array(t),new Uint8Array(e),i)),FN=(t,e,n,i,r)=>{switch(n){case Af:return t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset?!1:(t=t.buffer,e=e.buffer,$g(t,e,i,r));case Tf:return $g(t,e,i,r);case Jc:case Sf:case Qc:return Co(+t,+e);case Kb:return t.name==e.name&&t.message==e.message;case Ef:case tu:return t==`${e}`;case Ba:let s=C0;case Fa:if(s||(s=ru),t.size!=e.size)return!1;const o=r.get(t);if(o)return o==e;r.set(t,e);const a=A0(s(t),s(e),!0,i,r);return r.delete(t),a;case eu:return Symbol.prototype.valueOf.call(t)==Symbol.prototype.valueOf.call(e)}return!1},C0=t=>{let e=-1,n=Array(t.size);return t.forEach((i,r)=>{n[++e]=[r,i]}),n},ru=t=>{let e=-1;const n=new Array(t.size);return t.forEach(i=>{n[++e]=i}),n},Nf=(t,e)=>{if(Array.isArray(t))return!1;const n=typeof t;return n==="number"||n==="boolean"||t==null||eo(t)?!0:mN.test(t)||!gN.test(t)||e!=null&&t in Object(e)},VN=t=>{const e=[];return t.charCodeAt(0)===vN&&e.push(""),t.replace(bN,(n,i,r,s)=>{let o=n;r?o=s.replace(yN,"$1"):i&&(o=i.trim()),e.push(o)}),e},Dr=(t,e)=>Array.isArray(t)?t:Nf(t,e)?[t]:VN(`${t}`),Ha=(t,e)=>{e=Dr(e,t);let n=0;const i=e.length;for(;t!=null&&n<i;)t=t[hr(e[n])],n++;return n&&n==i?t:void 0};function zN(t,e){if(t!==e){const n=t!==void 0,i=t===null,r=t===t,s=eo(t),o=e!==void 0,a=e===null,l=e===e,c=eo(e);if(!a&&!c&&!s&&t>e||s&&o&&l&&!a&&!c||i&&o&&l||!n&&l||!r)return 1;if(!i&&!s&&!c&&t<e||c&&n&&r&&!i&&!s||a&&n&&r||!o&&r||!l)return-1}return 0}function UN(t,e,n){let i=-1;const r=t.criteria,s=e.criteria,o=r.length,a=n.length;for(;++i<o;){const l=i<a?n[i]:null,h=(l&&typeof l=="function"?l:zN)(r[i],s[i]);if(h)return l&&typeof l!="function"?h*(l=="desc"?-1:1):h}return t.index-e.index}const P0=(t,e)=>{let n=(o,a)=>!!(o==null?0:o.length)&&o.indexOf(a)>-1,i=!0;const r=[],s=e.length;if(!t.length)return r;e.length>=kf&&(n=(o,a)=>o.has(a),i=!1,e=new no(e));t:for(let o in t){let a=t[o];const l=a;if(a=a!==0?a:0,i&&l===l){let c=s;for(;c--;)if(e[c]===l)continue t;r.push(a)}else n(e,l)||r.push(a)}return r},HN=t=>{const e=(d,f)=>!!(d==null?0:d.length)&&d.indexOf(f)>-1,n=(d,f)=>d.has(f),i=t[0].length,r=t.length,s=new Array(r),o=[];let a,l=1/0,c=r;for(;c--;)a=t[c],l=Math.min(a.length,l),s[c]=i>=120&&a.length>=120?new no(c&&a):void 0;a=t[0];let h=-1;const u=s[0];t:for(;++h<i&&o.length<l;){let d=a[h];const f=d;if(d=d!==0?d:0,!(u?n(u,f):e(o,f))){for(c=r;--c;){const p=s[c];if(!(p?n(p,f):e(t[c],f)))continue t}u&&u.push(f),o.push(d)}}return o},hr=t=>{if(typeof t=="string"||eo(t))return t;const e=`${t}`;return e=="0"&&1/t==-1/0?"-0":e},es=(t,e=!1,n=!1,i=!0,r,s,o,a)=>{let l;if(r&&(l=o?r(t,s,o,a):r(t)),l!==void 0)return l;if(!Nt(t))return t;const c=Array.isArray(t),h=ai(t);if(c){if(l=ON(t),!e)return Lf(t,l)}else{const p=typeof t=="function";if(h===zs||h===ma||p&&!o){if(l=n||p?{}:S0(t),!e)return n?GN(t,za(t,Object.keys(t),l)):LN(t,Object.assign(l,t))}else{if(p||!GD[h])return o?t:{};l=DN(t,h,e)}}a||(a=new Ys);const u=a.get(t);if(u)return u;if(a.set(t,l),IN(t))return t.forEach((p,g)=>{l.set(g,es(p,e,n,i,r,g,t,a))}),l;if(PN(t))return t.forEach(p=>{l.add(es(p,e,n,i,r,p,t,a))}),l;if(Ua(t))return l;const f=c?void 0:(i?n?T0:Gh:n?O0:Va)(t);return(f||t).forEach((p,g)=>{f&&(g=p,p=t[g]),ms(l,g,es(p,e,n,i,r,g,t,a))}),l},GN=(t,e)=>za(t,E0(t),e),I0=(t,e)=>e.length<2?t:Ha(t,e.slice(0,-1)),jN=(t,e,n)=>{if(!Nt(t))return t;e=Dr(e,t);const i=e.length,r=i-1;let s=-1,o=t;for(;o!=null&&++s<i;){const a=hr(e[s]);let l=n;if(s!=r){const c=o[a];l=void 0,l===void 0&&(l=Nt(c)?c:Rf(e[s+1])?[]:{})}ms(o,a,l),o=o[a]}return t},Rf=(t,e)=>{const n=typeof t;return e=e??Number.MAX_SAFE_INTEGER,!!e&&(n==="number"||n!=="symbol"&&xN.test(t))&&t>-1&&t%1==0&&t<e},WN=(t,e)=>{e=Dr(e,t),t=I0(t,e);const n=e[e.length-1];return t==null||delete t[hr(n)]},YN=t=>{const e=typeof t;return e==="string"||e==="number"||e==="symbol"||e==="boolean"?t!=="__proto__":t===null},O0=t=>{const e=[];for(const n in t)e.push(n);return e},XN=t=>{t=Object(t);const e={};for(const n in t)e[n]=t[n];return e},Bg=(t,e)=>{if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]};function k0(t,e=!1){return(n,...i)=>{let r=-1,s=i.length,o=s>1?i[s-1]:void 0;const a=s>2?i[2]:void 0;for(o=t.length>3&&typeof o=="function"?(s--,o):e?(l,c)=>{if(Array.isArray(l)&&!Array.isArray(c))return c}:void 0,a&&lc(i[0],i[1],a)&&(o=s<3?void 0:o,s=1),n=Object(n);++r<s;){const l=i[r];l&&t(n,l,r,o)}return n}}const $f=(t,e,n,i,r)=>{t!==e&&Kt(e,(s,o)=>{if(Nt(s))r||(r=new Ys),qN(t,e,o,n,$f,i,r);else{let a=i?i(t[o],s,`${o}`,t,e,r):void 0;a===void 0&&(a=s),jh(t,o,a)}})},qN=(t,e,n,i,r,s,o)=>{const a=Bg(t,n),l=Bg(e,n),c=o.get(l);if(c){jh(t,n,c);return}let h=s?s(a,l,`${n}`,t,e,o):void 0,u=h===void 0;if(u){const d=Array.isArray(l),f=!d&&Ua(l);h=l,d||f?Array.isArray(a)?h=a:oi(a)&&Zn(a)?h=Lf(a):f?(u=!1,h=_0(l,!0)):h=[]:Ee(l)||va(l)?(h=a,va(a)?h=XN(a):(typeof a=="function"||!Nt(a))&&(h=S0(l))):u=!1}u&&(o.set(l,h),r(h,l,i,s,o),o.delete(l)),jh(t,n,h)},jh=(t,e,n)=>{(n!==void 0&&!Co(t[e],n)||n===void 0&&!(e in t))&&ms(t,e,n)};function KN(t,e,n){const i=Object(t),r=n(t);let{length:s}=r,o=-1;for(;s--;){const a=r[++o];if(e(i[a],a,i)===!1)break}return t}const ZN=(t,e)=>t&&KN(t,e,Va),Bf=(t,e)=>{if(t==null)return t;if(!Zn(t))return ZN(t,e);const n=t.length,i=Object(t);let r=-1;for(;++r<n&&e(i[r],r,i)!==!1;);return t};function JN(t){const e=t==null?0:t.length;return e?t[e-1]:void 0}const QN=Set&&1/ru(new Set([void 0,-0]))[1]==1/0?t=>new Set(t):()=>{};function L0(t,e,n,i,r,s){return Nt(t)&&Nt(e)&&(s.set(e,t),$f(t,e,void 0,L0,s),s.delete(e)),t}function tR(t,e,n){e.length?e=e.map(o=>Array.isArray(o)?a=>Ha(a,o.length===1?o[0]:o):o):e=[o=>o];let i=-1,r=-1;const s=Zn(t)?new Array(t.length):[];return Bf(t,o=>{const a=e.map(l=>l(o));s[++r]={criteria:a,index:++i,value:o}}),eR(s,(o,a)=>UN(o,a,n))}function eR(t,e){let{length:n}=t;for(t.sort(e);n--;)t[n]=t[n].value;return t}function M0(t){return t===t&&!Nt(t)}function D0(t,e){return n=>n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}function N0(t,e){return t!=null&&vR(t,e,mR)}function nR(t,e){return Nf(t)&&M0(e)?D0(hr(t),e):n=>{const i=Ha(n,t);return i===void 0&&i===e?N0(n,t):iu(e,i)}}function R0(t){const e=iR(t);return e.length===1&&e[0][2]?D0(e[0][0],e[0][1]):n=>n===t||rR(n,t,e)}function iR(t){const e=Va(t);let n=e.length;for(;n--;){const i=e[n],r=t[i];e[n]=[i,r,M0(r)]}return e}function rR(t,e,n,i){let r=n.length;const s=r,o=!i;if(t==null)return!s;let a,l;for(t=Object(t);r--;)if(a=n[r],o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1;for(;++r<s;){a=n[r];const c=a[0],h=t[c],u=a[1];if(o&&a[2]){if(h===void 0&&!(c in t))return!1}else{const d=new Ys;if(i&&(l=i(h,u,c,t,e,d)),!(l===void 0?iu(u,h,d):l))return!1}}return!0}function sR(t){return Nf(t)?oR(hr(t)):aR(t)}function oR(t){return e=>e==null?void 0:e[t]}function aR(t){return e=>Ha(e,t)}function lR(t){return typeof t=="function"?t:t==null?e=>e:typeof t=="object"?Array.isArray(t)?nR(t[0],t[1]):R0(t):sR(t)}function su(){const t=lR;return arguments.length?t(arguments[0]):t}const cR=(t,e,n,i)=>{let r=-1;const s=t==null?0:t.length;for(i&&s&&(n=t[++r]);++r<s;)n=e(n,t[r],r,t);return n},uR=(t,e,n,i,r)=>(r(t,(s,o,a)=>{n=i?(i=!1,s):e(n,s,o,a)}),n);function hR(t,e,n){const i=Array.isArray(t)?cR:uR,r=arguments.length<3;return i(t,e,n,r,Bf)}const dR=t=>Array.isArray(t)||va(t)||!!(t&&t[Symbol.isConcatSpreadable]);function $0(t,e,n,i,r){let s=-1;const o=t.length;for(n||(n=dR),r||(r=[]);++s<o;){var a=t[s];e>0&&n(a)?e>1?$0(a,e-1,n,i,r):r.push(...a):i||(r[r.length]=a)}return r}const va=t=>oi(t)&&ai(t)=="[object Arguments]",fR=(t,e)=>pR(t,e,(n,i)=>N0(t,i)),pR=(t,e,n)=>{let i=-1;const r=e.length,s={};for(;++i<r;){const o=e[i],a=Ha(t,o);n(a,o)&&jN(s,Dr(o,t),a)}return s},gR=t=>typeof t=="number"&&t>-1&&t%1==0&&t<=Number.MAX_SAFE_INTEGER,mR=(t,e)=>t!=null&&e in Object(t),vR=(t,e,n)=>{e=Dr(e,t);for(var i=-1,r=e.length,s=!1;++i<r;){var o=hr(e[i]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++i!=r?s:(r=t==null?0:t.length,!!r&&gR(r)&&Rf(o,r)&&(Array.isArray(t)||va(t)))},yR=t=>t.match(SN),bR=t=>t.match(uN),xR=(t,e)=>e===void 0?(wN(t)?bR(t):yR(t))||[]:t.match(e)||[],wR=(t,e,n)=>{const{length:i}=t;return n=n===void 0?i:n,!e&&n>=i?t:t.slice(e,n)},_R=SR("toUpperCase");function SR(t){return e=>{if(!e)return"";const n=b0(e)?x0(e):void 0,i=n?n[0]:e[0],r=n?wR(n,1).join(""):e.slice(1);return i[t]()+r}}function ER(t){return R0(es(t,!0))}let Ys=class{constructor(e){const n=this.__data__=new Yu(e);this.size=n.size}clear(){this.__data__=new Yu,this.size=0}delete(e){const n=this.__data__,i=n.delete(e);return this.size=n.size,i}get(e){return this.__data__.get(e)}has(e){return this.__data__.has(e)}set(e,n){let i=this.__data__;if(i instanceof Yu){const r=i.__data__;if(r.length<kf-1)return r.push([e,n]),this.size=++i.size,this;i=this.__data__=new B0(r)}return i.set(e,n),this.size=i.size,this}};class Yu{constructor(e){let n=-1;const i=e==null?0:e.length;for(this.clear();++n<i;){const r=e[n];this.set(r[0],r[1])}}clear(){this.__data__=[],this.size=0}delete(e){const n=this.__data__,i=yl(n,e);if(i<0)return!1;const r=n.length-1;return i==r?n.pop():n.splice(i,1),--this.size,!0}get(e){const n=this.__data__,i=yl(n,e);return i<0?void 0:n[i][1]}has(e){return yl(this.__data__,e)>-1}set(e,n){const i=this.__data__,r=yl(i,e);return r<0?(++this.size,i.push([e,n])):i[r][1]=n,this}}class B0{constructor(e){let n=-1;const i=e==null?0:e.length;for(this.clear();++n<i;){const r=e[n];this.set(r[0],r[1])}}clear(){this.size=0,this.__data__={hash:new Fg,map:new Map,string:new Fg}}delete(e){const n=bl(this,e).delete(e);return this.size-=n?1:0,n}get(e){return bl(this,e).get(e)}has(e){return bl(this,e).has(e)}set(e,n){const i=bl(this,e),r=i.size;return i.set(e,n),this.size+=i.size==r?0:1,this}}class Fg{constructor(e){let n=-1;const i=e==null?0:e.length;for(this.clear();++n<i;){const r=e[n];this.set(r[0],r[1])}}clear(){this.__data__=Object.create(null),this.size=0}delete(e){const n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}get(e){const i=this.__data__[e];return i===Hh?void 0:i}has(e){return this.__data__[e]!==void 0}set(e,n){const i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=n===void 0?Hh:n,this}}class no{constructor(e){let n=-1;const i=e==null?0:e.length;for(this.__data__=new B0;++n<i;)this.add(e[n])}add(e){return this.__data__.set(e,Hh),this}has(e){return this.__data__.has(e)}}no.prototype.push=no.prototype.add;const Ff=function(t){var e=Object.prototype.toString;return t===!0||t===!1||!!t&&typeof t=="object"&&e.call(t)===Jc},Nt=function(t){return!!t&&(typeof t=="object"||typeof t=="function")},Ot=function(t){var e=Object.prototype.toString;return typeof t=="number"||!!t&&typeof t=="object"&&e.call(t)===Qc},te=function(t){var e=Object.prototype.toString;return typeof t=="string"||!!t&&typeof t=="object"&&e.call(t)===tu},U=k0((t,e)=>{if(nu(e)||Zn(e)){za(e,Va(e),t);return}for(var n in e)hasOwnProperty.call(e,n)&&ms(t,n,e[n])}),F0=U,TR=F0,V0=(t,...e)=>{let n=-1,i=e.length;const r=i>2?e[2]:void 0;for(r&&lc(e[0],e[1],r)&&(i=1);++n<i;){const s=e[n];if(s==null)continue;const o=Object.keys(s),a=o.length;let l=-1;for(;++l<a;){const c=o[l],h=t[c];(h===void 0||Co(h,Object.prototype[c])&&!hasOwnProperty.call(t,c))&&(t[c]=s[c])}}return t},me=V0,z0=function(...e){return e.push(void 0,L0),_e.apply(void 0,e)},$i=z0,We=(t,e,...n)=>{let i=-1;const r=typeof e=="function",s=Zn(t)?new Array(t.length):[];return Bf(t,o=>{s[++i]=r?e.apply(o,n):U0(o,e,...n)}),s},U0=(t,e,...n)=>{e=Dr(e,t),t=I0(t,e);const i=t==null?t:t[hr(JN(e))];return i==null?void 0:i.apply(t,n)},ou=(t,e,n)=>{let i=0,r=t==null?0:t.length;if(r==0)return 0;n=su(n,2),e=n(e);const s=e!==e,o=e===null,a=eo(e),l=e===void 0;for(;i<r;){let c;const h=Math.floor((i+r)/2),u=n(t[h]),d=u!==void 0,f=u===null,p=u===u,g=eo(u);s?c=p:l?c=p&&d:o?c=p&&d&&!f:a?c=p&&d&&!f&&!g:f||g?c=!1:c=u<e,c?i=h+1:r=h}return Math.min(r,_N)},mi=(t,e)=>{let n=-1,i=(l,c)=>!!(l==null?0:l.length)&&l.indexOf(c)>-1;e=su(e,2);let r=!0;const{length:s}=t,o=[];let a=o;if(s>=kf){const l=e?null:QN(t);if(l)return ru(l);r=!1,i=(c,h)=>c.has(h),a=new no}else a=e?[]:o;t:for(;++n<s;){let l=t[n];const c=e?e(l):l;if(l=l!==0?l:0,r&&c===c){let h=a.length;for(;h--;)if(a[h]===c)continue t;e&&a.push(c),o.push(l)}else i(a,c)||(a!==o&&a.push(c),o.push(l))}return o},be=t=>es(t),ke=t=>es(t,!0),xn=t=>{if(t==null)return!0;if(Zn(t)&&(Array.isArray(t)||typeof t=="string"||typeof t.splice=="function"||Ua(t)||va(t)))return!t.length;const e=ai(t);if(e=="[object Map]"||e=="[object Set]")return!t.size;if(nu(t))return!CN(t).length;for(const n in t)if(hasOwnProperty.call(t,n))return!1;return!0},Ie=(t,e)=>iu(t,e),xt=t=>typeof t=="function",Ee=t=>{if(!oi(t)||ai(t)!="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},ft=t=>{if(!t)return[];if(Zn(t))return te(t)?x0(t):Lf(t);if(Symbol.iterator&&Symbol.iterator in Object(t)){const i=t[Symbol.iterator]();let r;const s=[];for(;!(r=i.next()).done;)s.push(r.value);return s}const e=ai(t);return(e==Ba?C0:e==Fa?ru:AN)(t)};function Ga(t,e,n){if(typeof t!="function")throw new TypeError("Expected a function");let i,r,s,o,a,l,c=0,h=!1,u=!1,d=!0;const f=!e&&e!==0&&window&&typeof window.requestAnimationFrame=="function";e=+e||0,Nt(n)&&(h=!!n.leading,u="maxWait"in n,s=u?Math.max(+n.maxWait||0,e):s,d="trailing"in n?!!n.trailing:d);function p(m){const b=i,w=r;return i=r=void 0,c=m,o=t.apply(w,b),o}function g(m,b){return f?(window.cancelAnimationFrame(a),window.requestAnimationFrame(m)):setTimeout(m,b)}function v(m){if(f)return window.cancelAnimationFrame(m);clearTimeout(m)}function x(m){return c=m,a=g(P,e),h?p(m):o}function S(m){const b=m-l,w=m-c,A=e-b;return u?Math.min(A,s-w):A}function C(m){const b=m-l,w=m-c;return l===void 0||b>=e||b<0||u&&w>=s}function P(){const m=Date.now();if(C(m))return O(m);a=g(P,S(m))}function O(m){return a=void 0,d&&i?p(m):(i=r=void 0,o)}function N(...m){const b=Date.now(),w=C(b);if(i=m,r=this,l=b,w){if(a===void 0)return x(l);if(u)return a=g(P,e),p(l)}return a===void 0&&(a=g(P,e)),o}return N.cancel=()=>{a!==void 0&&v(a),c=0,i=l=r=a=void 0},N.flush=()=>a===void 0?o:O(Date.now()),N.pending=()=>a!==void 0,N}const Vf=(t,e)=>(e=su(e,2),hR(t,(n,i,r)=>(r=e(i),hasOwnProperty.call(n,r)?n[r].push(i):ms(n,r,[i]),n),{})),Je=(t,e=[])=>{if(t==null)return[];const n=e.length;return n>1&&lc(t,e[0],e[1])?e=[]:n>2&&lc(e[0],e[1],e[2])&&(e=[e[0]]),Array.isArray(e)||(e=[su(e,2)]),tR(t,e.flat(1),[])},H0=t=>(t==null?0:t.length)?$0(t,1/0):[],io=(t,...e)=>Zn(t)?P0(t,e):[],G0=(t,...e)=>oi(t)&&Zn(t)?P0(t,e.flat(1)):[],Wh=(...t)=>{const e=t.map(n=>oi(n)&&Zn(n)?n:[]);return e.length&&e[0]===t[0]?HN(e):[]},cc=(...t)=>{const e=t.flat(1);return mi(e)},ni=(t,e)=>{if(t==null)return!1;typeof e=="string"&&(e=e.split("."));let n=-1,i=t;for(;++n<e.length;){if(!i||!hasOwnProperty.call(i,e[n]))return!1;i=i[e[n]]}return!0},Qt=(t,e,n)=>{e=Dr(e,t);let i=-1,r=e.length;for(r||(r=1,t=void 0);++i<r;){let s=t==null?void 0:t[hr(e[i])];s===void 0&&(i=r,s=n),t=typeof s=="function"?s.call(t):s}return t},Ze=(t,...e)=>{let n={};if(t==null)return n;let i=!1;e=e.flat(1).map(s=>(s=Dr(s,t),i||(i=s.length>1),s)),za(t,T0(t),n),i&&(n=es(n,!0,!0,!0,s=>Ee(s)?void 0:s));let r=e.length;for(;r--;)WN(n,e[r]);return n},uc=(t,...e)=>t==null?{}:fR(t,e.flat(1/0)),ln=(t,...e)=>(e.flat(1).forEach(n=>{n=hr(n),ms(t,n,t[n].bind(t))}),t),Kt=(t,e=n=>n)=>{let n=-1;const i=Object(t),r=Zn(t)?w0(t,!0):O0(t);let s=r.length;for(;s--;){const o=r[++n];if(e(i[o],o,i)===!1)break}},ja=(t="")=>xR(`${t}`.replace(/['\u2019]/g,"")).reduce((e,n,i)=>(n=n.toLowerCase(),e+(i?_R(n):n)),"");let AR=0;const kr=(t="")=>{const e=++AR;return`${t}`+e},_e=k0((t,e,n,i)=>{$f(t,e,n,i)},!0);class CR{constructor(){this.map=new WeakMap}has(e,n){return n===void 0?this.map.has(e):n in this.map.get(e)}create(e){return this.has(e)||this.map.set(e,Object.create(null)),this.get(e)}get(e,n){if(!this.has(e))return;const i=this.map.get(e);return n===void 0?i:i[n]}set(e,n,i){if(n===void 0)return;const r=this.create(e);typeof n=="string"?r[n]=i:Object.assign(r,n)}remove(e,n){if(this.has(e))if(n===void 0)this.map.delete(e);else{const i=this.map.get(e);delete i[n]}}}const j0=CR,ri=new j0,W0=new j0,ss=function(t,e){if(!(this instanceof ss))return new ss(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented?Ul:Hl,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&Object.assign(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this.envelope=!0};ss.prototype={constructor:ss,isDefaultPrevented:Hl,isPropagationStopped:Hl,isImmediatePropagationStopped:Hl,preventDefault:function(){const t=this.originalEvent;this.isDefaultPrevented=Ul,t&&t.preventDefault()},stopPropagation:function(){const t=this.originalEvent;this.isPropagationStopped=Ul,t&&t.stopPropagation()},stopImmediatePropagation:function(){const t=this.originalEvent;this.isImmediatePropagationStopped=Ul,t&&t.stopImmediatePropagation(),this.stopPropagation()}};["altKey","bubbles","cancelable","changedTouches","ctrlKey","detail","eventPhase","metaKey","pageX","pageY","shiftKey","view","char","code","charCode","key","keyCode","button","buttons","clientX","clientY","offsetX","offsetY","pointerId","pointerType","screenX","screenY","targetTouches","toElement","touches","which"].forEach(t=>PR(t));function PR(t){Object.defineProperty(ss.prototype,t,{enumerable:!0,configurable:!0,get:function(){return this.originalEvent?this.originalEvent[t]:void 0},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})}function Ul(){return!0}function Hl(){return!1}const ro=typeof window<"u"?window.document:null,IR=ro&&ro.documentElement,Y0=/^([^.]*)(?:\.(.+)|)/,X0=/[^\x20\t\r\n\f]+/g,q=function(t){return new q.Dom(t)};q.fn=q.prototype={constructor:q,length:0};q.guid=1;q.data=W0;q.merge=function(t,e){let n=+e.length,i=t.length;for(let r=0;r<n;r++)t[i++]=e[r];return t.length=i,t};q.parseHTML=function(t){const e=ro.implementation.createHTMLDocument(),n=e.createElement("base");n.href=ro.location.href,e.head.appendChild(n),e.body.innerHTML=t;const i=e.getElementsByTagName("script");for(let r=0;r<i.length;r++)i[r].remove();return Array.from(e.body.childNodes)};typeof Symbol=="function"&&(q.fn[Symbol.iterator]=Array.prototype[Symbol.iterator]);q.fn.toArray=function(){return Array.from(this)};q.fn.pushStack=function(t){const e=q.merge(this.constructor(),t);return e.prevObject=this,e};q.fn.find=function(t){const[e]=this,n=this.pushStack([]);if(!e)return n;const{nodeType:i}=e;return i!==1&&i!==9&&i!==11||(typeof t!="string"?e!==t&&e.contains(t)&&q.merge(n,[t]):q.merge(n,e.querySelectorAll(t))),n};q.fn.add=function(t,e){const n=q(t).toArray(),i=this.toArray(),r=this.pushStack([]);return q.merge(r,mi(i.concat(n))),r};q.fn.addBack=function(){return this.add(this.prevObject)};q.fn.filter=function(t){const e=[];for(let n=0;n<this.length;n++){const i=this[n];i.matches(t)&&e.push(i)}return this.pushStack(e)};const OR=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;function kR(t){return t[0]==="<"&&t[t.length-1]===">"&&t.length>=3}const q0=function(t){if(!t)return this;if(typeof t=="function")throw new Error("function not supported");if(arguments.length>1)throw new Error("selector with context not supported");if(t.nodeType)return this[0]=t,this.length=1,this;let e;if(kR(t+""))e=[null,t,null];else if(typeof t=="string")e=OR.exec(t);else return q.merge(this,t);if(!e||!e[1])return LR.find(t);if(e[1])return q.merge(this,q.parseHTML(e[1])),this;const n=ro.getElementById(e[2]);return n&&(this[0]=n,this.length=1),this};q.Dom=q0;q0.prototype=q.fn;q.Event=ss;q.event={special:Object.create(null)};q.event.has=function(t,e){const n=ri.get(t,"events");return n?e?Array.isArray(n[e])&&n[e].length>0:!0:!1};q.event.on=function(t,e,n,i,r,s){if(typeof e=="object"){typeof n!="string"&&(i=i||n,n=void 0);for(let o in e)q.event.on(t,o,n,i,e[o],s);return t}if(i==null&&r==null?(r=n,i=n=void 0):r==null&&(typeof n=="string"?(r=i,i=void 0):(r=i,i=n,n=void 0)),!r)return t;if(s===1){const o=r;r=function(a){return q().off(a),o.apply(this,arguments)},r.guid=o.guid||(o.guid=q.guid++)}for(let o=0;o<t.length;o++)q.event.add(t[o],e,r,i,n)};q.event.add=function(t,e,n,i,r){if(typeof t!="object")return;const s=ri.create(t);let o;n.handler&&(o=n,n=o.handler,r=o.selector),r&&IR.matches(r),n.guid||(n.guid=q.guid++);let a;(a=s.events)||(a=s.events=Object.create(null));let l;(l=s.handle)||(l=s.handle=function(u){return typeof q<"u"?q.event.dispatch.apply(t,arguments):void 0});const c=(e||"").match(X0)||[""];let h=c.length;for(;h--;){const[,u,d=""]=Y0.exec(c[h]);if(!u)continue;const f=d.split(".").sort();let p=q.event.special[u];const g=p&&(r?p.delegateType:p.bindType)||u;p=q.event.special[g];const v=Object.assign({type:g,origType:u,data:i,handler:n,guid:n.guid,selector:r,namespace:f.join(".")},o);let x;(x=a[g])||(x=a[g]=[],x.delegateCount=0,(!p||!p.setup||p.setup.call(t,i,f,l)===!1)&&t.addEventListener&&t.addEventListener(g,l)),p&&p.add&&(p.add.call(t,v),v.handler.guid||(v.handler.guid=n.guid)),r?x.splice(x.delegateCount++,0,v):x.push(v)}};q.event.remove=function(t,e,n,i,r){const s=ri.get(t);if(!s||!s.events)return;const o=s.events,a=(e||"").match(X0)||[""];let l=a.length;for(;l--;){const[,c,h=""]=Y0.exec(a[l]);if(!c){for(const S in o)q.event.remove(t,S+a[l],n,i,!0);continue}const u=q.event.special[c],d=u&&(i?u.delegateType:u.bindType)||c,f=o[d];if(!f||f.length===0)continue;const p=h.split(".").sort(),g=h?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,v=f.length;let x=v;for(;x--;){const S=f[x];(r||c===S.origType)&&(!n||n.guid===S.guid)&&(!g||g.test(S.namespace))&&(!i||i===S.selector||i==="**"&&S.selector)&&(f.splice(x,1),S.selector&&f.delegateCount--,u&&u.remove&&u.remove.call(t,S))}v&&f.length===0&&((!u||!u.teardown||u.teardown.call(t,p,s.handle)===!1)&&t.removeEventListener&&t.removeEventListener(d,s.handle),delete o[d])}xn(o)&&(ri.remove(t,"handle"),ri.remove(t,"events"))};q.event.dispatch=function(t){const e=this,n=q.event.fix(t);n.delegateTarget=e;const i=Array.from(arguments);i[0]=n;const r=ri.get(e,"events"),s=r&&r[n.type]||[],o=q.event.special[n.type];if(o&&o.preDispatch&&o.preDispatch.call(e,n)===!1)return;const a=q.event.handlers.call(e,n,s);let l=0,c;for(;(c=a[l++])&&!n.isPropagationStopped();){n.currentTarget=c.elem;let h=0,u;for(;(u=c.handlers[h++])&&!n.isImmediatePropagationStopped();){n.handleObj=u,n.data=u.data;const d=q.event.special[u.origType];let f;d&&d.handle?f=d.handle:f=u.handler;const p=f.apply(c.elem,i);p!==void 0&&(n.result=p)===!1&&(n.preventDefault(),n.stopPropagation())}}return o&&o.postDispatch&&o.postDispatch.call(e,n),n.result};q.event.handlers=function(t,e){const n=e.delegateCount,i=[];if(n&&!(t.type==="click"&&t.button>=1)){for(let r=t.target;r!==this;r=r.parentNode||this)if(r.nodeType===1&&!(t.type==="click"&&r.disabled===!0)){const s=[],o={};for(let a=0;a<n;a++){const l=e[a],c=l.selector+" ";o[c]===void 0&&(o[c]=r.matches(c)),o[c]&&s.push(l)}s.length&&i.push({elem:r,handlers:s})}}return n<e.length&&i.push({elem:this,handlers:e.slice(n)}),i};q.event.fix=function(t){return t.envelope?t:new ss(t)};const LR=q(ro);function zf(t){let e=t.length;for(;e--;)K0(t[e])}function K0(t){q.event.remove(t),ri.remove(t),W0.remove(t)}function Z0(t){for(let e=0;e<t.length;e++){const n=t[e];n.parentNode&&n.parentNode.removeChild(n)}}function MR(){for(let t=0;t<this.length;t++){const e=this[t];K0(e),zf(e.getElementsByTagName("*"))}return Z0(this),this}function DR(){return Z0(this),this}function NR(){for(let t=0;t<this.length;t++){const e=this[t];e.nodeType===1&&(zf(e.getElementsByTagName("*")),e.textContent="")}return this}function RR(){const t=[];for(let e=0;e<this.length;e++)t.push(this[e].cloneNode(!0));return this.pushStack(t)}function $R(t){const[e]=this;if(!e)return null;if(arguments.length===0)return e.innerHTML;if(t===void 0)return this;if(zf(ri,e.getElementsByTagName("*")),typeof t=="string"||typeof t=="number")e.innerHTML=t;else return e.innerHTML="",this.append(t);return this}function BR(...t){const[e]=this;return e?(t.forEach(n=>{n&&(typeof n=="string"?e.append(...q.parseHTML(n)):n.toString()==="[object Object]"?this.append(...Array.from(n)):Array.isArray(n)?this.append(...n):e.appendChild(n))}),this):this}function FR(...t){const[e]=this;return e?(t.forEach(n=>{n&&(typeof n=="string"?e.prepend(...q.parseHTML(n)):n.toString()==="[object Object]"?this.prepend(...Array.from(n)):Array.isArray(n)?this.prepend(...n):e.insertBefore(n,e.firstChild))}),this):this}function VR(t){return q(t).append(this),this}function zR(t){return q(t).prepend(this),this}const J0={};["width","height","top","bottom","left","right","padding","paddingTop","paddingBottom","paddingLeft","paddingRight","margin","marginTop","marginBottom","marginLeft","marginRight"].forEach(t=>{J0[t]=!0});function UR(t,e,n){typeof n=="number"&&J0[ja(e)]&&(n+="px"),t.style[e]=n}function HR(t,e){let n;if(typeof t=="string")if(e===void 0){const[i]=this;return i?i.style[t]:null}else n={[t]:e};else if(t)n=t;else throw new Error("no styles provided");for(let i in n)if(n.hasOwnProperty(i))for(let r=0;r<this.length;r++)UR(this[r],i,n[i]);return this}function GR(t,e){if(arguments.length<2){const[n]=this;return n?t===void 0?n.dataset:n.dataset[t]:null}for(let n=0;n<this.length;n++)this[n].dataset[t]=e;return this}function Uf(t,e,n){for(let i=0;i<e.length;i++){const r=e[i];k.prototype[t].apply({node:r},n)}}function jR(){return Uf("removeClass",this,arguments),this}function WR(){return Uf("addClass",this,arguments),this}function YR(){return Uf("toggleClass",this,arguments),this}function XR(){const[t]=this;return t?k.prototype.hasClass.apply({node:t},arguments):!1}function qR(t){const e=[];for(let n=0;n<this.length;n++){const i=this[n];let r=Array.from(i.children);typeof t=="string"&&(r=r.filter(s=>s.matches(t))),e.push(...r)}return this.pushStack(e)}function KR(t){const e=[];for(let n=0;n<this.length;n++){const i=this[n];if(typeof t=="string"){const r=i.closest(t);r&&e.push(r)}else{const[r]=q(t);r&&r.contains(i)&&e.push(r)}}return this.pushStack(e)}function ZR(t,e,n,i){return q.event.on(this,t,e,n,i),this}function JR(t,e,n,i){return q.event.on(this,t,e,n,i,1),this}function QR(t,e,n){if(t&&t.preventDefault&&t.handleObj){const i=t.handleObj;return q(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this}if(typeof t=="object"){for(let i in t)this.off(i,e,t[i]);return this}(e===!1||typeof e=="function")&&(n=e,e=void 0);for(let i=0;i<this.length;i++)q.event.remove(this[i],t,n,e);return this}function t$(){const[t]=this;if(t===window)return t.document.documentElement.clientWidth;if(!t)return;const e=window.getComputedStyle(t),n=t.offsetWidth,i=parseFloat(e.borderTopWidth),r=parseFloat(e.borderBottomWidth),s=parseFloat(e.paddingTop),o=parseFloat(e.paddingBottom);return n-r-i-s-o}function e$(){const[t]=this;if(t===window)return t.document.documentElement.clientHeight;if(!t)return;const e=window.getComputedStyle(t),n=t.offsetHeight,i=parseFloat(e.borderLeftWidth),r=parseFloat(e.borderRightWidth),s=parseFloat(e.paddingLeft),o=parseFloat(e.paddingRight);return n-i-r-s-o}function n$(){const[t]=this;if(!t)return;let e=q(t),n,i,r,s={top:0,left:0};if(e.css("position")==="fixed")i=t.getBoundingClientRect();else{i=e.offset(),r=t.ownerDocument,n=t.offsetParent||r.documentElement;const l=q(n),c=l.css("position")||"static";for(;n&&(n===r.body||n===r.documentElement)&&c==="static";)n=n.parentNode;if(n&&n!==t&&n.nodeType===1){const h=window.getComputedStyle(n),u=parseFloat(h.borderTopWidth)||0,d=parseFloat(h.borderLeftWidth)||0;s=l.offset(),s.top+=u,s.left+=d}}const o=parseFloat(window.getComputedStyle(t).marginTop)||0,a=parseFloat(window.getComputedStyle(t).marginLeft)||0;return{top:i.top-s.top-o,left:i.left-s.left-a}}function i$(t){const[e]=this;if(t===void 0){if(!e)return null;if(!e.getClientRects().length)return{top:0,left:0};const o=e.getBoundingClientRect();return{top:o.top+window.scrollY,left:o.left+window.scrollX}}if(!e)return this;const n=window.getComputedStyle(e);n.position==="static"&&this.css("position","relative");const i=this.offset(),r=t.top-i.top,s=t.left-i.left;return this.css({top:(parseFloat(n.top)||0)+r+"px",left:(parseFloat(n.left)||0)+s+"px"}),this}const r$=Object.freeze(Object.defineProperty({__proto__:null,addClass:WR,append:BR,appendTo:VR,children:qR,clone:RR,closest:KR,css:HR,data:GR,detach:DR,empty:NR,hasClass:XR,height:e$,html:$R,off:QR,offset:i$,on:ZR,one:JR,position:n$,prepend:FR,prependTo:zR,remove:MR,removeClass:jR,toggleClass:YR,width:t$},Symbol.toStringTag,{value:"Module"})),hc="animationFrameId",Ai={};Ai["transition-property"]=Ai["transition-duration"]=Ai["transition-delay"]=Ai["transition-timing-function"]=Ai["animation-name"]=Ai["animation-duration"]=Ai["animation-delay"]=Ai["animation-timing-function"]="";function s$(t,e={}){this.stop();for(let n=0;n<this.length;n++)o$(this[n],t,e);return this}function o$(t,e,n={}){let{duration:i=400,easing:r="ease-in-out",delay:s=0,complete:o}=n;const a=setTimeout(function(){const l=q(t);let c=!1,h="transitionend";i=i/1e3,s=s/1e3;const u={};if(typeof e=="string")u["animation-name"]=e,u["animation-duration"]=i+"s",u["animation-delay"]=s+"s",u["animation-timing-function"]=r,h="animationend";else{const p=[];for(var d in e)e.hasOwnProperty(d)&&(u[d]=e[d],p.push(d));i>0&&(u["transition-property"]=p.join(", "),u["transition-duration"]=i+"s",u["transition-delay"]=s+"s",u["transition-timing-function"]=r)}const f=function(p){if(p){if(p.target!==p.currentTarget)return;p.target.removeEventListener(h,f)}else t.removeEventListener(h,f);c=!0,l.css(Ai),o&&o.call(t)};if(i>0){t.addEventListener(h,f);const p=setTimeout(function(){c||f(null)},(i+s)*1e3+25);ri.set(t,hc,{id:p,stop:()=>{clearTimeout(p),t.removeEventListener(h,f)}})}l.css(u),i<=0&&f(null)});ri.set(t,hc,{stop:()=>clearTimeout(a)})}function a$(){for(let t=0;t<this.length;t++){const e=this[t],n=ri.get(e,hc);n&&(n.stop(),ri.remove(e,hc))}return this.css(Ai),this}const l$=Object.freeze(Object.defineProperty({__proto__:null,animate:s$,stop:a$},Symbol.toStringTag,{value:"Module"})),Vg={outerWidth:"offsetWidth",outerHeight:"offsetHeight",innerWidth:"clientWidth",innerHeight:"clientHeight",scrollLeft:"scrollLeft",scrollTop:"scrollTop",val:"value",text:"textContent"},zg={disabled:"disabled",value:"value",text:"textContent"};function c$(t,e){if(!t)throw new Error("no property provided");if(arguments.length===1){const[n]=this;return n?n[t]:null}if(e===void 0)return this;for(let n=0;n<this.length;n++)this[n][t]=e;return this}function u$(t,e){let n;if(typeof t=="string")if(e===void 0){const[i]=this;return i?i.getAttribute(t):null}else n={[t]:e};else if(t)n=t;else throw new Error("no attributes provided");for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];if(zg[i]){this.prop(zg[i],r);continue}for(let s=0;s<this.length;s++)r===null?this[s].removeAttribute(i):this[s].setAttribute(i,r)}return this}const Q0={prop:c$,attr:u$};Object.keys(Vg).forEach(t=>{Q0[t]=function(...e){return this.prop(Vg[t],...e)}});const h$=Q0,ir={useCSSSelectors:!1,classNamePrefix:"joint-",defaultTheme:"default",doubleTapInterval:300},au=Object.create(null),d$=au;au.load={noBubble:!0};[["mouseenter","mouseover"],["mouseleave","mouseout"],["pointerenter","pointerover"],["pointerleave","pointerout"]].forEach(([t,e])=>{au[t]={delegateType:e,bindType:e,handle:function(n){const i=this,r=n.relatedTarget,s=n.handleObj;let o;return(!r||!i.contains(r))&&(n.type=s.origType,o=s.handler.apply(i,arguments),n.type=e),o}}});const f$=ir.doubleTapInterval,p$=30;au.dbltap={bindType:"touchend",delegateType:"touchend",handle:function(t,...e){const{handleObj:n,target:i}=t,r=q.data.create(i),s=new Date().getTime(),o="lastTouch"in r?s-r.lastTouch:0;o<f$&&o>p$?(r.lastTouch=null,t.type=n.origType,n.handler.call(this,t,...e)):r.lastTouch=s}};Object.assign(q.fn,r$);Object.assign(q.fn,l$);Object.assign(q.fn,h$);Object.assign(q.event.special,d$);const En=function(t){return t&&t.toString().split(" ").map(function(e){return e.substr(0,ir.classNamePrefix.length)!==ir.classNamePrefix&&(e=ir.classNamePrefix+e),e}).join(" ")},g$=function(t){return t&&t.toString().split(" ").map(function(e){return e.substr(0,ir.classNamePrefix.length)===ir.classNamePrefix&&(e=e.substr(ir.classNamePrefix.length)),e}).join(" ")},ya=function(t,e){const n={},i={},r=k.namespace.svg,s=e||r,o=document.createDocumentFragment(),a=function(l,c,h){for(let u=0;u<l.length;u++){const d=l[u];if(typeof d=="string"){const P=document.createTextNode(d);c.appendChild(P);continue}if(!d.hasOwnProperty("tagName"))throw new Error("json-dom-parser: missing tagName");const f=d.tagName;let p;d.hasOwnProperty("namespaceURI")&&(h=d.namespaceURI),p=document.createElementNS(h,f);const g=h===r,v=g?k(p):q(p),x=d.attributes;x&&v.attr(x);const S=d.style;if(S&&q(p).css(S),d.hasOwnProperty("className")){const P=d.className;g?p.className.baseVal=P:p.className=P}if(d.hasOwnProperty("textContent")&&(p.textContent=d.textContent),d.hasOwnProperty("selector")){const P=d.selector;if(n[P])throw new Error("json-dom-parser: selector must be unique");n[P]=p,v.attr("joint-selector",P)}if(d.hasOwnProperty("groupSelector")){let P=d.groupSelector;Array.isArray(P)||(P=[P]);for(let O=0;O<P.length;O++){const N=P[O];let m=i[N];m||(m=i[N]=[]),m.push(p)}}c.appendChild(p);const C=d.children;Array.isArray(C)&&a(C,p,h)}};return a(t,o,s),{fragment:o,selectors:n,groupSelectors:i}},Qo=function(t){let e=0;if(t.length===0)return e;for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);e=(e<<5)-e+i,e=e&e}return e},fn=function(t,e,n){for(var i=Array.isArray(e)?e:e.split(n||"/"),r,s=0,o=i.length;s<o;)if(r=i[s++],Object(t)===t&&r in t)t=t[r];else return;return t},tx=function(t,e){return typeof e!="string"&&typeof e!="number"&&(e=String(e)),!(e==="constructor"&&typeof t[e]=="function"||e==="__proto__")},so=function(t,e,n,i){const r=Array.isArray(e)?e:e.split(i||"/"),s=r.length-1;let o=t,a=0;for(;a<s;a++){const l=r[a];if(!tx(o,l))return t;o=o[l]||(o[l]={})}return o[r[s]]=n,t},Yh=function(t,e,n){const i=Array.isArray(e)?e:e.split(n||"/"),r=i.length-1;let s=t,o=0;for(;o<r;o++){const a=i[o];if(!tx(s,a))return t;const l=s[a];if(!l)return t;s=l}return delete s[i[r]],t},Hf=function(t,e,n){e=e||"/";var i={};for(var r in t)if(t.hasOwnProperty(r)){var s=typeof t[r]=="object";if(s&&n&&n(t[r])&&(s=!1),s){var o=Hf(t[r],e,n);for(var a in o)o.hasOwnProperty(a)&&(i[r+e+a]=o[a])}else i[r]=t[r]}return i},Gf=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0,n=t==="x"?e:e&3|8;return n.toString(16)})},Pr=function(t){return Pr.id=Pr.id||1,t===void 0?"j_"+Pr.id++:(t.id=t.id===void 0?"j_"+Pr.id++:t.id,t.id)},ex=function(t){return t.replace(/[A-Z]/g,"-$&").toLowerCase()},ot=function(t){if(t.normalized)return t;const{originalEvent:e,target:n}=t,i=e&&e.changedTouches&&e.changedTouches[0];if(i)for(let r in i)t[r]===void 0&&(t[r]=i[r]);if(n){const r=n.correspondingUseElement;r&&(t.target=r)}return t.normalized=!0,t},nx=function(t){let r=0,s=0,o=0,a=0;return"detail"in t&&(s=t.detail),"wheelDelta"in t&&(s=-t.wheelDelta/120),"wheelDeltaY"in t&&(s=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(r=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(r=s,s=0),o="deltaX"in t?t.deltaX:r*10,a="deltaY"in t?t.deltaY:s*10,(o||a)&&t.deltaMode&&(t.deltaMode==1?(o*=40,a*=40):(o*=800,a*=800)),t.deltaX===0&&t.deltaY!==0&&t.shiftKey&&(o=a,a=0,r=s,s=0),o&&!r&&(r=o<1?-1:1),a&&!s&&(s=a<1?-1:1),{spinX:r,spinY:s,deltaX:o,deltaY:a}},ix=function(t,e){return t>e?e:t<-e?-e:t},oo=function(){var t;if(typeof window<"u"&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame),!t){var e=0;t=function(n){var i=new Date().getTime(),r=Math.max(0,16-(i-e)),s=setTimeout(function(){n(i+r)},r);return e=i+r,s}}return function(n,i,...r){return t(i!==void 0?n.bind(i,...r):n)}}(),ao=function(){var t,e=typeof window<"u";return e&&(t=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame),t=t||clearTimeout,e?t.bind(window):t}(),Ue=function(t){return te(t)&&t.slice(-1)==="%"},rx=function(t,e){function n(a){var l=new RegExp("(?:\\d+(?:\\.\\d+)*)("+a+")$").exec(t);return l?l[1]:null}var i=parseFloat(t);if(Number.isNaN(i))return null;var r={};r.value=i;var s;if(e==null)s="[A-Za-z]*";else if(Array.isArray(e)){if(e.length===0)return null;s=e.join("|")}else te(e)&&(s=e);var o=n(s);return o===null?null:(r.unit=o,r)},aa=0;function m$(t,e){const n=t.split(e);let i=1;for(let r=0,s=n.length-1;r<s;r++){const o=[];(r>0||n[0]!=="")&&o.push(aa),o.push(e),(r<s-1||n[s]!=="")&&o.push(aa),n.splice(i,0,...o),i+=o.length+1}return n.filter(r=>r!=="")}function Ug(t,e){if(t===null)return e.getBBox().height;switch(t.unit){case"em":return e.getBBox().height*t.value;case"px":case"":return t.value}}const sx=function(t,e,n={},i={}){var r=e.width,s=e.height,o=i.svgDocument||k("svg").node,a=k("tspan").node,l=k("text").attr(n).append(a).node,c=document.createTextNode("");l.style.opacity=0,l.style.display="block",a.style.display="block",a.appendChild(c),o.appendChild(l),i.svgDocument||document.body.appendChild(o);const h=i.preserveSpaces,u=" ",d=i.separator||i.separator===""?i.separator:u,f=typeof d=="string"?d:u;var p=i.eol||`
`,g=i.hyphen?new RegExp(i.hyphen):/[^\w\d\u00C0-\u1FFF\u2800-\uFFFD]/,v=i.maxLineCount;Ot(v)||(v=1/0);var x=t.split(d),S=[],C=[],P,O,N;h&&k(a).attr("xml:space","preserve");for(var m=0,b=0,w=x.length;m<w;m++){var A=x[m];if(!(!A&&!h)&&typeof A=="string"){var E=!1;if(p&&A.indexOf(p)>=0)if(A.length>1){const _t=m$(x[m],p);x.splice(m,1,..._t),m--,w=x.length;continue}else{if(h&&typeof x[m-1]=="string"){x.splice(m,aa,"",aa),w+=2,m--;continue}C[++b]=!h||typeof x[m+1]=="string"?"":void 0,E=!0}if(!E){let _t;if(h?_t=C[b]!==void 0?C[b]+f+A:A:_t=C[b]?C[b]+f+A:A,c.data=_t,a.getComputedTextLength()<=r)C[b]=_t,(P||O)&&(S[b++]=!0,P=0,O=0);else{if(!C[b]||P){var M=!!P;if(P=A.length-1,M||!P){if(!P){if(!C[b]){C=[];break}x.splice(m,2,A+x[m+1]),w--,S[b++]=!0,m--;continue}x[m]=A.substring(0,P);const gt=x[m+1];x[m+1]=A.substring(P)+(gt===void 0||gt===aa?"":gt)}else{if(O)x.splice(m,2,x[m]+x[m+1]),O=0;else{var $=A.search(g);$>-1&&$!==A.length-1&&$!==0&&(O=$+1,P=0),x.splice(m,1,A.substring(0,O||P),A.substring(O||P)),w++}b&&!S[b-1]&&b--}(!h||C[b]!=="")&&m--;continue}b++,m--}}var F=null;if(C.length>v)F=v-1;else if(s!==void 0){if(N===void 0&&c.data!=="")if(n.lineHeight==="auto")N=Ug({value:1.5,unit:"em"},l);else{const _t=rx(n.lineHeight,["em","px",""]);N=Ug(_t,l)}N*C.length>s&&(F=Math.floor(s/N)-1)}if(F!==null){C.splice(F+1);var j=i.ellipsis;if(!j||F<0)break;typeof j!="string"&&(j="…");var R=C[F];if(!R&&!E)break;var H=R.length,z,B;do{if(B=R[H],z=R.substring(0,H),B?B.match(d)&&(z+=B):z+=f,z+=j,c.data=z,a.getComputedTextLength()<=r){C[F]=z;break}H--}while(H>=0);break}}}return i.svgDocument?o.removeChild(l):document.body.removeChild(o),C.join(p)},ox=function(t){const[e]=q.parseHTML("<div>"+t+"</div>");return Array.from(e.getElementsByTagName("*")).forEach(function(n){n.getAttributeNames().forEach(function(r){const s=n.getAttribute(r);(r.startsWith("on")||s.startsWith("javascript:"))&&n.removeAttribute(r)})}),e.innerHTML},ax=function(t,e){if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(t,e);else{var n=window.URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(n)}},lx=function(t,e){const n=cx(t);ax(n,e)},cx=function(t){t=t.replace(/\s/g,""),t=decodeURIComponent(t);var e=t.indexOf(","),n=t.slice(0,e),i=n.split(":")[1].split(";")[0],r=t.slice(e+1),s;n.indexOf("base64")>=0?s=atob(r):s=unescape(encodeURIComponent(r));for(var o=new Uint8Array(s.length),a=0;a<s.length;a++)o[a]=s.charCodeAt(a);return new Blob([o],{type:i})},jf=function(t,e){if(!t||t.substr(0,5)==="data:")return setTimeout(function(){e(null,t)},0);var n=function(s,o){if(s.status===200){var a=new FileReader;a.onload=function(l){var c=l.target.result;o(null,c)},a.onerror=function(){o(new Error("Failed to load image "+t))},a.readAsDataURL(s.response)}else o(new Error("Failed to load image "+t))},i=function(s,o){var a=function(f){for(var p=32768,g=[],v=0;v<f.length;v+=p)g.push(String.fromCharCode.apply(null,f.subarray(v,v+p)));return g.join("")};if(s.status===200){var l=new Uint8Array(s.response),c=t.split(".").pop()||"png",h={svg:"svg+xml"},u="data:image/"+(h[c]||c)+";base64,",d=u+btoa(a(l));o(null,d)}else o(new Error("Failed to load image "+t))},r=new XMLHttpRequest;r.open("GET",t,!0),r.addEventListener("error",function(){e(new Error("Failed to load image "+t))}),r.responseType=window.FileReader?"blob":"arraybuffer",r.addEventListener("load",function(){window.FileReader?n(r,e):i(r,e)}),r.send()},Xr=function(t){var e=q(t);if(e.length===0)throw new Error("Element not found");var n=e[0],i=n.ownerDocument,r=n.getBoundingClientRect(),s=0,o=0;if(n.ownerSVGElement){var a=k(n),l=a.getBBox({target:a.svg()});s=r.width-l.width,o=r.height-l.height}return{x:r.left+window.pageXOffset-i.documentElement.offsetLeft+s/2,y:r.top+window.pageYOffset-i.documentElement.offsetTop+o/2,width:r.width-s,height:r.height-o}},ux=function(t,e){t=q(t).toArray();var n=t.map(function(r){var s=r.parentNode,o=s.insertBefore(document.createTextNode(""),r.nextSibling);return function(){if(s===this)throw new Error("You can't sort elements if any one is a descendant of another.");s.insertBefore(this,o),s.removeChild(o)}});t.sort(e);for(var i=0;i<n.length;i++)n[i].call(t[i]);return t},os=function(t,e){var n=q(t);Kt(e,function(i,r){var s=n.find(r).addBack().filter(r);ni(i,"class")&&(s.addClass(i.class),i=Ze(i,"class")),s.attr(i)})},Ne=function(t){if(Object(t)!==t){var e=0;return isFinite(t)&&(e=+t),{top:e,right:e,bottom:e,left:e}}var n,i,r,s;return n=i=r=s=0,isFinite(t.vertical)&&(n=r=+t.vertical),isFinite(t.horizontal)&&(i=s=+t.horizontal),isFinite(t.top)&&(n=+t.top),isFinite(t.right)&&(i=+t.right),isFinite(t.bottom)&&(r=+t.bottom),isFinite(t.left)&&(s=+t.left),{top:n,right:i,bottom:r,left:s}},hx={linear:function(t){return t},quad:function(t){return t*t},cubic:function(t){return t*t*t},inout:function(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)},exponential:function(t){return Math.pow(2,10*(t-1))},bounce:function(t){for(var e=0,n=1;;e+=n,n/=2)if(t>=(7-4*e)/11){var i=(11-6*e-11*t)/4;return-i*i+n*n}},reverse:function(t){return function(e){return 1-t(1-e)}},reflect:function(t){return function(e){return .5*(e<.5?t(2*e):2-t(2-2*e))}},clamp:function(t,e,n){return e=e||0,n=n||1,function(i){var r=t(i);return r<e?e:r>n?n:r}},back:function(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}},elastic:function(t){return t||(t=1.5),function(e){return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}}},Wf={number:function(t,e){var n=e-t;return function(i){return t+n*i}},object:function(t,e){var n=Object.keys(t);return function(i){var r,s,o={};for(r=n.length-1;r!=-1;r--)s=n[r],o[s]=t[s]+(e[s]-t[s])*i;return o}},hexColor:function(t,e){var n=parseInt(t.slice(1),16),i=parseInt(e.slice(1),16),r=n&255,s=(i&255)-r,o=n&65280,a=(i&65280)-o,l=n&16711680,c=(i&16711680)-l;return function(h){var u=r+s*h&255,d=o+a*h&65280,f=l+c*h&16711680;return"#"+(1<<24|u|d|f).toString(16).slice(1)}},unit:function(t,e){var n=/(-?[0-9]*.[0-9]*)(px|em|cm|mm|in|pt|pc|%)/,i=n.exec(t),r=n.exec(e),s=r[1].indexOf("."),o=s>0?r[1].length-s-1:0;t=+i[1];var a=+r[1]-t,l=i[2];return function(c){return(t+a*c).toFixed(o)+l}}},dx={outline:function(t){var e='<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology in="SourceAlpha" result="morphedOuter" operator="dilate" radius="${outerRadius}" /><feMorphology in="SourceAlpha" result="morphedInner" operator="dilate" radius="${innerRadius}" /><feComposite result="morphedOuterColored" in="colored" in2="morphedOuter" operator="in"/><feComposite operator="xor" in="morphedOuterColored" in2="morphedInner" result="outline"/><feMerge><feMergeNode in="outline"/><feMergeNode in="SourceGraphic"/></feMerge></filter>',n=Number.isFinite(t.margin)?t.margin:2,i=Number.isFinite(t.width)?t.width:1;return Hn(e)({color:t.color||"blue",opacity:Number.isFinite(t.opacity)?t.opacity:1,outerRadius:n+i,innerRadius:n})},highlight:function(t){var e='<filter><feFlood flood-color="${color}" flood-opacity="${opacity}" result="colored"/><feMorphology result="morphed" in="SourceGraphic" operator="dilate" radius="${width}"/><feComposite result="composed" in="colored" in2="morphed" operator="in"/><feGaussianBlur result="blured" in="composed" stdDeviation="${blur}"/><feBlend in="SourceGraphic" in2="blured" mode="normal"/></filter>';return Hn(e)({color:t.color||"red",width:Number.isFinite(t.width)?t.width:1,blur:Number.isFinite(t.blur)?t.blur:0,opacity:Number.isFinite(t.opacity)?t.opacity:1})},blur:function(t){var e=Number.isFinite(t.x)?t.x:2;return Hn('<filter><feGaussianBlur stdDeviation="${stdDeviation}"/></filter>')({stdDeviation:Number.isFinite(t.y)?[e,t.y]:e})},dropShadow:function(t){var e="SVGFEDropShadowElement"in window?'<filter><feDropShadow stdDeviation="${blur}" dx="${dx}" dy="${dy}" flood-color="${color}" flood-opacity="${opacity}"/></filter>':'<filter><feGaussianBlur in="SourceAlpha" stdDeviation="${blur}"/><feOffset dx="${dx}" dy="${dy}" result="offsetblur"/><feFlood flood-color="${color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="${opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge></filter>';return Hn(e)({dx:t.dx||0,dy:t.dy||0,opacity:Number.isFinite(t.opacity)?t.opacity:1,color:t.color||"black",blur:Number.isFinite(t.blur)?t.blur:4})},grayscale:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Hn('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${b} ${h} 0 0 0 0 0 1 0"/></filter>')({a:.2126+.7874*(1-e),b:.7152-.7152*(1-e),c:.0722-.0722*(1-e),d:.2126-.2126*(1-e),e:.7152+.2848*(1-e),f:.0722-.0722*(1-e),g:.2126-.2126*(1-e),h:.0722+.9278*(1-e)})},sepia:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Hn('<filter><feColorMatrix type="matrix" values="${a} ${b} ${c} 0 0 ${d} ${e} ${f} 0 0 ${g} ${h} ${i} 0 0 0 0 0 1 0"/></filter>')({a:.393+.607*(1-e),b:.769-.769*(1-e),c:.189-.189*(1-e),d:.349-.349*(1-e),e:.686+.314*(1-e),f:.168-.168*(1-e),g:.272-.272*(1-e),h:.534-.534*(1-e),i:.131+.869*(1-e)})},saturate:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Hn('<filter><feColorMatrix type="saturate" values="${amount}"/></filter>')({amount:1-e})},hueRotate:function(t){return Hn('<filter><feColorMatrix type="hueRotate" values="${angle}"/></filter>')({angle:t.angle||0})},invert:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Hn('<filter><feComponentTransfer><feFuncR type="table" tableValues="${amount} ${amount2}"/><feFuncG type="table" tableValues="${amount} ${amount2}"/><feFuncB type="table" tableValues="${amount} ${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:1-e})},brightness:function(t){return Hn('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}"/><feFuncG type="linear" slope="${amount}"/><feFuncB type="linear" slope="${amount}"/></feComponentTransfer></filter>')({amount:Number.isFinite(t.amount)?t.amount:1})},contrast:function(t){var e=Number.isFinite(t.amount)?t.amount:1;return Hn('<filter><feComponentTransfer><feFuncR type="linear" slope="${amount}" intercept="${amount2}"/><feFuncG type="linear" slope="${amount}" intercept="${amount2}"/><feFuncB type="linear" slope="${amount}" intercept="${amount2}"/></feComponentTransfer></filter>')({amount:e,amount2:.5-e/2})}},ba={number:function(t,e,n){n=n||{currency:["$",""],decimal:".",thousands:",",grouping:[3]};var i=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,r=i.exec(t),s=r[1]||" ",o=r[2]||">",a=r[3]||"",l=r[4]||"",c=r[5],h=+r[6],u=r[7],d=r[8],f=r[9],p=1,g="",v="",x=!1;switch(d&&(d=+d.substring(1)),(c||s==="0"&&o==="=")&&(c=s="0",o="=",u&&(h-=Math.floor((h-1)/4))),f){case"n":u=!0,f="g";break;case"%":p=100,v="%",f="f";break;case"p":p=100,v="%",f="r";break;case"b":case"o":case"x":case"X":l==="#"&&(g="0"+f.toLowerCase());break;case"c":case"d":x=!0,d=0;break;case"s":p=-1,f="r";break}l==="$"&&(g=n.currency[0],v=n.currency[1]),f=="r"&&!d&&(f="g"),d!=null&&(f=="g"?d=Math.max(1,Math.min(21,d)):(f=="e"||f=="f")&&(d=Math.max(0,Math.min(20,d))));var S=c&&u;if(x&&e%1)return"";var C=e<0||e===0&&1/e<0?(e=-e,"-"):a,P=v;if(p<0){var O=this.prefix(e,d);e=O.scale(e),P=O.symbol+v}else e*=p;e=this.convert(f,e,d);var N=e.lastIndexOf("."),m=N<0?e:e.substring(0,N),b=N<0?"":n.decimal+e.substring(N+1);function w(M){for(var $=M.length,F=[],j=0,R=n.grouping[0];$>0&&R>0;)F.push(M.substring($-=R,$+R)),R=n.grouping[j=(j+1)%n.grouping.length];return F.reverse().join(n.thousands)}!c&&u&&n.grouping&&(m=w(m));var A=g.length+m.length+b.length+(S?0:C.length),E=A<h?new Array(A=h-A+1).join(s):"";return S&&(m=w(E+m)),C+=g,e=m+b,(o==="<"?C+e+E:o===">"?E+C+e:o==="^"?E.substring(0,A>>=1)+C+e+E.substring(A):C+(S?e:E+e))+P},string:function(t,e){for(var n,i="{",r=!1,s=[];(n=t.indexOf(i))!==-1;){var o,a,l;if(o=t.slice(0,n),r){a=o.split(":"),l=a.shift().split("."),o=e;for(var c=0;c<l.length;c++)o=o[l[c]];a.length&&(o=this.number(a,o))}s.push(o),t=t.slice(n+1),r=!r,i=r?"}":"{"}return s.push(t),s.join("")},convert:function(t,e,n){switch(t){case"b":return e.toString(2);case"c":return String.fromCharCode(e);case"o":return e.toString(8);case"x":return e.toString(16);case"X":return e.toString(16).toUpperCase();case"g":return e.toPrecision(n);case"e":return e.toExponential(n);case"f":return e.toFixed(n);case"r":return(e=this.round(e,this.precision(e,n))).toFixed(Math.max(0,Math.min(20,this.precision(e*(1+1e-15),n))));default:return e+""}},round:function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},precision:function(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)},prefix:function(t,e){var n=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(function(r,s){var o=Math.pow(10,Math.abs(8-s)*3);return{scale:s>8?function(a){return a/o}:function(a){return a*o},symbol:r}}),i=0;return t&&(t<0&&(t*=-1),e&&(t=this.round(t,this.precision(t,e))),i=1+Math.floor(1e-12+Math.log(t)/Math.LN10),i=Math.max(-24,Math.min(24,Math.floor((i<=0?i+1:i-1)/3)*3))),n[8+i/3]}},Hn=function(t){var e=/<%= ([^ ]+) %>|\$\{ ?([^{} ]+) ?\}|\{\{([^{} ]+)\}\}/g;return function(n){return n=n||{},t.replace(e,function(i){for(var r=Array.from(arguments),s=r.slice(1,4).find(function(l){return!!l}),o=s.split("."),a=n[o.shift()];a!==void 0&&o.length;)a=a[o.shift()];return a!==void 0?a:""})}},fx=function(t){var e=window.top.document;t=t||e.body;function n(i,r){for(var s=["webkit","moz","ms","o",""],o=0;o<s.length;o++){var a=s[o],l=a?a+r:r.substr(0,1).toLowerCase()+r.substr(1);if(i[l]!==void 0)return xt(i[l])?i[l]():i[l]}}n(e,"FullscreenElement")||n(e,"FullScreenElement")?n(e,"ExitFullscreen")||n(e,"CancelFullScreen"):n(t,"RequestFullscreen")||n(t,"RequestFullScreen")},v$=function(){};var tn={},Hg=/\s+/,_r,vs=function(t,e,n,i,r){var s=0,o;if(n&&typeof n=="object")for(i!==void 0&&("context"in r)&&r.context===void 0&&(r.context=i),o=Object.keys(n);s<o.length;s++)e=vs(t,e,o[s],n[o[s]],r);else if(n&&Hg.test(n))for(o=n.split(Hg);s<o.length;s++)e=t(e,o[s],i,r);else e=t(e,n,i,r);return e};tn.on=function(t,e,n){if(this._events=vs(y$,this._events||{},t,e,{context:n,ctx:this,listening:_r}),_r){var i=this._listeners||(this._listeners={});i[_r.id]=_r,_r.interop=!1}return this};tn.listenTo=function(t,e,n){if(!t)return this;var i=t._listenId||(t._listenId=kr("l")),r=this._listeningTo||(this._listeningTo={}),s=_r=r[i];s||(this._listenId||(this._listenId=kr("l")),s=_r=r[i]=new lu(this,t));var o=b$(t,e,n,this);if(_r=void 0,o)throw o;return s.interop&&s.on(e,n),this};var y$=function(t,e,n,i){if(n){var r=t[e]||(t[e]=[]),s=i.context,o=i.ctx,a=i.listening;a&&a.count++,r.push({callback:n,context:s,ctx:s||o,listening:a})}return t},b$=function(t,e,n,i){try{t.on(e,n,i)}catch(r){return r}};tn.off=function(t,e,n){return this._events?(this._events=vs(px,this._events,t,e,{context:n,listeners:this._listeners}),this):this};tn.stopListening=function(t,e,n){var i=this._listeningTo;if(!i)return this;for(var r=t?[t._listenId]:Object.keys(i),s=0;s<r.length;s++){var o=i[r[s]];if(!o)break;o.obj.off(e,n,this),o.interop&&o.off(e,n)}return xn(i)&&(this._listeningTo=void 0),this};var px=function(t,e,n,i){if(t){var r=i.context,s=i.listeners,o=0,a;if(!e&&!r&&!n){if(s!=null)for(a=Object.keys(s);o<a.length;o++)s[a[o]].cleanup();return}for(a=e?[e]:Object.keys(t);o<a.length;o++){e=a[o];var l=t[e];if(!l)break;for(var c=[],h=0;h<l.length;h++){var u=l[h];if(n&&n!==u.callback&&n!==u.callback._callback||r&&r!==u.context)c.push(u);else{var d=u.listening;d&&d.off(e,n)}}c.length?t[e]=c:delete t[e]}return t}};tn.once=function(t,e,n){var i=vs(gx,{},t,e,this.off.bind(this));return typeof t=="string"&&n==null&&(e=void 0),this.on(i,e,n)};tn.listenToOnce=function(t,e,n){var i=vs(gx,{},e,n,this.stopListening.bind(this,t));return this.listenTo(t,i)};var gx=function(t,e,n,i){if(n){var r=t[e]=x$(function(){i(e,r),n.apply(this,arguments)});r._callback=n}return t},x$=function(t){var e;if(typeof t!="function")throw new TypeError("Expected a function");var n=2;return function(){return--n>0&&(e=t.apply(this,arguments)),n<=1&&(t=void 0),e}};tn.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),n=Array(e),i=0;i<e;i++)n[i]=arguments[i+1];return vs(w$,this._events,t,void 0,n),this};var w$=function(t,e,n,i){if(t){var r=t[e],s=t.all;r&&s&&(s=s.slice()),r&&Gg(r,i),s&&Gg(s,[e].concat(i))}return t},Gg=function(t,e){var n,i=-1,r=t.length,s=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++i<r;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s);return;case 2:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,o);return;case 3:for(;++i<r;)(n=t[i]).callback.call(n.ctx,s,o,a);return;default:for(;++i<r;)(n=t[i]).callback.apply(n.ctx,e);return}},lu=function(t,e){this.id=t._listenId,this.listener=t,this.obj=e,this.interop=!0,this.count=0,this._events=void 0};lu.prototype.on=tn.on;lu.prototype.off=function(t,e){var n;this.interop?(this._events=vs(px,this._events,t,e,{context:void 0,listeners:void 0}),n=!this._events):(this.count--,n=this.count===0),n&&this.cleanup()};lu.prototype.cleanup=function(){delete this.listener._listeningTo[this.obj._listenId],this.interop||delete this.obj._listeners[this.id]};tn.bind=tn.on;tn.unbind=tn.off;var Yf=function(t,e){var n=this,i;return t&&ni(t,"constructor")?i=t.constructor:i=function(){return n.apply(this,arguments)},U(i,n,e),i.prototype=Object.assign(Object.create(n.prototype),t),i.prototype.constructor=i,i.__super__=n.prototype,i},_$=function(t,e,n,i){switch(e){case 1:return function(){return t[n](this[i])};case 2:return function(r){return t[n](this[i],r)};case 3:return function(r,s){return t[n](this[i],jg(r,this),s)};case 4:return function(r,s,o){return t[n](this[i],jg(r,this),s,o)};default:return function(){var r=Array.prototype.slice.call(arguments);return r.unshift(this[i]),t[n].apply(t,r)}}},S$=function(t,e,n,i){Kt(n,function(r,s){e[s]&&(t.prototype[s]=_$(e,r,s,i))})},jg=function(t,e){return xt(t)?t:Nt(t)&&!e._isModel(t)?E$(t):te(t)?function(n){return n.get(t)}:t},E$=function(t){var e=ER(t);return function(n){return e(n.attributes)}},hn=function(t,e){var n=t||{};e||(e={}),this.preinitialize.apply(this,arguments),this.cid=kr(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection);var i=Qt(this,"defaults");n=me(U({},i,n),i),this.set(n,e),this.changed={},this.initialize.apply(this,arguments)};U(hn.prototype,tn,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",preinitialize:function(){},initialize:function(){},toJSON:function(t){return be(this.attributes)},get:function(t){return this.attributes[t]},has:function(t){return this.get(t)!=null},set:function(t,e,n){if(t==null)return this;var i;if(typeof t=="object"?(i=t,n=e):(i={})[t]=e,n||(n={}),!this._validate(i,n))return!1;var r=n.unset,s=n.silent,o=[],a=this._changing;this._changing=!0,a||(this._previousAttributes=be(this.attributes),this.changed={});var l=this.attributes,c=this.changed,h=this._previousAttributes;for(var u in i)e=i[u],Ie(l[u],e)||o.push(u),Ie(h[u],e)?delete c[u]:c[u]=e,r?delete l[u]:l[u]=e;if(this.idAttribute in i){var d=this.id;this.id=this.get(this.idAttribute),this.trigger("changeId",this,d,n)}if(!s){o.length&&(this._pending=n);for(var f=0;f<o.length;f++)this.trigger("change:"+o[f],this,l[o[f]],n)}if(a)return this;if(!s)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,U({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,U({},t,{unset:!0}))},hasChanged:function(t){return t==null?!xn(this.changed):ni(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?be(this.changed):!1;var e=this._changing?this._previousAttributes:this.attributes,n={},i;for(var r in t){var s=t[r];Ie(e[r],s)||(n[r]=s,i=!0)}return i?n:!1},previous:function(t){return t==null||!this._previousAttributes?null:this._previousAttributes[t]},previousAttributes:function(){return be(this._previousAttributes)},clone:function(){return new this.constructor(this.attributes)},isValid:function(t){return this._validate({},U({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=U({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,U(e,{validationError:n})),!1):!0}});hn.extend=Yf;function Xf(t){t=mi(t);const e=ft(t).reduce(function(n,i){return n[i.id]=i.clone(),n},{});return ft(t).forEach(function(n){const i=e[n.id];if(i.isLink()){const o=i.source(),a=i.target();o.id&&e[o.id]&&i.prop("source/id",e[o.id].id),a.id&&e[a.id]&&i.prop("target/id",e[a.id].id)}const r=n.get("parent");r&&e[r]&&i.set("parent",e[r].id);const s=ft(n.get("embeds")).reduce(function(o,a){return e[a]&&o.push(e[a].id),o},[]);xn(s)||i.set("embeds",s)}),e}const T$=["checked","selected","disabled","readOnly","contentEditable","value","indeterminate"],A$=T$.reduce((t,e)=>(t[e]=!0,t),{}),C$={qualify:function(t){return Ee(t)},set:function(t,e,n){Object.keys(t).forEach(function(i){if(A$[i]&&i in n){const r=t[i];n.tagName==="SELECT"&&Array.isArray(r)?Array.from(n.options).forEach(function(s,o){s.selected=r.includes(s.value)}):n[i]=r}})}},P$=C$;function xl(t,e,n){return function(i,r){var s=Ue(i);i=parseFloat(i),s&&(i/=100);var o;if(isFinite(i)){var a=r[n]();s||i>0&&i<1?o=a[t]+r[e]*i:o=a[t]+i}var l=L();return l[t]=o||0,l}}function vr(t,e){return function(n,i){var r=Ue(n);n=parseFloat(n),r&&(n/=100);var s={};if(isFinite(n)){var o=r||n>=0&&n<=1?n*i[e]:Math.max(n+i[e],0);s[t]=o}return s}}const Nn={"ref-x":{position:xl("x","width","origin")},"ref-y":{position:xl("y","height","origin")},"ref-dx":{position:xl("x","width","corner")},"ref-dy":{position:xl("y","height","corner")},"ref-width":{set:vr("width","width")},"ref-height":{set:vr("height","height")},"ref-rx":{set:vr("rx","width")},"ref-ry":{set:vr("ry","height")},"ref-cx":{set:vr("cx","width")},"ref-cy":{set:vr("cy","height")},"ref-r-inscribed":{set:function(t){var e=vr(t,"width"),n=vr(t,"height");return function(i,r){var s=r.height>r.width?e:n;return s(i,r)}}("r")},"ref-r-circumscribed":{set:function(t,e){var n=Ue(t);t=parseFloat(t),n&&(t/=100);var i=Math.sqrt(e.height*e.height+e.width*e.width),r;return isFinite(t)&&(n||t>=0&&t<=1?r=t*i:r=Math.max(t+i,0)),{r}}}};Nn.refX=Nn["ref-x"];Nn.refY=Nn["ref-y"];Nn["ref-x2"]=Nn["ref-x"];Nn["ref-y2"]=Nn["ref-y"];Nn["ref-width2"]=Nn["ref-width"];Nn["ref-height2"]=Nn["ref-height"];Nn["ref-r"]=Nn["ref-r-inscribed"];const I$=Nn,Wi={x:"x",y:"y",width:"w",height:"h",minimum:"s",maximum:"l",diagonal:"d"},O$=Object.keys(Wi).map(t=>Wi[t]).join(""),Xu="[-+]?[0-9]*\\.?[0-9]+(?:[eE][-+]?[0-9]+)?",k$=/\s/g,Wg=new RegExp(`^(${Xu}\\*)?([${O$}])(/${Xu})?([-+]{1,2}${Xu})?$`,"g");function mx(t){throw new Error(`Invalid calc() expression: ${t}`)}function L$(t,e){const n=Wg.exec(t.replace(k$,""));n||mx(t),Wg.lastIndex=0;const[,i,r,s,o]=n,{x:a,y:l,width:c,height:h}=e;let u=0;switch(r){case Wi.width:{u=c;break}case Wi.height:{u=h;break}case Wi.x:{u=a;break}case Wi.y:{u=l;break}case Wi.minimum:{u=Math.min(h,c);break}case Wi.maximum:{u=Math.max(h,c);break}case Wi.diagonal:{u=Math.sqrt(h*h+c*c);break}}return i&&(u*=parseFloat(i)),s&&(u/=parseFloat(s.slice(1))),o&&(u+=M$(o)),u}function M$(t){if(!t)return 0;const[e]=t;switch(e){case"+":return parseFloat(t.substr(1));case"-":return-parseFloat(t.substr(1))}return parseFloat(t)}function or(t){return typeof t=="string"&&t.includes("calc")}const vx="calc(",Yg=vx.length;function ar(t,e){let n=t,i=0;do{let r=n.indexOf(vx,i);if(r===-1)return n;let s=r+Yg,o=1;t:do{switch(n[s]){case"(":{o++;break}case")":{if(o--,o===0)break t;break}case void 0:mx(n)}s++}while(!0);let a=n.slice(r+Yg,s);or(a)&&(a=ar(a,e));const l=String(L$(a,e));n=n.slice(0,r)+l+n.slice(s+1),i=r+l.length}while(!0)}function Os(t,e,n){return n.text!==void 0}const yx={"line-height":{qualify:Os},"text-vertical-anchor":{qualify:Os},"text-path":{qualify:Os},annotations:{qualify:Os},eol:{qualify:Os},"display-empty":{qualify:Os},text:{qualify:function(t,e,n){const i=n["text-wrap"];return!i||!Ee(i)},set:function(t,e,n,i){const r="joint-text",s=q.data.get(n,r),o=i["line-height"],a=i["text-vertical-anchor"],l=i["display-empty"],c=i["font-size"],h=i.annotations,u=i.eol,d=i.x;let f=i["text-path"];const p=JSON.stringify([t,o,h,a,u,l,f,d,c]);if(s===void 0||s!==p){if(c&&n.setAttribute("font-size",c),Nt(f)){const g=f.selector;if(typeof g=="string"){const v=this.findNode(g);v instanceof SVGPathElement&&(f=U({"xlink:href":"#"+v.id},f))}}k(n).text(""+t,{lineHeight:o,annotations:h,textPath:f,x:d,textVerticalAnchor:a,eol:u,displayEmpty:l}),q.data.set(n,r,p)}}},"text-wrap":{qualify:Ee,set:function(t,e,n,i){var r={},s=t.width||0;Ue(s)?r.width=e.width*parseFloat(s)/100:or(s)?r.width=Number(ar(s,e)):t.width===null?r.width=1/0:s<=0?r.width=e.width+s:r.width=s;var o=t.height||0;Ue(o)?r.height=e.height*parseFloat(o)/100:or(o)?r.height=Number(ar(o,e)):t.height===null||(o<=0?r.height=e.height+o:r.height=o);var a,l=t.text;l===void 0&&(l=i.text),l!==void 0?a=(t.breakText||sx)(""+l,r,{"font-weight":i["font-weight"],"font-size":i["font-size"],"font-family":i["font-family"],lineHeight:i["line-height"],"letter-spacing":i["letter-spacing"]},{svgDocument:this.paper.svg,ellipsis:t.ellipsis,hyphen:t.hyphen,separator:t.separator,maxLineCount:t.maxLineCount,preserveSpaces:t.preserveSpaces}):a="",yx.text.set.call(this,a,e,n,i)}},title:{qualify:function(t,e){return e instanceof SVGElement},set:function(t,e,n){var i="joint-title",r=q.data.get(n,i);if(r===void 0||r!==t){if(q.data.set(n,i,t),n.tagName==="title"){n.textContent=t;return}var s=n.firstElementChild;if(s&&s.tagName==="title")s.textContent=t;else{var o=document.createElementNS(n.namespaceURI,"title");o.textContent=t,n.insertBefore(o,s)}}}}},D$=yx;function wl(t,e){var n=new L(1,0);return function(i){var r,s,o=this[t](i);return o?(s=e.rotate?o.vector().vectorAngle(n):0,r=o.start):(r=this.path.start,s=0),s===0?{transform:"translate("+r.x+","+r.y+")"}:{transform:"translate("+r.x+","+r.y+") rotate("+s+")"}}}function jo(){return this.model.isLink()}const xa={connection:{qualify:jo,set:function({stubs:t=0}){let e;if(isFinite(t)&&t!==0){let n;t<0?n=(this.getConnectionLength()+t)/2:n=t;const i=this.getConnection(),r=this.getConnectionSubdivisions(),s=i.divideAtLength(n,{segmentSubdivisions:r}),o=i.divideAtLength(-n,{segmentSubdivisions:r});s&&o&&(e=`${s[0].serialize()} ${o[1].serialize()}`)}return{d:e||this.getSerializedConnection()}}},"at-connection-length-keep-gradient":{qualify:jo,set:wl("getTangentAtLength",{rotate:!0})},"at-connection-length-ignore-gradient":{qualify:jo,set:wl("getTangentAtLength",{rotate:!1})},"at-connection-ratio-keep-gradient":{qualify:jo,set:wl("getTangentAtRatio",{rotate:!0})},"at-connection-ratio-ignore-gradient":{qualify:jo,set:wl("getTangentAtRatio",{rotate:!1})}};xa["at-connection-length"]=xa["at-connection-length-keep-gradient"];xa["at-connection-ratio"]=xa["at-connection-ratio-keep-gradient"];const N$=xa;function bx(t,e){var n="joint-shape",i=e&&e.resetOffset;return function(r,s,o){var a=q.data.get(o,n);if(!a||a.value!==r){var l=t(r);a={value:r,shape:l,shapeBBox:l.bbox()},q.data.set(o,n,a)}var c=a.shape.clone(),h=a.shapeBBox.clone(),u=h.origin(),d=s.origin();h.x=d.x,h.y=d.y;var f=s.maxRectScaleToFit(h,d),p=h.width===0||s.width===0?1:f.sx,g=h.height===0||s.height===0?1:f.sy;return c.scale(p,g,u),i&&c.translate(-u.x,-u.y),c}}function Xg(t){function e(i){return new K(k.normalizePathData(i))}var n=bx(e,t);return function(i,r,s){var o=n(i,r,s);return{d:o.serialize()}}}function qg(t){var e=bx(Ae,t);return function(n,i,r){var s=e(n,i,r);return{points:s.serialize()}}}const wa={"ref-d-reset-offset":{set:Xg({resetOffset:!0})},"ref-d-keep-offset":{set:Xg({resetOffset:!1})},"ref-points-reset-offset":{set:qg({resetOffset:!0})},"ref-points-keep-offset":{set:qg({resetOffset:!1})}};wa["ref-d"]=wa["ref-d-reset-offset"];wa["ref-points"]=wa["ref-points-reset-offset"];const R$=wa;function qu(t){var e={},n=t.stroke;typeof n=="string"&&(e.stroke=n,e.fill=n);var i=t["stroke-opacity"];return i===void 0&&(i=t.opacity),i!==void 0&&(e["stroke-opacity"]=i,e["fill-opacity"]=i),e}function Kg(t){const{paper:e}=this;return`url(#${t.type==="pattern"?e.definePattern(t):e.defineGradient(t)})`}const $$={"source-marker":{qualify:Ee,set:function(t,e,n,i){return t=U(qu(i),t),{"marker-start":"url(#"+this.paper.defineMarker(t)+")"}}},"target-marker":{qualify:Ee,set:function(t,e,n,i){return t=U(qu(i),{transform:"rotate(180)"},t),{"marker-end":"url(#"+this.paper.defineMarker(t)+")"}}},"vertex-marker":{qualify:Ee,set:function(t,e,n,i){return t=U(qu(i),t),{"marker-mid":"url(#"+this.paper.defineMarker(t)+")"}}},fill:{qualify:Ee,set:Kg},stroke:{qualify:Ee,set:Kg},filter:{qualify:Ee,set:function(t){return"url(#"+this.paper.defineFilter(t)+")"}}},B$=$$;function Zg(t,e,n){return function(i,r){var s;i==="middle"?s=r[e]/2:i===n?s=r[e]:isFinite(i)?s=i>-1&&i<1?-r[e]*i:-i:Ue(i)?s=r[e]*parseFloat(i)/100:s=0;var o=new L;return o[t]=-(r[t]+s),o}}const F$={"x-alignment":{offset:Zg("x","width","right")},"y-alignment":{offset:Zg("y","height","bottom")},"reset-offset":{offset:function(t,e){return t?{x:-e.x,y:-e.y}:{x:0,y:0}}}},V$=F$;function Jg(t){return function(n,i,r){const s=k(r);s.attr(t)!==n&&s.attr(t,n)}}const ys={ref:{},href:{set:Jg("href")},"xlink:href":{set:Jg("xlink:href")},port:{set:function(t){return t===null||t.id===void 0?t:t.id}},style:{qualify:Ee,set:function(t,e,n){q(n).css(t)}},html:{set:function(t,e,n){q(n).html(t+"")}},props:P$};U(ys,I$);U(ys,D$);U(ys,N$);U(ys,R$);U(ys,B$);U(ys,V$);const Po=ys,z$=function(t,e){if(Array.isArray(t))return e},rn=hn.extend({constructor:function(t,e){var n,i=t||{};if(typeof this.preinitialize=="function"&&this.preinitialize.apply(this,arguments),this.cid=kr("c"),this.attributes={},e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(i=this.parse(i,e)||{}),n=Qt(this,"defaults")){const r=e&&e.mergeArrays===!0?!1:z$;i=_e({},n,i,r)}this.set(i,e),this.changed={},this.initialize.apply(this,arguments)},translate:function(t,e,n){throw new Error("Must define a translate() method.")},toJSON:function(){const e=Qt(this.constructor.prototype,"defaults").attrs||{},n=this.attributes.attrs,i={};Kt(n,function(s,o){const a=e[o];Kt(s,function(l,c){Nt(l)&&!Array.isArray(l)?Kt(l,function(h,u){(!a||!a[c]||!Ie(a[c][u],h))&&(i[o]=i[o]||{},(i[o][c]||(i[o][c]={}))[u]=h)}):(!a||!Ie(a[c],l))&&(i[o]=i[o]||{},i[o][c]=l)})});const r=ke(Ze(this.attributes,"attrs"));return r.attrs=i,r},initialize:function(t){const e=this.getIdAttribute();(!t||t[e]===void 0)&&this.set(e,this.generateId(),{silent:!0}),this._transitionIds={},this._scheduledTransitionIds={},this.processPorts(),this.on("change:attrs",this.processPorts,this)},getIdAttribute:function(){return this.idAttribute||"id"},generateId:function(){return Gf()},processPorts:function(){var t=this.ports,e={};Kt(this.get("attrs"),function(s,o){s&&s.port&&(s.port.id!==void 0?e[s.port.id]=s.port:e[s.port]={id:s.port})});var n={};if(Kt(t,function(s,o){e[o]||(n[o]=!0)}),this.graph&&!xn(n)){var i=this.graph.getConnectedLinks(this,{inbound:!0});i.forEach(function(s){n[s.get("target").port]&&s.remove()});var r=this.graph.getConnectedLinks(this,{outbound:!0});r.forEach(function(s){n[s.get("source").port]&&s.remove()})}this.ports=e},remove:function(t={}){const{graph:e,collection:n}=this;if(!e)return n&&n.remove(this,t),this;e.startBatch("remove");const i=this.getParentCell();i&&i.unembed(this,t);const r=this.getEmbeddedCells();for(let s=0,o=r.length;s<o;s++){const a=r[s];a&&a.remove(t)}return this.trigger("remove",this,e.attributes.cells,t),e.stopBatch("remove"),this},toFront:function(t){var e=this.graph;if(e){t=me(t||{},{foregroundEmbeds:!0});let n;t.deep?(n=this.getEmbeddedCells({deep:!0,breadthFirst:t.breadthFirst!==!1,sortSiblings:t.foregroundEmbeds}),n.unshift(this)):n=[this];const i=t.foregroundEmbeds?n:Je(n,l=>l.z());let s=e.maxZIndex()-n.length+1;const o=e.get("cells");let a=o.toArray().indexOf(i[0])!==o.length-n.length;a||(a=i.some(function(l,c){return l.z()!==s+c})),a&&(this.startBatch("to-front"),s=s+n.length,i.forEach(function(l,c){l.set("z",s+c,t)}),this.stopBatch("to-front"))}return this},toBack:function(t){var e=this.graph;if(e){t=me(t||{},{foregroundEmbeds:!0});let i;t.deep?(i=this.getEmbeddedCells({deep:!0,breadthFirst:t.breadthFirst!==!1,sortSiblings:t.foregroundEmbeds}),i.unshift(this)):i=[this];const r=t.foregroundEmbeds?i:Je(i,a=>a.z());let s=e.minZIndex();var n=e.get("cells");let o=n.toArray().indexOf(r[0])!==0;o||(o=r.some(function(a,l){return a.z()!==s+l})),o&&(this.startBatch("to-back"),s-=i.length,r.forEach(function(a,l){a.set("z",s+l,t)}),this.stopBatch("to-back"))}return this},parent:function(t,e){return t===void 0?this.get("parent"):this.set("parent",t,e)},embed:function(t,e){const n=Array.isArray(t)?t:[t];if(!this.canEmbed(n))throw new Error("Recursive embedding not allowed.");if(n.some(i=>i.isEmbedded()&&this.id!==i.parent()))throw new Error("Embedding of already embedded cells is not allowed.");return this._embedCells(n,e),this},unembed:function(t,e){const n=Array.isArray(t)?t:[t];return this._unembedCells(n,e),this},canEmbed:function(t){return(Array.isArray(t)?t:[t]).every(n=>this!==n&&!this.isEmbeddedIn(n))},_embedCells:function(t,e){const n="embed";this.startBatch(n);const i=U([],this.get("embeds"));t.forEach(r=>{i[r.isLink()?"unshift":"push"](r.id),r.parent(this.id,e)}),this.set("embeds",mi(i),e),this.stopBatch(n)},_unembedCells:function(t,e){const n="unembed";this.startBatch(n),t.forEach(i=>i.unset("parent",e)),this.set("embeds",io(this.get("embeds"),...t.map(i=>i.id)),e),this.stopBatch(n)},getParentCell:function(){var t=this.parent(),e=this.graph;return t&&e&&e.getCell(t)||null},getAncestors:function(){var t=[];if(!this.graph)return t;for(var e=this.getParentCell();e;)t.push(e),e=e.getParentCell();return t},getEmbeddedCells:function(t){if(t=t||{},!this.graph)return[];if(t.deep)return t.breadthFirst?this._getEmbeddedCellsBfs(t.sortSiblings):this._getEmbeddedCellsDfs(t.sortSiblings);const e=this.get("embeds");if(xn(e))return[];let n=e.map(this.graph.getCell,this.graph);return t.sortSiblings&&(n=Je(n,i=>i.z())),n},_getEmbeddedCellsBfs:function(t){const e=[],n=[];for(n.push(this);n.length>0;){const i=n.shift();e.push(i);const r=i.getEmbeddedCells({sortSiblings:t});n.push(...r)}return e.shift(),e},_getEmbeddedCellsDfs:function(t){const e=[],n=[];for(n.push(this);n.length>0;){const i=n.pop();e.push(i);const r=i.getEmbeddedCells({sortSiblings:t});for(let s=r.length-1;s>=0;--s)n.push(r[s])}return e.shift(),e},isEmbeddedIn:function(t,e){var n=te(t)?t:t.id,i=this.parent();if(e=U({deep:!0},e),this.graph&&e.deep){for(;i;){if(i===n)return!0;i=this.graph.getCell(i).parent()}return!1}else return i===n},isEmbedded:function(){return!!this.parent()},clone:function(t){if(t=t||{},t.deep)return ft(Xf([this].concat(this.getEmbeddedCells({deep:!0}))));var e=hn.prototype.clone.apply(this,arguments);return e.set(this.getIdAttribute(),this.generateId()),e.unset("embeds"),e.unset("parent"),e},prop:function(t,e,n){var i="/",r=te(t);if(r||Array.isArray(t))if(arguments.length>1){var s,o;r?(s=t,o=s.split("/")):(s=t.join(i),o=t.slice());var a=o[0],l=o.length;const C=n||{};C.propertyPath=s,C.propertyValue=e,C.propertyPathArray=o,"rewrite"in C||(C.rewrite=!1);for(var c={},h=c,u=a,d=1;d<l;d++){var f=o[d],p=Number.isFinite(r?Number(f):f);h=h[u]=p?[]:{},u=f}c=so(c,o,e,"/");var g=_e({},this.attributes);C.rewrite&&Yh(g,s,"/");var v=_e(g,c);return this.set(a,v[a],C)}else return fn(this.attributes,t,i);const x=e||{};x.propertyPath=null,x.propertyValue=t,x.propertyPathArray=[],"rewrite"in x||(x.rewrite=!1);const S={};for(const C in t){const{changedValue:P}=_e({},{changedValue:this.attributes[C]},{changedValue:t[C]});S[C]=P}return this.set(S,x)},removeProp:function(t,e){e=e||{};var n=Array.isArray(t)?t:t.split("/"),i=n[0];if(i==="attrs"&&(e.dirty=!0),n.length===1)return this.unset(t,e);var r=n.slice(1),s=this.get(i);return s==null?this:(s=ke(s),Yh(s,r,"/"),this.set(i,s,e))},attr:function(t,e,n){var i=Array.from(arguments);return i.length===0?this.get("attrs"):(Array.isArray(t)?i[0]=["attrs"].concat(t):te(t)?i[0]="attrs/"+t:i[0]={attrs:t},this.prop.apply(this,i))},removeAttr:function(t,e){return Array.isArray(t)?this.removeProp(["attrs"].concat(t)):this.removeProp("attrs/"+t,e)},transition:function(t,e,n,i){i=i||"/";var r={duration:100,delay:10,timingFunction:hx.linear,valueFunction:Wf.number};n=U(r,n);var s=0,o,a=(function(u){var d,f,p;s=s||u,u-=s,f=u/n.duration,f<1?this._transitionIds[t]=d=oo(a):(f=1,delete this._transitionIds[t]),p=o(n.timingFunction(f)),n.transitionId=d,this.prop(t,p,n),d||this.trigger("transition:end",this,t)}).bind(this);const{_scheduledTransitionIds:l}=this;let c;var h=u=>{l[t]&&(l[t]=io(l[t],c),l[t].length===0&&delete l[t]),this.stopPendingTransitions(t,i),o=n.valueFunction(fn(this.attributes,t,i),e),this._transitionIds[t]=oo(u),this.trigger("transition:start",this,t)};return c=setTimeout(h,n.delay,a),l[t]||(l[t]=[]),l[t].push(c),c},getTransitions:function(){return cc(Object.keys(this._transitionIds),Object.keys(this._scheduledTransitionIds))},stopScheduledTransitions:function(t,e="/"){const{_scheduledTransitionIds:n={}}=this;let i=Object.keys(n);if(t){const r=t.split(e);i=i.filter(s=>Ie(r,s.split(e).slice(0,r.length)))}return i.forEach(r=>{n[r].forEach(o=>clearTimeout(o)),delete n[r]}),this},stopPendingTransitions(t,e="/"){const{_transitionIds:n={}}=this;let i=Object.keys(n);if(t){const r=t.split(e);i=i.filter(s=>Ie(r,s.split(e).slice(0,r.length)))}i.forEach(r=>{const s=n[r];ao(s),delete n[r],this.trigger("transition:end",this,r)})},stopTransitions:function(t,e="/"){return this.stopScheduledTransitions(t,e),this.stopPendingTransitions(t,e),this},addTo:function(t,e){return t.addCell(this,e),this},findView:function(t){return t.findViewByModel(this)},isElement:function(){return!1},isLink:function(){return!1},startBatch:function(t,e){return this.graph&&this.graph.startBatch(t,U({},e,{cell:this})),this},stopBatch:function(t,e){return this.graph&&this.graph.stopBatch(t,U({},e,{cell:this})),this},getChangeFlag:function(t){var e=0;if(!t)return e;for(var n in t)!t.hasOwnProperty(n)||!this.hasChanged(n)||(e|=t[n]);return e},angle:function(){return 0},position:function(){return new L(0,0)},z:function(){return this.get("z")||0},getPointFromConnectedLink:function(){return new L},getBBox:function(){return new J(0,0,0,0)},getPointRotatedAroundCenter(t,e,n){const i=new L(e,n);return t&&i.rotate(this.getBBox().center(),t),i},getAbsolutePointFromRelative(t,e){return this.getPointRotatedAroundCenter(-this.angle(),this.position().offset(t,e))},getRelativePointFromAbsolute(t,e){return this.getPointRotatedAroundCenter(this.angle(),t,e).difference(this.position())}},{getAttributeDefinition:function(t){var e=this.attributes,n=Po;return e&&e[t]||n[t]},define:function(t,e,n,i){n=U({defaults:$i({type:t},e,this.prototype.defaults)},n);var r=this.extend(n,i);return typeof joint<"u"&&ni(joint,"shapes")&&so(joint.shapes,t,r,"."),r}}),xx=function(t,e,n){if(te(n)){if(!dc[n])throw new Error('Unknown wrapper: "'+n+'"');n=dc[n]}if(!xt(n))throw new Error("Wrapper must be a function.");ft(e).forEach(function(i){t[i]=n(t[i])})},dc={cells:function(t){return function(){var e=Array.from(arguments),n=e.length,i=n>0&&e[0]||[],r=n>1&&e[n-1]||{};return Array.isArray(i)||(r instanceof rn?i=e:i instanceof rn&&(e.length>1&&e.pop(),i=e)),r instanceof rn&&(r={}),t.call(this,i,r)}}};function U$(t,...e){const n=[];return t.forEach((r,s)=>{n.push(r),s in e&&n.push(e[s])}),H$(n.join(""))}function H$(t){const e=new DOMParser,n=`<svg>${t.trim()}</svg>`;if(e.parseFromString(n.replace(/@/g,""),"application/xml").getElementsByTagName("parsererror")[0])throw new Error("Invalid SVG markup");const s=e.parseFromString(n,"text/html").querySelector("svg");return G$(s)}function wx(t){const e={},{tagName:n,attributes:i,namespaceURI:r,style:s,childNodes:o}=t;e.namespaceURI=r,e.tagName=r===k.namespace.xhtml?n.toLowerCase():n;const a={};for(var l=s.length;l--;){var c=s[l];a[c]=s.getPropertyValue(c)}e.style=a;const h=i.getNamedItem("@selector");h&&(e.selector=h.value,i.removeNamedItem("@selector"));const u=i.getNamedItem("@group-selector");if(u){const g=u.value.split(",");e.groupSelector=g.map(v=>v.trim()),i.removeNamedItem("@group-selector")}const d=i.getNamedItem("class");d&&(e.className=d.value);const f=[];o.forEach(g=>{switch(g.nodeType){case Node.TEXT_NODE:{const v=g.data.replace(/\s\s+/g," ");v.trim()&&f.push(v);break}case Node.ELEMENT_NODE:{f.push(wx(g));break}}}),f.length&&(e.children=f);const p={};return Array.from(i).forEach(g=>{const{name:v,value:x}=g;p[v]=x}),Object.keys(p).length>0&&(e.attributes=p),e}function G$(t){const e=[];return Array.from(t.children).forEach(n=>{e.push(wx(n))}),e}const je={TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left",TOP_LEFT:"top-left",TOP_RIGHT:"top-right",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",CENTER:"center"};function ns(t,e){const n=new J(t);switch(e){case void 0:throw new Error("Position required");case je.LEFT:case"leftMiddle":return n.leftMiddle();case je.RIGHT:case"rightMiddle":return n.rightMiddle();case je.TOP:case"topMiddle":return n.topMiddle();case je.BOTTOM:case"bottomMiddle":return n.bottomMiddle();case je.TOP_LEFT:case"topLeft":case"origin":return n.topLeft();case je.TOP_RIGHT:case"topRight":return n.topRight();case je.BOTTOM_LEFT:case"bottomLeft":return n.bottomLeft();case je.BOTTOM_RIGHT:case"bottomRight":case"corner":return n.bottomRight();case je.CENTER:return n.center();default:throw new Error(`Unknown position: ${e}`)}}const j$=Object.freeze(Object.defineProperty({__proto__:null,addClassNamePrefix:En,assign:U,bindAll:ln,breakText:sx,camelCase:ja,cancelFrame:ao,cap:ix,clone:be,cloneCells:Xf,cloneDeep:ke,dataUriToBlob:cx,debounce:Ga,deepMixin:TR,deepSupplement:z0,defaults:me,defaultsDeep:$i,difference:G0,downloadBlob:ax,downloadDataUri:lx,filter:dx,flattenDeep:H0,flattenObject:Hf,forIn:Kt,format:ba,getByPath:fn,getElementBBox:Xr,getRectPoint:ns,groupBy:Vf,guid:Pr,has:ni,hashCode:Qo,imageToDataUri:jf,interpolate:Wf,intersection:Wh,invoke:We,invokeProperty:U0,isBoolean:Ff,isEmpty:xn,isEqual:Ie,isFunction:xt,isNumber:Ot,isObject:Nt,isPercentage:Ue,isPlainObject:Ee,isString:te,merge:_e,mixin:F0,nextFrame:oo,noop:v$,normalizeEvent:ot,normalizeSides:Ne,normalizeWheel:nx,omit:Ze,parseCssNumeric:rx,parseDOMJSON:ya,pick:uc,removeClassNamePrefix:g$,result:Qt,sanitizeHTML:ox,setAttributesBySelector:os,setByPath:so,sortBy:Je,sortElements:ux,sortedIndex:ou,supplement:V0,svg:U$,template:Hn,timing:hx,toArray:ft,toKebabCase:ex,toggleFullScreen:fx,union:cc,uniq:mi,uniqueId:kr,unsetByPath:Yh,uuid:Gf,without:io,wrapWith:xx,wrappers:dc},Symbol.toStringTag,{value:"Module"}));function _x(t,e,n){var i=t.toJSON();return i.angle=e||0,me({},n,i)}function Wa(t,e,n,i){return t.map(function(r,s,o){var a=this.pointAt((s+.5)/o.length);return(r.dx||r.dy)&&a.offset(r.dx||0,r.dy||0),_x(a.round(),0,qf(i,r))},ts(e,n))}function Sx(t,e,n,i){var r=e.center(),s=e.width/e.height,o=e.topMiddle(),a=Ln.fromRect(e);return t.map(function(l,c,h){var u=n+i(c,h.length),d=o.clone().rotate(r,-u).scale(s,1,r),f=l.compensateRotation?-a.tangentTheta(d):0;return(l.dx||l.dy)&&d.offset(l.dx||0,l.dy||0),l.dr&&d.move(r,l.dr),_x(d.round(),f,qf(e,l))})}function qf(t,e){let{x:n,y:i,angle:r}=e;return Ue(n)?n=parseFloat(n)/100*t.width:or(n)&&(n=Number(ar(n,t))),Ue(i)?i=parseFloat(i)/100*t.height:or(i)&&(i=Number(ar(i,t))),{x:n,y:i,angle:r}}function Xh(t,e){const{x:n,y:i}=qf(t,e);return new L(n||0,i||0)}const W$=function(t,e){return t.map(n=>{const i=Xh(e,n).round().toJSON();return i.angle=n.angle||0,i})},Y$=function(t,e,n){return n.fn(t,e,n)},X$=function(t,e,n){var i=Xh(e,n.start||e.origin()),r=Xh(e,n.end||e.corner());return Wa(t,i,r,e)},q$=function(t,e,n){return Wa(t,e.origin(),e.bottomLeft(),e)},K$=function(t,e,n){return Wa(t,e.topRight(),e.corner(),e)},Z$=function(t,e,n){return Wa(t,e.origin(),e.topRight(),e)},J$=function(t,e,n){return Wa(t,e.bottomLeft(),e.corner(),e)},Q$=function(t,e,n){var i=n.startAngle||0,r=n.step||360/t.length;return Sx(t,e,i,function(s){return s*r})},t3=function(t,e,n){var i=n.startAngle||0,r=n.step||20;return Sx(t,e,i,function(s,o){return(s+.5-o/2)*r})},Ex=Object.freeze(Object.defineProperty({__proto__:null,absolute:W$,bottom:J$,ellipse:t3,ellipseSpread:Q$,fn:Y$,left:q$,line:X$,right:K$,top:Z$},Symbol.toStringTag,{value:"Module"}));function Nr(t,e){return $i({},t,e,{x:0,y:0,angle:0,attrs:{}})}function Tx(t){var e=t.center(),n=e.theta(t.origin()),i=e.theta(t.bottomLeft()),r=e.theta(t.corner()),s=e.theta(t.topRight());return[n,s,r,i]}function Ax(t,e,n,i){i=me({},i,{offset:15});var r=e.center().theta(t),s,o,a,l,c=i.offset,h=0;const[u,d,f,p]=Tx(e);r<d||r>f?(a=".3em",s=c,o=0,l="start"):r<u?(s=0,o=-c,n?(h=-90,l="start",a=".3em"):(l="middle",a="0")):r<p?(a=".3em",s=-c,o=0,l="end"):(s=0,o=c,n?(h=90,l="start",a=".3em"):(l="middle",a=".6em"));var g=Math.round;return Nr(i,{x:g(s),y:g(o),angle:h,attrs:{labelText:{y:a,textAnchor:l}}})}function Cx(t,e,n,i){i=me({},i,{offset:15});var r=e.center().theta(t),s,o,a,l,c=i.offset,h=0;const[u,d,f,p]=Tx(e);r<d||r>f?(a=".3em",s=-c,o=0,l="end"):r<u?(s=0,o=c,n?(h=90,l="start",a=".3em"):(l="middle",a=".6em")):r<p?(a=".3em",s=c,o=0,l="start"):(s=0,o=-c,n?(h=-90,l="start",a=".3em"):(l="middle",a="0"));var g=Math.round;return Nr(i,{x:g(s),y:g(o),angle:h,attrs:{labelText:{y:a,textAnchor:l}}})}function Px(t,e,n){n=me({},n,{offset:20});var i=re(0,0),r=-t.theta(i),s=r,o=t.clone().move(i,n.offset).difference(t).round(),a=".3em",l;(r+90)%180===0?(l=e?"end":"middle",!e&&r===-270&&(a="0em")):r>-270&&r<-90?(l="start",s=r-180):l="end";var c=Math.round;return Nr(n,{x:c(o.x),y:c(o.y),angle:e?s:0,attrs:{labelText:{y:a,textAnchor:l}}})}const e3=function(t,e,n){return Nr(n)},n3=function(t,e,n){return Nr(n,{x:-15,attrs:{labelText:{y:".3em",textAnchor:"end"}}})},i3=function(t,e,n){return Nr(n,{x:15,attrs:{labelText:{y:".3em",textAnchor:"start"}}})},r3=function(t,e,n){return Nr(n,{y:-15,attrs:{labelText:{y:"0",textAnchor:"middle"}}})},s3=function(t,e,n){return Nr(n,{y:15,attrs:{labelText:{y:".6em",textAnchor:"middle"}}})},o3=function(t,e,n){return Ax(t,e,!0,n)},a3=function(t,e,n){return Ax(t,e,!1,n)},l3=function(t,e,n){return Cx(t,e,!0,n)},c3=function(t,e,n){return Cx(t,e,!1,n)},u3=function(t,e,n){return Px(t.difference(e.center()),!1,n)},h3=function(t,e,n){return Px(t.difference(e.center()),!0,n)},Ix=Object.freeze(Object.defineProperty({__proto__:null,bottom:s3,inside:c3,insideOriented:l3,left:n3,manual:e3,outside:a3,outsideOriented:o3,radial:u3,radialOriented:h3,right:i3,top:r3},Symbol.toStringTag,{value:"Module"}));var Ox=function(t){var e=ke(t)||{};this.ports=[],this.groups={},this.portLayoutNamespace=Ex,this.portLabelLayoutNamespace=Ix,this._init(e)};Ox.prototype={getPorts:function(){return this.ports},getGroup:function(t){return this.groups[t]||{}},getPortsByGroup:function(t){return this.ports.filter(function(e){return e.group===t})},getGroupPortsMetrics:function(t,e){var n=this.getGroup(t),i=this.getPortsByGroup(t),r=n.position||{},s=r.name,o=this.portLayoutNamespace;o[s]||(s="left");var a=r.args||{},l=i.map(function(u){return u&&u.position&&u.position.args}),c=o[s](l,e,a),h={ports:i,result:[]};return ft(c).reduce((function(u,d,f){var p=u.ports[f];return u.result.push({portId:p.id,portTransformation:d,labelTransformation:this._getPortLabelLayout(p,L(d),e),portAttrs:p.attrs,portSize:p.size,labelSize:p.label.size}),u}).bind(this),h),h.result},_getPortLabelLayout:function(t,e,n){var i=this.portLabelLayoutNamespace,r=t.label.position.name||"left";return i[r]?i[r](e,n,t.label.position.args):null},_init:function(t){if(Nt(t.groups))for(var e=Object.keys(t.groups),n=0,i=e.length;n<i;n++){var r=e[n];this.groups[r]=this._evaluateGroup(t.groups[r])}for(var s=ft(t.items),o=0,a=s.length;o<a;o++)this.ports.push(this._evaluatePort(s[o]))},_evaluateGroup:function(t){return _e(t,{position:this._getPosition(t.position,!0),label:this._getLabel(t,!0)})},_evaluatePort:function(t){var e=U({},t),n=this.getGroup(t.group);return e.markup=e.markup||n.markup,e.attrs=_e({},n.attrs,e.attrs),e.position=this._createPositionNode(n,e),e.label=_e({},n.label,this._getLabel(e)),e.z=this._getZIndex(n,e),e.size=U({},n.size,e.size),e},_getZIndex:function(t,e){return Ot(e.z)?e.z:Ot(t.z)||t.z==="auto"?t.z:"auto"},_createPositionNode:function(t,e){return _e({name:"left",args:{}},t.position,{args:e.args})},_getPosition:function(t,e){var n={},i;xt(t)?(i="fn",n.fn=t):te(t)?i=t:t===void 0?i=e?"left":null:Array.isArray(t)?(i="absolute",n.x=t[0],n.y=t[1]):Nt(t)&&(i=t.name,U(n,t.args));var r={args:n};return i&&(r.name=i),r},_getLabel:function(t,e){var n=t.label||{},i=n;return i.position=this._getPosition(n.position,e),i}};const d3={_initializePorts:function(){this._createPortData(),this.on("change:ports",function(){this._processRemovedPort(),this._createPortData()},this)},_processRemovedPort:function(){var t=this.get("ports")||{},e={};ft(t.items).forEach(function(a){e[a.id]=!0});var n=this.previous("ports")||{},i={};ft(n.items).forEach(function(a){e[a.id]||(i[a.id]=!0)});var r=this.graph;if(r&&!xn(i)){var s=r.getConnectedLinks(this,{inbound:!0});s.forEach(function(a){i[a.get("target").port]&&a.remove()});var o=r.getConnectedLinks(this,{outbound:!0});o.forEach(function(a){i[a.get("source").port]&&a.remove()})}},hasPorts:function(){var t=this.prop("ports/items");return Array.isArray(t)&&t.length>0},hasPort:function(t){return this.getPortIndex(t)!==-1},getPorts:function(){return ke(this.prop("ports/items"))||[]},getGroupPorts:function(t){const e=ft(this.prop(["ports","items"])).filter(n=>n.group===t);return ke(e)},getPort:function(t){return ke(ft(this.prop("ports/items")).find(function(e){return e.id&&e.id===t}))},getPortsPositions:function(t){var e=this._portSettingsData.getGroupPortsMetrics(t,J(this.size()));return e.reduce(function(n,i){var r=i.portTransformation;return n[i.portId]={x:r.x,y:r.y,angle:r.angle},n},{})},getPortIndex:function(t){var e=Nt(t)?t.id:t;return this._isValidPortId(e)?ft(this.prop("ports/items")).findIndex(function(n){return n.id===e}):-1},addPort:function(t,e){if(!Nt(t)||Array.isArray(t))throw new Error("Element: addPort requires an object.");var n=U([],this.prop("ports/items"));return n.push(t),this.prop("ports/items",n,e),this},insertPort:function(t,e,n){const i=typeof t=="number"?t:this.getPortIndex(t);if(!Nt(e)||Array.isArray(e))throw new Error("dia.Element: insertPort requires an object.");const r=U([],this.prop("ports/items"));return r.splice(i,0,e),this.prop("ports/items",r,n),this},portProp:function(t,e,n,i){var r=this.getPortIndex(t);if(r===-1)throw new Error("Element: unable to find port with id "+t);var s=Array.prototype.slice.call(arguments,1);return Array.isArray(e)?s[0]=["ports","items",r].concat(e):te(e)?s[0]=["ports/items/",r,"/",e].join(""):(s=["ports/items/"+r],Ee(e)&&(s.push(e),s.push(n))),this.prop.apply(this,s)},_validatePorts:function(){var t=this.get("ports")||{},e=[];t=t||{};var n=ft(t.items);return n.forEach(function(i){typeof i!="object"&&e.push("Element: invalid port ",i),this._isValidPortId(i.id)||(i.id=this.generatePortId())},this),mi(n,"id").length!==n.length&&e.push("Element: found id duplicities in ports."),e},generatePortId:function(){return this.generateId()},_isValidPortId:function(t){return t!=null&&!Nt(t)},addPorts:function(t,e){return t.length&&this.prop("ports/items",U([],this.prop("ports/items")).concat(t),e),this},removePort:function(t,e){const n=e||{},i=this.getPortIndex(t);if(i!==-1){const r=U([],this.prop(["ports","items"]));r.splice(i,1),n.rewrite=!0,this.startBatch("port-remove"),this.prop(["ports","items"],r,n),this.stopBatch("port-remove")}return this},removePorts:function(t,e){let n,i;if(Array.isArray(t)){if(n=e||{},t.length===0)return this.this;i=U([],this.prop(["ports","items"])).filter(function(s){return!t.some(function(o){const a=Nt(o)?o.id:o;return s.id===a})})}else n=t||{},i=[];return this.startBatch("port-remove"),n.rewrite=!0,this.prop(["ports","items"],i,n),this.stopBatch("port-remove"),this},_createPortData:function(){var t=this._validatePorts();if(t.length>0)throw this.set("ports",this.previous("ports")),new Error(t.join(" "));var e;this._portSettingsData&&(e=this._portSettingsData.getPorts()),this._portSettingsData=new Ox(this.get("ports"));var n=this._portSettingsData.getPorts();if(e){var i=n.filter(function(s){if(!e.find(function(o){return o.id===s.id}))return s}),r=e.filter(function(s){if(!n.find(function(o){return o.id===s.id}))return s});r.length>0&&this.trigger("ports:remove",this,r),i.length>0&&this.trigger("ports:add",this,i)}}},f3={portContainerMarkup:"g",portMarkup:[{tagName:"circle",selector:"circle",attributes:{r:10,fill:"#FFFFFF",stroke:"#000000"}}],portLabelMarkup:[{tagName:"text",selector:"text",attributes:{fill:"#000000"}}],_portElementsCache:null,_initializePorts:function(){this._cleanPortsCache()},_refreshPorts:function(){this._removePorts(),this._cleanPortsCache(),this._renderPorts()},_cleanPortsCache:function(){this._portElementsCache={}},_renderPorts:function(){for(var t=[],e=this._getContainerElement(),n=0,i=e.node.childNodes.length;n<i;n++)t.push(e.node.childNodes[n]);var r=Vf(this.model._portSettingsData.getPorts(),"z"),s="auto";ft(r[s]).forEach(function(h){var u=this._getPortElement(h);e.append(u),t.push(u)},this);for(var o=Object.keys(r),a=0;a<o.length;a++){var l=o[a];if(l!==s){var c=parseInt(l,10);this._appendPorts(r[l],c,t)}}this._updatePorts()},_getContainerElement:function(){return this.rotatableNode||this.vel},_appendPorts:function(t,e,n){var i=this._getContainerElement(),r=ft(t).map(this._getPortElement,this);n[e]||e<0?k(n[Math.max(e,0)]).before(r):i.append(r)},_getPortElement:function(t){return this._portElementsCache[t.id]?this._portElementsCache[t.id].portElement:this._createPortElement(t)},findPortNodes:function(t,e){const n=this._portElementsCache[t];if(!n)return[];if(!e)return[n.portContentElement.node];const i=n.portElement.node,r=n.portSelectors;return this.findBySelector(e,i,r)},findPortNode:function(t,e){const[n=null]=this.findPortNodes(t,e);return n},_updatePorts:function(){this._updatePortGroup(void 0);var t=Object.keys(this.model._portSettingsData.groups);t.forEach(this._updatePortGroup,this)},_removePorts:function(){We(this._portElementsCache,"portElement.remove")},_createPortElement:function(t){let e,n,i,r;var s=k(this.portContainerMarkup).addClass("joint-port"),o=this._getPortMarkup(t);if(Array.isArray(o)){var a=this.parseDOMJSON(o,s.node),l=a.fragment;l.childNodes.length>1?e=k("g").append(l):e=k(l.firstChild),r=a.selectors}else e=k(o),Array.isArray(e)&&(e=k("g").append(e));if(!e)throw new Error("ElementView: Invalid port markup.");e.attr({port:t.id,"port-group":t.group});const c=this._getPortLabelMarkup(t.label);if(Array.isArray(c)){const{fragment:g,selectors:v}=this.parseDOMJSON(c,s.node),x=g.childNodes.length;x>0&&(i=v,n=x===1?k(g.firstChild):k("g").append(g))}else n=k(c),Array.isArray(n)&&(n=k("g").append(n));var h;if(r&&i){for(var u in i)if(r[u]&&u!==this.selector)throw new Error("ElementView: selectors within port must be unique.");h=U({},r,i)}else h=r||i||{};const d="portRoot",f="labelRoot",p="labelText";if(d in h||(h[d]=e.node),n){const g=n.node;if(f in h||(h[f]=g),!(p in h)){const v=n.tagName()==="TEXT"?g:Array.from(g.querySelectorAll("text"));h[p]=v,i||(i={}),i[p]=v}}return s.append(e.addClass("joint-port-body")),n&&s.append(n.addClass("joint-port-label")),this._portElementsCache[t.id]={portElement:s,portLabelElement:n,portSelectors:h,portLabelSelectors:i,portContentElement:e,portContentSelectors:r},s},_updatePortGroup:function(t){for(var e=J(this.model.size()),n=this.model._portSettingsData.getGroupPortsMetrics(t,e),i=0,r=n.length;i<r;i++){var s=n[i],o=s.portId,a=this._portElementsCache[o]||{},l=s.portTransformation,c=s.labelTransformation;c&&a.portLabelElement&&(this.updateDOMSubtreeAttributes(a.portLabelElement.node,c.attrs,{rootBBox:new J(s.labelSize),selectors:a.portLabelSelectors}),this.applyPortTransform(a.portLabelElement,c,-l.angle||0)),this.updateDOMSubtreeAttributes(a.portElement.node,s.portAttrs,{rootBBox:new J(s.portSize),selectors:a.portSelectors}),this.applyPortTransform(a.portElement,l)}},applyPortTransform:function(t,e,n){var i=k.createSVGMatrix().rotate(n||0).translate(e.x||0,e.y||0).rotate(e.angle||0);t.transform(i,{absolute:!0})},_getPortMarkup:function(t){return t.markup||this.model.get("portMarkup")||this.model.portMarkup||this.portMarkup},_getPortLabelMarkup:function(t){return t.markup||this.model.get("portLabelMarkup")||this.model.portLabelMarkup||this.portLabelMarkup}},Xt=rn.extend({defaults:{position:{x:0,y:0},size:{width:1,height:1},angle:0},initialize:function(){this._initializePorts(),rn.prototype.initialize.apply(this,arguments)},_initializePorts:function(){},_refreshPorts:function(){},isElement:function(){return!0},position:function(t,e,n){const i=Ot(e);n=(i?n:t)||{};const{parentRelative:r,deep:s,restrictedArea:o}=n;let a;if(r){if(!this.graph)throw new Error("Element must be part of a graph.");const l=this.getParentCell();l&&!l.isLink()&&(a=l.get("position"))}if(i){if(a&&(t+=a.x,e+=a.y),s||o){const{x:l,y:c}=this.get("position");this.translate(t-l,e-c,n)}else this.set("position",{x:t,y:e},n);return this}else{const l=L(this.get("position"));return r?l.difference(a):l}},translate:function(t,e,n){if(t=t||0,e=e||0,t===0&&e===0)return this;n=n||{},n.translateBy=n.translateBy||this.id;var i=this.get("position")||{x:0,y:0},r=n.restrictedArea;if(r&&n.translateBy===this.id)if(typeof r=="function"){var s=r.call(this,i.x+t,i.y+e,n);t=s.x-i.x,e=s.y-i.y}else{var o=this.getBBox({deep:!0}),a=i.x-o.x,l=i.y-o.y,c=Math.max(r.x+a,Math.min(r.x+r.width+a-o.width,i.x+t)),h=Math.max(r.y+l,Math.min(r.y+r.height+l-o.height,i.y+e));t=c-i.x,e=h-i.y}var u={x:i.x+t,y:i.y+e};return n.tx=t,n.ty=e,n.transition?(Nt(n.transition)||(n.transition={}),this.transition("position",u,U({},n.transition,{valueFunction:Wf.object})),We(this.getEmbeddedCells(),"translate",t,e,n)):(this.startBatch("translate",n),this.set("position",u,n),We(this.getEmbeddedCells(),"translate",t,e,n),this.stopBatch("translate",n)),this},size:function(t,e,n){var i=this.get("size");return t===void 0?{width:i.width,height:i.height}:(Nt(t)&&(n=e,e=Ot(t.height)?t.height:i.height,t=Ot(t.width)?t.width:i.width),this.resize(t,e,n))},resize:function(t,e,n){if(n=n||{},this.startBatch("resize",n),n.direction){var i=this.get("size");switch(n.direction){case"left":case"right":e=i.height;break;case"top":case"bottom":t=i.width;break}var r=Qe(this.get("angle")||0),s=this.getBBox(),o;if(r){var a={"top-right":0,right:0,"top-left":1,top:1,"bottom-left":2,left:2,"bottom-right":3,bottom:3}[n.direction];n.absolute&&(a+=Math.floor((r+45)/90),a%=4);var l=s[["bottomLeft","corner","topRight","origin"][a]](),c=L(l).rotate(s.center(),-r),h=Math.sqrt(t*t+e*e)/2,u=a*Math.PI/2;u+=Math.atan(a%2==0?e/t:t/e),u-=an(r);var d=L.fromPolar(h,u,c);o=L(d).offset(t/-2,e/-2)}else switch(o=s.topLeft(),n.direction){case"top":case"top-right":o.offset(0,s.height-e);break;case"left":case"bottom-left":o.offset(s.width-t,0);break;case"top-left":o.offset(s.width-t,s.height-e);break}this.set("size",{width:t,height:e},n),this.position(o.x,o.y,n)}else this.set("size",{width:t,height:e},n);return this.stopBatch("resize",n),this},scale:function(t,e,n,i){var r=this.getBBox().scale(t,e,n);return this.startBatch("scale",i),this.position(r.x,r.y,i),this.resize(r.width,r.height,i),this.stopBatch("scale"),this},fitEmbeds:function(t){return this.fitToChildren(t)},fitToChildren:function(t={}){const{graph:e}=this;if(!e)throw new Error("Element must be part of a graph.");const n=this.getEmbeddedCells().filter(i=>i.isElement());return n.length===0?this:(this.startBatch("fit-embeds",t),t.deep&&We(n,"fitToChildren",t),this._fitToElements(Object.assign({elements:n},t)),this.stopBatch("fit-embeds"),this)},fitParent:function(t={}){const{graph:e}=this;if(!e)throw new Error("Element must be part of a graph.");if(t.deep&&t.terminator&&(t.terminator===this||t.terminator===this.id))return this;const n=this.getParentCell();if(!n||!n.isElement())return this;const i=n.getEmbeddedCells().filter(r=>r.isElement());return i.length===0?this:(this.startBatch("fit-parent",t),n._fitToElements(Object.assign({elements:i},t)),t.deep&&n.fitParent(t),this.stopBatch("fit-parent"),this)},_fitToElements:function(t={}){const e=this.graph.getCellsBBox(t.elements);if(!e)return;const{expandOnly:n,shrinkOnly:i}=t;if(n&&i)return;let{x:r,y:s,width:o,height:a}=e;const{left:l,right:c,top:h,bottom:u}=Ne(t.padding);r-=l,s-=h,o+=l+c,a+=u+h;let d=new J(r,s,o,a);if(n)d=this.getBBox().union(d);else if(i){const f=this.getBBox().intersect(d);if(!f)return;d=f}this.set({position:{x:d.x,y:d.y},size:{width:d.width,height:d.height}},t)},rotate:function(t,e,n,i){if(n){var r=this.getBBox().center(),s=this.get("size"),o=this.get("position");r.rotate(n,this.get("angle")-t);var a=r.x-s.width/2-o.x,l=r.y-s.height/2-o.y;this.startBatch("rotate",{angle:t,absolute:e,origin:n}),this.position(o.x+a,o.y+l,i),this.rotate(t,e,null,i),this.stopBatch("rotate")}else this.set("angle",e?t:(this.get("angle")+t)%360,i);return this},angle:function(){return Qe(this.get("angle")||0)},getBBox:function(t={}){const{graph:e,attributes:n}=this,{deep:i,rotate:r}=t;if(i&&e){const u=this.getEmbeddedCells({deep:!0,breadthFirst:!0});return u.push(this),e.getCellsBBox(u,t)}const{angle:s=0,position:{x:o,y:a},size:{width:l,height:c}}=n,h=new J(o,a,l,c);return r&&h.rotateAroundCenter(s),h},getPointFromConnectedLink:function(t,e){var n=this.getBBox(),i=n.center(),r=t.get(e);if(!r)return i;var s=r.port;if(!s||!this.hasPort(s))return i;var o=this.portProp(s,["group"]),a=this.getPortsPositions(o),l=new L(a[s]).offset(n.origin()),c=this.angle();return c&&l.rotate(i,-c),l}});U(Xt.prototype,d3);const dr=rn.extend({defaultLabel:void 0,labelMarkup:void 0,_builtins:{defaultLabel:{markup:[{tagName:"rect",selector:"rect"},{tagName:"text",selector:"text"}],attrs:{text:{fill:"#000000",fontSize:14,textAnchor:"middle",textVerticalAnchor:"middle",pointerEvents:"none"},rect:{ref:"text",fill:"#ffffff",rx:3,ry:3,x:"calc(x)",y:"calc(y)",width:"calc(w)",height:"calc(h)"}},position:{distance:.5}}},defaults:{source:{},target:{}},isLink:function(){return!0},disconnect:function(t){return this.set({source:{x:0,y:0},target:{x:0,y:0}},t)},source:function(t,e,n){if(t===void 0)return be(this.get("source"));var i,r,s=t instanceof rn;if(s)return i=be(e)||{},i.id=t.id,r=n,this.set("source",i,r);var o=!Ee(t);return o?(i=be(e)||{},i.x=t.x,i.y=t.y,r=n,this.set("source",i,r)):(i=t,r=e,this.set("source",i,r))},target:function(t,e,n){if(t===void 0)return be(this.get("target"));var i,r,s=t instanceof rn;if(s)return i=be(e)||{},i.id=t.id,r=n,this.set("target",i,r);var o=!Ee(t);return o?(i=be(e)||{},i.x=t.x,i.y=t.y,r=n,this.set("target",i,r)):(i=t,r=e,this.set("target",i,r))},router:function(t,e,n){if(t===void 0){var i=this.get("router");return i?typeof i=="object"?be(i):i:null}var r=typeof t=="object"||typeof t=="function",s=r?t:{name:t,args:e},o=r?e:n;return this.set("router",s,o)},connector:function(t,e,n){if(t===void 0){var i=this.get("connector");return i?typeof i=="object"?be(i):i:null}var r=typeof t=="object"||typeof t=="function",s=r?t:{name:t,args:e},o=r?e:n;return this.set("connector",s,o)},label:function(t,e,n){var i=this.labels();return t=isFinite(t)&&t!==null?t|0:0,t<0&&(t=i.length+t),arguments.length<=1?this.prop(["labels",t]):this.prop(["labels",t],e,n)},labels:function(t,e){return arguments.length===0?(t=this.get("labels"),Array.isArray(t)?t.slice():[]):(Array.isArray(t)||(t=[]),this.set("labels",t,e))},hasLabels:function(){const{labels:t}=this.attributes;return Array.isArray(t)&&t.length>0},insertLabel:function(t,e,n){if(!e)throw new Error("dia.Link: no label provided");var i=this.labels(),r=i.length;return t=isFinite(t)&&t!==null?t|0:r,t<0&&(t=r+t+1),i.splice(t,0,e),this.labels(i,n)},appendLabel:function(t,e){return this.insertLabel(-1,t,e)},removeLabel:function(t,e){var n=this.labels();return t=isFinite(t)&&t!==null?t|0:-1,n.splice(t,1),this.labels(n,e)},vertex:function(t,e,n){var i=this.vertices();if(t=isFinite(t)&&t!==null?t|0:0,t<0&&(t=i.length+t),arguments.length<=1)return this.prop(["vertices",t]);var r=this._normalizeVertex(e);return this.prop(["vertices",t],r,n)},vertices:function(t,e){if(arguments.length===0)return t=this.get("vertices"),Array.isArray(t)?t.slice():[];Array.isArray(t)||(t=[]);for(var n=[],i=0;i<t.length;i++){var r=t[i],s=this._normalizeVertex(r);n.push(s)}return this.set("vertices",n,e)},insertVertex:function(t,e,n){if(!e)throw new Error("dia.Link: no vertex provided");var i=this.vertices(),r=i.length;t=isFinite(t)&&t!==null?t|0:r,t<0&&(t=r+t+1);var s=this._normalizeVertex(e);return i.splice(t,0,s),this.vertices(i,n)},removeVertex:function(t,e){var n=this.vertices();return t=isFinite(t)&&t!==null?t|0:-1,n.splice(t,1),this.vertices(n,e)},_normalizeVertex:function(t){var e=!Ee(t);return e?{x:t.x,y:t.y}:t},translate:function(t,e,n){return n=n||{},n.translateBy=n.translateBy||this.id,n.tx=t,n.ty=e,this.applyToPoints(function(i){return{x:(i.x||0)+t,y:(i.y||0)+e}},n)},scale:function(t,e,n,i){return this.applyToPoints(function(r){return L(r).scale(t,e,n).toJSON()},i)},applyToPoints:function(t,e){if(!xt(t))throw new TypeError("dia.Link: applyToPoints expects its first parameter to be a function.");var n={},{source:i,target:r}=this.attributes;i.id||(n.source=t(i)),r.id||(n.target=t(r));var s=this.vertices();return s.length>0&&(n.vertices=s.map(t)),this.set(n,e)},getSourcePoint:function(){var t=this.getSourceCell();return t?t.getPointFromConnectedLink(this,"source"):new L(this.source())},getTargetPoint:function(){var t=this.getTargetCell();return t?t.getPointFromConnectedLink(this,"target"):new L(this.target())},getPointFromConnectedLink:function(){return this.getPolyline().pointAt(.5)},getPolyline:function(){const t=[this.getSourcePoint(),...this.vertices().map(L),this.getTargetPoint()];return new Ae(t)},getBBox:function(){return this.getPolyline().bbox()},reparent:function(t){var e;if(this.graph){var n=this.getSourceElement(),i=this.getTargetElement(),r=this.getParentCell();n&&i&&(n===i||n.isEmbeddedIn(i)?e=i:i.isEmbeddedIn(n)?e=n:e=this.graph.getCommonAncestor(n,i)),r&&(!e||e.id!==r.id)&&r.unembed(this,t),e&&e.embed(this,t)}return e},hasLoop:function(t){t=t||{};var{source:e,target:n}=this.attributes,i=e.id,r=n.id;if(!i||!r)return!1;var s=i===r;if(!s&&t.deep&&this.graph){var o=this.getSourceCell(),a=this.getTargetCell();s=o.isEmbeddedIn(a)||a.isEmbeddedIn(o)}return s},getSourceCell:function(){const{graph:t,attributes:e}=this;var n=e.source;return n&&n.id&&t&&t.getCell(n.id)||null},getSourceElement:function(){var t=this,e={};do{if(e[t.id])return null;e[t.id]=!0,t=t.getSourceCell()}while(t&&t.isLink());return t},getTargetCell:function(){const{graph:t,attributes:e}=this;var n=e.target;return n&&n.id&&t&&t.getCell(n.id)||null},getTargetElement:function(){var t=this,e={};do{if(e[t.id])return null;e[t.id]=!0,t=t.getTargetCell()}while(t&&t.isLink());return t},getRelationshipAncestor:function(){var t;if(this.graph){var e=[this,this.getSourceElement(),this.getTargetElement()].filter(function(n){return!!n});t=this.graph.getCommonAncestor.apply(this.graph,e)}return t||null},isRelationshipEmbeddedIn:function(t){var e=te(t)||Ot(t)?t:t.id,n=this.getRelationshipAncestor();return!!n&&(n.id===e||n.isEmbeddedIn(e))},_getDefaultLabel:function(){var t=this.get("defaultLabel")||this.defaultLabel||{},e={};return e.markup=t.markup||this.get("labelMarkup")||this.labelMarkup,e.position=t.position,e.attrs=t.attrs,e.size=t.size,e}},{endsEqual:function(t,e){var n=t.port===e.port||!t.port&&!e.port;return t.id===e.id&&n}}),qr={_results:{},_tests:{svgforeignobject:function(){return!!document.createElementNS&&/SVGForeignObject/.test({}.toString.call(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")))}},addTest:function(t,e){return this._tests[t]=e},test:function(t){var e=this._tests[t];if(!e)throw new Error('Test not defined ("'+t+'"). Use `joint.env.addTest(name, fn) to add a new test.`');var n=this._results[t];if(typeof n<"u")return n;try{n=e()}catch{n=!1}return this._results[t]=n,n}},p3=Xt.define("standard.Rectangle",{attrs:{root:{cursor:"move"},body:{width:"calc(w)",height:"calc(h)",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}]}),g3=Xt.define("standard.Circle",{attrs:{root:{cursor:"move"},body:{cx:"calc(s/2)",cy:"calc(s/2)",r:"calc(s/2)",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"circle",selector:"body"},{tagName:"text",selector:"label"}]}),m3=Xt.define("standard.Ellipse",{attrs:{root:{cursor:"move"},body:{cx:"calc(w/2)",cy:"calc(h/2)",rx:"calc(w/2)",ry:"calc(h/2)",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"body"},{tagName:"text",selector:"label"}]}),v3=Xt.define("standard.Path",{attrs:{root:{cursor:"move"},body:{d:"M 0 0 H calc(w) V calc(h) H 0 Z",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"text",selector:"label"}]}),y3=Xt.define("standard.Polygon",{attrs:{root:{cursor:"move"},body:{points:"0 0 calc(w) 0 calc(w) calc(h) 0 calc(h)",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"}]}),b3=Xt.define("standard.Polyline",{attrs:{root:{cursor:"move"},body:{points:"0 0 calc(w) 0 calc(w) calc(h) 0 calc(h)",strokeWidth:2,stroke:"#333333",fill:"#FFFFFF"},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"polyline",selector:"body"},{tagName:"text",selector:"label"}]}),x3=Xt.define("standard.Image",{attrs:{root:{cursor:"move"},image:{width:"calc(w)",height:"calc(h)"},label:{textVerticalAnchor:"top",textAnchor:"middle",x:"calc(w/2)",y:"calc(h+10)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),w3=Xt.define("standard.BorderedImage",{attrs:{root:{cursor:"move"},border:{width:"calc(w)",height:"calc(h)",stroke:"#333333",strokeWidth:2},background:{width:"calc(w-1)",height:"calc(h-1)",x:.5,y:.5,fill:"#FFFFFF"},image:{width:"calc(w-1)",height:"calc(h-1)",x:.5,y:.5},label:{textVerticalAnchor:"top",textAnchor:"middle",x:"calc(w/2)",y:"calc(h+10)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"background",attributes:{stroke:"none"}},{tagName:"image",selector:"image"},{tagName:"rect",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),_3=Xt.define("standard.EmbeddedImage",{attrs:{root:{cursor:"move"},body:{width:"calc(w)",height:"calc(h)",stroke:"#333333",fill:"#FFFFFF",strokeWidth:2},image:{width:"calc(0.3*w)",height:"calc(h-20)",x:10,y:10,preserveAspectRatio:"xMidYMin"},label:{textVerticalAnchor:"top",textAnchor:"left",x:"calc(0.3*w+20)",y:10,fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"image",selector:"image"},{tagName:"text",selector:"label"}]}),S3=Xt.define("standard.InscribedImage",{attrs:{root:{cursor:"move"},border:{rx:"calc(w/2)",ry:"calc(h/2)",cx:"calc(w/2)",cy:"calc(h/2)",stroke:"#333333",strokeWidth:2},background:{rx:"calc(w/2)",ry:"calc(h/2)",cx:"calc(w/2)",cy:"calc(h/2)",fill:"#FFFFFF"},image:{width:"calc(0.68*w)",height:"calc(0.68*h)",x:"calc(0.16*w)",y:"calc(0.16*h)",preserveAspectRatio:"xMidYMid"},label:{textVerticalAnchor:"top",textAnchor:"middle",x:"calc(w/2)",y:"calc(h+10)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"image"},{tagName:"ellipse",selector:"border",attributes:{fill:"none"}},{tagName:"text",selector:"label"}]}),E3=Xt.define("standard.HeaderedRectangle",{attrs:{root:{cursor:"move"},body:{width:"calc(w)",height:"calc(h)",strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},header:{width:"calc(w)",height:30,strokeWidth:2,stroke:"#000000",fill:"#FFFFFF"},headerText:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:15,fontSize:16,fill:"#333333"},bodyText:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h/2+15)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerText"},{tagName:"text",selector:"bodyText"}]});var Ku=10;const T3=Xt.define("standard.Cylinder",{attrs:{root:{cursor:"move"},body:{lateralArea:Ku,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},top:{cx:"calc(w/2)",cy:Ku,rx:"calc(w/2)",ry:Ku,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{textVerticalAnchor:"middle",textAnchor:"middle",x:"calc(w/2)",y:"calc(h+15)",fontSize:14,fill:"#333333"}}},{markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],topRy:function(t,e){if(t===void 0)return this.attr("body/lateralArea");var n={lateralArea:t},i=Ue(t),r=i?`calc(${parseFloat(t)/100}*h)`:t,s={cy:r,ry:r};return this.attr({body:n,top:s},e)}},{attributes:{"lateral-area":{set:function(t,e){var n=Ue(t);n&&(t=parseFloat(t)/100);var i=e.x,r=e.y,s=e.width,o=e.height,a=s/2,l=n?o*t:t,c=k.KAPPA,h=c*a,u=c*(n?o*t:t),d=i,f=i+s/2,p=i+s,g=r+l,v=g-l,x=r+o-l,S=r+o,C=["M",d,g,"L",d,x,"C",i,x+u,f-h,S,f,S,"C",f+h,S,p,x+u,p,x,"L",p,g,"C",p,g-u,f+h,v,f,v,"C",f-h,v,d,g-u,d,g,"Z"];return{d:C.join(" ")}}}}});var A3={tagName:"foreignObject",selector:"foreignObject",attributes:{overflow:"hidden"},children:[{tagName:"div",namespaceURI:"http://www.w3.org/1999/xhtml",selector:"label",style:{width:"100%",height:"100%",position:"static",backgroundColor:"transparent",textAlign:"center",margin:0,padding:"0px 5px",boxSizing:"border-box",display:"flex",alignItems:"center",justifyContent:"center"}}]},C3={tagName:"text",selector:"label",attributes:{"text-anchor":"middle"}},P3=qr.test("svgforeignobject")?A3:C3;const I3=Xt.define("standard.TextBlock",{attrs:{root:{cursor:"move"},body:{width:"calc(w)",height:"calc(h)",stroke:"#333333",fill:"#ffffff",strokeWidth:2},foreignObject:{width:"calc(w)",height:"calc(h)"},label:{style:{fontSize:14}}}},{markup:[{tagName:"rect",selector:"body"},P3]},{attributes:{text:{set:function(t,e,n,i){if(n instanceof HTMLElement)n.textContent=t;else{var r=i.style||{},s={text:t,width:-5,height:"100%"},o=U({"text-vertical-anchor":"middle"},r);return Po["text-wrap"].set.call(this,s,e,n,o),{fill:r.color||null}}},position:function(t,e,n){if(n instanceof SVGElement)return e.center()}}}}),O3=dr.define("standard.Link",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 10 -5 0 0 10 5 z"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),k3=dr.define("standard.DoubleLink",{attrs:{line:{connection:!0,stroke:"#DDDDDD",strokeWidth:4,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"#000000",d:"M 10 -3 10 -10 -2 0 10 10 10 3"}},outline:{connection:!0,stroke:"#000000",strokeWidth:6,strokeLinejoin:"round"}}},{markup:[{tagName:"path",selector:"outline",attributes:{fill:"none",cursor:"pointer"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),L3=dr.define("standard.ShadowLink",{attrs:{line:{connection:!0,stroke:"#FF0000",strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",stroke:"none",d:"M 0 -10 -10 0 0 10 z"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}},shadow:{connection:!0,transform:"translate(3,6)",stroke:"#000000",strokeOpacity:.2,strokeWidth:20,strokeLinejoin:"round",targetMarker:{type:"path",d:"M 0 -10 -10 0 0 10 z",stroke:"none"},sourceMarker:{type:"path",stroke:"none",d:"M -10 -10 0 0 -10 10 0 10 0 -10 z"}}}},{markup:[{tagName:"path",selector:"shadow",attributes:{fill:"none","pointer-events":"none"}},{tagName:"path",selector:"line",attributes:{fill:"none",cursor:"pointer"}}]}),M3=Object.freeze(Object.defineProperty({__proto__:null,BorderedImage:w3,Circle:g3,Cylinder:T3,DoubleLink:k3,Ellipse:m3,EmbeddedImage:_3,HeaderedRectangle:E3,Image:x3,InscribedImage:S3,Link:O3,Path:v3,Polygon:y3,Polyline:b3,Rectangle:p3,ShadowLink:L3,TextBlock:I3},Symbol.toStringTag,{value:"Module"})),Bs={POINT:"point",CUBIC:"cubic",LINE:"line",GAP:"gap"},D3=Object.values(Bs),N3=10,R3=1,Kf=function(t,e,n=[],i={}){const{cornerType:r=Bs.POINT,cornerRadius:s=N3,cornerPreserveAspectRatio:o=!1,precision:a=R3,raw:l=!1}=i;if(D3.indexOf(r)===-1)throw new Error("Invalid `cornerType` provided to `straight` connector.");let c;if(r===Bs.POINT||!s){const h=[t].concat(n).concat([e]),u=new Ae(h);c=new K(u)}else{c=new K,c.appendSegment(K.createSegment("M",t));let h;const u=n.length;for(let d=0;d<u;d++){const f=new L(n[d]),p=n[d-1]||t,g=n[d+1]||e,v=h||f.distance(p)/2;h=f.distance(g)/2;let x,S;o?x=S=-Math.min(s,v,h):(x=-Math.min(s,v),S=-Math.min(s,h));const C=f.clone().move(p,x).round(a),P=f.clone().move(g,S).round(a);switch(c.appendSegment(K.createSegment("L",C)),r){case Bs.CUBIC:{const O=.3333333333333333,N=2/3,m=new L(O*C.x+N*f.x,N*f.y+O*C.y),b=new L(O*P.x+N*f.x,N*f.y+O*P.y);c.appendSegment(K.createSegment("C",m,b,P));break}case Bs.LINE:{c.appendSegment(K.createSegment("L",P));break}case Bs.GAP:{c.appendSegment(K.createSegment("M",P));break}}}c.appendSegment(K.createSegment("L",e))}return l?c:c.serialize()};var $3=5,Qg=["arc","gap","cubic"],B3=0,tm=1,F3=["smooth"],_l=1/3,Sl=2/3;function em(t,e){let{x:n,y:i}=t,{x:r,y:s}=e;if(n>r){let o=n;n=r,r=o,o=i,i=s,s=o}if(i>s){let o=n;n=r,r=o,o=i,i=s,s=o}return[new L(n,i),new L(r,s)]}function V3(t,e){const[{x:n,y:i},{x:r,y:s}]=em(t.start,t.end),[{x:o,y:a},{x:l,y:c}]=em(e.start,e.end),h=n<=l&&o<=r,u=i<=c&&a<=s;return h&&u}function Zu(t,e,n){var i=[].concat(t,n,e);return i.reduce(function(r,s,o){var a=i[o+1];return a!=null&&(r[o]=ts(s,a)),r},[])}function z3(t){var e=t.paper,n=e._jumpOverUpdateList;if(n==null){n=e._jumpOverUpdateList=[];var i=e.model;i.on("batch:stop",function(){this.hasActiveBatch()||U3(e)}),i.on("reset",function(){n=e._jumpOverUpdateList=[]})}n.indexOf(t)<0&&(n.push(t),t.listenToOnce(t.model,"change:connector remove",function(){n.splice(n.indexOf(t),1)}))}function U3(t){for(var e=t._jumpOverUpdateList,n=0;n<e.length;n++){const i=e[n],r=i.getFlag(i.constructor.Flags.CONNECTOR);i.requestUpdate(r)}}function H3(t,e){return ft(e).reduce(function(n,i){var r=t.intersection(i);return r&&n.push(r),n},[])}function nm(t,e){return ts(t,e).squaredLength()}function G3(t,e,n){return e.reduce(function(i,r,s){if(r.skip===!0)return i;var o=i.pop()||t,a=re(r).move(o.start,-n),l=re(r).move(o.start,+n),c=e[s+1];if(c!=null){var h=l.distance(c);h<=n&&(l=c.move(o.start,h),c.skip=!0)}else{var u=a.distance(o.end);if(u<n*2+tm)return i.push(o),i}var d=l.distance(o.start);if(d<n*2+tm)return i.push(o),i;var f=ts(a,l);return f.isJump=!0,i.push(ts(o.start,a),f,ts(l,o.end)),i},[])}function im(t,e,n,i){var r=new K,s;return s=K.createSegment("M",t[0].start),r.appendSegment(s),ft(t).forEach(function(o,a){if(o.isJump){var l,c,h,u;if(n==="arc"){l=-90,c=o.start.difference(o.end);var d=+(c.x<0||c.x===0&&c.y<0);d&&(l+=180);var f=o.midpoint(),p=new pt(f,o.end).rotate(f,l),g;g=new pt(o.start,f),h=g.pointAt(2/3).rotate(o.start,l),u=p.pointAt(1/3).rotate(p.end,-l),s=K.createSegment("C",h,u,p.end),r.appendSegment(s),g=new pt(f,o.end),h=p.pointAt(1/3).rotate(p.end,l),u=g.pointAt(1/3).rotate(o.end,-l),s=K.createSegment("C",h,u,o.end),r.appendSegment(s)}else if(n==="gap")s=K.createSegment("M",o.end),r.appendSegment(s);else if(n==="cubic"){l=o.start.theta(o.end);var v=e*.6,x=e*1.35;c=o.start.difference(o.end),d=+(c.x<0||c.x===0&&c.y<0),d&&(x*=-1),h=L(o.start.x+v,o.start.y+x).rotate(o.start,l),u=L(o.end.x-v,o.end.y+x).rotate(o.end,l),s=K.createSegment("C",h,u,o.end),r.appendSegment(s)}}else{var S=t[a+1];i==0||!S||S.isJump?(s=K.createSegment("L",o.end),r.appendSegment(s)):j3(i,r,o.end,o.start,S.end)}}),r}function j3(t,e,n,i,r){var s=n.distance(i)/2,o=n.distance(r)/2,a=-Math.min(t,s),l=-Math.min(t,o),c=n.clone().move(i,a).round(),h=n.clone().move(r,l).round(),u=new L(_l*c.x+Sl*n.x,Sl*n.y+_l*c.y),d=new L(_l*h.x+Sl*n.x,Sl*n.y+_l*h.y),f;f=K.createSegment("L",c),e.appendSegment(f),f=K.createSegment("C",u,d,h),e.appendSegment(f)}const W3=function(t,e,n,i){z3(this);var r=i.raw,s=i.size||$3,o=i.jump&&(""+i.jump).toLowerCase(),a=i.radius||B3,l=i.ignoreConnectors||F3;Qg.indexOf(o)===-1&&(o=Qg[0]);var c=this.paper,h=c.model,u=h.getLinks();if(u.length===1)return im(Zu(t,e,n),s,o,a);var d=this.model,f=u.indexOf(d),p=c.options.defaultConnector||{},g=u.filter(function(O,N){var m=O.get("connector")||p;return ft(l).includes(m.name)?!1:N>f?m.name!=="jumpover":!0}),v=g.map(function(O){return c.findViewByModel(O)}),x=Zu(t,e,n),S=v.map(function(O){return O==null?[]:O===this?x:Zu(O.sourcePoint,O.targetPoint,O.route)},this),C=x.reduce(function(O,N){var m=g.reduce(function(b,w,A){if(w!==d){const E=S[A].slice(),M=E.findIndex(F=>V3(N,F));M>-1&&N.containsPoint(E[M].end)&&E.splice(M+1,1);const $=H3(N,E);b.push.apply(b,$)}return b},[]).sort(function(b,w){return nm(N.start,b)-nm(N.start,w)});return m.length>0?O.push.apply(O,G3(N,m,s)):O.push(N),O},[]),P=im(C,s,o,a);return r?P:P.serialize()},Y3=function(t,e,n=[],i={}){const{raw:r}=i;return Kf(t,e,n,{cornerType:"point",raw:r})},X3=10,q3=0,kx=function(t,e,n=[],i={}){const{radius:r=X3,raw:s}=i;return Kf(t,e,n,{cornerType:"cubic",cornerRadius:r,precision:q3,raw:s})},K3=function(t,e,n,i){var r=i&&i.raw,s;if(n&&n.length!==0){var o=[t].concat(n).concat([e]),a=oe.throughPoints(o);s=new K(a)}else{s=new K;var l;if(l=K.createSegment("M",t),s.appendSegment(l),Math.abs(t.x-e.x)>=Math.abs(t.y-e.y)){var c=(t.x+e.x)/2;l=K.createSegment("C",c,t.y,c,e.y,e.x,e.y),s.appendSegment(l)}else{var h=(t.y+e.y)/2;l=K.createSegment("C",t.x,h,e.x,h,e.x,e.y),s.appendSegment(l)}}return r?s:s.serialize()},ti={AUTO:"auto",HORIZONTAL:"horizontal",VERTICAL:"vertical",CLOSEST_POINT:"closest-point",OUTWARDS:"outwards"},On={UP:"up",DOWN:"down",LEFT:"left",RIGHT:"right",AUTO:"auto",CLOSEST_POINT:"closest-point",OUTWARDS:"outwards"},Zf=function(t,e,n=[],i={},r){const s=!!i.raw,{direction:o=ti.AUTO,precision:a=3}=i,l={coeff:i.distanceCoefficient||.6,angleTangentCoefficient:i.angleTangentCoefficient||80,tau:i.tension||.5,sourceTangent:i.sourceTangent?new L(i.sourceTangent):null,targetTangent:i.targetTangent?new L(i.targetTangent):null,rotate:!!i.rotate};typeof i.sourceDirection=="string"?l.sourceDirection=i.sourceDirection:typeof i.sourceDirection=="number"?l.sourceDirection=new L(1,0).rotate(null,i.sourceDirection):l.sourceDirection=i.sourceDirection?new L(i.sourceDirection).normalize():null,typeof i.targetDirection=="string"?l.targetDirection=i.targetDirection:typeof i.targetDirection=="number"?l.targetDirection=new L(1,0).rotate(null,i.targetDirection):l.targetDirection=i.targetDirection?new L(i.targetDirection).normalize():null;const c=[t,...n,e].map(g=>new L(g));let h;if(l.sourceTangent)h=l.sourceTangent;else{const g=eB(r,c,o,l),v=c[0].distance(c[1])*l.coeff,x=c[1].difference(c[0]).normalize(),S=qh(g,x);if(S>Math.PI/4){const C=v+(S-Math.PI/4)*l.angleTangentCoefficient;h=g.clone().scale(C,C)}else h=g.clone().scale(v,v)}let u;if(l.targetTangent)u=l.targetTangent;else{const g=nB(r,c,o,l),v=c.length-1,x=c[v-1].distance(c[v])*l.coeff,S=c[v-1].difference(c[v]).normalize(),C=qh(g,S);if(C>Math.PI/4){const P=x+(C-Math.PI/4)*l.angleTangentCoefficient;u=g.clone().scale(P,P)}else u=g.clone().scale(x,x)}const f=rB(c,h,u,l).map(g=>sB(g,l)),p=new K(f).round(a);return s?p:p.serialize()};Zf.Directions=ti;Zf.TangentDirections=On;function Z3(t,e,n){const{sourceBBox:i}=t;let r,s;if(!t.sourceView)i.x>e[1].x?r="right":r="left";else if(s=t.sourceView.model.angle(),n.rotate&&s){const a=t.sourceView.getNodeUnrotatedBBox(t.sourceView.el),l=e[0].clone();l.rotate(i.center(),s),r=a.sideNearestToPoint(l)}else r=i.sideNearestToPoint(e[0]);let o;switch(r){case"left":o=new L(-1,0);break;case"right":default:o=new L(1,0);break}return n.rotate&&s&&o.rotate(null,-s),o}function J3(t,e,n){const{targetBBox:i}=t;let r,s;if(!t.targetView)i.x>e[e.length-2].x?r="left":r="right";else if(s=t.targetView.model.angle(),n.rotate&&s){const a=t.targetView.getNodeUnrotatedBBox(t.targetView.el),l=e[e.length-1].clone();l.rotate(i.center(),s),r=a.sideNearestToPoint(l)}else r=i.sideNearestToPoint(e[e.length-1]);let o;switch(r){case"left":o=new L(-1,0);break;case"right":default:o=new L(1,0);break}return n.rotate&&s&&o.rotate(null,-s),o}function Q3(t,e,n){const{sourceBBox:i}=t;let r,s;if(!t.sourceView)i.y>e[1].y?r="bottom":r="top";else if(s=t.sourceView.model.angle(),n.rotate&&s){const a=t.sourceView.getNodeUnrotatedBBox(t.sourceView.el),l=e[0].clone();l.rotate(i.center(),s),r=a.sideNearestToPoint(l)}else r=i.sideNearestToPoint(e[0]);let o;switch(r){case"top":o=new L(0,-1);break;case"bottom":default:o=new L(0,1);break}return n.rotate&&s&&o.rotate(null,-s),o}function tB(t,e,n){const{targetBBox:i}=t;let r,s;if(!t.targetView)i.y>e[e.length-2].y?r="top":r="bottom";else if(s=t.targetView.model.angle(),n.rotate&&s){const a=t.targetView.getNodeUnrotatedBBox(t.targetView.el),l=e[e.length-1].clone();l.rotate(i.center(),s),r=a.sideNearestToPoint(l)}else r=i.sideNearestToPoint(e[e.length-1]);let o;switch(r){case"top":o=new L(0,-1);break;case"bottom":default:o=new L(0,1);break}return n.rotate&&s&&o.rotate(null,-s),o}function rm(t,e,n){const{sourceBBox:i}=t;let r,s;if(!t.sourceView)r=i.sideNearestToPoint(e[1]);else if(s=t.sourceView.model.angle(),n.rotate&&s){const a=t.sourceView.getNodeUnrotatedBBox(t.sourceView.el),l=e[0].clone();l.rotate(i.center(),s),r=a.sideNearestToPoint(l)}else r=i.sideNearestToPoint(e[0]);let o;switch(r){case"top":o=new L(0,-1);break;case"bottom":o=new L(0,1);break;case"right":o=new L(1,0);break;case"left":o=new L(-1,0);break}return n.rotate&&s&&o.rotate(null,-s),o}function sm(t,e,n){const{targetBBox:i}=t;let r,s;if(!t.targetView)r=i.sideNearestToPoint(e[e.length-2]);else if(s=t.targetView.model.angle(),n.rotate&&s){const a=t.targetView.getNodeUnrotatedBBox(t.targetView.el),l=e[e.length-1].clone();l.rotate(i.center(),s),r=a.sideNearestToPoint(l)}else r=i.sideNearestToPoint(e[e.length-1]);let o;switch(r){case"top":o=new L(0,-1);break;case"bottom":o=new L(0,1);break;case"right":o=new L(1,0);break;case"left":o=new L(-1,0);break}return n.rotate&&s&&o.rotate(null,-s),o}function om(t,e,n){return e[1].difference(e[0]).normalize()}function am(t,e,n){const i=e.length-1;return e[i-1].difference(e[i]).normalize()}function lm(t,e,n){const{sourceBBox:i}=t,r=i.center();return e[0].difference(r).normalize()}function cm(t,e,n){const{targetBBox:i}=t,r=i.center();return e[e.length-1].difference(r).normalize()}function eB(t,e,n,i){if(i.sourceDirection)switch(i.sourceDirection){case On.UP:return new L(0,-1);case On.DOWN:return new L(0,1);case On.LEFT:return new L(-1,0);case On.RIGHT:return new L(1,0);case On.AUTO:return rm(t,e,i);case On.CLOSEST_POINT:return om(t,e);case On.OUTWARDS:return lm(t,e);default:return i.sourceDirection}switch(n){case ti.HORIZONTAL:return Z3(t,e,i);case ti.VERTICAL:return Q3(t,e,i);case ti.CLOSEST_POINT:return om(t,e);case ti.OUTWARDS:return lm(t,e);case ti.AUTO:default:return rm(t,e,i)}}function nB(t,e,n,i){if(i.targetDirection)switch(i.targetDirection){case On.UP:return new L(0,-1);case On.DOWN:return new L(0,1);case On.LEFT:return new L(-1,0);case On.RIGHT:return new L(1,0);case On.AUTO:return sm(t,e,i);case On.CLOSEST_POINT:return am(t,e);case On.OUTWARDS:return cm(t,e);default:return i.targetDirection}switch(n){case ti.HORIZONTAL:return J3(t,e,i);case ti.VERTICAL:return tB(t,e,i);case ti.CLOSEST_POINT:return am(t,e);case ti.OUTWARDS:return cm(t,e);case ti.AUTO:default:return sm(t,e,i)}}function iB(t,e){const n=Math.cos(e),i=Math.sin(e),r=n*t.x-i*t.y,s=i*t.x+n*t.y;t.x=r,t.y=s}function qh(t,e){let n=t.dot(e)/(t.magnitude()*e.magnitude());return n<-1&&(n=-1),n>1&&(n=1),Math.acos(n)}function um(t,e){return t.x*e.y-t.y*e.x}function rB(t,e,n,i){const{tau:r,coeff:s}=i,o=[],a=[],l=[],c=t.length-1;for(let h=0;h<c;h++)o[h]=t[h].distance(t[h+1]);a[0]=e,a[c]=n;for(let h=1;h<c;h++){let u,d;h===1?u=t[h-1].clone().offset(a[h-1].x,a[h-1].y):u=t[h-1].clone(),h===c-1?d=t[h+1].clone().offset(a[h+1].x,a[h+1].y):d=t[h+1].clone();const f=u.difference(t[h]).normalize(),p=d.difference(t[h]).normalize(),g=qh(f,p);let v=(Math.PI-g)/2,x;const S=um(f,p);let C;C=um(t[h].difference(t[h+1]),t[h].difference(t[h-1])),S<0&&(v=-v),g<Math.PI/2&&(v<0&&C<0||v>0&&C>0)&&(v=v-Math.PI),x=p.clone(),iB(x,v);const P=x.clone(),O=x.clone(),N=o[h-1]*s,m=o[h]*s;P.scale(N,N),O.scale(m,m),a[h]=[P,O]}for(let h=0;h<c;h++){let u,d;h===0?u=t[h+1].difference(a[h].x/r,a[h].y/r):u=t[h+1].difference(a[h][1].x/r,a[h][1].y/r),h===c-1?d=t[h].clone().offset(a[h+1].x/r,a[h+1].y/r):d=t[h].difference(a[h+1][0].x/r,a[h+1][0].y/r),l[h]=[u,t[h],t[h+1],d]}return l}function sB(t,e){const{tau:n}=e,i=new L;i.x=t[1].x+(t[2].x-t[0].x)/(6*n),i.y=t[1].y+(t[2].y-t[0].y)/(6*n);const r=new L;return r.x=t[2].x+(t[3].x-t[1].x)/(6*n),r.y=t[2].y+(t[3].y-t[1].y)/(6*n),new oe(t[1],i,r,t[2])}const oB=Object.freeze(Object.defineProperty({__proto__:null,curve:Zf,jumpover:W3,normal:Y3,rounded:kx,smooth:K3,straight:Kf},Symbol.toStringTag,{value:"Module"}));var Kr=function(t){this.cid=kr("view"),this.preinitialize.apply(this,arguments),U(this,uc(t,lB)),this._ensureElement(),this.initialize.apply(this,arguments)},aB=/^(\S+)\s*(.*)$/,lB=["model","collection","el","id","attributes","className","tagName","events"];U(Kr.prototype,tn,{tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof q?t:q(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=Qt(this,"events")),!t)return this;this.undelegateEvents();for(var e in t){var n=t[e];if(xt(n)||(n=this[n]),!!n){var i=e.match(aB);this.delegate(i[1],i[2],n.bind(this))}}return this},delegate:function(t,e,n){return this.$el.on(t+".delegateEvents"+this.cid,e,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){return this.$el.off(t+".delegateEvents"+this.cid,e,n),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(Qt(this,"el"));else{var t=U({},Qt(this,"attributes"));this.id&&(t.id=Qt(this,"id")),this.className&&(t.class=Qt(this,"className")),this.setElement(this._createElement(Qt(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}});Kr.extend=Yf;const Sr={},ae=Kr.extend({options:{},theme:null,themeClassNamePrefix:En("theme-"),requireSetThemeOverride:!1,defaultTheme:ir.defaultTheme,children:null,childNodes:null,DETACHABLE:!0,UPDATE_PRIORITY:2,FLAG_INSERT:1<<30,FLAG_REMOVE:1<<29,FLAG_INIT:1<<28,constructor:function(t){this.requireSetThemeOverride=t&&!!t.theme,this.options=U({},this.options,t),Kr.call(this,t)},initialize:function(){Sr[this.cid]=this,this.setTheme(this.options.theme||this.defaultTheme),this.init()},unmount:function(){this.svgElement?this.vel.remove():this.$el.remove()},isMounted:function(){return this.el.parentNode!==null},renderChildren:function(t){if(t||(t=Qt(this,"children")),t){var e=this.svgElement,n=k.namespace[e?"svg":"xhtml"],i=ya(t,n);(e?this.vel:this.$el).empty().append(i.fragment),this.childNodes=i.selectors}return this},findAttribute:function(t,e){for(var n=e;n&&n.nodeType===1;){var i=n.getAttribute(t);if(i)return i;if(n===this.el)return null;n=n.parentNode}return null},_ensureElement:function(){if(this.el)this.setElement(Qt(this,"el"));else{var t=Qt(this,"tagName"),e=U({},Qt(this,"attributes")),n=U({},Qt(this,"style"));this.id&&(e.id=Qt(this,"id")),this.setElement(this._createElement(t)),this._setAttributes(e),this._setStyle(n)}this._ensureElClassName()},_setAttributes:function(t){this.svgElement?this.vel.attr(t):this.$el.attr(t)},_setStyle:function(t){this.$el.css(t)},_createElement:function(t){return this.svgElement?document.createElementNS(k.namespace.svg,t):document.createElement(t)},_setElement:function(t){this.$el=t instanceof q?t:q(t),this.el=this.$el[0],this.svgElement&&(this.vel=k(this.el))},_ensureElClassName:function(){var t=Qt(this,"className");if(t){var e=En(t);this.svgElement?this.vel.removeClass(t).addClass(e):this.$el.removeClass(t).addClass(e)}},init:function(){},onRender:function(){},confirmUpdate:function(){return 0},setTheme:function(t,e){return e=e||{},this.theme&&this.requireSetThemeOverride&&!e.override?this:(this.removeThemeClassName(),this.addThemeClassName(t),this.onSetTheme(this.theme,t),this.theme=t,this)},addThemeClassName:function(t){if(t=t||this.theme,!t)return this;var e=this.themeClassNamePrefix+t;return this.svgElement?this.vel.addClass(e):this.$el.addClass(e),this},removeThemeClassName:function(t){t=t||this.theme;var e=this.themeClassNamePrefix+t;return this.svgElement?this.vel.removeClass(e):this.$el.removeClass(e),this},onSetTheme:function(t,e){},remove:function(){return this.onRemove(),this.undelegateDocumentEvents(),Sr[this.cid]=null,Kr.prototype.remove.apply(this,arguments),this},onRemove:function(){},getEventNamespace:function(){return".joint-event-ns-"+this.cid},delegateElementEvents:function(t,e,n){if(!e)return this;n||(n={});var i=this.getEventNamespace();for(var r in e){var s=e[r];typeof s!="function"&&(s=this[s]),s&&q(t).on(r+i,n,s.bind(this))}return this},undelegateElementEvents:function(t){return q(t).off(this.getEventNamespace()),this},delegateDocumentEvents:function(t,e){return t||(t=Qt(this,"documentEvents")),this.delegateElementEvents(document,t,e)},undelegateDocumentEvents:function(){return this.undelegateElementEvents(document)},eventData:function(t,e){if(!t)throw new Error("eventData(): event object required.");var n=t.data,i="__"+this.cid+"__";return e===void 0?n?n[i]||{}:{}:(n||(n=t.data={}),n[i]||(n[i]={}),U(n[i],e),this)},stopPropagation:function(t){return this.eventData(t,{propagationStopped:!0}),this},isPropagationStopped:function(t){return!!this.eventData(t).propagationStopped}},{extend:function(){var t=Array.from(arguments),e=t[0]&&U({},t[0])||{},n=t[1]&&U({},t[1])||{},i=e.render||this.prototype&&this.prototype.render||null;return e.render=function(){return typeof i=="function"&&i.apply(this,arguments),this.render.__render__===i&&this.onRender(),this},e.render.__render__=i,Kr.extend.call(this,e,n)}});var lr=function(t,e){e||(e={}),this.preinitialize.apply(this,arguments),e.model&&(this.model=e.model),e.comparator!==void 0&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,U({silent:!0},e))},cB={add:!0,remove:!0,merge:!0},uB={add:!0,remove:!1},hm=function(t,e,n){n=Math.min(Math.max(n,0),t.length);var i=Array(t.length-n),r=e.length,s;for(s=0;s<i.length;s++)i[s]=t[s+n];for(s=0;s<r;s++)t[s+n]=e[s];for(s=0;s<i.length;s++)t[s+r+n]=i[s]};U(lr.prototype,tn,{model:hn,preinitialize:function(){},initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},add:function(t,e){return this.set(t,U({merge:!1},e,uB))},remove:function(t,e){e=U({},e);var n=!Array.isArray(t);t=n?[t]:t.slice();var i=this._removeModels(t,e);return!e.silent&&i.length&&(e.changes={added:[],merged:[],removed:i},this.trigger("update",this,e)),n?i[0]:i},set:function(t,e){if(t!=null){e=U({},cB,e);var n=!Array.isArray(t);t=n?[t]:t.slice();var i=e.at;i!=null&&(i=+i),i>this.length&&(i=this.length),i<0&&(i+=this.length+1);var r=[],s=[],o=[],a=[],l={},c=e.add,h=e.merge,u=e.remove,d=!1,f=this.comparator&&i==null&&e.sort!==!1,p=te(this.comparator)?this.comparator:null,g,v;for(v=0;v<t.length;v++){g=t[v];var x=this.get(g);if(x){if(h&&g!==x){var S=this._isModel(g)?g.attributes:g;x.set(S,e),o.push(x),f&&!d&&(d=x.hasChanged(p))}l[x.cid]||(l[x.cid]=!0,r.push(x)),t[v]=x}else c&&(g=t[v]=this._prepareModel(g,e),g&&(s.push(g),this._addReference(g,e),l[g.cid]=!0,r.push(g)))}if(u){for(v=0;v<this.length;v++)g=this.models[v],l[g.cid]||a.push(g);a.length&&this._removeModels(a,e)}var C=!1,P=!f&&c&&u;if(r.length&&P?(C=this.length!==r.length||this.models.some(function(O,N){return O!==r[N]}),this.models.length=0,hm(this.models,r,0),this.length=this.models.length):s.length&&(f&&(d=!0),hm(this.models,s,i??this.length),this.length=this.models.length),d&&this.sort({silent:!0}),!e.silent){for(v=0;v<s.length;v++)i!=null&&(e.index=i+v),g=s[v],g.trigger("add",g,this,e);(d||C)&&this.trigger("sort",this,e),(s.length||a.length||o.length)&&(e.changes={added:s,removed:a,merged:o},this.trigger("update",this,e))}return n?t[0]:t}},reset:function(t,e){e=e?be(e):{};for(var n=0;n<this.models.length;n++)this._removeReference(this.models[n],e);return e.previousModels=this.models,this._reset(),t=this.add(t,U({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,U({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,U({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return Array.prototype.slice.apply(this.models,arguments)},get:function(t){if(t!=null)return this._byId[t]||this._byId[this.modelId(this._isModel(t)?t.attributes:t,t.idAttribute)]||t.cid&&this._byId[t.cid]},has:function(t){return this.get(t)!=null},at:function(t){return t<0&&(t+=this.length),this.models[t]},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var n=e.length;return xt(e)&&(e=e.bind(this)),n===1||te(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t,e){return t[e||this.model.prototype.idAttribute||"id"]},values:function(){return new la(this,Lx)},keys:function(){return new la(this,Mx)},entries:function(){return new la(this,hB)},each:function(t,e){this.models.forEach(t,e)},filter:function(t,e){return this.models.filter(t,e)},find:function(t,e){return this.models.find(t,e)},findIndex:function(t,e){return this.models.findIndex(t,e)},first:function(){return this.models[0]},includes:function(t){return this.models.includes(t)},last:function(){return this.models[this.models.length-1]},isEmpty:function(){return!this.models.length},map:function(t,e){return this.models.map(t,e)},reduce:function(t,e=this.first()){return this.models.reduce(t,e)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?be(e):{},e.collection=this;var n;return this.model.prototype?n=new this.model(t,e):n=this.model(t,e),n.validationError?(this.trigger("invalid",this,n.validationError,e),!1):n},_removeModels:function(t,e){for(var n=[],i=0;i<t.length;i++){var r=this.get(t[i]);if(r){var s=this.models.indexOf(r);this.models.splice(s,1),this.length--,delete this._byId[r.cid];var o=this.modelId(r.attributes,r.idAttribute);o!=null&&delete this._byId[o],e.silent||(e.index=s,r.trigger("remove",r,this,e)),n.push(r),this._removeReference(r,e)}}return t.length>0&&!e.silent&&delete e.index,n},_isModel:function(t){return t instanceof hn},_addReference:function(t,e){this._byId[t.cid]=t;var n=this.modelId(t.attributes,t.idAttribute);n!=null&&(this._byId[n]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var n=this.modelId(t.attributes,t.idAttribute);n!=null&&delete this._byId[n],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){if(e){if((t==="add"||t==="remove")&&n!==this)return;if(t==="changeId"){var r=this.modelId(e.previousAttributes(),e.idAttribute),s=this.modelId(e.attributes,e.idAttribute);r!=null&&delete this._byId[r],s!=null&&(this._byId[s]=e)}}this.trigger.apply(this,arguments)}});var fc=typeof Symbol=="function"&&Symbol.iterator;fc&&(lr.prototype[fc]=lr.prototype.values);var la=function(t,e){this._collection=t,this._kind=e,this._index=0},Lx=1,Mx=2,hB=3;fc&&(la.prototype[fc]=function(){return this});la.prototype.next=function(){if(this._collection){if(this._index<this._collection.length){var t=this._collection.at(this._index);this._index++;var e;if(this._kind===Lx)e=t;else{var n=this._collection.modelId(t.attributes,t.idAttribute);this._kind===Mx?e=n:e=[n,t]}return{value:e,done:!1}}this._collection=void 0}return{value:void 0,done:!0}};var dB={toArray:1,sortBy:3},fB=[lr,dB,"models"];function pB(t){var e=t[0],n=t[1],i=t[2];S$(e,{sortBy:Je,toArray:ft},n,i)}pB(fB);lr.extend=Yf;function Wo(t){return t?Array.isArray(t)?t:[t]:[]}const ei=ae.extend({tagName:"g",svgElement:!0,className:"highlight",HIGHLIGHT_FLAG:1,UPDATE_PRIORITY:3,DETACHABLE:!1,UPDATABLE:!0,MOUNTABLE:!0,cellView:null,nodeSelector:null,node:null,updateRequested:!1,postponedUpdate:!1,transformGroup:null,detachedTransformGroup:null,requestUpdate(t,e){const{paper:n}=t;this.cellView=t,this.nodeSelector=e,n&&(this.updateRequested=!0,n.requestViewUpdate(this,this.HIGHLIGHT_FLAG,this.UPDATE_PRIORITY))},confirmUpdate(){this.updateRequested=!1;const{cellView:t,nodeSelector:e}=this;return t.isMounted()?(this.update(t,e),this.mount(),this.transform(),0):(this.postponedUpdate=!0,0)},findNode(t,e=null){let n;if(typeof e=="string")n=t.findNode(e);else if(Ee(e)){const i=t.model.isLink(),{label:r=null,port:s,selector:o}=e;i&&r!==null?n=t.findLabelNode(r,o):!i&&s?n=t.findPortNode(s,o):n=t.findNode(o)}else e&&(n=k.toNode(e),n instanceof SVGElement||(n=null));return n||null},getNodeMatrix(t,e){const{options:n}=this,{layer:i}=n,{rotatableNode:r}=t,s=t.getNodeMatrix(e);return r?i?r.contains(e)?s:t.getRootRotateMatrix().inverse().multiply(s):t.getNodeRotateMatrix(e).multiply(s):s},mount(){const{MOUNTABLE:t,cellView:e,el:n,options:i,transformGroup:r,detachedTransformGroup:s,postponedUpdate:o,nodeSelector:a}=this;if(!t||r)return;if(o){this.update(e,a),this.transform();return}const{vel:l,paper:c}=e,{layer:h}=i;if(h){let u;s?(u=s,this.detachedTransformGroup=null):u=k("g").addClass("highlight-transform").append(n),this.transformGroup=u,c.getLayerView(h).insertSortedNode(u.node,i.z)}else(!n.parentNode||n.nextSibling)&&l.append(n)},unmount(){const{MOUNTABLE:t,transformGroup:e,vel:n}=this;t&&(e?(this.transformGroup=null,this.detachedTransformGroup=e,e.remove()):n.remove())},transform(){const{transformGroup:t,cellView:e,updateRequested:n}=this;if(!t||e.model.isLink()||n)return;const i=e.getRootTranslateMatrix(),r=e.getRootRotateMatrix(),s=i.multiply(r);t.attr("transform",k.matrixToTransformString(s))},update(){const{node:t,cellView:e,nodeSelector:n,updateRequested:i,id:r}=this;if(i)return;this.postponedUpdate=!1;const s=this.node=this.findNode(e,n);t&&this.unhighlight(e,t),s?(this.highlight(e,s),this.mount()):(this.unmount(),e.notify("cell:highlight:invalid",r,this))},onRemove(){const{node:t,cellView:e,id:n,constructor:i}=this;t&&this.unhighlight(e,t),this.unmount(),i._removeRef(e,n)},highlight(t,e){},unhighlight(t,e){},listenToUpdateAttributes(t){const e=Qt(this,"UPDATE_ATTRIBUTES");!Array.isArray(e)||e.length===0||this.listenTo(t.model,"change",this.onCellAttributeChange)},onCellAttributeChange(){const{cellView:t}=this;if(!t)return;const{model:e,paper:n}=t;Qt(this,"UPDATE_ATTRIBUTES").some(r=>e.hasChanged(r))&&n.requestViewUpdate(this,this.HIGHLIGHT_FLAG,this.UPDATE_PRIORITY)}},{_views:{},highlight:function(t,e,n){const i=this.uniqueId(e,n);this.add(t,e,i,n)},unhighlight:function(t,e,n){const i=this.uniqueId(e,n);this.remove(t,i)},get(t,e=null){const{cid:n}=t,{_views:i}=this,r=i[n];if(e===null){const s=[];if(!r)return s;for(let o in r){const a=r[o];a instanceof this&&s.push(a)}return s}else{if(!r)return null;if(e in r){const s=r[e];if(s instanceof this)return s}return null}},add(t,e,n,i={}){if(!n)throw new Error("dia.HighlighterView: An ID required.");const r=ei.get(t,n);r&&r.remove();const s=new this(i);return s.id=n,this._addRef(t,n,s),s.requestUpdate(t,e),s.listenToUpdateAttributes(t),s},_addRef(t,e,n){const{cid:i}=t,{_views:r}=this;let s=r[i];s||(s=r[i]={}),s[e]=n},_removeRef(t,e){const{cid:n}=t,{_views:i}=this,r=i[n];if(r){e&&delete r[e];for(let s in r)return;delete i[n]}},remove(t,e=null){Wo(this.get(t,e)).forEach(n=>{n.remove()})},removeAll(t,e=null){const{_views:n}=this;for(let i in n)for(let r in n[i]){const s=n[i][r];s.cellView.paper===t&&s instanceof this&&(e===null||r===e)&&s.remove()}},update(t,e=null,n=!1){Wo(this.get(t,e)).forEach(i=>{(n||i.UPDATABLE)&&i.update()})},transform(t,e=null){Wo(this.get(t,e)).forEach(n=>{n.UPDATABLE&&n.transform()})},unmount(t,e=null){Wo(this.get(t,e)).forEach(n=>n.unmount())},mount(t,e=null){Wo(this.get(t,e)).forEach(n=>n.mount())},uniqueId(t,e=""){return k.ensureId(t)+JSON.stringify(e)}}),gB=ei.extend({tagName:"path",className:"highlight-stroke",attributes:{"pointer-events":"none",fill:"none"},options:{padding:3,rx:0,ry:0,useFirstSubpath:!1,attrs:{"stroke-width":3,stroke:"#FEB663"}},getPathData(t,e){const{options:n}=this,{useFirstSubpath:i}=n;let r;try{const s=k(e);if(r=s.convertToPathData().trim(),s.tagName()==="PATH"&&i){const o=r.search(/.M/i)+1;o>0&&(r=r.substr(0,o))}}catch{const o=t.getNodeBoundingRect(e);r=k.rectToPath(U({},n,o.toJSON()))}return r},highlightConnection(t){this.vel.attr("d",t.getSerializedConnection())},highlightNode(t,e){const{vel:n,options:i}=this,{padding:r,layer:s}=i;let o=this.getNodeMatrix(t,e);if(r){!s&&e===t.el&&n.remove();let a=t.getNodeBoundingRect(e);const l=a.x+a.width/2,c=a.y+a.height/2;a=k.transformRect(a,o);const h=Math.max(a.width,1),u=Math.max(a.height,1),d=(h+r)/h,f=(u+r)/u,p=k.createSVGMatrix({a:d,b:0,c:0,d:f,e:l-d*l,f:c-f*c});o=o.multiply(p)}n.attr({d:this.getPathData(t,e),transform:k.matrixToTransformString(o)})},highlight(t,e){const{vel:n,options:i}=this;n.attr(i.attrs),i.nonScalingStroke&&n.attr("vector-effect","non-scaling-stroke"),t.isNodeConnection(e)?this.highlightConnection(t):this.highlightNode(t,e)}}),dm=20;function mB(t,e){const n=t.children();for(;n.length>0;){const i=n.shift();e(i)&&n.push(...i.children())}}const vB=ei.extend({tagName:"rect",className:"highlight-mask",attributes:{"pointer-events":"none"},options:{padding:3,maskClip:dm,deep:!1,attrs:{stroke:"#FEB663","stroke-width":3,"stroke-linecap":"butt","stroke-linejoin":"miter"}},VISIBLE:"white",INVISIBLE:"black",MASK_ROOT_ATTRIBUTE_BLACKLIST:["marker-start","marker-end","marker-mid","transform","stroke-dasharray","class"],MASK_CHILD_ATTRIBUTE_BLACKLIST:["stroke","fill","stroke-width","stroke-opacity","stroke-dasharray","fill-opacity","marker-start","marker-end","marker-mid","class"],MASK_REPLACE_TAGS:["FOREIGNOBJECT","IMAGE","USE","TEXT","TSPAN","TEXTPATH"],MASK_REMOVE_TAGS:["TEXT","TSPAN","TEXTPATH"],transformMaskChild(t,e){const{MASK_CHILD_ATTRIBUTE_BLACKLIST:n,MASK_REPLACE_TAGS:i,MASK_REMOVE_TAGS:r}=this,s=e.tagName();if(!k.isSVGGraphicsElement(e)||r.includes(s))return e.remove(),!1;if(i.includes(s)){const o=t.vel.findOne(`#${e.id}`);if(o){const{node:a}=o;let l=t.getNodeBoundingRect(a);t.model.isElement()&&(l=k.transformRect(l,t.getNodeMatrix(a)));const c=k("rect",l.toJSON()),{x:h,y:u}=l.center(),{angle:d,cx:f=h,cy:p=u}=o.rotate();d&&c.rotate(d,f,p),e.parent().append(c)}return e.remove(),!1}return n.forEach(o=>{o==="fill"&&e.attr("fill")==="none"||e.removeAttr(o)}),!0},transformMaskRoot(t,e){const{MASK_ROOT_ATTRIBUTE_BLACKLIST:n}=this;n.forEach(i=>{e.removeAttr(i)})},getMaskShape(t,e){const{options:n,MASK_REPLACE_TAGS:i}=this,{deep:r}=n,s=e.tagName();let o;if(s==="G"){if(!r)return null;o=e.clone(),mB(o,a=>this.transformMaskChild(t,a))}else{if(i.includes(s))return null;o=e.clone()}return this.transformMaskRoot(t,o),o},getMaskId(){return`highlight-mask-${this.cid}`},getMask(t,e){const{VISIBLE:n,INVISIBLE:i,options:r}=this,{padding:s,attrs:o}=r,a=parseFloat(k("g").attr(o).attr("stroke-width")),l=e.attr("fill")!=="none";let c=parseFloat(e.attr("stroke-width"));isNaN(c)&&(c=1);const h=c+s*2,u=h+a*2;let d=this.getMaskShape(t,e);if(!d){const f=t.getNodeBoundingRect(e.node);f.inflate(f.width?0:.5,f.height?0:.5),d=k("rect",f.toJSON())}return d.attr(o),k("mask",{id:this.getMaskId()}).append([d.clone().attr({fill:l?n:"none",stroke:n,"stroke-width":u}),d.clone().attr({fill:l?i:"none",stroke:i,"stroke-width":h})])},removeMask(t){const e=t.svg.getElementById(this.getMaskId());e&&t.defs.removeChild(e)},addMask(t,e){t.defs.appendChild(e.node)},highlight(t,e){const{options:n,vel:i}=this,{padding:r,attrs:s,maskClip:o=dm,layer:a}=n,l="stroke"in s?s.stroke:"#000000";!a&&e===t.el&&i.remove();const c=t.getNodeBoundingRect(e).inflate(r+o),h=this.getNodeMatrix(t,e),u=this.getMask(t,k(e));this.addMask(t.paper,u),i.attr(c.toJSON()),i.attr({transform:k.matrixToTransformString(h),mask:`url(#${u.id})`,fill:l})},unhighlight(t){this.removeMask(t.paper)}}),yB=ei.extend({UPDATABLE:!1,MOUNTABLE:!1,highlight:function(t,e){const{alphaValue:n=.3}=this.options;e.style.opacity=n},unhighlight:function(t,e){e.style.opacity=""}}),fm=En("highlighted"),bB=ei.extend({UPDATABLE:!1,MOUNTABLE:!1,options:{className:fm},highlight:function(t,e){k(e).addClass(this.options.className)},unhighlight:function(t,e){k(e).removeClass(this.options.className)}},{className:fm}),Ju={ROW:"row",COLUMN:"column"},xB=ei.extend({tagName:"g",MOUNTABLE:!0,UPDATE_ATTRIBUTES:function(){return[this.options.attribute]},_prevItems:null,highlight(t,e){const n=t.model,{attribute:i,size:r=20,gap:s=5,direction:o=Ju.ROW}=this.options;if(!i)throw new Error("List: attribute is required");const a=typeof r=="number"?{width:r,height:r}:r,l=o===Ju.ROW,c=l?a.width:a.height;let h=n.get(i);Array.isArray(h)||(h=[]);const u=this._prevItems||[],d=h.map((v,x)=>Ie(u[x],h[x]));if(u.length!==h.length||d.some(v=>!v)){const v=this.vel.children(),x=h.map((S,C)=>{const P=C in v?v[C].node:null;if(d[C])return P;const O=this.createListItem(S,a,P);if(!O)return null;if(!(O instanceof SVGElement))throw new Error("List: item must be an SVGElement");O.dataset.index=C,O.dataset.attribute=i;const N=C*(c+s);return O.setAttribute("transform",l?`translate(${N}, 0)`:`translate(0, ${N})`),O});this.vel.empty().append(x),this._prevItems=h}const f=h.length,p=f===0?0:f*c+(f-1)*s,g=l?{width:p,height:a.height}:{width:a.width,height:p};this.position(n,g)},position(t,e){const{vel:n,options:i}=this,{margin:r=5,position:s="top-left"}=i,{width:o,height:a}=t.size(),{left:l,right:c,top:h,bottom:u}=Ne(r),d=new J(l,h,o-(l+c),a-(h+u));let{x:f,y:p}=ns(d,s);switch(s){case je.CENTER:case je.TOP:case je.BOTTOM:{f-=e.width/2;break}case je.RIGHT:case je.BOTTOM_RIGHT:case je.TOP_RIGHT:{f-=e.width;break}}switch(s){case je.CENTER:case je.RIGHT:case je.LEFT:{p-=e.height/2;break}case je.BOTTOM:case je.BOTTOM_RIGHT:case je.BOTTOM_LEFT:{p-=e.height;break}}n.attr("transform",`translate(${f}, ${p})`)}},{Directions:Ju,Positions:je}),wB=Object.freeze(Object.defineProperty({__proto__:null,addClass:bB,list:xB,mask:vB,opacity:yB,stroke:gB},Symbol.toStringTag,{value:"Module"}));function cu(t,e,n){if(Ee(n)){const{x:r,y:s}=n;if(isFinite(s)){const o=new pt(e,t),{start:a,end:l}=o.parallel(s);e=a,t=l}n=r}if(!isFinite(n))return t;var i=t.distance(e);return n===0&&i>0?t:t.move(e,-Math.min(n,i-1))}function Jf(t){var e=t.getAttribute("stroke-width");return e===null?0:parseFloat(e)||0}function _B(t,e,n=0){let i,r,s,o;const{start:a,end:l}=t;switch(e){case"left":i="x",r=l,s=a,o=-1;break;case"right":i="x",r=a,s=l,o=1;break;case"top":i="y",r=l,s=a,o=-1;break;case"bottom":i="y",r=a,s=l,o=1;break;default:return}a[i]<l[i]?r[i]=s[i]:s[i]=r[i],isFinite(n)&&(r[i]+=o*n,s[i]+=o*n)}function SB(t,e,n,i){let{offset:r,alignOffset:s,align:o}=i;return o&&_B(t,o,s),cu(t.end,t.start,r)}function Dx(t,e,n,i){var r=e.getNodeBBox(n);i.stroke&&r.inflate(Jf(n)/2);var s=t.intersect(r),o=s?t.start.chooseClosest(s):t.end;return cu(o,t.start,i.offset)}function EB(t,e,n,i){var r=e.model.angle();if(r===0)return Dx(t,e,n,i);var s=e.getNodeUnrotatedBBox(n);i.stroke&&s.inflate(Jf(n)/2);var o=s.center(),a=t.clone().rotate(o,r),l=a.setLength(1e6).intersect(s),c=l?a.start.chooseClosest(l).rotate(o,-r):t.end;return cu(c,t.start,i.offset)}function TB(t){if(!t)return null;var e=t;do{var n=e.tagName;if(typeof n!="string")return null;if(n=n.toUpperCase(),n==="G")e=e.firstElementChild;else if(n==="TITLE")e=e.nextElementSibling;else break}while(e);return e}var Qu="segmentSubdivisons",th="shapeBBox";function AB(t,e,n,i){var r,s,o=i.selector,a=t.end;if(typeof o=="string"?r=e.findNode(o):o===!1?r=n:Array.isArray(o)?r=fn(n,o):r=TB(n),!k.isSVGGraphicsElement(r)){if(r===n||!k.isSVGGraphicsElement(n))return a;r=n}var l=e.getNodeShape(r),c=e.getNodeMatrix(r),h=e.getRootTranslateMatrix(),u=e.getRootRotateMatrix(),d=h.multiply(u).multiply(c),f=d.inverse(),p=k.transformLine(t,f),g=p.start.clone(),v=e.getNodeData(r);if(i.insideout===!1){v[th]||(v[th]=l.bbox());var x=v[th];if(x.containsPoint(g))return a}var S;if(l instanceof K){var C=i.precision||2;v[Qu]||(v[Qu]=l.getSegmentSubdivisions({precision:C})),S={precision:C,segmentSubdivisions:v[Qu]}}i.extrapolate===!0&&p.setLength(1e6),s=p.intersect(l,S),s?k.isArray(s)&&(s=g.chooseClosest(s)):i.sticky===!0&&(l instanceof J?s=l.pointNearestToPoint(g):l instanceof Ln?s=l.intersectionWithLineFromCenterToPoint(g):s=l.closestPoint(g,S));var P=s?k.transformPoint(s,d):a,O=i.offset||0;return i.stroke&&(O+=Jf(r)/2),cu(P,t.start,O)}const CB=SB,PB=Dx,IB=EB,OB=AB,kB=Object.freeze(Object.defineProperty({__proto__:null,anchor:CB,bbox:PB,boundary:OB,rectangle:IB},Symbol.toStringTag,{value:"Module"}));function pm(t,e){if(e===0)return"0%";const n=1e3;return`${Math.round(t/e*100*n)/n}%`}function LB(t){return function(e,n,i,r){var s=n.isNodeConnection(i)?DB:MB;return s(t,e,n,i,r)}}function MB(t,e,n,i,r){var s=n.model.angle(),o=n.getNodeUnrotatedBBox(i),a=n.model.getBBox().center();r.rotate(a,s);var l=r.x-o.x,c=r.y-o.y;return t&&(l=pm(l,o.width),c=pm(c,o.height)),e.anchor={name:"topLeft",args:{dx:l,dy:c,rotate:!0}},e}function DB(t,e,n,i,r){var s=n.getConnection();if(!s)return e;var o=s.closestPointLength(r);if(t){var a=s.length();e.anchor={name:"connectionRatio",args:{ratio:o/a}}}else e.anchor={name:"connectionLength",args:{length:o}};return e}const NB=LB(!0),RB=function(t,e,n){return t},$B=function(t,e,n){var i=e.side||"bottom",r=Ne(e.padding||40),s=n.sourceBBox,o=n.targetBBox,a=s.center(),l=o.center(),c,h,u;switch(i){case"bottom":u=1,c="y",h="height";break;case"top":u=-1,c="y",h="height";break;case"left":u=-1,c="x",h="width";break;case"right":u=1,c="x",h="width";break;default:throw new Error("Router: invalid side")}return a[c]+=u*(s[h]/2+r[i]),l[c]+=u*(o[h]/2+r[i]),u*(a[c]-l[c])>0?l[c]=a[c]:a[c]=l[c],[a].concat(t,l)};var BB={N:"S",S:"N",E:"W",W:"E"},FB={N:-Math.PI/2*3,S:-Math.PI/2,E:0,W:Math.PI};function pc(t,e,n){var i=new L(t.x,e.y);return n.containsPoint(i)&&(i=new L(e.x,t.y)),i}function Kh(t,e){return t[e==="W"||e==="E"?"width":"height"]}function Mn(t,e){return t.x===e.x?t.y>e.y?"N":"S":t.y===e.y?t.x>e.x?"W":"E":null}function El(t){return new J(t.x,t.y,0,0)}function gc(t){var e=Ne(t.padding||t.elementPadding||20);return{x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}function Nx(t,e){return t.sourceBBox.clone().moveAndExpand(gc(e))}function Rx(t,e){return t.targetBBox.clone().moveAndExpand(gc(e))}function VB(t,e){if(t.sourceAnchor)return t.sourceAnchor;var n=Nx(t,e);return n.center()}function zB(t,e){if(t.targetAnchor)return t.targetAnchor;var n=Rx(t,e);return n.center()}function $x(t,e,n){var i=new L(t.x,e.y),r=new L(e.x,t.y),s=Mn(t,i),o=Mn(t,r),a=BB[n],l=s===n||s!==a&&(o===a||o!==n)?i:r;return{points:[l],direction:Mn(l,e)}}function Gl(t,e,n){var i=pc(t,e,n);return{points:[i],direction:Mn(i,e)}}function UB(t,e,n,i){var r={},s=[new L(t.x,e.y),new L(e.x,t.y)],o=s.filter(function(u){return!n.containsPoint(u)}),a=o.filter(function(u){return Mn(u,t)!==i}),l;if(a.length>0)l=a.filter(function(u){return Mn(t,u)===i}).pop(),l=l||a[0],r.points=[l],r.direction=Mn(l,e);else{l=G0(s,o)[0];var c=new L(e).move(l,-Kh(n,i)/2),h=pc(c,t,n);r.points=[h,c],r.direction=Mn(c,e)}return r}function HB(t,e,n,i){var r=Gl(e,t,i),s=r.points[0];if(n.containsPoint(s)){r=Gl(t,e,n);var o=r.points[0];if(i.containsPoint(o)){var a=new L(t).move(o,-Kh(n,Mn(t,o))/2),l=new L(e).move(s,-Kh(i,Mn(e,s))/2),c=new pt(a,l).midpoint(),h=Gl(t,c,n),u=$x(c,e,h.direction);r.points=[h.points[0],u.points[0]],r.direction=u.direction}}return r}function eh(t,e,n,i,r){var s={},o=n.union(i).inflate(1),a=o.center().distance(e)>o.center().distance(t),l=a?e:t,c=a?t:e,h,u,d;return r?(h=L.fromPolar(o.width+o.height,FB[r],l),h=o.pointNearestToPoint(h).move(h,-1)):h=o.pointNearestToPoint(l).move(l,1),u=pc(h,c,o),h.round().equals(u.round())?(u=L.fromPolar(o.width+o.height,an(h.theta(l))+Math.PI/2,c),u=o.pointNearestToPoint(u).move(c,1).round(),d=pc(h,u,o),s.points=a?[u,d,h]:[h,d,u]):s.points=a?[u,h]:[h,u],s.direction=Mn(a?h:u,e),s}function Zh(t,e,n){var i=Nx(n,e),r=Rx(n,e),s=VB(n,e),o=zB(n,e);i=i.union(El(s)),r=r.union(El(o)),t=ft(t).map(L),t.unshift(s),t.push(o);for(var a,l=[],c=0,h=t.length-1;c<h;c++){var u=null,d=t[c],f=t[c+1],p=!!Mn(d,f);if(c===0)c+1===h?i.intersect(r.clone().inflate(1))?u=eh(d,f,i,r):p||(u=HB(d,f,i,r)):i.containsPoint(f)?u=eh(d,f,i,El(f).moveAndExpand(gc(e))):p||(u=Gl(d,f,i));else if(c+1===h){var g=p&&Mn(f,d)===a;r.containsPoint(d)||g?u=eh(d,f,El(d).moveAndExpand(gc(e)),r,a):p||(u=UB(d,f,r,a))}else p||(u=$x(d,f,a));u?(Array.prototype.push.apply(l,u.points),a=u.direction):a=Mn(d,f),c+1<h&&l.push(f)}return l}var Bx={step:10,maximumLoops:2e3,precision:1,maxAllowedDirectionChange:90,perpendicular:!0,excludeEnds:[],excludeTypes:[],startDirections:["top","right","bottom","left"],endDirections:["top","right","bottom","left"],directionMap:{top:{x:0,y:-1},right:{x:1,y:0},bottom:{x:0,y:1},left:{x:-1,y:0}},cost:function(){return this.step},directions:function(){var t=this.step,e=this.cost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:-t,offsetY:0,cost:e},{offsetX:0,offsetY:t,cost:e},{offsetX:0,offsetY:-t,cost:e}]},penalties:function(){return{0:0,45:this.step/2,90:this.step/2}},paddingBox:function(){var t=this.step;return{x:-t,y:-t,width:2*t,height:2*t}},isPointObstacle:null,fallbackRouter:function(t,e,n){if(!xt(Zh))throw new Error("Manhattan requires the orthogonal router as default fallback.");return Zh(t,U({},Bx,e),n)},fallbackRoute:function(t,e,n){return null},draggingRoute:null};function Qf(t){this.map={},this.options=t,this.mapGridSize=100}Qf.prototype.build=function(t,e){var n=this.options,i=ft(n.excludeEnds).reduce(function(l,c){var h=e.get(c);if(h){var u=t.getCell(h.id);u&&l.push(u)}return l},[]),r=[],s=t.getCell(e.get("source").id);s&&(r=cc(r,s.getAncestors().map(function(l){return l.id})));var o=t.getCell(e.get("target").id);o&&(r=cc(r,o.getAncestors().map(function(l){return l.id})));var a=this.mapGridSize;return t.getElements().reduce(function(l,c){var h=ft(n.excludeTypes).includes(c.get("type")),u=i.find(function(P){return P.id===c.id}),d=r.includes(c.id),f=h||u||d;if(!f)for(var p=c.getBBox().moveAndExpand(n.paddingBox),g=p.origin().snapToGrid(a),v=p.corner().snapToGrid(a),x=g.x;x<=v.x;x+=a)for(var S=g.y;S<=v.y;S+=a){var C=x+"@"+S;l[C]=l[C]||[],l[C].push(p)}return l},this.map),this};Qf.prototype.isPointAccessible=function(t){var e=t.clone().snapToGrid(this.mapGridSize).toString();return ft(this.map[e]).every(function(n){return!n.containsPoint(t)})};function bs(){this.items=[],this.hash={},this.values={},this.OPEN=1,this.CLOSE=2}bs.prototype.add=function(t,e){this.hash[t]?this.items.splice(this.items.indexOf(t),1):this.hash[t]=this.OPEN,this.values[t]=e;var n=ou(this.items,t,(function(i){return this.values[i]}).bind(this));this.items.splice(n,0,t)};bs.prototype.remove=function(t){this.hash[t]=this.CLOSE};bs.prototype.isOpen=function(t){return this.hash[t]===this.OPEN};bs.prototype.isClose=function(t){return this.hash[t]===this.CLOSE};bs.prototype.isEmpty=function(){return this.items.length===0};bs.prototype.pop=function(){var t=this.items.shift();return this.remove(t),t};function Fx(t,e){return e&&e.paddingBox?t.sourceBBox.clone().moveAndExpand(e.paddingBox):t.sourceBBox.clone()}function Vx(t,e){return e&&e.paddingBox?t.targetBBox.clone().moveAndExpand(e.paddingBox):t.targetBBox.clone()}function zx(t,e){if(t.sourceAnchor)return t.sourceAnchor;var n=Fx(t,e);return n.center()}function GB(t,e){if(t.targetAnchor)return t.targetAnchor;var n=Vx(t,e);return n.center()}function nh(t,e,n,i,r){var s=360/n,o=t.theta(jB(t,e,i,r)),a=Qe(o+s/2);return s*Math.floor(a/s)}function jB(t,e,n,i){var r=i.step,s=e.x-t.x,o=e.y-t.y,a=s/n.x,l=o/n.y,c=a*r,h=l*r;return new L(t.x+c,t.y+h)}function gm(t,e){var n=Math.abs(t-e);return n>180?360-n:n}function WB(t,e,n){var i=n.step;ft(n.directions).forEach(function(r){r.gridOffsetX=r.offsetX/i*e.x,r.gridOffsetY=r.offsetY/i*e.y})}function YB(t,e,n){return{source:e.clone(),x:mm(n.x-e.x,t),y:mm(n.y-e.y,t)}}function mm(t,e){if(!t)return e;var n=Math.abs(t),i=Math.round(n/e);if(!i)return n;var r=i*e,s=n-r,o=s/i;return e+o}function XB(t,e){var n=e.source,i=ii(t.x-n.x,e.x)+n.x,r=ii(t.y-n.y,e.y)+n.y;return new L(i,r)}function ta(t,e){return t.round(e)}function jl(t,e,n){return ta(XB(t.clone(),e),n)}function ca(t){return t.clone().toString()}function ih(t){return new L(t.x===0?0:Math.abs(t.x)/t.x,t.y===0?0:Math.abs(t.y)/t.y)}function qB(t,e,n,i,r,s,o){for(var a=[],l=ih(r.difference(n)),c=ca(n),h=t[c],u;h;){u=e[c];var d=ih(u.difference(h));d.equals(l)||(a.unshift(u),l=d),c=ca(h),h=t[c]}var f=e[c],p=ih(f.difference(i));return p.equals(l)||a.unshift(f),a}function vm(t,e){for(var n=1/0,i=0,r=e.length;i<r;i++){var s=t.manhattanDistance(e[i]);s<n&&(n=s)}return n}function ym(t,e,n,i,r){var s=r.precision,o=r.directionMap,a=t.difference(e.center()),l=Nt(o)?Object.keys(o):[],c=ft(n),h=l.reduce(function(u,d){if(c.includes(d)){for(var f=o[d],p=new L(t.x+f.x*(Math.abs(a.x)+e.width),t.y+f.y*(Math.abs(a.y)+e.height)),g=new pt(t,p),v=g.intersect(e)||[],x=v.length,S,C=null,P=0;P<x;P++){var O=v[P],N=t.squaredDistance(O);(S===void 0||N>S)&&(S=N,C=O)}if(C){var m=jl(C,i,s);e.containsPoint(m)&&(m=jl(m.offset(f.x*i.x,f.y*i.y),i,s)),u.push(m)}}return u},[]);return e.containsPoint(t)||h.push(jl(t,i,s)),h}function KB(t,e,n,i){var r=i.precision,s,o;t instanceof J?s=ta(zx(this,i).clone(),r):s=ta(t.clone(),r),e instanceof J?o=ta(GB(this,i).clone(),r):o=ta(e.clone(),r);var a=YB(i.step,s,o),l,c,h,u;if(t instanceof J?(l=s,h=ym(l,t,i.startDirections,a,i)):(l=s,h=[l]),e instanceof J?(c=o,u=ym(o,e,i.endDirections,a,i)):(c=o,u=[c]),h=h.filter(kt=>!n(kt)),u=u.filter(kt=>!n(kt)),h.length>0&&u.length>0){for(var d=new bs,f={},p={},g={},v=0,x=h.length;v<x;v++){var S=h[v],C=ca(S);d.add(C,vm(S,u)),f[C]=S,g[C]=0}var P=i.previousDirectionAngle,O=P===void 0,N,m,b=i.directions;WB(b,a,i);for(var w=b.length,A=ft(u).reduce(function(kt,Ce){var Wt=ca(Ce);return kt.push(Wt),kt},[]),E=i.maximumLoops;!d.isEmpty()&&E>0;){var M=d.pop(),$=f[M],F=p[M],j=g[M],R=F===void 0,H=$.equals(l),z;R?O?H?z=null:z=nh(l,$,w,a,i):z=P:z=nh(F,$,w,a,i);var B=h.length===u.length;if(B){for(var _t=0;_t<h.length;_t++)if(!h[_t].equals(u[_t])){B=!1;break}}var gt=R&&B;if(!gt&&A.indexOf(M)>=0)return i.previousDirectionAngle=z,qB(p,f,$,l,c);for(v=0;v<w;v++){N=b[v];var Rt=N.angle;if(m=gm(z,Rt),!(!(O&&H)&&m>i.maxAllowedDirectionChange)){var ne=jl($.clone().offset(N.gridOffsetX,N.gridOffsetY),a,r),bt=ca(ne);if(!(d.isClose(bt)||n(ne))){if(A.indexOf(bt)>=0){var St=ne.equals(c);if(!St){var Y=nh(ne,c,w,a,i),W=gm(Rt,Y);if(W>i.maxAllowedDirectionChange)continue}}var Q=N.cost,$t=H?0:i.penalties[m],Bt=j+Q+$t;(!d.isOpen(bt)||Bt<g[bt])&&(f[bt]=ne,p[bt]=$,g[bt]=Bt,d.add(bt,Bt+vm(ne,u)))}}}E--}}return i.fallbackRoute.call(this,l,c,i)}function ZB(t){if(t.directions=Qt(t,"directions"),t.penalties=Qt(t,"penalties"),t.paddingBox=Qt(t,"paddingBox"),t.padding=Qt(t,"padding"),t.padding){var e=Ne(t.padding);t.paddingBox={x:-e.left,y:-e.top,width:e.left+e.right,height:e.top+e.bottom}}ft(t.directions).forEach(function(n){var i=new L(0,0),r=new L(n.offsetX,n.offsetY);n.angle=Qe(i.theta(r))})}function JB(t,e,n){ZB(e),n.options.perpendicular=!!e.perpendicular;var i=Fx(n,e),r=Vx(n,e),s=zx(n,e);let o;if(typeof e.isPointObstacle=="function")o=e.isPointObstacle;else{const C=new Qf(e);C.build(n.paper.model,n.model),o=P=>!C.isPointAccessible(P)}for(var a=ft(t).map(L),l=[],c=s,h,u,d=0,f=a.length;d<=f;d++){var p=null;if(u=h||i,h=a[d],!h){h=r;var g=!n.model.get("source").id||!n.model.get("target").id;if(g&&xt(e.draggingRoute)){var v=u===i?s:u,x=h.origin();p=e.draggingRoute.call(n,v,x,e)}}if(p=p||KB.call(n,u,h,o,e),p===null)return e.fallbackRouter(t,e,n);var S=p[0];S&&S.equals(c)&&p.shift(),c=p[p.length-1]||c,Array.prototype.push.apply(l,p)}return l}const Jh=function(t,e,n){return JB(t,U({},Bx,e),n)};var QB={maxAllowedDirectionChange:45,diagonalCost:function(){var t=this.step;return Math.ceil(Math.sqrt(t*t<<1))},directions:function(){var t=this.step,e=this.cost(),n=this.diagonalCost();return[{offsetX:t,offsetY:0,cost:e},{offsetX:t,offsetY:t,cost:n},{offsetX:0,offsetY:t,cost:e},{offsetX:-t,offsetY:t,cost:n},{offsetX:-t,offsetY:0,cost:e},{offsetX:-t,offsetY:-t,cost:n},{offsetX:0,offsetY:-t,cost:e},{offsetX:t,offsetY:-t,cost:n}]},fallbackRoute:function(t,e,n){var i=t.theta(e),r=[],s={x:e.x,y:t.y},o={x:t.x,y:e.y};if(i%180>90){var a=s;s=o,o=a}var l=i%90<45?s:o,c=new pt(t,l),h=90*Math.ceil(i/90),u=L.fromPolar(c.squaredLength(),an(h+135),l),d=new pt(e,u),f=c.intersection(d),p=f||e,g=f?p:t,v=360/n.directions.length,x=g.theta(e),S=Qe(x+v/2),C=v*Math.floor(S/v);return n.previousDirectionAngle=C,p&&r.push(p.round()),r.push(e),r}};const tF=function(t,e,n){if(!xt(Jh))throw new Error("Metro requires the manhattan router.");return Jh(t,U({},QB,e),n)},et={AUTO:"auto",LEFT:"left",RIGHT:"right",TOP:"top",BOTTOM:"bottom",ANCHOR_SIDE:"anchor-side",MAGNET_SIDE:"magnet-side"},bm=[et.LEFT,et.RIGHT,et.TOP,et.BOTTOM],Us={[et.LEFT]:et.RIGHT,[et.RIGHT]:et.LEFT,[et.TOP]:et.BOTTOM,[et.BOTTOM]:et.TOP},eF=[et.TOP,et.BOTTOM],Tl={0:et.RIGHT,180:et.LEFT,270:et.TOP,90:et.BOTTOM};function ea(t){return t.angle()}function Al(t){return new Ae(t).simplify({threshold:1}).points}function mc(t,e){const{point:n,x0:i,y0:r,view:s,bbox:o,direction:a}=t,{point:l,x0:c,y0:h,view:u,bbox:d,direction:f}=e;let p;if(s)s.model.isLink()?p=xm(l,n,s):a===et.ANCHOR_SIDE?p=o.sideNearestToPoint(n):a===et.MAGNET_SIDE?p=s.model.getBBox().sideNearestToPoint(n):p=a;else{const v=new J(i,r,0,0);p=bm.includes(a)?a:v.sideNearestToPoint(l)}let g;if(u)u.model.isLink()?g=xm(n,l,u):f===et.ANCHOR_SIDE?g=d.sideNearestToPoint(l):f===et.MAGNET_SIDE?g=u.model.getBBox().sideNearestToPoint(l):g=f;else{const v=new J(c,h,0,0);g=bm.includes(f)?f:v.sideNearestToPoint(n)}return[p,g]}function nF(t,e,n){const{x0:i,y0:r,width:s,height:o,point:a,margin:l}=t,c=i+s,h=r+o,u=i-l,d=c+l,f=r-l,{x:p}=a,{x0:g,y0:v}=e;return g===p&&v<r?et.BOTTOM:g<p&&v<f?et.RIGHT:g>p&&v<f?et.LEFT:g<u&&v>=r||g>d&&v>=r?et.TOP:g>=u&&g<=p&&v>h||g<=d&&g>=p&&v>h?n.point.x<g?et.RIGHT:et.LEFT:et.TOP}function iF(t,e,n){const{x0:i,y0:r,width:s,height:o,point:a,margin:l}=t,c=i+s,h=r+o,u=i-l,d=c+l,f=h+l,{x:p}=a,{x0:g,y0:v}=e;return g===p&&v>h?et.TOP:g<p&&v>f?et.RIGHT:g>p&&v>f?et.LEFT:g<u&&v<=h||g>d&&v<=h?et.BOTTOM:g>=u&&g<=p&&v<r||g<=d&&g>=p&&v<r?n.point.x<g?et.RIGHT:et.LEFT:et.BOTTOM}function rF(t,e,n){const{y0:i,x0:r,width:s,height:o,point:a,margin:l}=t,c=r+s,h=i+o,u=r-l,d=i-l,f=h+l,{x:p,y:g}=a,{x0:v,y0:x}=e;return v<p&&x===g?et.RIGHT:v<=u&&x<g?et.BOTTOM:v<=u&&x>g?et.TOP:v>=r&&x<=d||v>=r&&x>=f?et.LEFT:v>c&&x>=d&&x<=g||v>c&&x<=f&&x>=g?n.point.y<x?et.BOTTOM:et.TOP:et.LEFT}function sF(t,e,n){const{y0:i,x0:r,width:s,height:o,point:a,margin:l}=t,c=r+s,h=i+o,u=c+l,d=i-l,f=h+l,{x:p,y:g}=a,{x0:v,y0:x}=e;return v>p&&x===g?et.LEFT:v>=u&&x<g?et.BOTTOM:v>=u&&x>g?et.TOP:v<=c&&x<=d||v<=c&&x>=f?et.RIGHT:v<r&&x>=d&&x<=g||v<r&&x<=f&&x>=g?n.point.y<x?et.BOTTOM:et.TOP:et.RIGHT}function oF(t,e,n){const[i]=mc(t,e);switch(i){case et.TOP:return nF(t,e,n);case et.RIGHT:return sF(t,e,n);case et.BOTTOM:return iF(t,e,n);case et.LEFT:return rF(t,e,n)}}function xm(t,e,n){const i=n.getTangentAtLength(n.getClosestPointLength(e)),r=Math.round(ea(i)/90)*90;if(r%180===0&&t.y===e.y)return t.x<e.x?et.LEFT:et.RIGHT;if(t.x===e.x)return t.y<e.y?et.TOP:et.BOTTOM;switch(r){case 0:case 180:case 360:return t.y<e.y?et.TOP:et.BOTTOM;case 90:case 270:return t.x<e.x?et.LEFT:et.RIGHT}}function wm(t,e,n,i,r,s,o){i===et.AUTO&&(i=r?et.MAGNET_SIDE:et.ANCHOR_SIDE);const a=t&&t.model.isElement(),{x:l,y:c,width:h=0,height:u=0}=a?J.fromRectUnion(n,t.model.getBBox()):s;return{point:e,x0:l,y0:c,view:t,bbox:n,width:h,height:u,direction:i,margin:a?o:0}}function rh({x:t,y:e}){const n=new L(t,e);return{point:n,x0:n.x,y0:n.y,view:null,bbox:new J(t,e,0,0),width:0,height:0,direction:null,margin:0}}function _m(t,e,n){const i=e.point.clone(),{x0:r,y0:s,width:o,height:a}=e;switch(t){case"left":i.x=r-n;break;case"right":i.x=r+o+n;break;case"top":i.y=s-n;break;case"bottom":i.y=s+a+n;break}return i}function yr(t,e){const{point:n,x0:i,y0:r,view:s,width:o,height:a,margin:l}=t,{point:c,x0:h,y0:u,width:d,height:f,margin:p}=e,g=h+d,v=u+f,x=i+o,S=r+a,C=s&&s.model.isElement(),P=i-l,O=x+l,N=r-l,m=S+l,b=h-p,w=g+p,A=u-p,E=v+p,[M,$]=mc(t,e),F=_m(M,{point:n,x0:i,y0:r,width:o,height:a},l),j=_m($,{point:c,x0:h,y0:u,width:d,height:f},p),{x:R,y:H}=F,{x:z,y:B}=j,_t=(h+g)/2,gt=(u+v)/2,Rt=(i+x)/2,ne=(r+S)/2,bt=(Rt<_t?x+h:g+i)/2,St=(ne<gt?S+u:v+r)/2;if(M==="left"&&$==="right"){if(P<=w){let W=St;return x<=h&&(v>=N&&B<H?W=Math.min(A,N):u<=m&&B>=H&&(W=Math.max(E,m))),[{x:R,y:H},{x:R,y:W},{x:z,y:W},{x:z,y:B}]}const Y=(R+z)/2;return[{x:Y,y:H},{x:Y,y:B}]}else if(M==="right"&&$==="left"){if(O>=b){let W=St;return R>g&&(v>=N&&B<H?W=Math.min(A,N):u<=m&&B>=H&&(W=Math.max(E,m))),[{x:R,y:H},{x:R,y:W},{x:z,y:W},{x:z,y:B}]}const Y=(R+z)/2;return[{x:Y,y:H},{x:Y,y:B}]}else if(M==="top"&&$==="bottom"){if(H<B){let W=bt,Q=H;return H<u&&(g>=P&&z<R?W=Math.min(b,P):h<=O&&z>=R&&(W=Math.max(w,O))),[{x:R,y:Q},{x:W,y:Q},{x:W,y:B},{x:z,y:B}]}const Y=(H+B)/2;return[{x:R,y:Y},{x:z,y:Y}]}else if(M==="bottom"&&$==="top"){if(H-l>B){let W=bt,Q=H;return H>v&&(g>=P&&z<R?W=Math.min(b,P):h<=O&&z>=R&&(W=Math.max(w,O))),[{x:R,y:Q},{x:W,y:Q},{x:W,y:B},{x:z,y:B}]}const Y=(H+B)/2;return[{x:R,y:Y},{x:z,y:Y}]}else if(M==="top"&&$==="top"){let Y,W=Math.min((S+u)/2,B),Q=Math.min((r+v)/2,H);if(B<H){if(R>=w||R<=b)return[{x:R,y:Math.min(H,B)},{x:z,y:Math.min(H,B)}];z>R?Y=Math.min(R,b):Y=Math.max(R,w)}else{if(z>=O||z<=P)return[{x:R,y:Math.min(H,B)},{x:z,y:Math.min(H,B)}];z>=R?Y=Math.max(z,O):Y=Math.min(z,P)}return[{x:R,y:Q},{x:Y,y:Q},{x:Y,y:W},{x:z,y:W}]}else if(M==="bottom"&&$==="bottom"){let Y,W=Math.max((r+v)/2,B),Q=Math.max((S+u)/2,H);if(B>H){if(R>=w||R<=b)return[{x:R,y:Math.max(H,B)},{x:z,y:Math.max(H,B)}];z>R?Y=Math.min(R,b):Y=Math.max(R,w)}else{if(z>=O||z<=P)return[{x:R,y:Math.max(H,B)},{x:z,y:Math.max(H,B)}];z>=R?Y=Math.max(z,O):Y=Math.min(z,P)}return[{x:R,y:Q},{x:Y,y:Q},{x:Y,y:W},{x:z,y:W}]}else if(M==="left"&&$==="left"){let Y,W=Math.min((x+h)/2,z),Q=Math.min((i+g)/2,R);return z>R?B<=H?Y=Math.min(N,B):Y=Math.max(m,B):B>=H?Y=Math.min(A,H):Y=Math.max(E,H),[{x:Q,y:H},{x:Q,y:Y},{x:W,y:Y},{x:W,y:B}]}else if(M==="right"&&$==="right"){let Y,W=Math.max((i+g)/2,z),Q=Math.max((x+h)/2,R);return z<R?B<=H?Y=Math.min(N,B):Y=Math.max(m,B):B>=H?Y=Math.min(A,H):Y=Math.max(E,H),[{x:Q,y:H},{x:Q,y:Y},{x:W,y:Y},{x:W,y:B}]}else if(M==="top"&&$==="right"){if(H>B){if(R<z){let W=St;return(W>gt||!C)&&W<E&&R<h&&(W=A),[{x:R,y:W},{x:z,y:W},{x:z,y:B}]}return[{x:R,y:B}]}const Y=Math.max(bt,w);if(z<R&&B>r&&B<S)return[{x:R,y:H},{x:Y,y:H},{x:Y,y:B}];if(Y>P&&B>r||h>x){const W=Math.min(r-l,u-p),Q=Math.max(x+l,g+p);return[{x:R,y:W},{x:Q,y:W},{x:Q,y:B}]}return[{x:R,y:H},{x:Math.max(Y,z),y:H},{x:Math.max(Y,z),y:B}]}else if(M==="top"&&$==="left"){if(H>B){if(R>z){let W=St;return(W>gt||!C)&&W<E&&R>g&&(W=A),[{x:R,y:W},{x:z,y:W},{x:z,y:B}]}return[{x:R,y:B}]}const Y=Math.min(b,bt);if(R<z&&S>=B)return[{x:R,y:H},{x:Y,y:H},{x:Y,y:B}];if(Y<O&&H<v){const W=Math.min(N,A),Q=Math.min(P,b);return[{x:R,y:W},{x:Q,y:W},{x:Q,y:B}]}return[{x:R,y:H},{x:Y,y:H},{x:Y,y:B}]}else if(M==="bottom"&&$==="right"){if(H<B){if(R<z){let W=St;return(W<gt||!C)&&W>A&&R<h&&(W=E),[{x:R,y:W},{x:z,y:W},{x:z,y:B}]}return[{x:R,y:B}]}else if(i<z){const W=Math.max(m,E),Q=Math.max(O,w);return[{x:R,y:W},{x:Q,y:W},{x:Q,y:B}]}const Y=bt;return[{x:R,y:H},{x:Y,y:H},{x:Y,y:B}]}else if(M==="bottom"&&$==="left"){if(H<B){if(R>z){let W=St;return(W<gt||!C)&&W>A&&R>g&&(W=E),[{x:R,y:W},{x:z,y:W},{x:z,y:B}]}return[{x:R,y:B}]}else if(x>z){const W=Math.max(m,E),Q=Math.min(P,b);return[{x:R,y:W},{x:Q,y:W},{x:Q,y:B}]}const Y=bt;return[{x:R,y:H},{x:Y,y:H},{x:Y,y:B}]}else if(M==="left"&&$==="bottom"){if(R>=z&&H>=E)return[{x:z,y:H}];if(R>=g&&H<B){const Q=bt;return[{x:Q,y:H},{x:Q,y:B},{x:z,y:B}]}if(z<x&&v<=r){const Q=St;return[{x:R,y:H},{x:R,y:Q},{x:z,y:Q}]}const Y=Math.min(b,R),W=Math.max(m,E);return[{x:Y,y:H},{x:Y,y:W},{x:z,y:W}]}else if(M==="left"&&$==="top"){if(R>z&&H<A)return[{x:z,y:H}];if(R>=g&&H>B){const Q=bt;return[{x:Q,y:H},{x:Q,y:B},{x:z,y:B}]}if(z<=x&&B>H){const Q=St;return[{x:R,y:H},{x:R,y:Q},{x:z,y:Q}]}const Y=B<H?Math.min(P,b):P,W=Math.min(N,A);return[{x:Y,y:H},{x:Y,y:W},{x:z,y:W}]}else if(M==="right"&&$==="top"){if(R<=z&&H<A)return[{x:z,y:H}];if(x<h&&H>B){let Q=bt;return[{x:Q,y:H},{x:Q,y:B},{x:z,y:B}]}if(z<R&&u>S){const Q=St;return[{x:R,y:H},{x:R,y:Q},{x:z,y:Q}]}const Y=Math.max(O,w),W=Math.min(N,A);return[{x:Y,y:H},{x:Y,y:W},{x:z,y:W}]}else if(M==="right"&&$==="bottom"){if(R<=z&&H>=E)return[{x:z,y:H}];if(R<=b&&H<B){const Q=bt;return[{x:Q,y:H},{x:Q,y:B},{x:z,y:B}]}if(z>i&&v<r){const Q=St;return[{x:R,y:H},{x:R,y:Q},{x:z,y:Q}]}const Y=Math.max(w,R),W=Math.max(m,E);return[{x:Y,y:H},{x:Y,y:W},{x:z,y:W}]}}function Ux(t,e,n){const{sourceDirection:i=et.AUTO,targetDirection:r=et.AUTO}=e,s=e.margin||20,o=e.useVertices||!1,a=!!n.model.source().port,l=wm(n.sourceView,n.sourceAnchor,n.sourceBBox,i,a,n.sourceAnchor,s),c=!!n.model.target().port,h=wm(n.targetView,n.targetAnchor,n.targetBBox,r,c,n.targetAnchor,s);let u=[];if(!o||t.length===0)return Al(yr(l,h));const d=t.map(g=>rh(g)),[f]=d;if(l.view&&l.view.model.isElement()&&l.view.model.getBBox().inflate(s).containsPoint(f.point)){const[g]=mc(l,f),v=g,x=rh(l.point);x.margin=s,x.direction=g,f.direction=v,u.push(...yr(x,f),f.point)}else{const g=d[1]||h,v=oF(l,f,g);f.direction=v,u.push(...yr(l,f),f.point)}for(let g=0;g<d.length-1;g++){const v=d[g],x=d[g+1],S=new pt(v.point,x.point),C=ea(S);if(C%90===0){const N=Tl[C],m=Us[N];if(N!==v.direction)u.push(v.point,x.point),x.direction=m;else{const b=Qe(C-90);let w=0,A=0;b===90?A=-s:b===180?w=-s:b===270?A=s:b===0&&(w=s);const E={x:v.point.x+w,y:v.point.y+A},M={x:x.point.x+w,y:x.point.y+A},$=new pt(x.point,M);x.direction=Tl[ea($)],u.push(v.point,E,M,x.point)}continue}const[P,O]=sh(v,x);v.direction=P,x.direction=O,u.push(...yr(v,x),x.point)}const p=d[d.length-1];if(h.view&&h.view.model.isElement())if(h.view.model.getBBox().inflate(s).containsPoint(p.point)){const[g]=sh(p,h),v=rh(h.point),[,x]=mc(p,h);v.margin=s,v.direction=x,p.direction=g,u.push(...yr(p,v))}else{const g=Al(u),v=new pt(g[g.length-2],p.point),x=Tl[Math.round(ea(v))];p.direction=x;let S=yr(p,h);const[C,P]=Al([...S,h.point]),O=new pt(C,P),N=Math.round(ea(O)),m=Tl[N];m!==x&&x===Us[m]&&(p.margin=s,S=yr(p,h)),u.push(...S)}else{const[g]=sh(p,h);p.direction=g,u.push(...yr(p,h))}return Al(u)}function sh(t,e){const n=t.direction,i=eF.includes(n);let r=t.direction,s=e.direction;if(i){const o=t.point.y>e.point.y,a=e.point.x-t.point.x;n===et.BOTTOM?(r=o?Us[n]:a>=0?et.RIGHT:et.LEFT,a>0?s=o?et.LEFT:et.TOP:a<0&&(s=o?et.RIGHT:et.TOP)):(r=o?a>=0?et.RIGHT:et.LEFT:Us[n],a>0?s=o?et.BOTTOM:et.LEFT:a<0&&(s=o?et.BOTTOM:et.RIGHT))}else{const o=t.point.x>e.point.x,a=e.point.y-t.point.y;n===et.RIGHT?(r=o?Us[n]:a>=0?et.BOTTOM:et.TOP,a>0?s=o?et.TOP:et.LEFT:a<0&&(s=o?et.BOTTOM:et.LEFT)):(r=o?a>=0?et.BOTTOM:et.TOP:Us[n],a>0?s=o?et.RIGHT:et.TOP:a<0&&(s=o?et.RIGHT:et.BOTTOM))}return[r,s]}Ux.Directions=et;const aF=Ux,lF=Object.freeze(Object.defineProperty({__proto__:null,manhattan:Jh,metro:tF,normal:RB,oneSide:$B,orthogonal:Zh,rightAngle:aF},Symbol.toStringTag,{value:"Module"}));function cF(t,e,n,i){var r="ratio"in i?i.ratio:.5;return t.getPointAtRatio(r)}function uF(t,e,n,i){var r="length"in i?i.length:20;return t.getPointAtLength(r)}function hF(t,e,n,i){var r=1e6,s=t.getConnection(),o=t.getConnectionSubdivisions(),a=new pt(n.clone().offset(0,r),n.clone().offset(0,-r)),l=new pt(n.clone().offset(r,0),n.clone().offset(-r,0)),c=a.intersect(s,{segmentSubdivisions:o}),h=l.intersect(s,{segmentSubdivisions:o}),u=[];return c&&Array.prototype.push.apply(u,c),h&&Array.prototype.push.apply(u,h),u.length>0?n.chooseClosest(u):"fallbackAt"in i?Hx(t,i.fallbackAt):Gx(t,e,n,i)}function dF(t,e,n,i){var r=t.getClosestPoint(n);return r||new L}function Ya(t){return function(e,n,i,r){if(i instanceof Element){var s=this.paper.findView(i),o;if(s)if(s.isNodeConnection(i)){var a="fixedAt"in r?r.fixedAt:"50%";o=Hx(s,a)}else o=s.getNodeBBox(i).center();else o=new L;return t.call(this,e,n,o,r)}return t.apply(this,arguments)}}function Hx(t,e){var n=parseFloat(e);return Ue(e)?t.getPointAtRatio(n/100):t.getPointAtLength(n)}const fF=Ya(hF),Gx=Ya(dF),pF=Object.freeze(Object.defineProperty({__proto__:null,connectionClosest:Gx,connectionLength:uF,connectionPerpendicular:fF,connectionRatio:cF,resolveRef:Ya},Symbol.toStringTag,{value:"Module"}));function fr(t){return function(e,n,i,r){var s=!!r.rotate,o=s?e.getNodeUnrotatedBBox(n):e.getNodeBBox(n),a=o[t](),l=r.dx;if(l){var c=Ue(l);l=parseFloat(l),isFinite(l)&&(c&&(l/=100,l*=o.width),a.x+=l)}var h=r.dy;if(h){var u=Ue(h);h=parseFloat(h),isFinite(h)&&(u&&(h/=100,h*=o.height),a.y+=h)}return s?a.rotate(e.model.getBBox().center(),-e.model.angle()):a}}function gF(t,e,n,i){var r=t.model.angle(),s=t.getNodeBBox(e),o=s.center(),a=s.origin(),l=s.corner(),c=i.padding;if(isFinite(c)||(c=0),a.y+c<=n.y&&n.y<=l.y-c){var h=n.y-o.y;o.x+=r===0||r===180?0:h*1/Math.tan(an(r)),o.y+=h}else if(a.x+c<=n.x&&n.x<=l.x-c){var u=n.x-o.x;o.y+=r===90||r===270?0:u*Math.tan(an(r)),o.x+=u}return o}function mF(t,e,n,i){var r=!!i.rotate,s,o,a;r?(s=t.getNodeUnrotatedBBox(e),a=t.model.getBBox().center(),o=t.model.angle()):s=t.getNodeBBox(e);var l=i.padding;isFinite(l)&&s.inflate(l),r&&n.rotate(a,o);var c=s.sideNearestToPoint(n),h;switch(c){case"left":h=s.leftMiddle();break;case"right":h=s.rightMiddle();break;case"top":h=s.topMiddle();break;case"bottom":h=s.bottomMiddle();break}return r?h.rotate(a,-o):h}function vF(t,e,n,i,r){return t.model.getPointFromConnectedLink(this.model,r).offset(i.dx,i.dy)}const yF=fr("center"),bF=fr("topMiddle"),xF=fr("bottomMiddle"),wF=fr("leftMiddle"),_F=fr("rightMiddle"),SF=fr("origin"),EF=fr("topRight"),TF=fr("bottomLeft"),AF=fr("corner"),CF=Ya(gF),PF=Ya(mF),IF=vF,OF=Object.freeze(Object.defineProperty({__proto__:null,bottom:xF,bottomLeft:TF,bottomRight:AF,center:yF,left:wF,midSide:PF,modelCenter:IF,perpendicular:CF,right:_F,top:bF,topLeft:SF,topRight:EF},Symbol.toStringTag,{value:"Module"})),kF=lr.extend({initialize:function(t,e){e.cellNamespace?this.cellNamespace=e.cellNamespace:this.cellNamespace=typeof joint<"u"&&ni(joint,"shapes")?joint.shapes:null,this.graph=e.graph},model:function(t,e){const n=e.collection,i=n.cellNamespace,{type:r}=t,s=fn(i,r,".");if(!s)throw new Error(`dia.Graph: Could not find cell constructor for type: '${r}'. Make sure to add the constructor to 'cellNamespace'.`);const o=new s(t,e);return e.dry||(o.graph=n.graph),o},comparator:function(t){return t.get("z")||0}}),li=hn.extend({initialize:function(t,e){e=e||{};var n=new kF([],{model:e.cellModel,cellNamespace:e.cellNamespace,graph:this});hn.prototype.set.call(this,"cells",n),n.on("all",this.trigger,this),this.on("change:z",this._sortOnChangeZ,this),this._out={},this._in={},this._nodes={},this._edges={},this._batches={},n.on("add",this._restructureOnAdd,this),n.on("remove",this._restructureOnRemove,this),n.on("reset",this._restructureOnReset,this),n.on("change:source",this._restructureOnChangeSource,this),n.on("change:target",this._restructureOnChangeTarget,this),n.on("remove",this._removeCell,this)},_sortOnChangeZ:function(){this.get("cells").sort()},_restructureOnAdd:function(t){if(t.isLink()){this._edges[t.id]=!0;var{source:e,target:n}=t.attributes;e.id&&((this._out[e.id]||(this._out[e.id]={}))[t.id]=!0),n.id&&((this._in[n.id]||(this._in[n.id]={}))[t.id]=!0)}else this._nodes[t.id]=!0},_restructureOnRemove:function(t){if(t.isLink()){delete this._edges[t.id];var{source:e,target:n}=t.attributes;e.id&&this._out[e.id]&&this._out[e.id][t.id]&&delete this._out[e.id][t.id],n.id&&this._in[n.id]&&this._in[n.id][t.id]&&delete this._in[n.id][t.id]}else delete this._nodes[t.id]},_restructureOnReset:function(t){t=t.models,this._out={},this._in={},this._nodes={},this._edges={},t.forEach(this._restructureOnAdd,this)},_restructureOnChangeSource:function(t){var e=t.previous("source");e.id&&this._out[e.id]&&delete this._out[e.id][t.id];var n=t.attributes.source;n.id&&((this._out[n.id]||(this._out[n.id]={}))[t.id]=!0)},_restructureOnChangeTarget:function(t){var e=t.previous("target");e.id&&this._in[e.id]&&delete this._in[e.id][t.id];var n=t.get("target");n.id&&((this._in[n.id]||(this._in[n.id]={}))[t.id]=!0)},getOutboundEdges:function(t){return this._out&&this._out[t]||{}},getInboundEdges:function(t){return this._in&&this._in[t]||{}},toJSON:function(){var t=hn.prototype.toJSON.apply(this,arguments);return t.cells=this.get("cells").toJSON(),t},fromJSON:function(t,e){if(!t.cells)throw new Error("Graph JSON must contain cells array.");return this.set(t,e)},set:function(t,e,n){var i;return typeof t=="object"?(i=t,n=e):(i={})[t]=e,i.hasOwnProperty("cells")&&(this.resetCells(i.cells,n),i=Ze(i,"cells")),hn.prototype.set.call(this,i,n)},clear:function(t){t=U({},t,{clear:!0});var e=this.get("cells");if(e.length===0)return this;this.startBatch("clear",t);var n=e.sortBy(function(i){return i.isLink()?1:2});do n.shift().remove(t);while(n.length>0);return this.stopBatch("clear"),this},_prepareCell:function(t,e){var n;if(t instanceof hn?(n=t.attributes,!t.graph&&(!e||!e.dry)&&(t.graph=this)):n=t,!te(n.type))throw new TypeError("dia.Graph: cell type must be a string.");return t},minZIndex:function(){var t=this.get("cells").first();return t&&t.get("z")||0},maxZIndex:function(){var t=this.get("cells").last();return t&&t.get("z")||0},addCell:function(t,e){return Array.isArray(t)?this.addCells(t,e):(t instanceof hn?t.has("z")||t.set("z",this.maxZIndex()+1):t.z===void 0&&(t.z=this.maxZIndex()+1),this.get("cells").add(this._prepareCell(t,e),e||{}),this)},addCells:function(t,e){return t.length===0?this:(t=H0(t),e.maxPosition=e.position=t.length-1,this.startBatch("add",e),t.forEach(function(n){this.addCell(n,e),e.position--},this),this.stopBatch("add",e),this)},resetCells:function(t,e){var n=ft(t).map(function(i){return this._prepareCell(i,e)},this);return this.get("cells").reset(n,e),this},removeCells:function(t,e){return t.length&&(this.startBatch("remove"),We(t,"remove",e),this.stopBatch("remove")),this},_removeCell:function(t,e,n){n=n||{},n.clear||(n.disconnectLinks?this.disconnectLinks(t,n):this.removeLinks(t,n)),this.get("cells").remove(t,{silent:!0}),t.graph===this&&(t.graph=null)},getCell:function(t){return this.get("cells").get(t)},getCells:function(){return this.get("cells").toArray()},getElements:function(){return this.get("cells").toArray().filter(t=>t.isElement())},getLinks:function(){return this.get("cells").toArray().filter(t=>t.isLink())},getFirstCell:function(){return this.get("cells").first()},getLastCell:function(){return this.get("cells").last()},getConnectedLinks:function(t,e){e=e||{};var n=e.indirect,i=e.inbound,r=e.outbound;i===void 0&&r===void 0&&(i=r=!0);var s=[],o={};r&&a(this,t),i&&l(this,t);function a(u,d){if(Kt(u.getOutboundEdges(d.id),(function(p,g){if(!o[g]){var v=u.getCell(g);s.push(v),o[g]=!0,n&&(i&&l(u,v),r&&a(u,v))}}).bind(u)),n&&d.isLink()){var f=d.getTargetCell();f&&f.isLink()&&(o[f.id]||(s.push(f),a(u,f)))}}function l(u,d){if(Kt(u.getInboundEdges(d.id),(function(p,g){if(!o[g]){var v=u.getCell(g);s.push(v),o[g]=!0,n&&(i&&l(u,v),r&&a(u,v))}}).bind(u)),n&&d.isLink()){var f=d.getSourceCell();f&&f.isLink()&&(o[f.id]||(s.push(f),l(u,f)))}}if(e.deep){var c=t.getEmbeddedCells({deep:!0}),h={};c.forEach(function(u){u.isElement()&&(h[u.id]=!0)}),c.forEach(function(u){u.isLink()||(r&&Kt(this.getOutboundEdges(u.id),(function(d,f){if(!o[f]){var p=this.getCell(f),{source:g,target:v}=p.attributes,x=g.id,S=v.id;if(!e.includeEnclosed&&x&&h[x]&&S&&h[S])return;s.push(this.getCell(f)),o[f]=!0}}).bind(this)),i&&Kt(this.getInboundEdges(u.id),(function(d,f){if(!o[f]){var p=this.getCell(f),{source:g,target:v}=p.attributes,x=g.id,S=v.id;if(!e.includeEnclosed&&x&&h[x]&&S&&h[S])return;s.push(this.getCell(f)),o[f]=!0}}).bind(this)))},this)}return s},getNeighbors:function(t,e){e||(e={});var n=e.inbound,i=e.outbound;n===void 0&&i===void 0&&(n=i=!0);var r=this.getConnectedLinks(t,e).reduce((function(a,l){var{source:c,target:h}=l.attributes,u=l.hasLoop(e);if(n&&ni(c,"id")&&!a[c.id]){var d=this.getCell(c.id);d.isElement()&&(u||d&&d!==t&&(!e.deep||!d.isEmbeddedIn(t)))&&(a[c.id]=d)}if(i&&ni(h,"id")&&!a[h.id]){var f=this.getCell(h.id);f.isElement()&&(u||f&&f!==t&&(!e.deep||!f.isEmbeddedIn(t)))&&(a[h.id]=f)}return a}).bind(this),{});if(t.isLink()){if(n){var s=t.getSourceCell();s&&s.isElement()&&!r[s.id]&&(r[s.id]=s)}if(i){var o=t.getTargetCell();o&&o.isElement()&&!r[o.id]&&(r[o.id]=o)}}return ft(r)},getCommonAncestor:function(){var t=Array.from(arguments).map(function(n){for(var i=[],r=n.get("parent");r;)i.push(r),r=this.getCell(r).get("parent");return i},this);t=t.sort(function(n,i){return n.length-i.length});var e=ft(t.shift()).find(function(n){return t.every(function(i){return i.includes(n)})});return this.getCell(e)},getSuccessors:function(t,e){e=e||{};var n=[];return this.search(t,function(i){i!==t&&n.push(i)},U({},e,{outbound:!0})),n},cloneCells:Xf,cloneSubgraph:function(t,e){var n=this.getSubgraph(t,e);return this.cloneCells(n)},getSubgraph:function(t,e){e=e||{};var n=[],i={},r=[],s=[];return ft(t).forEach(function(o){if(i[o.id]||(n.push(o),i[o.id]=o,o.isLink()?s.push(o):r.push(o)),e.deep){var a=o.getEmbeddedCells({deep:!0});a.forEach(function(l){i[l.id]||(n.push(l),i[l.id]=l,l.isLink()?s.push(l):r.push(l))})}}),s.forEach(function(o){var{source:a,target:l}=o.attributes;if(a.id&&!i[a.id]){var c=this.getCell(a.id);n.push(c),i[c.id]=c,r.push(c)}if(l.id&&!i[l.id]){var h=this.getCell(l.id);n.push(this.getCell(l.id)),i[h.id]=h,r.push(h)}},this),r.forEach(function(o){var a=this.getConnectedLinks(o,e);a.forEach(function(l){var{source:c,target:h}=l.attributes;!i[l.id]&&c.id&&i[c.id]&&h.id&&i[h.id]&&(n.push(l),i[l.id]=l)})},this),n},getPredecessors:function(t,e){e=e||{};var n=[];return this.search(t,function(i){i!==t&&n.push(i)},U({},e,{inbound:!0})),n},search:function(t,e,n){n=n||{},n.breadthFirst?this.bfs(t,e,n):this.dfs(t,e,n)},bfs:function(t,e,n={}){const i={},r={},s=[];for(s.push(t),r[t.id]=0;s.length>0;){var o=s.shift();if(i[o.id]||(i[o.id]=!0,e.call(this,o,r[o.id])===!1))continue;const a=this.getNeighbors(o,n);for(let l=0,c=a.length;l<c;l++){const h=a[l];r[h.id]=r[o.id]+1,s.push(h)}}},dfs:function(t,e,n={}){const i={},r={},s=[];for(s.push(t),r[t.id]=0;s.length>0;){const o=s.pop();if(i[o.id]||(i[o.id]=!0,e.call(this,o,r[o.id])===!1))continue;const a=this.getNeighbors(o,n),l=s.length;for(let c=0,h=a.length;c<h;c++){const u=a[c];r[u.id]=r[o.id]+1,s.splice(l,0,u)}}},getSources:function(){var t=[];return Kt(this._nodes,(function(e,n){(!this._in[n]||xn(this._in[n]))&&t.push(this.getCell(n))}).bind(this)),t},getSinks:function(){var t=[];return Kt(this._nodes,(function(e,n){(!this._out[n]||xn(this._out[n]))&&t.push(this.getCell(n))}).bind(this)),t},isSource:function(t){return!this._in[t.id]||xn(this._in[t.id])},isSink:function(t){return!this._out[t.id]||xn(this._out[t.id])},isSuccessor:function(t,e){var n=!1;return this.search(t,function(i){if(i===e&&i!==t)return n=!0,!1},{outbound:!0}),n},isPredecessor:function(t,e){var n=!1;return this.search(t,function(i){if(i===e&&i!==t)return n=!0,!1},{inbound:!0}),n},isNeighbor:function(t,e,n){n=n||{};var i=n.inbound,r=n.outbound;i===void 0&&r===void 0&&(i=r=!0);var s=!1;return this.getConnectedLinks(t,n).forEach(function(o){var{source:a,target:l}=o.attributes;if(i&&ni(a,"id")&&a.id===e.id||r&&ni(l,"id")&&l.id===e.id)return s=!0,!1}),s},disconnectLinks:function(t,e){this.getConnectedLinks(t).forEach(function(n){n.set(n.attributes.source.id===t.id?"source":"target",{x:0,y:0},e)})},removeLinks:function(t,e){We(this.getConnectedLinks(t),"remove",e)},findModelsFromPoint:function(t){return this.getElements().filter(e=>e.getBBox({rotate:!0}).containsPoint(t))},findModelsInArea:function(t,e={}){const n=new J(t),{strict:i=!1}=e,r=i?"containsRect":"intersect";return this.getElements().filter(s=>n[r](s.getBBox({rotate:!0})))},findModelsUnderElement:function(t,e={}){const{searchBy:n="bbox"}=e,i=t.getBBox().rotateAroundCenter(t.angle());return(n==="bbox"?this.findModelsInArea(i):this.findModelsFromPoint(ns(i,n))).filter(s=>t.id!==s.id&&!s.isEmbeddedIn(t))},getBBox:function(){return this.getCellsBBox(this.getCells())},getCellsBBox:function(t,e={}){const{rotate:n=!0}=e;return ft(t).reduce(function(i,r){const s=r.getBBox({rotate:n});return s?i?i.union(s):s:i},null)},translate:function(t,e,n){var i=this.getCells().filter(function(r){return!r.isEmbedded()});return We(i,"translate",t,e,n),this},resize:function(t,e,n){return this.resizeCells(t,e,this.getCells(),n)},resizeCells:function(t,e,n,i){var r=this.getCellsBBox(n);if(r){var s=Math.max(t/r.width,0),o=Math.max(e/r.height,0);We(n,"scale",s,o,r.origin(),i)}return this},startBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)+1,this.trigger("batch:start",U({},e,{batchName:t}))},stopBatch:function(t,e){return e=e||{},this._batches[t]=(this._batches[t]||0)-1,this.trigger("batch:stop",U({},e,{batchName:t}))},hasActiveBatch:function(t){const e=this._batches;let n;return arguments.length===0?n=Object.keys(e):Array.isArray(t)?n=t:n=[t],n.some(i=>e[i]>0)}},{validations:{multiLinks:function(t,e){var{source:n,target:i}=e.attributes;if(n.id&&i.id){var r=e.getSourceCell();if(r){var s=t.getConnectedLinks(r,{outbound:!0}),o=s.filter(function(a){var{source:l,target:c}=a.attributes;return l&&l.id===n.id&&(!l.port||l.port===n.port)&&c&&c.id===i.id&&(!c.port||c.port===i.port)});if(o.length>1)return!1}}return!0},linkPinning:function(t,e){var{source:n,target:i}=e.attributes;return n.id&&i.id}}});xx(li.prototype,["resetCells","addCells","removeCells"],dc.cells);const yn={GRID:"grid",CELLS:"cells",BACK:"back",FRONT:"front",TOOLS:"tools",LABELS:"labels"},vc=ae.extend({tagName:"g",svgElement:!0,pivotNodes:null,defaultTheme:null,options:{name:""},className:function(){return En(`${this.options.name}-layer`)},init:function(){this.pivotNodes={}},insertSortedNode:function(t,e){this.el.insertBefore(t,this.insertPivot(e))},insertNode:function(t){const{el:e}=this;t.parentNode!==e&&e.appendChild(t)},insertPivot:function(t){const{el:e,pivotNodes:n}=this;t=+t,t||(t=0);let i=n[t];if(i)return i;i=n[t]=document.createComment("z-index:"+(t+1));let r=-1/0;for(let s in n)s=+s,s<t&&s>r&&(r=s,t-1);if(r!==-1/0){const s=n[r];e.insertBefore(i,s.nextSibling)}else e.insertBefore(i,e.firstChild);return i},removePivots:function(){const{el:t,pivotNodes:e}=this;for(let n in e)t.removeChild(e[n]);this.pivotNodes={}}}),LF=["transform","x","y","cx","cy","dx","dy","x1","y1","x2","y2","points","d","r","rx","ry","width","height","stroke-width","font-size"],MF=["r","rx","ry","width","height","stroke-width","font-size"],DF=LF.reduce((t,e)=>(t[e]=!0,t),{}),NF=MF.reduce((t,e)=>(t[e]=!0,t),{});function Sm(t,e){const n={};for(let i in t)t.hasOwnProperty(i)&&(n[i]=jx(i,t[i],e));return n}function jx(t,e,n){if(t in DF&&or(e)){let i=ar(e,n);return t in NF&&(i=Math.max(0,i)),i}return e}const ks={DEFAULT:"default",EMBEDDING:"embedding",CONNECTING:"connecting",MAGNET_AVAILABILITY:"magnetAvailability",ELEMENT_AVAILABILITY:"elementAvailability"},RF={TOOLS:"TOOLS"},Gt=ae.extend({tagName:"g",svgElement:!0,selector:"root",metrics:null,className:function(){var t=["cell"],e=this.model.get("type");return e&&e.toLowerCase().split(".").forEach(function(n,i,r){t.push("type-"+r.slice(0,i+1).join("-"))}),t.join(" ")},_presentationAttributes:null,_flags:null,setFlags:function(){var t={},e={},n=0,i,r,s,o=Qt(this,"presentationAttributes");for(var a in o)if(o.hasOwnProperty(a)){var l=o[a];for(Array.isArray(l)||(l=[l]),i=0,r=l.length;i<r;i++){s=l[i];var c=t[s];c||(c=t[s]=1<<n++),e[a]|=c}}var h=Qt(this,"initFlag");for(Array.isArray(h)||(h=[h]),i=0,r=h.length;i<r;i++)s=h[i],t[s]||(t[s]=1<<n++);if(n>25)throw new Error("dia.CellView: Maximum number of flags exceeded.");this._flags=t,this._presentationAttributes=e},hasFlag:function(t,e){return t&this.getFlag(e)},removeFlag:function(t,e){return t^t&this.getFlag(e)},getFlag:function(t){var e=this._flags;if(!e)return 0;var n=0;if(Array.isArray(t))for(var i=0,r=t.length;i<r;i++)n|=e[t[i]];else n|=e[t];return n},attributes:function(){var t=this.model;return{"model-id":t.id,"data-type":t.attributes.type}},constructor:function(t){t.id=t.id||Pr(this),ae.call(this,t)},initialize:function(){this.setFlags(),ae.prototype.initialize.apply(this,arguments),this.cleanNodesCache(),this.startListening()},startListening:function(){this.listenTo(this.model,"change",this.onAttributesChange)},onAttributesChange:function(t,e){var n=t.getChangeFlag(this._presentationAttributes);e.updateHandled||!n||(e.dirty&&this.hasFlag(n,"UPDATE")&&(n|=this.getFlag("RENDER")),e.tool&&(e.async=!1),this.requestUpdate(n,e))},requestUpdate:function(t,e){const{paper:n}=this;n&&t>0&&n.requestViewUpdate(this,t,this.UPDATE_PRIORITY,e)},parseDOMJSON:function(t,e){var n=ya(t),i=n.selectors,r=n.groupSelectors;for(var s in r){if(i[s])throw new Error("dia.CellView: ambiguous group selector");i[s]=r[s]}if(e){var o=this.selector;if(i[o])throw new Error("dia.CellView: ambiguous root selector.");i[o]=e}return{fragment:n.fragment,selectors:i}},can:function(t){var e=xt(this.options.interactive)?this.options.interactive(this):this.options.interactive;return Nt(e)&&e[t]!==!1||Ff(e)&&e!==!1},findBySelector:function(t,e,n){if(!t||t===".")return[e];if(n){var i=n[t];if(i)return Array.isArray(i)?i:[i]}return this.useCSSSelectors?q(e).find(t).toArray():[]},findNodes:function(t){return this.findBySelector(t,this.el,this.selectors)},findNode:function(t){const[e=null]=this.findNodes(t);return e},notify:function(t){if(this.paper){var e=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t].concat(e)),this.paper.trigger.apply(this.paper,[t,this].concat(e))}},getBBox:function(t){var e;if(t&&t.useModelGeometry){var n=this.model;e=n.getBBox().bbox(n.angle())}else e=this.getNodeBBox(this.el);return this.paper.localToPaperRect(e)},getNodeBBox:function(t){const e=this.getNodeBoundingRect(t),n=this.getRootTranslateMatrix().multiply(this.getNodeRotateMatrix(t)),i=this.getNodeMatrix(t);return k.transformRect(e,n.multiply(i))},getNodeRotateMatrix(t){return!this.rotatableNode||this.rotatableNode.contains(t)?this.getRootRotateMatrix():k.createSVGMatrix()},getNodeUnrotatedBBox:function(t){var e=this.getNodeBoundingRect(t),n=this.getNodeMatrix(t),i=this.getRootTranslateMatrix();return k.transformRect(e,i.multiply(n))},getRootTranslateMatrix:function(){var t=this.model,e=t.position(),n=k.createSVGMatrix().translate(e.x,e.y);return n},getRootRotateMatrix:function(){var t=k.createSVGMatrix(),e=this.model,n=e.angle();if(n){var i=e.getBBox(),r=i.width/2,s=i.height/2;t=t.translate(r,s).rotate(n).translate(-r,-s)}return t},_notifyHighlight:function(t,e,n={}){const{el:i}=this;let r;if(typeof e=="string"?r=this.findNode(e)||i:[r=i]=this.$(e),n.partial=r!==i,n.type===void 0){let s;switch(!0){case n.embedding:s=ks.EMBEDDING;break;case n.connecting:s=ks.CONNECTING;break;case n.magnetAvailability:s=ks.MAGNET_AVAILABILITY;break;case n.elementAvailability:s=ks.ELEMENT_AVAILABILITY;break;default:s=ks.DEFAULT;break}n.type=s}return this.notify(t,r,n),this},highlight:function(t,e){return this._notifyHighlight("cell:highlight",t,e)},unhighlight:function(t,e={}){return this._notifyHighlight("cell:unhighlight",t,e)},findMagnet:function(t){const e=this.el;let n=this.$(t)[0];n||(n=e);do{const i=n.getAttribute("magnet"),r=n===e;if((i||r)&&i!=="false")return n;if(r)return;n=n.parentNode}while(n)},findProxyNode:function(t,e){t||(t=this.el);const n=t.getAttribute(`${e}-selector`);if(n){const i=this.findNode(n);if(i)return i}return t},getSelector:function(t,e){var n;if(t===this.el)return typeof e=="string"&&(n=":scope > "+e),n;if(t){var i=k(t).index()+1;n=t.tagName+":nth-child("+i+")",e&&(n+=" > "+e),n=this.getSelector(t.parentNode,n)}return n},addLinkFromMagnet:function(t,e,n){var i=this.paper,r=i.model,s=i.getDefaultLink(this,t);return s.set({source:this.getLinkEnd(t,e,n,s,"source"),target:{x:e,y:n}}).addTo(r,{async:!1,ui:!0}),s.findView(i)},getLinkEnd:function(t,...e){var n=this.model,i=n.id,r=this.findAttribute("port",t),s=t.getAttribute("joint-selector"),o={id:i};return s!=null&&(o.magnet=s),r!=null?(o.port=r,!n.hasPort(r)&&!s&&(o.selector=this.getSelector(t))):s==null&&this.el!==t&&(o.selector=this.getSelector(t)),this.customizeLinkEnd(o,t,...e)},customizeLinkEnd:function(t,e,n,i,r,s){const{paper:o}=this,{connectionStrategy:a}=o.options;if(typeof a=="function"){var l=a.call(o,t,this,e,new L(n,i),r,s,o);if(l)return l}return t},getMagnetFromLinkEnd:function(t){var e=t.port,n=t.magnet,i=this.model,r;return e!=null&&i.isElement()&&i.hasPort(e)?r=this.findPortNode(e,n)||this.el:(n||(n=t.selector),!n&&e!=null&&(n='[port="'+e+'"]'),r=this.findNode(n)),this.findProxyNode(r,"magnet")},dragLinkStart:function(t,e,n,i){this.model.startBatch("add-link");const r=this.addLinkFromMagnet(e,n,i);r.notifyPointerdown(t,n,i),r.eventData(t,r.startArrowheadMove("target",{whenNotAllowed:"remove"})),this.eventData(t,{linkView:r})},dragLink:function(t,e,n){var i=this.eventData(t),r=i.linkView;if(r)r.pointermove(t,e,n);else{var s=this.paper,o=s.options.magnetThreshold,a=this.getEventTarget(t),l=i.targetMagnet;if(o==="onleave"){if(l===a||k(l).contains(a))return}else if(s.eventData(t).mousemoved<=o)return;this.dragLinkStart(t,l,e,n)}},dragLinkEnd:function(t,e,n){var i=this.eventData(t),r=i.linkView;r&&(r.pointerup(t,e,n),this.model.stopBatch("add-link"))},getAttributeDefinition:function(t){return this.model.constructor.getAttributeDefinition(t)},setNodeAttributes:function(t,e){xn(e)||(t instanceof SVGElement?k(t).attr(e):q(t).attr(e))},processNodeAttributes:function(t,e){var n,i,r,s,o,a,l,c,h,u=[];const d={};for(n in e)e.hasOwnProperty(n)&&(d[k.attributeNames[n]]=e[n]);for(n in d)d.hasOwnProperty(n)&&(i=d[n],r=this.getAttributeDefinition(n),r&&(!xt(r.qualify)||r.qualify.call(this,i,t,d,this))?(te(r.set)&&(a||(a={}),a[r.set]=i),i!==null&&u.push(n,r)):(a||(a={}),a[n]=i));for(s=0,o=u.length;s<o;s+=2)n=u[s],r=u[s+1],i=e[n],xt(r.set)&&(l||(l={}),l[n]=i),xt(r.position)&&(c||(c={}),c[n]=i),xt(r.offset)&&(h||(h={}),h[n]=i);return{raw:d,normal:a,set:l,position:c,offset:h}},updateRelativeAttributes:function(t,e,n,i){i||(i={});var r,s,o,a=Sm(e.raw||{},n),l=e.normal||{};for(const b in l)l[b]=a[b];var c=e.set,h=e.position,u=e.offset;for(r in c){s=a[r],o=this.getAttributeDefinition(r);var d=o.set.call(this,s,n.clone(),t,a,this);Nt(d)?U(l,d):d!==void 0&&(l[r]=d)}if(t instanceof HTMLElement){this.setNodeAttributes(t,l);return}var f=l.transform,p=k.transformStringToMatrix(f),g=L(p.e,p.f);f&&(l=Ze(l,"transform"),p.e=p.f=0);var v,x,S;if(h||u){var C=this.getNodeScale(t,i.scalableNode);v=C.sx,x=C.sy}var P=!1;for(r in h)s=a[r],o=this.getAttributeDefinition(r),S=o.position.call(this,s,n.clone(),t,a,this),S&&(g.offset(L(S).scale(v,x)),P||(P=!0));this.setNodeAttributes(t,l);var O=!1;if(u){var N=this.getNodeBoundingRect(t);if(N.width>0&&N.height>0){var m=k.transformRect(N,p).scale(1/v,1/x);for(r in u)s=a[r],o=this.getAttributeDefinition(r),S=o.offset.call(this,s,m,t,a,this),S&&(g.offset(L(S).scale(v,x)),O||(O=!0))}}(f!==void 0||P||O)&&(g.round(1),p.e=g.x,p.f=g.y,t.setAttribute("transform",k.matrixToTransformString(p)))},getNodeScale:function(t,e){var n,i;if(e&&e.contains(t)){var r=e.scale();n=1/r.sx,i=1/r.sy}else n=1,i=1;return{sx:n,sy:i}},cleanNodesCache:function(){this.metrics={}},nodeCache:function(t){var e=this.metrics;if(!e)return{};var n=k.ensureId(t),i=e[n];return i||(i=e[n]={}),i},getNodeData:function(t){var e=this.nodeCache(t);return e.data||(e.data={}),e.data},getNodeBoundingRect:function(t){var e=this.nodeCache(t);return e.boundingRect===void 0&&(e.boundingRect=k(t).getBBox()),new J(e.boundingRect)},getNodeMatrix:function(t){const e=this.nodeCache(t);if(e.magnetMatrix===void 0){const{rotatableNode:n,el:i}=this;let r;n&&n.contains(t)?r=n:r=i,e.magnetMatrix=k(t).getTransformToElement(r)}return k.createSVGMatrix(e.magnetMatrix)},getNodeShape:function(t){var e=this.nodeCache(t);return e.geometryShape===void 0&&(e.geometryShape=k(t).toGeometryShape()),e.geometryShape.clone()},isNodeConnection:function(t){return this.model.isLink()&&(!t||t===this.el)},findNodesAttributes:function(t,e,n,i){var r,s,o,a,l={},c=[];for(var h in t)if(t.hasOwnProperty(h)&&(o=t[h],!!Ee(o))){var u=n[h]=this.findBySelector(h,e,i);for(r=0,s=u.length;r<s;r++){var d=u[r];a=k.ensureId(d);var f=i&&i[h]===d,p=l[a];if(p){p.array||(c.push(a),p.array=!0,p.attributes=[p.attributes],p.selectedLength=[p.selectedLength]);var g=p.attributes,v=p.selectedLength;if(f)g.unshift(o),v.unshift(-1);else{var x=ou(v,s);g.splice(x,0,o),v.splice(x,0,s)}}else l[a]={attributes:o,selectedLength:f?-1:s,node:d,array:!1}}}for(r=0,s=c.length;r<s;r++)a=c[r],o=l[a],o.attributes=_e({},...o.attributes.reverse());return l},getEventTarget:function(t,e={}){const{target:n,type:i,clientX:r=0,clientY:s=0}=t;return e.fromPoint||i==="touchmove"||i==="touchend"||"pointerId"in t&&n.hasPointerCapture(t.pointerId)?document.elementFromPoint(r,s):n},updateDOMSubtreeAttributes:function(t,e,n){n||(n={}),n.rootBBox||(n.rootBBox=J()),n.selectors||(n.selectors=this.selectors);var i={},r={},s=[],o=[],a,l,c,h,u,d=n.roAttributes,f=this.findNodesAttributes(d||e,t,i,n.selectors),p=d?this.findNodesAttributes(e,t,i,n.selectors):f;for(var g in f)if(h=f[g],c=h.attributes,l=h.node,u=this.processNodeAttributes(l,c),!u.set&&!u.position&&!u.offset&&!u.raw.ref)this.setNodeAttributes(l,Sm(u.normal,n.rootBBox));else{var v=p[g]&&p[g].attributes,x=v&&c.ref===void 0?v.ref:c.ref,S;if(x){if(S=(i[x]||this.findBySelector(x,t,n.selectors))[0],!S)throw new Error('dia.CellView: "'+x+'" reference does not exist.')}else S=null;if(a={node:l,refNode:S,processedAttributes:u,allAttributes:v},S){var C=o.findIndex(function(P){return P.refNode===l});C>-1?o.splice(C,0,a):o.push(a)}else s.push(a)}s.push(...o);for(let P=0,O=s.length;P<O;P++){a=s[P],l=a.node,S=a.refNode;const N=S?k.ensureId(S):"";let m=r[N];m||(m=r[N]=S?k(S).getBBox({target:$F(l,S)}):n.rootBBox),d?(u=this.processNodeAttributes(l,a.allAttributes),this.mergeProcessedAttributes(u,a.processedAttributes)):u=a.processedAttributes,this.updateRelativeAttributes(l,u,m,n)}},mergeProcessedAttributes:function(t,e){t.set||(t.set={}),t.position||(t.position={}),t.offset||(t.offset={}),U(t.set,e.set),U(t.position,e.position),U(t.offset,e.offset);var n=t.normal&&t.normal.transform;n!==void 0&&e.normal&&(e.normal.transform=n),t.normal=e.normal},onMount(t){t||(this.mountTools(),ei.mount(this))},onDetach(){this.unmountTools(),ei.unmount(this)},onRemove:function(){this.removeTools(),this.removeHighlighters()},_toolsView:null,hasTools:function(t){var e=this._toolsView;return e?t?e.getName()===t:!0:!1},addTools:function(t){return this.removeTools(),t&&(this._toolsView=t,t.configure({relatedView:this}),t.listenTo(this.paper,"tools:event",this.onToolEvent.bind(this))),this},unmountTools(){const t=this._toolsView;return t&&t.unmount(),this},mountTools(){const t=this._toolsView;return t&&!t.isMounted()&&t.mount(),this},updateTools:function(t){var e=this._toolsView;return e&&e.update(t),this},removeTools:function(){var t=this._toolsView;return t&&(t.remove(),this._toolsView=null),this},hideTools:function(){var t=this._toolsView;return t&&t.hide(),this},showTools:function(){var t=this._toolsView;return t&&t.show(),this},onToolEvent:function(t){switch(t){case"remove":this.removeTools();break;case"hide":this.hideTools();break;case"show":this.showTools();break}},removeHighlighters:function(){ei.remove(this)},updateHighlighters:function(t=!1){ei.update(this,null,t)},transformHighlighters:function(){ei.transform(this)},preventDefaultInteraction(t){this.eventData(t,{defaultInteractionPrevented:!0})},isDefaultInteractionPrevented(t){const{defaultInteractionPrevented:e=!1}=this.eventData(t);return e},pointerdblclick:function(t,e,n){this.notify("cell:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){this.notify("cell:pointerclick",t,e,n)},contextmenu:function(t,e,n){this.notify("cell:contextmenu",t,e,n)},pointerdown:function(t,e,n){const{model:i}=this,{graph:r}=i;r&&(i.startBatch("pointer"),this.eventData(t,{graph:r})),this.notify("cell:pointerdown",t,e,n)},pointermove:function(t,e,n){this.notify("cell:pointermove",t,e,n)},pointerup:function(t,e,n){const{graph:i}=this.eventData(t);this.notify("cell:pointerup",t,e,n),i&&i.stopBatch("pointer",{cell:this.model})},mouseover:function(t){this.notify("cell:mouseover",t)},mouseout:function(t){this.notify("cell:mouseout",t)},mouseenter:function(t){this.notify("cell:mouseenter",t)},mouseleave:function(t){this.notify("cell:mouseleave",t)},mousewheel:function(t,e,n,i){this.notify("cell:mousewheel",t,e,n,i)},onevent:function(t,e,n,i){this.notify(e,t,n,i)},onmagnet:function(){},magnetpointerdblclick:function(){},magnetcontextmenu:function(){},checkMouseleave(t){const{paper:e,model:n}=this;if(e.isAsync()){if(n.isLink()){const s=n.getSourceElement();if(s){const a=e.findViewByModel(s);a&&(e.dumpView(a),e.checkViewVisibility(a))}const o=n.getTargetElement();if(o){const a=e.findViewByModel(o);a&&(e.dumpView(a),e.checkViewVisibility(a))}}e.dumpView(this),e.checkViewVisibility(this)}const i=this.getEventTarget(t,{fromPoint:!0}),r=e.findView(i);r!==this&&(this.mouseleave(t),r&&r.mouseenter(t))},setInteractivity:function(t){this.options.interactive=t}},{Flags:RF,Highlighting:ks,addPresentationAttributes:function(t){return _e({},Qt(this.prototype,"presentationAttributes"),t,function(e,n){if(!(!e||!n)&&(typeof e=="string"&&(e=[e]),typeof n=="string"&&(n=[n]),Array.isArray(e)&&Array.isArray(n)))return mi(e.concat(n))})},evalAttribute:jx});Object.defineProperty(Gt.prototype,"useCSSSelectors",{get(){const t=this.model.useCSSSelectors;return t!==void 0?t:ir.useCSSSelectors}});function $F(t,e){let n=t;do{if(n.contains(e))return n;n=n.parentNode}while(n);return null}const Zt={TOOLS:Gt.Flags.TOOLS,UPDATE:"UPDATE",TRANSLATE:"TRANSLATE",RESIZE:"RESIZE",PORTS:"PORTS",ROTATE:"ROTATE",RENDER:"RENDER"},Ls={MOVE:"move",MAGNET:"magnet"},Te=Gt.extend({_removePorts:function(){},_renderPorts:function(){},className:function(){var t=Gt.prototype.className.apply(this).split(" ");return t.push("element"),t.join(" ")},initialize:function(){Gt.prototype.initialize.apply(this,arguments),this._initializePorts()},presentationAttributes:{attrs:[Zt.UPDATE],position:[Zt.TRANSLATE,Zt.TOOLS],size:[Zt.RESIZE,Zt.PORTS,Zt.TOOLS],angle:[Zt.ROTATE,Zt.TOOLS],markup:[Zt.RENDER],ports:[Zt.PORTS]},initFlag:[Zt.RENDER],UPDATE_PRIORITY:0,confirmUpdate:function(t,e){const{useCSSSelectors:n}=this;this.hasFlag(t,Zt.PORTS)&&(this._removePorts(),this._cleanPortsCache());let i=!1;if(this.hasFlag(t,Zt.RENDER))this.render(),this.updateTools(e),this.updateHighlighters(!0),i=!0,t=this.removeFlag(t,[Zt.RENDER,Zt.UPDATE,Zt.RESIZE,Zt.TRANSLATE,Zt.ROTATE,Zt.PORTS,Zt.TOOLS]);else{let r=!1;this.hasFlag(t,Zt.RESIZE)&&(this.resize(e),r=!0,t=this.removeFlag(t,[Zt.RESIZE,Zt.UPDATE]),n&&(t=this.removeFlag(t,Zt.PORTS))),this.hasFlag(t,Zt.UPDATE)&&(this.update(this.model,null,e),t=this.removeFlag(t,Zt.UPDATE),r=!0,n&&(t=this.removeFlag(t,Zt.PORTS))),this.hasFlag(t,Zt.TRANSLATE)&&(this.translate(),t=this.removeFlag(t,Zt.TRANSLATE),i=!0),this.hasFlag(t,Zt.ROTATE)&&(this.rotate(),t=this.removeFlag(t,Zt.ROTATE),i=!0),this.hasFlag(t,Zt.PORTS)&&(this._renderPorts(),r=!0,t=this.removeFlag(t,Zt.PORTS)),r&&this.updateHighlighters(!1)}return i&&this.transformHighlighters(),this.hasFlag(t,Zt.TOOLS)&&(this.updateTools(e),t=this.removeFlag(t,Zt.TOOLS)),t},_initializePorts:function(){},update:function(t,e){this.cleanNodesCache();const{useCSSSelectors:n}=this;n&&this._removePorts();var i=this.model,r=i.attr();this.updateDOMSubtreeAttributes(this.el,r,{rootBBox:new J(i.size()),selectors:this.selectors,scalableNode:this.scalableNode,rotatableNode:this.rotatableNode,roAttributes:e===r?null:e}),n&&this._renderPorts()},rotatableSelector:"rotatable",scalableSelector:"scalable",scalableNode:null,rotatableNode:null,renderMarkup:function(){var t=this.model,e=t.get("markup")||t.markup;if(!e)throw new Error("dia.ElementView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if(typeof e=="string")return this.renderStringMarkup(e);throw new Error("dia.ElementView: invalid markup")},renderJSONMarkup:function(t){var e=this.parseDOMJSON(t,this.el),n=this.selectors=e.selectors;this.rotatableNode=k(n[this.rotatableSelector])||null,this.scalableNode=k(n[this.scalableSelector])||null,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=this.vel;e.append(k(t)),this.rotatableNode=e.findOne(".rotatable"),this.scalableNode=e.findOne(".scalable");var n=this.selectors={};n[this.selector]=this.el},render:function(){return this.vel.empty(),this.renderMarkup(),this.scalableNode&&this.update(),this.resize(),this.rotatableNode?(this.rotate(),this.translate()):this.updateTransformation(),this.useCSSSelectors||this._renderPorts(),this},resize:function(t){if(this.scalableNode)return this.sgResize(t);this.model.attributes.angle&&this.rotate(),this.update()},translate:function(){if(this.rotatableNode)return this.rgTranslate();this.updateTransformation()},rotate:function(){if(this.rotatableNode){this.rgRotate(),this.update();return}this.updateTransformation()},updateTransformation:function(){var t=this.getTranslateString(),e=this.getRotateString();e&&(t+=" "+e),this.vel.attr("transform",t)},getTranslateString:function(){var t=this.model.attributes.position;return"translate("+t.x+","+t.y+")"},getRotateString:function(){var t=this.model.attributes,e=t.angle;if(!e)return null;var n=t.size;return"rotate("+e+","+n.width/2+","+n.height/2+")"},rgRotate:function(){this.rotatableNode.attr("transform",this.getRotateString())},rgTranslate:function(){this.vel.attr("transform",this.getTranslateString())},sgResize:function(t){var e=this.model,n=e.angle(),i=e.size(),r=this.scalableNode,s=!1;r.node.getElementsByTagName("path").length>0&&(s=!0);var o=r.getBBox({recursive:s}),a=i.width/(o.width||1),l=i.height/(o.height||1);r.attr("transform","scale("+a+","+l+")");var c=this.rotatableNode,h=c&&c.attr("transform");if(h){c.attr("transform",h+" rotate("+-n+","+i.width/2+","+i.height/2+")");var u=r.getBBox({target:this.paper.cells});e.set("position",{x:u.x,y:u.y},U({updateHandled:!0},t)),this.translate(),this.rotate()}this.update()},prepareEmbedding:function(t={}){const e=t.model||this.model,i=(t.paper||this.paper).model,r=t.initialZIndices={},s=e.getEmbeddedCells({deep:!0}),o=i.getConnectedLinks(e,{deep:!0,includeEnclosed:!0});[e,...s,...o].forEach(c=>r[c.id]=c.attributes.z),e.startBatch("to-front"),e.toFront({deep:!0,ui:!0});const a=i.getElements().reduce((c,h)=>Math.max(c,h.attributes.z||0),0);o.forEach(c=>{c.attributes.z<=a&&c.set("z",a+1,{ui:!0})}),e.stopBatch("to-front");const l=e.parent();l?(i.getCell(l).unembed(e,{ui:!0}),t.initialParentId=l):t.initialParentId=null},processEmbedding:function(t={},e,n,i){const r=t.model||this.model,s=t.paper||this.paper,o=s.model,{findParentBy:a,frontParentOnly:l,validateEmbedding:c}=s.options;let h;xt(a)?h=ft(a.call(o,this,e,n,i)):a==="pointer"?h=ft(o.findModelsFromPoint({x:n,y:i})):h=o.findModelsUnderElement(r,{searchBy:a}),h=h.filter(f=>f instanceof rn&&r.id!==f.id&&!f.isEmbeddedIn(r)),l&&(h=h.slice(-1));let u=null;const d=t.candidateEmbedView;for(let f=h.length-1;f>=0;f--){const p=h[f];if(d&&d.model.id==p.id){u=d;break}else{const g=p.findView(s);if(!xt(c)||c.call(s,this,g)){u=g;break}}}u&&u!=d&&(this.clearEmbedding(t),t.candidateEmbedView=u.highlight(u.findProxyNode(null,"container"),{embedding:!0})),!u&&d&&this.clearEmbedding(t)},clearEmbedding:function(t){t||(t={});var e=t.candidateEmbedView;e&&(e.unhighlight(e.findProxyNode(null,"container"),{embedding:!0}),t.candidateEmbedView=null)},finalizeEmbedding:function(t={}){const e=t.candidateEmbedView,n=t.model||this.model,i=t.paper||this.paper;if(e)e.model.embed(n,{ui:!0}),e.unhighlight(e.findProxyNode(null,"container"),{embedding:!0}),t.candidateEmbedView=null;else{const{validateUnembedding:r}=i.options,{initialParentId:s}=t;if(s&&typeof r=="function"&&!r.call(i,this)){this._disallowUnembed(t);return}}i.model.getConnectedLinks(n,{deep:!0}).forEach(r=>{r.reparent({ui:!0})})},_disallowUnembed:function(t){const{model:e,whenNotAllowed:n="revert"}=t,i=e||this.model,s=(t.paper||this.paper).model;switch(n){case"remove":{i.remove({ui:!0});break}case"revert":{const{initialParentId:o,initialPosition:a,initialZIndices:l}=t;if(a){const{x:h,y:u}=a;i.position(h,u,{deep:!0,ui:!0})}l&&Object.keys(l).forEach(h=>{const u=s.getCell(h);u&&u.set("z",l[h],{ui:!0})});const c=s.getCell(o);c&&c.embed(i,{ui:!0});break}}},getDelegatedView:function(){for(var t=this,e=t.model,n=t.paper;t&&!e.isLink();){if(!e.isEmbedded()||t.can("stopDelegation"))return t;e=e.getParentCell(),t=n.findViewByModel(e)}return null},findProxyNode:function(t,e){t||(t=this.el);const n=t.getAttribute(`${e}-selector`);if(n){const i=this.findAttribute("port",t);if(i){const r=this.findPortNode(i,n);if(r)return r}else{const r=this.findNode(n);if(r)return r}}return t},notifyPointerdown(t,e,n){Gt.prototype.pointerdown.call(this,t,e,n),this.notify("element:pointerdown",t,e,n)},notifyPointermove(t,e,n){Gt.prototype.pointermove.call(this,t,e,n),this.notify("element:pointermove",t,e,n)},notifyPointerup(t,e,n){this.notify("element:pointerup",t,e,n),Gt.prototype.pointerup.call(this,t,e,n)},pointerdblclick:function(t,e,n){Gt.prototype.pointerdblclick.apply(this,arguments),this.notify("element:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){Gt.prototype.pointerclick.apply(this,arguments),this.notify("element:pointerclick",t,e,n)},contextmenu:function(t,e,n){Gt.prototype.contextmenu.apply(this,arguments),this.notify("element:contextmenu",t,e,n)},pointerdown:function(t,e,n){this.notifyPointerdown(t,e,n),this.dragStart(t,e,n)},pointermove:function(t,e,n){const i=this.eventData(t),{targetMagnet:r,action:s,delegatedView:o}=i;switch(r&&this.magnetpointermove(t,r,e,n),s){case Ls.MAGNET:this.dragMagnet(t,e,n);break;case Ls.MOVE:(o||this).drag(t,e,n);default:if(i.preventPointerEvents)break;this.notifyPointermove(t,e,n);break}this.eventData(t,i)},pointerup:function(t,e,n){const i=this.eventData(t),{targetMagnet:r,action:s,delegatedView:o}=i;switch(r&&this.magnetpointerup(t,r,e,n),s){case Ls.MAGNET:this.dragMagnetEnd(t,e,n);break;case Ls.MOVE:(o||this).dragEnd(t,e,n);default:if(i.preventPointerEvents)break;this.notifyPointerup(t,e,n)}r&&this.magnetpointerclick(t,r,e,n),this.checkMouseleave(t)},mouseover:function(t){Gt.prototype.mouseover.apply(this,arguments),this.notify("element:mouseover",t)},mouseout:function(t){Gt.prototype.mouseout.apply(this,arguments),this.notify("element:mouseout",t)},mouseenter:function(t){Gt.prototype.mouseenter.apply(this,arguments),this.notify("element:mouseenter",t)},mouseleave:function(t){Gt.prototype.mouseleave.apply(this,arguments),this.notify("element:mouseleave",t)},mousewheel:function(t,e,n,i){Gt.prototype.mousewheel.apply(this,arguments),this.notify("element:mousewheel",t,e,n,i)},onmagnet:function(t,e,n){const{currentTarget:i}=t;this.magnetpointerdown(t,i,e,n),this.eventData(t,{targetMagnet:i}),this.dragMagnetStart(t,e,n)},magnetpointerdown:function(t,e,n,i){this.notify("element:magnet:pointerdown",t,e,n,i)},magnetpointermove:function(t,e,n,i){this.notify("element:magnet:pointermove",t,e,n,i)},magnetpointerup:function(t,e,n,i){this.notify("element:magnet:pointerup",t,e,n,i)},magnetpointerdblclick:function(t,e,n,i){this.notify("element:magnet:pointerdblclick",t,e,n,i)},magnetcontextmenu:function(t,e,n,i){this.notify("element:magnet:contextmenu",t,e,n,i)},dragStart:function(t,e,n){if(this.isDefaultInteractionPrevented(t))return;var i=this.getDelegatedView();if(!i||!i.can("elementMove"))return;this.eventData(t,{action:Ls.MOVE,delegatedView:i});const r=i.model.position();i.eventData(t,{initialPosition:r,pointerOffset:r.difference(e,n),restrictedArea:this.paper.getRestrictedArea(i,e,n)})},dragMagnetStart:function(t,e,n){const{paper:i}=this,r=t.isPropagationStopped();if(r&&this.eventData(t,{preventPointerEvents:!0}),this.isDefaultInteractionPrevented(t)||!this.can("addLinkFromMagnet"))return;const{targetMagnet:s=t.currentTarget}=this.eventData(t);if(t.stopPropagation(),!i.options.validateMagnet.call(i,this,s,t)){r?this.dragStart(t,e,n):this.pointerdown(t,e,n);return}i.options.magnetThreshold<=0&&this.dragLinkStart(t,s,e,n),this.eventData(t,{action:Ls.MAGNET})},drag:function(t,e,n){var i=this.paper,r=i.options.gridSize,s=this.model,o=this.eventData(t),{pointerOffset:a,restrictedArea:l,embedding:c}=o,h=ii(e+a.x,r),u=ii(n+a.y,r);s.position(h,u,{restrictedArea:l,deep:!0,ui:!0}),i.options.embeddingMode&&(c||(this.prepareEmbedding(o),c=!0),this.processEmbedding(o,t,e,n)),this.eventData(t,{embedding:c})},dragMagnet:function(t,e,n){this.dragLink(t,e,n)},dragEnd:function(t,e,n){var i=this.eventData(t);i.embedding&&this.finalizeEmbedding(i)},dragMagnetEnd:function(t,e,n){this.dragLinkEnd(t,e,n)},magnetpointerclick:function(t,e,n,i){var r=this.paper;r.eventData(t).mousemoved>r.options.clickThreshold||this.notify("element:magnet:pointerclick",t,e,n,i)}},{Flags:Zt});U(Te.prototype,f3);const Jt={TOOLS:Gt.Flags.TOOLS,RENDER:"RENDER",UPDATE:"UPDATE",LABELS:"LABELS",SOURCE:"SOURCE",TARGET:"TARGET",CONNECTOR:"CONNECTOR"},Xs=Gt.extend({className:function(){var t=Gt.prototype.className.apply(this).split(" ");return t.push("link"),t.join(" ")},_labelCache:null,_labelSelectors:null,_V:null,_dragData:null,metrics:null,decimalsRounding:2,initialize:function(){Gt.prototype.initialize.apply(this,arguments),this._labelCache={},this._labelSelectors={},this._V={},this.cleanNodesCache()},presentationAttributes:{markup:[Jt.RENDER],attrs:[Jt.UPDATE],router:[Jt.UPDATE],connector:[Jt.CONNECTOR],labels:[Jt.LABELS],labelMarkup:[Jt.LABELS],vertices:[Jt.UPDATE],source:[Jt.SOURCE,Jt.UPDATE],target:[Jt.TARGET,Jt.UPDATE]},initFlag:[Jt.RENDER,Jt.SOURCE,Jt.TARGET,Jt.TOOLS],UPDATE_PRIORITY:1,confirmUpdate:function(t,e){if(e||(e={}),this.hasFlag(t,Jt.SOURCE)){if(!this.updateEndProperties("source"))return t;t=this.removeFlag(t,Jt.SOURCE)}if(this.hasFlag(t,Jt.TARGET)){if(!this.updateEndProperties("target"))return t;t=this.removeFlag(t,Jt.TARGET)}const{paper:n,sourceView:i,targetView:r}=this;if(n&&(i&&!n.isViewMounted(i)||r&&!n.isViewMounted(r)))return t;if(this.hasFlag(t,Jt.RENDER))return this.render(),this.updateHighlighters(!0),this.updateTools(e),t=this.removeFlag(t,[Jt.RENDER,Jt.UPDATE,Jt.LABELS,Jt.TOOLS,Jt.CONNECTOR]),t;let s=!1;const{model:o}=this,{attributes:a}=o;let l=this.hasFlag(t,Jt.LABELS);l&&(this.onLabelsChange(o,a.labels,e),t=this.removeFlag(t,Jt.LABELS),s=!0);const c=this.hasFlag(t,Jt.UPDATE),h=this.hasFlag(t,Jt.CONNECTOR);return(c||h)&&(c?e.translateBy&&o.isRelationshipEmbeddedIn(e.translateBy)?this.translate(e.tx,e.ty):this.update():(this.updatePath(),this.updateDOM()),this.updateTools(e),t=this.removeFlag(t,[Jt.UPDATE,Jt.TOOLS,Jt.CONNECTOR]),l=!1,s=!0),l&&this.updateLabelPositions(),s&&this.updateHighlighters(),this.hasFlag(t,Jt.TOOLS)&&(this.updateTools(e),t=this.removeFlag(t,Jt.TOOLS)),t},requestConnectionUpdate:function(t){this.requestUpdate(this.getFlag(Jt.UPDATE),t)},isLabelsRenderRequired:function(t={}){const e=this.model.previous("labels");if(!e)return!0;if("propertyPathArray"in t&&"propertyValue"in t){var n=t.propertyPathArray||[],i=n.length;if(i>1){var r=!!e[n[1]];if(r){if(i===2)return"markup"in Object(t.propertyValue);if(n[2]!=="markup")return!1}}}return!0},onLabelsChange:function(t,e,n){this.isLabelsRenderRequired(n)?this.renderLabels():this.updateLabels()},render:function(){return this.vel.empty(),this.unmountLabels(),this._V={},this.renderMarkup(),this.renderLabels(),this.update(),this},renderMarkup:function(){var t=this.model,e=t.get("markup")||t.markup;if(!e)throw new Error("dia.LinkView: markup required");if(Array.isArray(e))return this.renderJSONMarkup(e);if(typeof e=="string")return this.renderStringMarkup(e);throw new Error("dia.LinkView: invalid markup")},renderJSONMarkup:function(t){var e=this.parseDOMJSON(t,this.el);this.selectors=e.selectors,this.vel.append(e.fragment)},renderStringMarkup:function(t){var e=k(t);Array.isArray(e)||(e=[e]),this.vel.append(e)},_getLabelMarkup:function(t){if(t){if(Array.isArray(t))return this.parseDOMJSON(t,null);if(typeof t=="string")return this._getLabelStringMarkup(t);throw new Error("dia.linkView: invalid label markup")}},_getLabelStringMarkup:function(t){var e=k(t),n=document.createDocumentFragment();if(!Array.isArray(e))n.appendChild(e.node);else for(var i=0,r=e.length;i<r;i++){var s=e[i].node;n.appendChild(s)}return{fragment:n,selectors:{}}},_normalizeLabelMarkup:function(t){if(t){var e=t.fragment;if(!(t.fragment instanceof DocumentFragment)||!t.fragment.hasChildNodes())throw new Error("dia.LinkView: invalid label markup.");var n,i=e.childNodes;return i.length>1||i[0].nodeName.toUpperCase()!=="G"?n=k("g").append(e):n=k(i[0]),n.addClass("label"),{node:n.node,selectors:t.selectors}}},renderLabels:function(){var t=this._V,e=t.labels,n=this._labelCache={},i=this._labelSelectors={},r=this.model,s=r.attributes.labels||[],o=s.length;if(o===0)return e&&e.remove(),this;e?e.empty():(e=t.labels=k("g").addClass("labels"),this.options.labelsLayer&&(e.addClass(En(Qt(this,"className"))),e.attr("model-id",r.id)));for(var a=0;a<o;a++){var l=s[a],c=this._normalizeLabelMarkup(this._getLabelMarkup(l.markup)),h,u;if(c)h=c.node,u=c.selectors;else{var d=r._builtins.defaultLabel,f=this._normalizeLabelMarkup(this._getLabelMarkup(d.markup)),p=r._getDefaultLabel(),g=this._normalizeLabelMarkup(this._getLabelMarkup(p.markup)),v=g||f;h=v.node,u=v.selectors}h.setAttribute("label-idx",a),e.append(h),n[a]=h;var x=this.selector;if(u[x])throw new Error("dia.LinkView: ambiguous label root selector.");u[x]=h,i[a]=u}return e.parent()||this.mountLabels(),this.updateLabels(),this},mountLabels:function(){const{el:t,paper:e,model:n,_V:i,options:r}=this,{labels:s}=i;if(!s||!n.hasLabels())return;const{node:o}=s;r.labelsLayer?e.getLayerView(r.labelsLayer).insertSortedNode(o,n.get("z")):o.parentNode!==t&&t.appendChild(o)},unmountLabels:function(){const{options:t,_V:e}=this;if(!e)return;const{labels:n}=e;n&&t.labelsLayer&&n.remove()},findLabelNodes:function(t,e){const n=this._labelCache[t];if(!n)return[];const i=this._labelSelectors[t];return this.findBySelector(e,n,i)},findLabelNode:function(t,e){const[n=null]=this.findLabelNodes(t,e);return n},_mergeLabelAttrs:function(t,e,n,i){return e===null?null:e===void 0?n===null?null:n===void 0?t?void 0:i:t?n:_e({},i,n):t?_e({},n,e):_e({},i,n,e)},_mergeLabelSize:function(t,e){return t===null?null:t===void 0?e===null?null:e===void 0?void 0:e:_e({},e,t)},updateLabels:function(){if(!this._V.labels)return this;for(var t=this.model,e=t.get("labels")||[],n=this.can("labelMove"),i=t._builtins.defaultLabel,r=i.attrs,s=t._getDefaultLabel(),o=s.markup,a=s.attrs,l=s.size,c=0,h=e.length;c<h;c++){var u=this._labelCache[c];u.setAttribute("cursor",n?"move":"default");var d=this._labelSelectors[c],f=e[c],p=f.markup,g=f.attrs,v=f.size,x=this._mergeLabelAttrs(p||o,g,a,r),S=this._mergeLabelSize(v,l);this.updateDOMSubtreeAttributes(u,x,{rootBBox:new J(S),selectors:d})}return this},removeRedundantLinearVertices:function(t){const n=this.model,i=n.vertices(),r=[this.sourceAnchor,...i,this.targetAnchor],s=r.length,o=new Ae(r);o.simplify({threshold:.001});const a=o.points.map(c=>c.toJSON()),l=a.length;return s===l?0:(n.vertices(a.slice(1,l-1),t),s-l)},getEndView:function(t){switch(t){case"source":return this.sourceView||null;case"target":return this.targetView||null;default:throw new Error("dia.LinkView: type parameter required.")}},getEndAnchor:function(t){switch(t){case"source":return new L(this.sourceAnchor);case"target":return new L(this.targetAnchor);default:throw new Error("dia.LinkView: type parameter required.")}},getEndConnectionPoint:function(t){switch(t){case"source":return new L(this.sourcePoint);case"target":return new L(this.targetPoint);default:throw new Error("dia.LinkView: type parameter required.")}},getEndMagnet:function(t){switch(t){case"source":var e=this.sourceView;if(!e)break;return this.sourceMagnet||e.el;case"target":var n=this.targetView;if(!n)break;return this.targetMagnet||n.el;default:throw new Error("dia.LinkView: type parameter required.")}return null},update:function(){return this.updateRoute(),this.updatePath(),this.updateDOM(),this},translate:function(t=0,e=0){const{route:n,path:i}=this;if(!n||!i)return;const r=new Ae(n);r.translate(t,e),this.route=r.points,this.sourcePoint.offset(t,e),this.targetPoint.offset(t,e),this.sourceAnchor.offset(t,e),this.targetAnchor.offset(t,e),i.translate(t,e),this.updateDOM()},updateDOM(){const{el:t,model:e,selectors:n}=this;this.cleanNodesCache(),this.updateDOMSubtreeAttributes(t,e.attr(),{selectors:n}),this.updateLabelPositions(),this.options.perpendicular=null},updateRoute:function(){const{model:t}=this,e=t.vertices(),n=this.findAnchors(e),i=this.sourceAnchor=n.source,r=this.targetAnchor=n.target,s=this.findRoute(e);this.route=s;var o=this.findConnectionPoints(s,i,r);this.sourcePoint=o.source,this.targetPoint=o.target},updatePath:function(){const{route:t,sourcePoint:e,targetPoint:n}=this,i=this.findPath(t,e.clone(),n.clone());this.path=i},findAnchorsOrdered:function(t,e,n,i){var r,s,o,a,l=this.model,c=l.get(t),h=l.get(n),u=this.getEndView(t),d=this.getEndView(n),f=this.getEndMagnet(t),p=this.getEndMagnet(n);u?(e?o=new L(e):d?o=p:o=new L(h),r=this.getAnchor(c.anchor,u,f,o,t)):r=new L(c),d?(a=new L(i||r),s=this.getAnchor(h.anchor,d,p,a,n)):s=new L(h);var g={};return g[t]=r,g[n]=s,g},findAnchors:function(t){var e=this.model,n=t[0],i=t[t.length-1];return e.target().priority&&!e.source().priority?this.findAnchorsOrdered("target",i,"source",n):this.findAnchorsOrdered("source",n,"target",i)},findConnectionPoints:function(t,e,n){var i=t[0],r=t[t.length-1],s=this.model,o=s.get("source"),a=s.get("target"),l=this.sourceView,c=this.targetView,h=this.paper.options,u,d,f;if(l&&!l.isNodeConnection(this.sourceMagnet)){u=this.sourceMagnet||l.el;var p=o.connectionPoint||h.defaultConnectionPoint,g=i||n,v=new pt(g,e);f=this.getConnectionPoint(p,l,u,v,"source")}else f=e;var x;if(c&&!c.isNodeConnection(this.targetMagnet)){d=this.targetMagnet||c.el;var S=a.connectionPoint||h.defaultConnectionPoint,C=r||e,P=new pt(C,n);x=this.getConnectionPoint(S,c,d,P,"target")}else x=n;return{source:f,target:x}},getAnchor:function(t,e,n,i,r){var s=e.isNodeConnection(n),o=this.paper.options;if(t||(s?t=o.defaultLinkAnchor:this.options.perpendicular?t={name:"perpendicular"}:t=o.defaultAnchor),!t)throw new Error("Anchor required.");var a;if(typeof t=="function")a=t;else{var l=t.name,c=s?"linkAnchorNamespace":"anchorNamespace";if(a=o[c][l],typeof a!="function")throw new Error("Unknown anchor: "+l)}var h=a.call(this,e,n,i,t.args||{},r,this);return h?h.round(this.decimalsRounding):new L},getConnectionPoint:function(t,e,n,i,r){var s,o=i.end,a=this.paper.options;if(!t)return o;var l;if(typeof t=="function")l=t;else{var c=t.name;if(l=a.connectionPointNamespace[c],typeof l!="function")throw new Error("Unknown connection point: "+c)}return s=l.call(this,i,e,n,t.args||{},r,this),s?s.round(this.decimalsRounding):o},_getDefaultLabelPositionProperty:function(){var t=this.model,e=t._builtins.defaultLabel,n=e.position,i=t._getDefaultLabel(),r=this._normalizeLabelPosition(i.position);return _e({},n,r)},_normalizeLabelPosition:function(t){return typeof t=="number"?{distance:t,offset:null,angle:0,args:null}:t},_mergeLabelPositionProperty:function(t,e){return t===null?null:t===void 0?e===null?null:e:_e({},e,t)},updateLabelPositions:function(){if(!this._V.labels)return this;var t=this.path;if(!t)return this;var e=this.model,n=e.get("labels")||[];if(!n.length)return this;for(var i=this._getDefaultLabelPositionProperty(),r=0,s=n.length;r<s;r++){var o=this._labelCache[r];if(o){var a=n[r],l=this._normalizeLabelPosition(a.position),c=this._mergeLabelPositionProperty(l,i),h=this._getLabelTransformationMatrix(c);o.setAttribute("transform",k.matrixToTransformString(h)),this._cleanLabelMatrices(r)}}return this},_cleanLabelMatrices:function(t){const{metrics:e,_labelSelectors:n}=this,i=n[t];if(i)for(let r in i){const{id:s}=i[r];s&&s in e&&delete e[s].magnetMatrix}},updateEndProperties:function(t){const{model:e,paper:n}=this,i=`${t}View`,r=e.get(t),s=r&&r.id;if(!s)return this[i]=null,this.updateEndMagnet(t),!0;const o=n.getModelById(s);if(!o)throw new Error("LinkView: invalid "+t+" cell.");const a=o.findView(n);return a?(this[i]=a,this.updateEndMagnet(t),!0):!1},updateEndMagnet:function(t){const e=`${t}Magnet`,n=this.getEndView(t);if(n){let i=n.getMagnetFromLinkEnd(this.model.get(t));i===n.el&&(i=null),this[e]=i}else this[e]=null},_getLabelPositionProperty:function(t){return this.model.label(t).position||{}},_getLabelPositionAngle:function(t){var e=this._getLabelPositionProperty(t);return e.angle||0},_getLabelPositionArgs:function(t){var e=this._getLabelPositionProperty(t);return e.args},_getDefaultLabelPositionArgs:function(){var t=this.model._getDefaultLabel(),e=t.position||{};return e.args},_mergeLabelPositionArgs:function(t,e){return t===null?null:t===void 0?e===null?null:e:_e({},e,t)},addLabel:function(t,e,n,i){var r,s,o=0,a;typeof t!="number"?(r=t.x,s=t.y,typeof e=="number"?(o=e,a=n):a=e):(r=t,s=e,typeof n=="number"?(o=n,a=i):a=n);var l=this._getDefaultLabelPositionArgs(),c=a,h=this._mergeLabelPositionArgs(c,l),u={position:this.getLabelPosition(r,s,o,h)},d=-1;return this.model.insertLabel(d,u,a),d},addVertex:function(t,e,n){var i=typeof t!="number",r=i?t.x:t,s=i?t.y:e,o=i?e:n,a={x:r,y:s},l=this.getVertexIndex(r,s);return this.model.insertVertex(l,a,o),l},sendToken:function(t,e,n){function i(u,d){return function(){u.remove(),typeof d=="function"&&d()}}var r,s,o;Nt(e)?(r=e.duration,s=e.direction==="reverse",o=e.connection):(r=e,s=!1,o=null),r=r||1e3;var a={dur:r+"ms",repeatCount:1,calcMode:"linear",fill:"freeze"};s&&(a.keyPoints="1;0",a.keyTimes="0;1");var l=k(t),c;if(typeof o=="string")c=this.findNode(o);else{var h=this._V;c=h.connection?h.connection.node:this.el.querySelector("path")}if(!(c instanceof SVGPathElement))throw new Error("dia.LinkView: token animation requires a valid connection path.");l.appendTo(this.paper.cells).animateAlongPath(a,c),setTimeout(i(l,n),r)},findRoute:function(t){t||(t=[]);var e=this.paper.options.routerNamespace||lF,n=this.model.router(),i=this.paper.options.defaultRouter;if(!n)if(i)n=i;else return t.map(L);var r=xt(n)?n:e[n.name];if(!xt(r))throw new Error('dia.LinkView: unknown router: "'+n.name+'".');var s=n.args||{},o=r.call(this,t,s,this);return o||t.map(L)},findPath:function(t,e,n){var i=this.paper.options.connectorNamespace||oB,r=this.model.connector(),s=this.paper.options.defaultConnector;r||(r=s||{});var o=xt(r)?r:i[r.name];if(!xt(o))throw new Error('dia.LinkView: unknown connector: "'+r.name+'".');var a=be(r.args||{});a.raw=!0;var l=o.call(this,e,n,t,a,this);return typeof l=="string"&&(l=new K(k.normalizePathData(l))),l},getConnection:function(){var t=this.path;return t?t.clone():null},getSerializedConnection:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("data"))return e.data;var n=t.serialize();return e.data=n,n},getConnectionSubdivisions:function(){var t=this.path;if(!t)return null;var e=this.metrics;if(e.hasOwnProperty("segmentSubdivisions"))return e.segmentSubdivisions;var n=t.getSegmentSubdivisions();return e.segmentSubdivisions=n,n},getConnectionLength:function(){var t=this.path;if(!t)return 0;var e=this.metrics;if(e.hasOwnProperty("length"))return e.length;var n=t.length({segmentSubdivisions:this.getConnectionSubdivisions()});return e.length=n,n},getPointAtLength:function(t){var e=this.path;return e?e.pointAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getPointAtRatio:function(t){var e=this.path;return e?(Ue(t)&&(t=parseFloat(t)/100),e.pointAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()})):null},getTangentAtLength:function(t){var e=this.path;return e?e.tangentAtLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getTangentAtRatio:function(t){var e=this.path;return e?e.tangentAt(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPoint:function(t){var e=this.path;return e?e.closestPoint(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointLength:function(t){var e=this.path;return e?e.closestPointLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getClosestPointRatio:function(t){var e=this.path;return e?e.closestPointNormalizedLength(t,{segmentSubdivisions:this.getConnectionSubdivisions()}):null},getLabelPosition:function(t,e,n,i){var r={},s=0,o;typeof n=="number"?(s=n,o=i):o=n,o&&(r.args=o);var a=!(o&&o.absoluteDistance),l=o&&o.absoluteDistance&&o.reverseDistance,c=o&&o.absoluteOffset,h=this.path,u={segmentSubdivisions:this.getConnectionSubdivisions()},d=new L(t,e),f=h.closestPointT(d,u),p=h.lengthAtT(f,u);a&&(p=p/this.getConnectionLength()||0),l&&(p=-1*(this.getConnectionLength()-p)||1),r.distance=p;var g;c||(g=h.tangentAtT(f));var v;if(g)v=g.pointOffset(d);else{var x=h.pointAtT(f),S=d.difference(x);v={x:S.x,y:S.y}}return r.offset=v,r.angle=s,r},_getLabelTransformationMatrix:function(t){var e,n=0,i={};if(typeof t=="number")e=t;else if(typeof t.distance=="number")i=t.args||{},e=t.distance,n=t.angle||0;else throw new Error("dia.LinkView: invalid label position distance.");var r=e>0&&e<=1,s=0,o={x:0,y:0};if(t.offset){var a=t.offset;typeof a=="number"&&(s=a),a.x&&(o.x=a.x),a.y&&(o.y=a.y)}var l=o.x!==0||o.y!==0||s===0,c=i.keepGradient,h=i.ensureLegibility,u=this.path,d={segmentSubdivisions:this.getConnectionSubdivisions()},f=r?e*this.getConnectionLength():e,p=u.tangentAtLength(f,d),g,v=n;if(p){if(l)g=p.start.clone(),g.offset(o);else{var x=p.clone();x.rotate(p.start,-90),x.setLength(s),g=x.end}c&&(v=p.angle()+n,h&&(v=Qe((v+90)%180-90)))}else g=u.start.clone(),l&&g.offset(o);return k.createSVGMatrix().translate(g.x,g.y).rotate(v)},getLabelCoordinates:function(t){var e=this._getLabelTransformationMatrix(t);return new L(e.e,e.f)},getVertexIndex:function(t,e){for(var n=this.model,i=n.vertices(),r=this.getClosestPointLength(new L(t,e)),s=0,o=i.length;s<o;s++){var a=i[s],l=this.getClosestPointLength(a);if(r<l)break}return s},notifyPointerdown(t,e,n){Gt.prototype.pointerdown.call(this,t,e,n),this.notify("link:pointerdown",t,e,n)},notifyPointermove(t,e,n){Gt.prototype.pointermove.call(this,t,e,n),this.notify("link:pointermove",t,e,n)},notifyPointerup(t,e,n){this.notify("link:pointerup",t,e,n),Gt.prototype.pointerup.call(this,t,e,n)},pointerdblclick:function(t,e,n){Gt.prototype.pointerdblclick.apply(this,arguments),this.notify("link:pointerdblclick",t,e,n)},pointerclick:function(t,e,n){Gt.prototype.pointerclick.apply(this,arguments),this.notify("link:pointerclick",t,e,n)},contextmenu:function(t,e,n){Gt.prototype.contextmenu.apply(this,arguments),this.notify("link:contextmenu",t,e,n)},pointerdown:function(t,e,n){this.notifyPointerdown(t,e,n),this.dragStart(t,e,n)},pointermove:function(t,e,n){var i=this._dragData;i&&this.eventData(t,i);var r=this.eventData(t);switch(r.action){case"label-move":this.dragLabel(t,e,n);break;case"arrowhead-move":this.dragArrowhead(t,e,n);break;case"move":this.drag(t,e,n);break}i&&U(i,this.eventData(t)),this.notifyPointermove(t,e,n)},pointerup:function(t,e,n){var i=this._dragData;i&&(this.eventData(t,i),this._dragData=null);var r=this.eventData(t);switch(r.action){case"label-move":this.dragLabelEnd(t,e,n);break;case"arrowhead-move":this.dragArrowheadEnd(t,e,n);break;case"move":this.dragEnd(t,e,n)}this.notifyPointerup(t,e,n),this.checkMouseleave(t)},mouseover:function(t){Gt.prototype.mouseover.apply(this,arguments),this.notify("link:mouseover",t)},mouseout:function(t){Gt.prototype.mouseout.apply(this,arguments),this.notify("link:mouseout",t)},mouseenter:function(t){Gt.prototype.mouseenter.apply(this,arguments),this.notify("link:mouseenter",t)},mouseleave:function(t){Gt.prototype.mouseleave.apply(this,arguments),this.notify("link:mouseleave",t)},mousewheel:function(t,e,n,i){Gt.prototype.mousewheel.apply(this,arguments),this.notify("link:mousewheel",t,e,n,i)},onlabel:function(t,e,n){this.notifyPointerdown(t,e,n),this.dragLabelStart(t,e,n);var i=this.eventData(t).stopPropagation;i&&t.stopPropagation()},dragLabelStart:function(t,e,n){if(this.can("labelMove")){if(this.isDefaultInteractionPrevented(t))return;var i=t.currentTarget,r=parseInt(i.getAttribute("label-idx"),10),s=this._getDefaultLabelPositionProperty(),o=this._normalizeLabelPosition(this._getLabelPositionProperty(r)),a=this._mergeLabelPositionProperty(o,s),l=this.getLabelCoordinates(a),c=l.x-e,h=l.y-n,u=this._getLabelPositionAngle(r),d=this._getLabelPositionArgs(r),f=this._getDefaultLabelPositionArgs(),p=this._mergeLabelPositionArgs(d,f);this.eventData(t,{action:"label-move",labelIdx:r,dx:c,dy:h,positionAngle:u,positionArgs:p,stopPropagation:!0})}else this.eventData(t,{stopPropagation:!0});this.paper.delegateDragEvents(this,t.data)},dragArrowheadStart:function(t,e,n){if(this.can("arrowheadMove")){var i=t.target,r=i.getAttribute("end"),s=this.startArrowheadMove(r,{ignoreBackwardsCompatibility:!0});this.eventData(t,s)}},dragStart:function(t,e,n){this.isDefaultInteractionPrevented(t)||this.can("linkMove")&&this.eventData(t,{action:"move",dx:e,dy:n})},dragLabel:function(t,e,n){var i=this.eventData(t),r={position:this.getLabelPosition(e+i.dx,n+i.dy,i.positionAngle,i.positionArgs)};this.paper.options.snapLabels&&delete r.position.offset;const s={ui:!0};this.paper.isAsync()&&t.type==="touchmove"&&(s.async=!1),this.model.label(i.labelIdx,r,s)},dragArrowhead:function(t,e,n){this.paper.options.snapLinks?!this._snapArrowhead(t,e,n)&&this.paper.options.snapLinksSelf&&this._snapArrowheadSelf(t,e,n):this.paper.options.snapLinksSelf?this._snapArrowheadSelf(t,e,n):this._connectArrowhead(this.getEventTarget(t),e,n,this.eventData(t))},drag:function(t,e,n){var i=this.eventData(t);this.model.translate(e-i.dx,n-i.dy,{ui:!0}),this.eventData(t,{dx:e,dy:n})},dragLabelEnd:function(){},dragArrowheadEnd:function(t,e,n){var i=this.eventData(t),r=this.paper;r.options.snapLinks?this._snapArrowheadEnd(i):this._connectArrowheadEnd(i,e,n),r.linkAllowed(this)?(this._finishEmbedding(i),this._notifyConnectEvent(i,t)):this._disallow(i),this._afterArrowheadMove(i)},dragEnd:function(){},_disallow:function(t){switch(t.whenNotAllowed){case"remove":this.model.remove({ui:!0});break;case"revert":default:this.model.set(t.arrowhead,t.initialEnd,{ui:!0});break}},_finishEmbedding:function(t){this.paper.options.embeddingMode&&this.model.reparent()&&(t.z=null)},_notifyConnectEvent:function(t,e){var n=t.arrowhead,i=t.initialEnd,r=this.model.prop(n),s=r&&!dr.endsEqual(i,r);if(s){var o=this.paper;i.id&&this.notify("link:disconnect",e,o.findViewByModel(i.id),t.initialMagnet,n),r.id&&this.notify("link:connect",e,o.findViewByModel(r.id),t.magnetUnderPointer,n)}},_snapToPoints:function(t,e,n){let i=null,r=1/0,s=null,o=1/0,a=t.x,l=t.y;for(let c=0;c<e.length;c++){const h=Math.abs(e[c].x-t.x);h<r&&(r=h,i=e[c]);const u=Math.abs(e[c].y-t.y);u<o&&(o=u,s=e[c])}return r<n&&(a=i.x),o<n&&(l=s.y),{x:a,y:l}},_snapArrowheadSelf:function(t,e,n){const{paper:i,model:r}=this,{snapLinksSelf:s}=i.options,o=this.eventData(t),a=s.radius||20,l=this.getEndAnchor(o.arrowhead==="source"?"target":"source"),c=r.vertices(),h=[l,...c],u=this._snapToPoints({x:e,y:n},h,a),d=i.localToClientPoint(u);this._connectArrowhead(document.elementFromPoint(d.x,d.y),u.x,u.y,this.eventData(t))},_snapArrowhead:function(t,e,n){const{paper:i}=this,{snapLinks:r,connectionStrategy:s}=i.options,o=this.eventData(t);let a=!1;var l=r.radius||50,c=i.findViewsInArea({x:e-l,y:n-l,width:2*l,height:2*l}),h=o.closestView||null,u=o.closestMagnet||null,d=o.magnetProxy||null;o.closestView=o.closestMagnet=o.magnetProxy=null;var f=Number.MAX_VALUE,p=new L(e,n);c.forEach(function(O){const N=[];O.el.getAttribute("magnet")!=="false"&&N.push({bbox:O.model.getBBox(),magnet:O.el}),O.$("[magnet]").toArray().forEach(m=>{N.push({bbox:O.getNodeBBox(m),magnet:m})}),N.forEach(m=>{const{magnet:b,bbox:w}=m,A=w.center().squaredDistance(p);A<f&&(u===b||i.options.validateConnection.apply(i,o.validateConnectionArgs(O,O.el===b?null:b)))&&(f=A,o.closestView=O,o.closestMagnet=b)})},this);var g,v=null,x=o.closestView,S=o.closestMagnet;S&&(v=o.magnetProxy=x.findProxyNode(S,"highlighter"));var C=o.arrowhead,P=u!==S;if(h&&P&&h.unhighlight(d,{connecting:!0,snapping:!0}),x){const{prevEnd:O,prevX:N,prevY:m}=o;if(o.prevX=e,o.prevY=n,a=!0,!P&&(typeof s!="function"||N===e&&m===n)||(g=x.getLinkEnd(S,e,n,this.model,C),!P&&Ie(O,g)))return a;o.prevEnd=g,P&&x.highlight(v,{connecting:!0,snapping:!0})}else g={x:e,y:n};return this.model.set(C,g||{x:e,y:n},{ui:!0}),h&&this.notify("link:snap:disconnect",t,h,u,C),x&&this.notify("link:snap:connect",t,x,S,C),a},_snapArrowheadEnd:function(t){var e=t.closestView,n=t.closestMagnet;e&&n&&(e.unhighlight(t.magnetProxy,{connecting:!0,snapping:!0}),t.magnetUnderPointer=e.findMagnet(n)),t.closestView=t.closestMagnet=null},_connectArrowhead:function(t,e,n,i){const{paper:r,model:s}=this;if(i.eventTarget!==t){i.magnetProxy&&i.viewUnderPointer.unhighlight(i.magnetProxy,{connecting:!0});const o=i.viewUnderPointer=r.findView(t);if(o){const a=i.magnetUnderPointer=o.findMagnet(t),l=i.magnetProxy=o.findProxyNode(a,"highlighter");a&&this.paper.options.validateConnection.apply(r,i.validateConnectionArgs(o,a))?l&&o.highlight(l,{connecting:!0}):(i.magnetUnderPointer=null,i.magnetProxy=null)}else i.magnetUnderPointer=null,i.magnetProxy=null}i.eventTarget=t,s.set(i.arrowhead,{x:e,y:n},{ui:!0})},_connectArrowheadEnd:function(t={},e,n){const{model:i}=this,{viewUnderPointer:r,magnetUnderPointer:s,magnetProxy:o,arrowhead:a}=t;if(!s||!o||!r)return;r.unhighlight(o,{connecting:!0});const l=r.getLinkEnd(s,e,n,i,a);i.set(a,l,{ui:!0})},_beforeArrowheadMove:function(t){t.z=this.model.get("z"),this.model.toFront();var e=this.el.style;t.pointerEvents=e.pointerEvents,e.pointerEvents="none",this.paper.options.markAvailable&&this._markAvailableMagnets(t)},_afterArrowheadMove:function(t){t.z!==null&&(this.model.set("z",t.z,{ui:!0}),t.z=null),this.el.style.pointerEvents=t.pointerEvents,this.paper.options.markAvailable&&this._unmarkAvailableMagnets(t)},_createValidateConnectionArgs:function(t){var e=[];e[4]=t,e[5]=this;var n,i=0,r=0;t==="source"?(i=2,n="target"):(r=2,n="source");var s=this.model.get(n);if(s.id){var o=e[i]=this.paper.findViewByModel(s.id),a=o.getMagnetFromLinkEnd(s);a===o.el&&(a=void 0),e[i+1]=a}function l(c,h){return e[r]=c,e[r+1]=c.el===h?void 0:h,e}return l},_markAvailableMagnets:function(t){function e(u,d){var f=u.paper,p=f.options.validateConnection;return p.apply(f,this.validateConnectionArgs(u,d))}var n=this.paper,i=n.model.getCells();t.marked={};for(var r=0,s=i.length;r<s;r++){var o=i[r].findView(n);if(o){var a=Array.prototype.slice.call(o.el.querySelectorAll("[magnet]"));o.el.getAttribute("magnet")!=="false"&&a.push(o.el);var l=a.filter(e.bind(t,o));if(l.length>0){for(var c=0,h=l.length;c<h;c++)o.highlight(l[c],{magnetAvailability:!0});o.highlight(null,{elementAvailability:!0}),t.marked[o.model.id]=l}}}},_unmarkAvailableMagnets:function(t){for(var e=Object.keys(t.marked),n,i,r=0,s=e.length;r<s;r++){n=e[r],i=t.marked[n];var o=this.paper.findViewByModel(n);if(o){for(var a=0,l=i.length;a<l;a++)o.unhighlight(i[a],{magnetAvailability:!0});o.unhighlight(null,{elementAvailability:!0})}}t.marked=null},startArrowheadMove:function(t,e){e||(e={});var n={action:"arrowhead-move",arrowhead:t,whenNotAllowed:e.whenNotAllowed||"revert",initialMagnet:this[t+"Magnet"]||(this[t+"View"]?this[t+"View"].el:null),initialEnd:be(this.model.get(t)),validateConnectionArgs:this._createValidateConnectionArgs(t)};return this._beforeArrowheadMove(n),e.ignoreBackwardsCompatibility!==!0&&(this._dragData=n),n},onMount:function(){Gt.prototype.onMount.apply(this,arguments),this.mountLabels()},onDetach:function(){Gt.prototype.onDetach.apply(this,arguments),this.unmountLabels()},onRemove:function(){Gt.prototype.onRemove.apply(this,arguments),this.unmountLabels()}},{Flags:Jt});Object.defineProperty(Xs.prototype,"sourceBBox",{enumerable:!0,get:function(){var t=this.sourceView;if(!t){var e=this.model.source();return new J(e.x,e.y)}var n=this.sourceMagnet;return t.isNodeConnection(n)?new J(this.sourceAnchor):t.getNodeBBox(n||t.el)}});Object.defineProperty(Xs.prototype,"targetBBox",{enumerable:!0,get:function(){var t=this.targetView;if(!t){var e=this.model.target();return new J(e.x,e.y)}var n=this.targetMagnet;return t.isNodeConnection(n)?new J(this.targetAnchor):t.getNodeBBox(n||t.el)}});const BF=vc.extend({style:{"pointer-events":"none"},_gridCache:null,_gridSettings:null,init(){vc.prototype.init.apply(this,arguments);const{options:{paper:t}}=this;this._gridCache=null,this._gridSettings=[],this.listenTo(t,"transform resize",this.updateGrid)},setGrid(t){this._gridSettings=this.getGridSettings(t),this.renderGrid()},getGridSettings(t){const e=[];return t&&(Array.isArray(t)?t:[t||{}]).forEach(i=>{e.push(...this._resolveDrawGridOption(i))}),e},removeGrid(){const{_gridCache:t}=this;t&&(t.root.remove(),this._gridCache=null)},renderGrid(){const{options:{paper:t}}=this,{_gridSettings:e}=this;if(this.removeGrid(),e.length===0)return;const n=t.options.drawGridSize||t.options.gridSize;if(n<=1)return;const i=this._getGridRefs();e.forEach((r,s)=>{const o="pattern_"+s,a=_e({},r),{scaleFactor:l=1}=a;a.width=n*l||1,a.height=n*l||1;let c;i.exist(o)?c=i.get(o):(c=k("pattern",{id:o,patternUnits:"userSpaceOnUse"},k(a.markup)),i.add(o,c)),xt(a.render)&&a.render(c.node.firstChild,a,t),c.attr({width:a.width,height:a.height})}),i.root.appendTo(this.el),this.updateGrid()},updateGrid(){const{_gridCache:t,_gridSettings:e,options:{paper:n}}=this;if(!t)return;const{root:i,patterns:r}=t,{x:s,y:o,width:a,height:l}=n.getArea();i.attr({x:s,y:o,width:a,height:l});for(const c in r)r[c].attr({x:-s,y:-o});e.forEach((c,h)=>{if(xt(c.update)){const u=r["pattern_"+h];c.update(u.node.firstChild,c,n)}})},_getGridRefs(){let{_gridCache:t}=this;if(t)return t;const e=k("defs"),n=k("svg",{width:"100%",height:"100%"},[e]);return t=this._gridCache={root:n,patterns:{},add:function(i,r){const s=k("rect",{width:"100%",height:"100%",fill:`url(#${i})`});e.append(r),n.append(s),this.patterns[i]=r},get:function(i){return this.patterns[i]},exist:function(i){return this.patterns[i]!==void 0}},t},_resolveDrawGridOption(t){var e=this.options.patterns;if(te(t)&&Array.isArray(e[t]))return e[t].map(function(l){return U({},l)});var n=t||{args:[{}]},i=Array.isArray(n),r=n.name;if(!i&&!r&&!n.markup&&(r="dot"),r&&Array.isArray(e[r])){var s=e[r].map(function(l){return U({},l)}),o=Array.isArray(n.args)?n.args:[n.args||{}];me(o[0],Ze(t,"args"));for(var a=0;a<o.length;a++)s[a]&&U(s[a],o[a]);return s}return i?n:[n]}}),Ms={NONE:"sorting-none",APPROX:"sorting-approximate",EXACT:"sorting-exact"},FF=50,Em=20,Tm=1e3,VF=1/0,Cl=9007199254740991,oh=Gt.Highlighting,Am={[oh.DEFAULT]:{name:"stroke",options:{padding:3}},[oh.MAGNET_AVAILABILITY]:{name:"addClass",options:{className:"available-magnet"}},[oh.ELEMENT_AVAILABILITY]:{name:"addClass",options:{className:"available-cell"}}},zF=[{name:yn.GRID},{name:yn.BACK},{name:yn.CELLS},{name:yn.LABELS},{name:yn.FRONT},{name:yn.TOOLS}],fi=ae.extend({className:"paper",options:{width:800,height:600,gridSize:1,drawGrid:!1,drawGridSize:null,background:!1,elementView:Te,linkView:Xs,snapLabels:!1,snapLinks:!1,snapLinksSelf:!1,labelsLayer:!1,multiLinks:!0,guard:function(t,e){return!1},highlighting:Am,preventContextMenu:!0,preventDefaultBlankAction:!0,preventDefaultViewAction:!0,restrictTranslate:!1,markAvailable:!1,defaultLink:function(){const{cellNamespace:t}=this.model.get("cells"),e=fn(t,["standard","Link"]);if(!e)throw new Error("dia.Paper: no default link model found. Use `options.defaultLink` to specify a default link model.");return new e},defaultConnector:{name:"normal"},defaultRouter:{name:"normal"},defaultAnchor:{name:"center"},defaultLinkAnchor:{name:"connectionRatio"},defaultConnectionPoint:{name:"boundary"},connectionStrategy:null,validateMagnet:function(t,e,n){return e.getAttribute("magnet")!=="passive"},validateConnection:function(t,e,n,i,r,s){return(r==="target"?n:t)instanceof Te},embeddingMode:!1,validateEmbedding:function(t,e){return!0},validateUnembedding:function(t){return!0},findParentBy:"bbox",frontParentOnly:!0,interactive:{labelMove:!1},linkPinning:!0,allowLink:null,clickThreshold:0,moveThreshold:0,magnetThreshold:0,sorting:Ms.APPROX,frozen:!1,autoFreeze:!1,onViewUpdate:function(t,e,n,i,r){e&(t.FLAG_INSERT|t.FLAG_REMOVE)||i.mounting||i.isolate||r.requestConnectedLinksUpdate(t,n,i)},onViewPostponed:function(t,e,n){return n.forcePostponedViewUpdate(t,e)},beforeRender:null,afterRender:null,viewport:null,cellViewNamespace:null,routerNamespace:null,connectorNamespace:null,highlighterNamespace:wB,anchorNamespace:OF,linkAnchorNamespace:pF,connectionPointNamespace:kB,overflow:!1},events:{dblclick:"pointerdblclick",dbltap:"pointerdblclick",contextmenu:"contextmenu",mousedown:"pointerdown",touchstart:"pointerdown",mouseover:"mouseover",mouseout:"mouseout",mouseenter:"mouseenter",mouseleave:"mouseleave",wheel:"mousewheel","mouseenter .joint-cell":"mouseenter","mouseleave .joint-cell":"mouseleave","mouseenter .joint-tools":"mouseenter","mouseleave .joint-tools":"mouseleave","dblclick .joint-cell [magnet]":"magnetpointerdblclick","contextmenu .joint-cell [magnet]":"magnetcontextmenu","mousedown .joint-link .label":"onlabel","touchstart .joint-link .label":"onlabel","dragstart .joint-cell image":"onImageDragStart"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},stylesheet:`
        .joint-element .scalable * {
            vector-effect: non-scaling-stroke;
        }
    `,svg:null,viewport:null,defs:null,tools:null,layers:null,_viewportMatrix:null,_viewportTransformString:null,_updates:null,_layers:null,SORT_DELAYING_BATCHES:["add","to-front","to-back"],UPDATE_DELAYING_BATCHES:["translate"],FORM_CONTROL_TAG_NAMES:["TEXTAREA","INPUT","BUTTON","SELECT","OPTION"],GUARDED_TAG_NAMES:["SELECT"],MIN_SCALE:1e-6,init:function(){const{options:t}=this;t.cellViewNamespace||(t.cellViewNamespace=typeof joint<"u"&&ni(joint,"shapes")?joint.shapes:null);const e=this.model=t.model||new li;this._layers={},this.cloneOptions(),this.render(),this._setDimensions(),this.startListening(),this._views={},this._mw_evt_buffer={event:null,deltas:[]},this.resetViews(e.attributes.cells.models),!this.isFrozen()&&this.isAsync()&&this.updateViewsAsync()},_resetUpdates:function(){return this._updates={id:null,priorities:[{},{},{}],unmountedCids:[],mountedCids:[],unmounted:{},mounted:{},count:0,keyFrozen:!1,freezeKey:null,sort:!1,disabled:!1,idle:!1}},startListening:function(){var t=this.model;this.listenTo(t,"add",this.onCellAdded).listenTo(t,"remove",this.onCellRemoved).listenTo(t,"change",this.onCellChange).listenTo(t,"reset",this.onGraphReset).listenTo(t,"sort",this.onGraphSort).listenTo(t,"batch:stop",this.onGraphBatchStop),this.on("cell:highlight",this.onCellHighlight).on("cell:unhighlight",this.onCellUnhighlight).on("transform",this.update)},onCellAdded:function(t,e,n){var i=n.position;this.isAsync()||!Ot(i)?this.renderView(t,n):(n.maxPosition===i&&this.freeze({key:"addCells"}),this.renderView(t,n),i===0&&this.unfreeze({key:"addCells"}))},onCellRemoved:function(t,e,n){const i=this.findViewByModel(t);i&&this.requestViewUpdate(i,i.FLAG_REMOVE,i.UPDATE_PRIORITY,n)},onCellChange:function(t,e){if(t!==this.model.attributes.cells&&t.hasChanged("z")&&this.options.sorting===Ms.APPROX){const n=this.findViewByModel(t);n&&this.requestViewUpdate(n,n.FLAG_INSERT,n.UPDATE_PRIORITY,e)}},onGraphReset:function(t,e){this.resetLayers(),this.resetViews(t.models,e)},onGraphSort:function(){this.model.hasActiveBatch(this.SORT_DELAYING_BATCHES)||this.sortViews()},onGraphBatchStop:function(t){if(!this.isFrozen()){var e=t&&t.batchName,n=this.model;if(!this.isAsync()){var i=this.UPDATE_DELAYING_BATCHES;i.includes(e)&&!n.hasActiveBatch(i)&&this.updateViews(t)}var r=this.SORT_DELAYING_BATCHES;r.includes(e)&&!n.hasActiveBatch(r)&&this.sortViews()}},cloneOptions:function(){const{options:t}=this,{defaultConnector:e,defaultRouter:n,defaultConnectionPoint:i,defaultAnchor:r,defaultLinkAnchor:s,highlighting:o,cellViewNamespace:a,interactive:l}=t;!a&&typeof joint<"u"&&ni(joint,"shapes")&&(t.cellViewNamespace=joint.shapes),xt(e)||(t.defaultConnector=ke(e)),xt(n)||(t.defaultRouter=ke(n)),xt(i)||(t.defaultConnectionPoint=ke(i)),xt(r)||(t.defaultAnchor=ke(r)),xt(s)||(t.defaultLinkAnchor=ke(s)),Ee(l)&&(t.interactive=U({},l)),Ee(o)&&(t.highlighting=$i({},o,Am))},children:function(){var t=k.namespace;return[{namespaceURI:t.xhtml,tagName:"div",className:En("paper-background"),selector:"background",style:{position:"absolute",inset:0}},{namespaceURI:t.svg,tagName:"svg",attributes:{width:"100%",height:"100%","xmlns:xlink":t.xlink},selector:"svg",style:{position:"absolute",inset:0},children:[{tagName:"defs",selector:"defs"},{tagName:"g",className:En("layers"),selector:"layers"}]}]},hasLayerView(t){return t in this._layers},getLayerView(t){const{_layers:e}=this;if(t in e)return e[t];throw new Error(`dia.Paper: Unknown layer "${t}"`)},getLayerNode(t){return this.getLayerView(t).el},render:function(){this.renderChildren();const{el:t,childNodes:e,options:n,stylesheet:i}=this,{svg:r,defs:s,layers:o}=e;return t.style.position="relative",r.style.overflow=n.overflow?"visible":"hidden",this.svg=r,this.defs=s,this.layers=o,this.renderLayers(),k.ensureId(r),this.addStylesheet(i),n.background&&this.drawBackground(n.background),n.drawGrid&&this.setGrid(n.drawGrid),this},addStylesheet:function(t){t&&k(this.svg).prepend(k.createSVGStyle(t))},createLayer(t){switch(t){case yn.GRID:return new BF({name:t,paper:this,patterns:this.constructor.gridPatterns});default:return new vc({name:t})}},renderLayers:function(t=zF){this.removeLayers(),t.forEach(({name:r,sorted:s})=>{const o=this.createLayer(r);this.layers.appendChild(o.el),this._layers[r]=o});const e=this.getLayerView(yn.CELLS),n=this.getLayerView(yn.TOOLS),i=this.getLayerView(yn.LABELS);this.tools=n.el,this.cells=this.viewport=e.el,e.vel.addClass(En("viewport")),i.vel.addClass(En("viewport")),e.el.style.webkitUserSelect="none",e.el.style.userSelect="none",i.el.style.webkitUserSelect="none",i.el.style.userSelect="none"},removeLayers:function(){const{_layers:t}=this;Object.keys(t).forEach(e=>{t[e].remove(),delete t[e]})},resetLayers:function(){const{_layers:t}=this;Object.keys(t).forEach(e=>{t[e].removePivots()})},update:function(){return this._background&&this.updateBackgroundImage(this._background),this},scale:function(t,e,n){const i=this.matrix();return t===void 0?k.matrixToScale(i):(e===void 0&&(e=t),t=Math.max(t||0,this.MIN_SCALE),e=Math.max(e||0,this.MIN_SCALE),i.a=t,i.d=e,this.matrix(i,n),this)},scaleUniformAtPoint:function(t,e,n){const{a:i,d:r,e:s,f:o}=this.matrix();if(t=Math.max(t||0,this.MIN_SCALE),t===i&&t===r)return this;const a=k.createSVGMatrix().translate(s-e.x*(t-i),o-e.y*(t-r)).scale(t,t);return this.matrix(a,n),this},translate:function(t,e,n){const i=this.matrix();return t===void 0?k.matrixToTranslate(i):(t||(t=0),e||(e=0),i.e===t&&i.f===e?this:(i.e=t,i.f=e,this.matrix(i,n),this))},matrix:function(t,e={}){var n=this.layers;if(t===void 0){var i=n.getAttribute("transform");return(this._viewportTransformString||null)===i?t=this._viewportMatrix:(t=n.getCTM(),this._viewportMatrix=t,this._viewportTransformString=i),k.createSVGMatrix(t)}const r=this.matrix(),s=k.createSVGMatrix(t),o=this._viewportTransformString,a=k.matrixToTransformString(s);if(a===o)return this;if(!o&&k.matrixToTransformString()===a)return this;const{a:l,d:c,e:h,f:u}=s;return n.setAttribute("transform",a),this._viewportMatrix=s,this._viewportTransformString=n.getAttribute("transform"),(l!==r.a||c!==r.d)&&this.trigger("scale",l,c,e),(h!==r.e||u!==r.f)&&this.trigger("translate",h,u,e),this.trigger("transform",s,e),this},clientMatrix:function(){return k.createSVGMatrix(this.cells.getScreenCTM())},requestConnectedLinksUpdate:function(t,e,n){if(t instanceof Gt)for(var i=t.model,r=this.model.getConnectedLinks(i),s=0,o=r.length;s<o;s++){var a=r[s],l=this.findViewByModel(a);if(l){var c=["UPDATE"];a.getTargetCell()===i&&c.push("TARGET"),a.getSourceCell()===i&&c.push("SOURCE");var h=Math.max(e+1,l.UPDATE_PRIORITY);this.scheduleViewUpdate(l,l.getFlag(c),h,n)}}},forcePostponedViewUpdate:function(t,e){if(!t||!(t instanceof Gt))return!1;var n=t.model;if(n.isElement())return!1;if(!(e&t.getFlag(["SOURCE","TARGET"]))){var i={silent:!0},r=0,s=this.findViewByModel(n.getSourceCell());s&&!this.isViewMounted(s)&&(r=this.dumpView(s,i),t.updateEndMagnet("source"));var o=0,a=this.findViewByModel(n.getTargetCell());if(a&&!this.isViewMounted(a)&&(o=this.dumpView(a,i),t.updateEndMagnet("target")),r===0&&o===0)return!this.dumpView(t,i)}return!1},requestViewUpdate:function(t,e,n,i){i||(i={}),this.scheduleViewUpdate(t,e,n,i);var r=this.isAsync();if(!(this.isFrozen()||r&&i.async!==!1)&&!this.model.hasActiveBatch(this.UPDATE_DELAYING_BATCHES)){var s=this.updateViews(i);r&&this.notifyAfterRender(s,i)}},scheduleViewUpdate:function(t,e,n,i){const{_updates:r,options:s}=this;r.idle&&s.autoFreeze&&(r.idle=!1,this.unfreeze());const{FLAG_REMOVE:o,FLAG_INSERT:a,UPDATE_PRIORITY:l,cid:c}=t;let h=r.priorities[n];if(h||(h=r.priorities[n]={}),n>l)for(let f=n-1;f>=l;f--){const p=r.priorities[f];!p||!(c in p)||(h[c]|=p[c],delete p[c])}let u=h[c]||0;if((u&e)===e)return;u||r.count++,e&o&&u&a?h[c]^=a:e&a&&u&o&&(h[c]^=o),h[c]|=e;const d=s.onViewUpdate;typeof d=="function"&&d.call(this,t,e,n,i||{},this)},dumpViewUpdate:function(t){if(!t)return 0;var e=this._updates,n=t.cid,i=e.priorities[t.UPDATE_PRIORITY],r=this.registerMountedView(t)|i[n];return delete i[n],r},dumpView:function(t,e={}){const n=this.dumpViewUpdate(t);if(!n)return 0;const i=!e.silent;i&&this.notifyBeforeRender(e);const r=this.updateView(t,n,e);if(i){const s={updated:1,priority:t.UPDATE_PRIORITY};this.notifyAfterRender(s,e)}return r},updateView:function(t,e,n){if(!t)return 0;const{FLAG_REMOVE:i,FLAG_INSERT:r,FLAG_INIT:s,model:o}=t;if(t instanceof Gt){if(e&i)return this.removeView(o),0;if(e&r){const a=!!(e&s);a&&(e^=s),this.insertView(t,a),e^=r}}return e?t.confirmUpdate(e,n||{}):0},requireView:function(t,e){var n=this.findViewByModel(t);return n?(this.dumpView(n,e),n):null},registerUnmountedView:function(t){var e=t.cid,n=this._updates;if(e in n.unmounted)return 0;var i=n.unmounted[e]|=t.FLAG_INSERT;return n.unmountedCids.push(e),delete n.mounted[e],i},registerMountedView:function(t){var e=t.cid,n=this._updates;if(e in n.mounted)return 0;n.mounted[e]=!0,n.mountedCids.push(e);var i=n.unmounted[e]||0;return delete n.unmounted[e],i},isViewMounted:function(t){if(!t)return!1;var e=t.cid,n=this._updates;return e in n.mounted},dumpViews:function(t){var e=me({},t,{viewport:null});this.checkViewport(e),this.updateViews(e)},updateViews:function(t){this.notifyBeforeRender(t);let e,n=0,i=0,r=Cl;do i++,e=this.updateViewsBatch(t),n+=e.updated,r=Math.min(e.priority,r);while(!e.empty);const s={updated:n,batches:i,priority:r};return this.notifyAfterRender(s,t),s},hasScheduledUpdates:function(){const t=this._updates.priorities,e=Object.keys(t);let n=e.length;for(;n>0&&n--;)for(let i in t[e[n]])return!0;return!1},updateViewsAsync:function(t,e){t||(t={}),e||(e={processed:0,priority:Cl});const{_updates:n,options:i}=this,r=n.id;if(r){ao(r),e.processed===0&&this.hasScheduledUpdates()&&this.notifyBeforeRender(t);const s=this.updateViewsBatch(t),o=me({},t,{mountBatchSize:Tm-s.mounted,unmountBatchSize:Tm-s.unmounted}),a=this.checkViewport(o),l=a.unmounted,c=a.mounted;let h=e.processed;const u=n.count;s.updated>0?(h+=s.updated+s.unmounted,s.processed=h,e.priority=Math.min(s.priority,e.priority),s.empty&&c===0?(s.unmounted+=l,s.mounted+=c,s.priority=e.priority,this.notifyAfterRender(s,t),e.processed=0,e.priority=Cl,n.count=0):e.processed=h):n.idle||i.autoFreeze&&(this.freeze(),n.idle=!0,this.trigger("render:idle",t));const d=t.progress;if(u&&typeof d=="function"&&d.call(this,s.empty,h,u,s,this),n.id!==r)return}if(n.disabled)throw new Error("dia.Paper: can not unfreeze the paper after it was removed");n.id=oo(this.updateViewsAsync,this,t,e)},notifyBeforeRender:function(t={}){let e=t.beforeRender;typeof e!="function"&&(e=this.options.beforeRender,typeof e!="function")||e.call(this,t,this)},notifyAfterRender:function(t,e={}){let n=e.afterRender;typeof n!="function"&&(n=this.options.afterRender),typeof n=="function"&&n.call(this,t,e,this),this.trigger("render:done",t,e)},updateViewsBatch:function(t){t||(t={});var e=t.batchSize||VF,n=this._updates,i=0,r=0,s=0,o=0,a=Cl,l=!0,c=this.options,h=n.priorities,u="viewport"in t?t.viewport:c.viewport;typeof u!="function"&&(u=null);var d=c.onViewPostponed;typeof d!="function"&&(d=null);var f=Object.keys(h);t:for(var p=0,g=f.length;p<g;p++){var v=+f[p],x=h[v];for(var S in x){if(i>=e){l=!1;break t}var C=Sr[S];if(!C){delete x[S];continue}var P=x[S];if(!(P&C.FLAG_REMOVE)){var O=S in n.unmounted;if(C.DETACHABLE&&u&&!u.call(this,C,!O,this)){O||(this.registerUnmountedView(C),this.detachView(C)),n.unmounted[S]|=P,delete x[S],s++;continue}O&&(P|=C.FLAG_INSERT,o++),P|=this.registerMountedView(C)}var N=this.updateView(C,P,t);if(N>0&&(x[S]=N,!d||!d.call(this,C,N,this)||x[S])){r++,l=!1;continue}a>v&&(a=v),i++,delete x[S]}}return{priority:a,updated:i,postponed:r,unmounted:s,mounted:o,empty:l}},getUnmountedViews:function(){const t=this._updates,e=Object.keys(t.unmounted),n=e.length,i=new Array(n);for(var r=0;r<n;r++)i[r]=Sr[e[r]];return i},getMountedViews:function(){const t=this._updates,e=Object.keys(t.mounted),n=e.length,i=new Array(n);for(var r=0;r<n;r++)i[r]=Sr[e[r]];return i},checkUnmountedViews:function(t,e){e||(e={});var n=0;typeof t!="function"&&(t=null);for(var i=("mountBatchSize"in e)?e.mountBatchSize:1/0,r=this._updates,s=r.unmountedCids,o=r.unmounted,a=0,l=Math.min(s.length,i);a<l;a++){var c=s[a];if(c in o){var h=Sr[c];if(h){if(h.DETACHABLE&&t&&!t.call(this,h,!1,this)){s.push(c);continue}n++;var u=this.registerMountedView(h);u&&this.scheduleViewUpdate(h,u,h.UPDATE_PRIORITY,{mounting:!0})}}}return s.splice(0,a),n},checkMountedViews:function(t,e){e||(e={});var n=0;if(typeof t!="function")return n;for(var i=("unmountBatchSize"in e)?e.unmountBatchSize:1/0,r=this._updates,s=r.mountedCids,o=r.mounted,a=0,l=Math.min(s.length,i);a<l;a++){var c=s[a];if(c in o){var h=Sr[c];if(h){if(!h.DETACHABLE||t.call(this,h,!0,this)){s.push(c);continue}n++;var u=this.registerUnmountedView(h);u&&this.detachView(h)}}}return s.splice(0,a),n},checkViewVisibility:function(t,e={}){let n="viewport"in e?e.viewport:this.options.viewport;typeof n!="function"&&(n=null);const i=this._updates,{mounted:r,unmounted:s}=i,o=!t.DETACHABLE||!n||n.call(this,t,!1,this);let a=!1,l=!1;if(t.cid in r&&!o){this.registerUnmountedView(t)&&this.detachView(t);const u=i.mountedCids.indexOf(t.cid);i.mountedCids.splice(u,1),a=!0}if(!a&&t.cid in s&&o){const h=i.unmountedCids.indexOf(t.cid);i.unmountedCids.splice(h,1);var c=this.registerMountedView(t);c&&this.scheduleViewUpdate(t,c,t.UPDATE_PRIORITY,{mounting:!0}),l=!0}return{mounted:l?1:0,unmounted:a?1:0}},checkViewport:function(t){var e=me({},t,{mountBatchSize:1/0,unmountBatchSize:1/0}),n="viewport"in e?e.viewport:this.options.viewport,i=this.checkMountedViews(n,e);if(i>0){var r=this._updates.unmountedCids;e.mountBatchSize=Math.min(r.length-i,e.mountBatchSize)}var s=this.checkUnmountedViews(n,e);return{mounted:s,unmounted:i}},freeze:function(t){t||(t={});var e=this._updates,n=t.key,i=this.options.frozen,r=e.freezeKey;if(n&&n!==r){if(i&&r)return;e.freezeKey=n,e.keyFrozen=i}this.options.frozen=!0;var s=e.id;e.id=null,this.isAsync()&&s&&ao(s)},unfreeze:function(t){t||(t={});var e=this._updates,n=t.key,i=e.freezeKey;n&&i&&n!==i||(e.freezeKey=null,!(n&&n===i&&e.keyFrozen)&&(this.isAsync()?(this.freeze(),this.updateViewsAsync(t)):this.updateViews(t),this.options.frozen=e.keyFrozen=!1,e.sort&&(this.sortViews(),e.sort=!1)))},isAsync:function(){return!!this.options.async},isFrozen:function(){return!!this.options.frozen},isExactSorting:function(){return this.options.sorting===Ms.EXACT},onRemove:function(){this.freeze(),this._updates.disabled=!0,this.removeLayers(),this.removeViews()},getComputedSize:function(){var t=this.options,e=t.width,n=t.height;return Ot(e)||(e=this.el.clientWidth),Ot(n)||(n=this.el.clientHeight),{width:e,height:n}},setDimensions:function(t,e,n={}){const{options:i}=this,{width:r,height:s}=i;let o=t===void 0?r:t,a=e===void 0?s:e;if(r===o&&s===a)return;i.width=o,i.height=a,this._setDimensions();const l=this.getComputedSize();this.trigger("resize",l.width,l.height,n)},_setDimensions:function(){const{options:t}=this;let e=t.width,n=t.height;Ot(e)&&(e=`${Math.round(e)}px`),Ot(n)&&(n=`${Math.round(n)}px`),this.$el.css({width:e===null?"":e,height:n===null?"":n})},fitToContent:function(t,e,n,i){Nt(t)?i=t:i=U({gridWidth:t,gridHeight:e,padding:n},i);const{x:r,y:s,width:o,height:a}=this.getFitToContentArea(i),{sx:l,sy:c}=this.scale();return this.translate(-r*l,-s*c,i),this.setDimensions(o*l,a*c,i),new J(r,s,o,a)},getFitToContentArea:function(t={}){const e=t.gridWidth||1,n=t.gridHeight||1,i=Ne(t.padding||0),r=Math.max(t.minWidth||0,e),s=Math.max(t.minHeight||0,n),o=t.maxWidth||Number.MAX_VALUE,a=t.maxHeight||Number.MAX_VALUE,l=t.allowNewOrigin,c="contentArea"in t?new J(t.contentArea):this.getContentArea(t),{sx:h,sy:u}=this.scale();c.x*=h,c.y*=u,c.width*=h,c.height*=u;let d=Math.ceil((c.width+c.x)/e),f=Math.ceil((c.height+c.y)/n);t.allowNegativeBottomRight||(d=Math.max(d,1),f=Math.max(f,1)),d*=e,f*=n;let p=0;(l==="negative"&&c.x<0||l==="positive"&&c.x>=0||l==="any")&&(p=Math.ceil(-c.x/e)*e,p+=i.left,d+=p);let g=0;return(l==="negative"&&c.y<0||l==="positive"&&c.y>=0||l==="any")&&(g=Math.ceil(-c.y/n)*n,g+=i.top,f+=g),d+=i.right,f+=i.bottom,d=Math.max(d,r),f=Math.max(f,s),d=Math.min(d,o),f=Math.min(f,a),new J(-p/h,-g/u,d/h,f/u)},transformToFitContent:function(t){t||(t={});let e,n;if("contentArea"in t){const C=t.contentArea;e=this.localToPaperRect(C),n=new L(C)}else e=this.getContentBBox(t),n=this.paperToLocalPoint(e);if(!e.width||!e.height)return;me(t,{padding:0,preserveAspectRatio:!0,scaleGrid:null,minScale:0,maxScale:Number.MAX_VALUE,verticalAlign:"top",horizontalAlign:"left"});const i=Ne(t.padding),r=t.minScaleX||t.minScale,s=t.maxScaleX||t.maxScale,o=t.minScaleY||t.minScale,a=t.maxScaleY||t.maxScale;let l;if(t.fittingBBox)l=t.fittingBBox;else{const C=this.translate(),P=this.getComputedSize();l={x:C.tx,y:C.ty,width:P.width,height:P.height}}l=new J(l).moveAndExpand({x:i.left,y:i.top,width:-i.left-i.right,height:-i.top-i.bottom});const c=this.matrix(),{a:h,d:u,e:d,f}=c;let p=l.width/e.width*h,g=l.height/e.height*u;if(t.preserveAspectRatio&&(p=g=Math.min(p,g)),t.scaleGrid){const C=t.scaleGrid;p=C*Math.floor(p/C),g=C*Math.floor(g/C)}p=Math.min(s,Math.max(r,p)),g=Math.min(a,Math.max(o,g));const v={x:p/h,y:g/u};let x=l.x-n.x*p-d,S=l.y-n.y*g-f;switch(t.verticalAlign){case"middle":S=S+(l.height-e.height*v.y)/2;break;case"bottom":S=S+(l.height-e.height*v.y);break}switch(t.horizontalAlign){case"middle":x=x+(l.width-e.width*v.x)/2;break;case"right":x=x+(l.width-e.width*v.x);break}c.a=p,c.d=g,c.e=x,c.f=S,this.matrix(c,t)},scaleContentToFit:function(t){this.transformToFitContent(t)},getContentArea:function(t){return t&&t.useModelGeometry?this.model.getBBox()||new J:k(this.cells).getBBox()},getContentBBox:function(t){return this.localToPaperRect(this.getContentArea(t))},getArea:function(){return this.paperToLocalRect(this.getComputedSize())},getRestrictedArea:function(...t){const{restrictTranslate:e}=this.options;let n;return xt(e)?n=e.apply(this,t):e===!0?n=this.getArea():e?n=new J(e):n=null,n},createViewForModel:function(t){const{options:e}=this;var n,i,r=e.cellViewNamespace,s=t.get("type")+"View",o=fn(r,s,".");t.isLink()?(n=e.linkView,i=Xs):(n=e.elementView,i=Te);var a=n.prototype instanceof Kr?o||n:n.call(this,t)||o||i;return new a({model:t,interactive:e.interactive,labelsLayer:e.labelsLayer===!0?yn.LABELS:e.labelsLayer})},removeView:function(t){const{id:e}=t,{_views:n,_updates:i}=this,r=n[e];if(r){var{cid:s}=r;const{mounted:o,unmounted:a}=i;r.remove(),delete n[e],delete o[s],delete a[s]}return r},renderView:function(t,e){const{id:n}=t,i=this._views;let r,s,o=!0;return n in i&&(r=i[n],r.model===t?(s=r.FLAG_INSERT,o=!1):this.removeView(t)),o&&(r=i[n]=this.createViewForModel(t),r.paper=this,s=this.registerUnmountedView(r)|this.FLAG_INIT|r.getFlag(Qt(r,"initFlag"))),this.requestViewUpdate(r,s,r.UPDATE_PRIORITY,e),r},onImageDragStart:function(){return!1},resetViews:function(t,e){e||(e={}),t||(t=[]),this._resetUpdates(),this.removeViews();const n=this.options.autoFreeze?null:"reset";this.freeze({key:n});for(var i=0,r=t.length;i<r;i++)this.renderView(t[i],e);this.unfreeze({key:n}),this.sortViews()},removeViews:function(){We(this._views,"remove"),this._views={}},sortViews:function(){if(this.isExactSorting()){if(this.isFrozen()){this._updates.sort=!0;return}this.sortViewsExact()}},sortViewsExact:function(){var t=Array.from(this.cells.childNodes).filter(n=>n.getAttribute("model-id")),e=this.model.get("cells");ux(t,function(n,i){var r=e.get(n.getAttribute("model-id")),s=e.get(i.getAttribute("model-id")),o=r.attributes.z||0,a=s.attributes.z||0;return o===a?0:o<a?-1:1})},insertView:function(t,e){const n=this.getLayerView(yn.CELLS),{el:i,model:r}=t;switch(this.options.sorting){case Ms.APPROX:n.insertSortedNode(i,r.get("z"));break;case Ms.EXACT:default:n.insertNode(i);break}t.onMount(e)},detachView(t){t.unmount(),t.onDetach()},findView:function(t){var e=te(t)?this.cells.querySelector(t):t instanceof q?t[0]:t,n=this.findAttribute("model-id",e);if(n)return this._views[n]},findViewByModel:function(t){var e=te(t)||Ot(t)?t:t&&t.id;return this._views[e]},findViewsFromPoint:function(t){t=new L(t);var e=this.model.getElements().map(this.findViewByModel,this);return e.filter(function(n){return n&&n.vel.getBBox({target:this.cells}).containsPoint(t)},this)},findViewsInArea:function(t,e){e=me(e||{},{strict:!1}),t=new J(t);var n=this.model.getElements().map(this.findViewByModel,this),i=e.strict?"containsRect":"intersect";return n.filter(function(r){return r&&t[i](r.vel.getBBox({target:this.cells}))},this)},removeTools:function(){return this.dispatchToolsEvent("remove"),this},hideTools:function(){return this.dispatchToolsEvent("hide"),this},showTools:function(){return this.dispatchToolsEvent("show"),this},dispatchToolsEvent:function(t,...e){typeof t=="string"&&this.trigger("tools:event",t,...e)},getModelById:function(t){return this.model.getCell(t)},snapToGrid:function(t,e){return this.clientToLocalPoint(t,e).snapToGrid(this.options.gridSize)},localToPaperPoint:function(t,e){var n=new L(t,e),i=k.transformPoint(n,this.matrix());return i},localToPaperRect:function(t,e,n,i){var r=new J(t,e,n,i),s=k.transformRect(r,this.matrix());return s},paperToLocalPoint:function(t,e){var n=new L(t,e),i=k.transformPoint(n,this.matrix().inverse());return i},paperToLocalRect:function(t,e,n,i){var r=new J(t,e,n,i),s=k.transformRect(r,this.matrix().inverse());return s},localToClientPoint:function(t,e){var n=new L(t,e),i=k.transformPoint(n,this.clientMatrix());return i},localToClientRect:function(t,e,n,i){var r=new J(t,e,n,i),s=k.transformRect(r,this.clientMatrix());return s},clientToLocalPoint:function(t,e){var n=new L(t,e),i=k.transformPoint(n,this.clientMatrix().inverse());return i},clientToLocalRect:function(t,e,n,i){var r=new J(t,e,n,i),s=k.transformRect(r,this.clientMatrix().inverse());return s},localToPagePoint:function(t,e){return this.localToPaperPoint(t,e).offset(this.pageOffset())},localToPageRect:function(t,e,n,i){return this.localToPaperRect(t,e,n,i).offset(this.pageOffset())},pageToLocalPoint:function(t,e){var n=new L(t,e),i=n.difference(this.pageOffset());return this.paperToLocalPoint(i)},pageToLocalRect:function(t,e,n,i){var r=this.pageOffset(),s=new J(t,e,n,i);return s.x-=r.x,s.y-=r.y,this.paperToLocalRect(s)},clientOffset:function(){var t=this.svg.getBoundingClientRect();return new L(t.left,t.top)},pageOffset:function(){return this.clientOffset().offset(window.scrollX,window.scrollY)},linkAllowed:function(t){if(!(t instanceof Xs))throw new Error("Must provide a linkView.");var e=t.model,n=this.options,i=this.model,r=i.constructor.validations;return!(!n.multiLinks&&!r.multiLinks.call(this,i,e)||!n.linkPinning&&!r.linkPinning.call(this,i,e)||typeof n.allowLink=="function"&&!n.allowLink.call(this,t,this))},getDefaultLink:function(t,e){return xt(this.options.defaultLink)?this.options.defaultLink.call(this,t,e):this.options.defaultLink.clone()},resolveHighlighter:function(t={}){let{highlighter:e,type:n}=t;const{highlighting:i,highlighterNamespace:r}=this.options;if(e===void 0){if(!i||n&&(e=i[n],e===!1))return!1;e||(e=i.default)}if(!e)return!1;te(e)&&(e={name:e});const s=e.name,o=r[s];if(!o)throw new Error('Unknown highlighter ("'+s+'")');if(typeof o.highlight!="function")throw new Error('Highlighter ("'+s+'") is missing required highlight() method');if(typeof o.unhighlight!="function")throw new Error('Highlighter ("'+s+'") is missing required unhighlight() method');return{highlighter:o,options:e.options||{},name:s}},onCellHighlight:function(t,e,n){const i=this.resolveHighlighter(n);if(!i)return;const{highlighter:r,options:s}=i;r.highlight(t,e,s)},onCellUnhighlight:function(t,e,n){const i=this.resolveHighlighter(n);if(!i)return;const{highlighter:r,options:s}=i;r.unhighlight(t,e,s)},pointerdblclick:function(t){t.preventDefault(),t=ot(t);var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.snapToGrid(t.clientX,t.clientY);e?e.pointerdblclick(t,n.x,n.y):this.trigger("blank:pointerdblclick",t,n.x,n.y)}},pointerclick:function(t){var e=this.eventData(t);if(e.mousemoved<=this.options.clickThreshold){t=ot(t);var n=this.findView(t.target);if(this.guard(t,n))return;var i=this.snapToGrid(t.clientX,t.clientY);n?n.pointerclick(t,i.x,i.y):this.trigger("blank:pointerclick",t,i.x,i.y)}},contextmenu:function(t){if(this.options.preventContextMenu&&t.preventDefault(),this.contextMenuFired){this.contextMenuFired=!1;return}t=ot(t),this.contextMenuTrigger(t)},contextMenuTrigger:function(t){var e=this.findView(t.target);if(!this.guard(t,e)){var n=this.snapToGrid(t.clientX,t.clientY);e?e.contextmenu(t,n.x,n.y):this.trigger("blank:contextmenu",t,n.x,n.y)}},pointerdown:function(t){t=ot(t);const{target:e,button:n}=t,i=this.findView(e),r=n===2;if(i){if(!r&&this.guard(t,i))return;const s=this.FORM_CONTROL_TAG_NAMES.includes(e.tagName);this.options.preventDefaultViewAction&&!s&&t.preventDefault(),s&&i.preventDefaultInteraction(t);const o=this.customEventTrigger(t,i);if(o){if(o.isPropagationStopped())return;t.data=o.data}const a=e.closest("[magnet]");if(a&&i.el!==a&&i.el.contains(a)){const l=ot(new q.Event(t.originalEvent,{data:t.data,currentTarget:a}));if(this.onmagnet(l),l.isDefaultPrevented()&&t.preventDefault(),l.isPropagationStopped()){if(r)return;this.delegateDragEvents(i,l.data);return}t.data=l.data}}if(r){this.contextMenuFired=!0;const s=new q.Event(t.originalEvent,{type:"contextmenu",data:t.data});this.contextMenuTrigger(s)}else{const s=this.snapToGrid(t.clientX,t.clientY);i?i.pointerdown(t,s.x,s.y):(this.options.preventDefaultBlankAction&&t.preventDefault(),this.trigger("blank:pointerdown",t,s.x,s.y)),this.delegateDragEvents(i,t.data)}},pointermove:function(t){var e=this.eventData(t);e.mousemoved||(e.mousemoved=0,this.undelegateEvents());var n=++e.mousemoved;if(!(n<=this.options.moveThreshold)){t=ot(t);var i=this.snapToGrid(t.clientX,t.clientY),r=e.sourceView;r?r.pointermove(t,i.x,i.y):this.trigger("blank:pointermove",t,i.x,i.y),this.eventData(t,e)}},pointerup:function(t){this.undelegateDocumentEvents();var e=ot(t),n=this.snapToGrid(e.clientX,e.clientY),i=this.eventData(t).sourceView;i?i.pointerup(e,n.x,n.y):this.trigger("blank:pointerup",e,n.x,n.y),e.isPropagationStopped()||this.pointerclick(new q.Event(t.originalEvent,{type:"click",data:t.data})),this.delegateEvents()},mouseover:function(t){t=ot(t);var e=this.findView(t.target);if(!this.guard(t,e))if(e)e.mouseover(t);else{if(this.el===t.target)return;this.trigger("blank:mouseover",t)}},mouseout:function(t){t=ot(t);var e=this.findView(t.target);if(!this.guard(t,e))if(e)e.mouseout(t);else{if(this.el===t.target)return;this.trigger("blank:mouseout",t)}},mouseenter:function(t){t=ot(t);const{target:e,relatedTarget:n,currentTarget:i}=t,r=this.findView(e);if(this.guard(t,r))return;const s=this.findView(n);r&&(s===r||(r.mouseenter(t),this.el.contains(n)))||s||i===this.el&&this.trigger("paper:mouseenter",t)},mouseleave:function(t){t=ot(t);const{target:e,relatedTarget:n,currentTarget:i}=t,r=this.findView(e);if(this.guard(t,r))return;const s=this.findView(n);r&&(s===r||(r.mouseleave(t),this.el.contains(n)))||s||i===this.el&&this.trigger("paper:mouseleave",t)},_processMouseWheelEvtBuf:Ga(function(){const{event:t,deltas:e}=this._mw_evt_buffer,n=e.reduce((o,a)=>o+ix(a,FF),0),i=Math.pow(.995,n),{x:r,y:s}=this.clientToLocalPoint(t.clientX,t.clientY);this.trigger("paper:pinch",t,r,s,i),this._mw_evt_buffer={event:null,deltas:[]}},Em,{maxWait:Em}),mousewheel:function(t){t=ot(t);const e=this.findView(t.target);if(this.guard(t,e))return;const n=t.originalEvent,i=this.snapToGrid(n.clientX,n.clientY),{deltaX:r,deltaY:s}=nx(n),o=this._events["paper:pinch"];if(t.ctrlKey&&o&&o.length>0)n.preventDefault(),this._mw_evt_buffer.event=t,this._mw_evt_buffer.deltas.push(s),this._processMouseWheelEvtBuf();else{const a=Math.max(-1,Math.min(1,n.wheelDelta));e?e.mousewheel(t,i.x,i.y,a):this.trigger("blank:mousewheel",t,i.x,i.y,a),this.trigger("paper:pan",t,r,s)}},onevent:function(t){var e=t.currentTarget,n=e.getAttribute("event");if(n){var i=this.findView(e);if(i){if(t=ot(t),this.guard(t,i))return;var r=this.snapToGrid(t.clientX,t.clientY);i.onevent(t,n,r.x,r.y)}}},magnetEvent:function(t,e){var n=t.currentTarget,i=n.getAttribute("magnet");if(i){var r=this.findView(n);if(r){if(t=ot(t),this.guard(t,r))return;var s=this.snapToGrid(t.clientX,t.clientY);e.call(this,r,t,n,s.x,s.y)}}},onmagnet:function(t){if(t.button===2){this.contextMenuFired=!0,this.magnetContextMenuFired=!0;const e=new q.Event(t.originalEvent,{type:"contextmenu",data:t.data,currentTarget:t.currentTarget});this.magnetContextMenuTrigger(e),e.isPropagationStopped()&&t.stopPropagation()}else this.magnetEvent(t,function(e,n,i,r,s){e.onmagnet(n,r,s)})},magnetpointerdblclick:function(t){this.magnetEvent(t,function(e,n,i,r,s){e.magnetpointerdblclick(n,i,r,s)})},magnetcontextmenu:function(t){if(this.options.preventContextMenu&&t.preventDefault(),this.magnetContextMenuFired){this.magnetContextMenuFired=!1;return}this.magnetContextMenuTrigger(t)},magnetContextMenuTrigger:function(t){this.magnetEvent(t,function(e,n,i,r,s){e.magnetcontextmenu(n,i,r,s)})},onlabel:function(t){var e=t.currentTarget,n=this.findView(e);if(!n||(t=ot(t),this.guard(t,n)))return;const i=this.customEventTrigger(t,n,e);if(i){if(i.isPropagationStopped())return;t.data=i.data}var r=this.snapToGrid(t.clientX,t.clientY);n.onlabel(t,r.x,r.y)},getPointerArgs(t){const e=ot(t),{x:n,y:i}=this.snapToGrid(e.clientX,e.clientY);return[e,n,i]},delegateDragEvents:function(t,e){e||(e={}),this.eventData({data:e},{sourceView:t||null,mousemoved:0}),this.delegateDocumentEvents(null,e)},guard:function(t,e){if(t.type==="mousedown"&&t.button===2||this.options.guard&&this.options.guard(t,e))return!0;if(t.data&&t.data.guarded!==void 0)return t.data.guarded;const{target:n}=t;return this.GUARDED_TAG_NAMES.includes(n.tagName)?!0:!(e&&e.model&&e.model instanceof rn||this.el===n||this.svg.contains(n))},setGridSize:function(t){const{options:e}=this;return e.gridSize=t,e.drawGrid&&!e.drawGridSize&&this.getLayerView(yn.GRID).renderGrid(),this},setGrid:function(t){return this.getLayerView(yn.GRID).setGrid(t),this},updateBackgroundImage:function(t){t=t||{};var e=t.position||"center",n=t.size||"auto auto",i=this.scale(),r=this.translate();if(Nt(e)){var s=r.tx+i.sx*(e.x||0),o=r.ty+i.sy*(e.y||0);e=s+"px "+o+"px"}Nt(n)&&(n=new J(n).scale(i.sx,i.sy),n=n.width+"px "+n.height+"px");const{background:a}=this.childNodes;a.style.backgroundSize=n,a.style.backgroundPosition=e},drawBackgroundImage:function(t,e){if(!(t instanceof HTMLImageElement)){this.childNodes.background.style.backgroundImage="";return}if(!(!this._background||this._background.id!==e.id)){e=e||{};var n,i=e.size,r=e.repeat||"no-repeat",s=e.opacity||1,o=Math.abs(e.quality)||1,a=this.constructor.backgroundPatterns[ja(r)];if(xt(a)){t.width*=o,t.height*=o;var l=a(t,e);if(!(l instanceof HTMLCanvasElement))throw new Error("dia.Paper: background pattern must return an HTML Canvas instance");n=l.toDataURL("image/png"),r="repeat",Nt(i)?(i.width*=l.width/t.width,i.height*=l.height/t.height):i===void 0&&(e.size={width:l.width/o,height:l.height/o})}else n=t.src,i===void 0&&(e.size={width:t.width,height:t.height});this.childNodes.background.style.opacity=s,this.childNodes.background.style.backgroundRepeat=r,this.childNodes.background.style.backgroundImage=`url(${n})`,this.updateBackgroundImage(e)}},updateBackgroundColor:function(t){this.$el.css("backgroundColor",t||"")},drawBackground:function(t){if(t=t||{},this.updateBackgroundColor(t.color),t.image){t=this._background=ke(t),Pr(t);var e=document.createElement("img");e.onload=this.drawBackgroundImage.bind(this,e,t),e.src=t.image}else this.drawBackgroundImage(null),this._background=null;return this},setInteractivity:function(t){this.options.interactive=t,We(this._views,"setInteractivity",t)},isDefined:function(t){return!!this.svg.getElementById(t)},defineFilter:function(t){if(!Nt(t))throw new TypeError("dia.Paper: defineFilter() requires 1. argument to be an object.");var e=t.id,n=t.name;if(e||(e=n+this.svg.id+Qo(JSON.stringify(t))),!this.isDefined(e)){var i=dx,r=i[n]&&i[n](t.args||{});if(!r)throw new Error("Non-existing filter "+n);var s=U({filterUnits:"userSpaceOnUse"},t.attrs,{id:e});k(r,s).appendTo(this.defs)}return e},defineGradient:function(t){if(!Nt(t))throw new TypeError("dia.Paper: defineGradient() requires 1. argument to be an object.");const{svg:e,defs:n}=this,{type:i,id:r=i+e.id+Qo(JSON.stringify(t)),stops:s,attrs:o={}}=t;if(this.isDefined(r))return r;const a=ft(s).map(({offset:c,color:h,opacity:u})=>k("stop").attr({offset:c,"stop-color":h,"stop-opacity":Number.isFinite(u)?u:1})),l=k(i,o,a);return l.id=r,l.appendTo(n),r},definePattern:function(t){if(!Nt(t))throw new TypeError("dia.Paper: definePattern() requires 1. argument to be an object.");const{svg:e,defs:n}=this,{id:i=e.id+Qo(JSON.stringify(t)),markup:r,attrs:s={}}=t;if(!r)throw new TypeError("dia.Paper: definePattern() requires markup.");if(this.isDefined(i))return i;const o=k("pattern",{patternUnits:"userSpaceOnUse"});if(o.id=i,o.attr(s),typeof r=="string")o.append(k(r));else{const{fragment:a}=ya(r);o.append(a)}return o.appendTo(n),i},defineMarker:function(t){if(!Nt(t))throw new TypeError("dia.Paper: defineMarker() requires the first argument to be an object.");const{svg:e,defs:n}=this,{id:i=e.id+Qo(JSON.stringify(t)),markup:r,attrs:s={},markerUnits:o="userSpaceOnUse"}=t;if(this.isDefined(i))return i;const a=k("marker",{orient:"auto",overflow:"visible",markerUnits:o});a.id=i,a.attr(s);let l;if(r){let u;if(typeof r=="string")u=k(r),u=Array.isArray(u)?u:[u];else{const{fragment:d}=ya(r);u=k(d).children()}u.length>1?l=k("g").append(u):l=u[0]}else{const{type:u="path"}=t;l=k(u)}const c=Ze(t,"type","id","markup","attrs","markerUnits");return Object.keys(c).forEach(u=>{const d=c[u],f=l.attr(u);if(f==null)l.attr(u,d);else switch(u){case"transform":l.attr(u,d+" "+f);break}}),l.appendTo(a),a.appendTo(n),i},customEventTrigger:function(t,e,n=e.el){const i=t.target.closest("[event]");if(i&&n!==i&&e.el.contains(i)){const r=ot(new q.Event(t.originalEvent,{data:t.data,currentTarget:i}));return this.onevent(r),r.isDefaultPrevented()&&t.preventDefault(),r}return null}},{sorting:Ms,Layers:yn,backgroundPatterns:{flipXy:function(t){var e=document.createElement("canvas"),n=t.width,i=t.height;e.width=2*n,e.height=2*i;var r=e.getContext("2d");return r.drawImage(t,0,0,n,i),r.setTransform(-1,0,0,-1,e.width,e.height),r.drawImage(t,0,0,n,i),r.setTransform(-1,0,0,1,e.width,0),r.drawImage(t,0,0,n,i),r.setTransform(1,0,0,-1,0,e.height),r.drawImage(t,0,0,n,i),e},flipX:function(t){var e=document.createElement("canvas"),n=t.width,i=t.height;e.width=n*2,e.height=i;var r=e.getContext("2d");return r.drawImage(t,0,0,n,i),r.translate(2*n,0),r.scale(-1,1),r.drawImage(t,0,0,n,i),e},flipY:function(t){var e=document.createElement("canvas"),n=t.width,i=t.height;e.width=n,e.height=i*2;var r=e.getContext("2d");return r.drawImage(t,0,0,n,i),r.translate(0,2*i),r.scale(1,-1),r.drawImage(t,0,0,n,i),e},watermark:function(t,e){e=e||{};var n=t.width,i=t.height,r=document.createElement("canvas");r.width=n*3,r.height=i*3;for(var s=r.getContext("2d"),o=Ot(e.watermarkAngle)?-e.watermarkAngle:-20,a=an(o),l=r.width/4,c=r.height/4,h=0;h<4;h++)for(var u=0;u<4;u++)(h+u)%2>0&&(s.setTransform(1,0,0,1,(2*h-1)*l,(2*u-1)*c),s.rotate(a),s.drawImage(t,-n/2,-i/2,n,i));return r}},gridPatterns:{dot:[{color:"#AAAAAA",thickness:1,markup:"rect",render:function(t,e){k(t).attr({width:e.thickness,height:e.thickness,fill:e.color})}}],fixedDot:[{color:"#AAAAAA",thickness:1,markup:"rect",render:function(t,e){k(t).attr({fill:e.color})},update:function(t,e,n){const{sx:i,sy:r}=n.scale(),s=i<=1?e.thickness:e.thickness/i,o=r<=1?e.thickness:e.thickness/r;k(t).attr({width:s,height:o})}}],mesh:[{color:"#AAAAAA",thickness:1,markup:"path",render:function(t,e){var n,i=e.width,r=e.height,s=e.thickness;i-s>=0&&r-s>=0?n=["M",i,0,"H0 M0 0 V0",r].join(" "):n="M 0 0 0 0",k(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}}],doubleMesh:[{color:"#AAAAAA",thickness:1,markup:"path",render:function(t,e){var n,i=e.width,r=e.height,s=e.thickness;i-s>=0&&r-s>=0?n=["M",i,0,"H0 M0 0 V0",r].join(" "):n="M 0 0 0 0",k(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}},{color:"#000000",thickness:3,scaleFactor:4,markup:"path",render:function(t,e){var n,i=e.width,r=e.height,s=e.thickness;i-s>=0&&r-s>=0?n=["M",i,0,"H0 M0 0 V0",r].join(" "):n="M 0 0 0 0",k(t).attr({d:n,stroke:e.color,"stroke-width":e.thickness})}}]}}),Rr=ae.extend({name:null,tagName:"g",className:"tool",svgElement:!0,_visible:!0,init:function(){var t=this.name;t&&this.vel.attr("data-tool-name",t)},configure:function(t,e){return this.relatedView=t,this.paper=t.paper,this.parentView=e,this.simulateRelatedView(this.el),this.delegateEvents(),this},simulateRelatedView:function(t){t&&t.setAttribute("model-id",this.relatedView.model.id)},getName:function(){return this.name},show:function(){this.el.style.display="",this._visible=!0},hide:function(){this.el.style.display="none",this._visible=!1},isVisible:function(){return!!this._visible},focus:function(){var t=this.options.focusOpacity;isFinite(t)&&(this.el.style.opacity=t),this.parentView.focusTool(this)},blur:function(){this.el.style.opacity="",this.parentView.blurTool(this)},update:function(){},guard:function(t){const{paper:e,relatedView:n}=this;return!e||!n?!0:e.guard(t,n)}}),UF=ae.extend({tagName:"g",className:"tools",svgElement:!0,tools:null,isRendered:!1,options:{tools:null,relatedView:null,name:null},configure:function(t){t=U(this.options,t);var e=t.tools;if(!Array.isArray(e))return this;var n=t.relatedView;if(!(n instanceof Gt))return this;for(var i=this.tools=[],r=0,s=e.length;r<s;r++){var o=e[r];o instanceof Rr&&(o.configure(n,this),this.vel.append(o.el),i.push(o))}return this.isRendered=!1,n.requestUpdate(n.getFlag("TOOLS")),this},getName:function(){return this.options.name},update:function(t){t||(t={});var e=this.tools;if(!e)return this;for(var n=this.isRendered,i=0,r=e.length;i<r;i++){var s=e[i];n?t.tool!==s.cid&&s.isVisible()&&s.update():s.render()}return this.isMounted()||this.mount(),n||(this.blurTool(),this.isRendered=!0),this},focusTool:function(t){var e=this.tools;if(!e)return this;for(var n=0,i=e.length;n<i;n++){var r=e[n];t===r?r.show():r.hide()}return this},blurTool:function(t){var e=this.tools;if(!e)return this;for(var n=0,i=e.length;n<i;n++){var r=e[n];r!==t&&!r.isVisible()&&(r.show(),r.update())}return this},hide:function(){return this.focusTool(null)},show:function(){return this.blurTool(null)},onRemove:function(){var t=this.tools;if(!t)return this;for(var e=0,n=t.length;e<n;e++)t[e].remove();this.tools=null},mount:function(){const{options:t,el:e}=this,{relatedView:n,layer:i=yn.TOOLS,z:r}=t;return n&&(i?n.paper.getLayerView(i).insertSortedNode(e,r):n.el.appendChild(e)),this}}),Wx=Object.freeze(Object.defineProperty({__proto__:null,Cell:rn,CellView:Gt,Element:Xt,ElementView:Te,Graph:li,HighlighterView:ei,LayersNames:yn,Link:dr,LinkView:Xs,Paper:fi,PaperLayer:vc,ToolView:Rr,ToolsView:UF,attributes:Po},Symbol.toStringTag,{value:"Module"}));function yc(t,e){const{model:n}=t;return e?n.getBBox():n.isLink()?t.getConnection().bbox():t.getNodeUnrotatedBBox(t.el)}function HF(t,e,n){var i=NB.call(this.paper,{},e,n,t,this.model);return i.anchor}var Cm=ae.extend({tagName:"g",svgElement:!0,className:"marker-segment",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},children:[{tagName:"line",selector:"line",attributes:{stroke:"#33334F","stroke-width":2,fill:"none","pointer-events":"none"}},{tagName:"rect",selector:"handle",attributes:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#33334F",stroke:"#FFFFFF","stroke-width":2}}],onRender:function(){this.renderChildren()},position:function(t,e,n,i){const{scale:r}=this.options;let s=k.createSVGMatrix().translate(t,e).rotate(n);r&&(s=s.scale(r));var o=this.childNodes.handle;o.setAttribute("transform",k.matrixToTransformString(s)),o.setAttribute("cursor",n%180===0?"row-resize":"col-resize");var a=i.getClosestPoint(new L(t,e)),l=this.childNodes.line;l.setAttribute("x1",t),l.setAttribute("y1",e),l.setAttribute("x2",a.x),l.setAttribute("y2",a.y)},onPointerDown:function(t){this.options.guard(t)||(this.trigger("change:start",this,t),t.stopPropagation(),t.preventDefault(),this.options.paper.undelegateEvents(),this.delegateDocumentEvents(null,t.data))},onPointerMove:function(t){this.trigger("changing",this,t)},onPointerUp:function(t){this.undelegateDocumentEvents(),this.options.paper.delegateEvents(),this.trigger("change:end",this,t)},show:function(){this.el.style.display=""},hide:function(){this.el.style.display="none"}});const GF=Rr.extend({name:"segments",precision:.5,options:{handleClass:Cm,segmentLengthThreshold:40,redundancyRemoval:!0,anchor:HF,snapRadius:10,snapHandle:!0,stopPropagation:!0},handles:null,onRender:function(){this.resetHandles();var t=this.relatedView,e=t.model.vertices();e.unshift(t.sourcePoint),e.push(t.targetPoint);for(var n=0,i=e.length;n<i-1;n++){var r=e[n],s=e[n+1],o=this.renderHandle(r,s);this.simulateRelatedView(o.el),this.handles.push(o),o.options.index=n}return this},renderHandle:function(t,e){var n=new this.options.handleClass({paper:this.paper,scale:this.options.scale,guard:i=>this.guard(i)});return n.render(),this.updateHandle(n,t,e),n.vel.appendTo(this.el),this.startHandleListening(n),n},update:function(){return this.render(),this},startHandleListening:function(t){this.listenTo(t,"change:start",this.onHandleChangeStart),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"change:end",this.onHandleChangeEnd)},resetHandles:function(){var t=this.handles;if(this.handles=[],this.stopListening(),!!Array.isArray(t))for(var e=0,n=t.length;e<n;e++)t[e].remove()},shiftHandleIndexes:function(t){for(var e=this.handles,n=0,i=e.length;n<i;n++)e[n].options.index+=t},resetAnchor:function(t,e){var n=this.relatedView.model;e?n.prop([t,"anchor"],e,{rewrite:!0,ui:!0,tool:this.cid}):n.removeProp([t,"anchor"],{ui:!0,tool:this.cid})},snapHandle:function(t,e,n){var i=t.options.index,r=this.relatedView,s=r.model,o=s.vertices(),a=t.options.axis,l=o[i-2]||n.sourceAnchor,c=o[i+1]||n.targetAnchor,h=this.options.snapRadius;return Math.abs(e[a]-l[a])<h?e[a]=l[a]:Math.abs(e[a]-c[a])<h&&(e[a]=c[a]),e},onHandleChanging:function(t,e){const{options:n}=this;var i=this.eventData(e),r=this.relatedView,s=r.paper,o=t.options.index-1,a=ot(e),l=s.snapToGrid(a.clientX,a.clientY),c=this.snapHandle(t,l.clone(),i),h=t.options.axis,u=this.options.snapHandle?0:l[h]-c[h],d=r.model,f=ke(d.vertices()),p=this.options.anchor;typeof p!="function"&&(p=null);const g=t.options.index,v=[r.sourcePoint.clone(),...f,r.targetPoint.clone()];let x=0;if(g-1>=0){const R=v[g-1],H=v[g];new pt(R,H).vector().theta()%90!==0&&(f.splice(g-1,0,i.originalVertices[g-1]),x++,this.shiftHandleIndexes(1))}var S=f[o+x],C=f[o+1+x];if(g+2<v.length){const R=v[g+1],H=v[g+2];if(new pt(R,H).vector().theta()%90!==0){const B=i.originalVertices.length===1,_t=B?0:g,gt=i.firstHandleShifted&&!B?1:0;let Rt=1+x;f.splice(g+Rt,0,i.originalVertices[_t-gt])}}var P=r.sourceView,O=r.sourceBBox,N=!1,m=!1;if(S?o===0?O.containsPoint(S)?(f.shift(),this.shiftHandleIndexes(-1),N=!0):(S[h]=c[h],m=!0):S[h]=c[h]:(S=r.sourceAnchor.toJSON(),S[h]=c[h],O.containsPoint(S)?(S[h]=c[h],N=!0):(f.unshift(S),this.shiftHandleIndexes(1),i.firstHandleShifted=!0,m=!0)),p&&P){if(N){var b=i.sourceAnchor.clone();b[h]=c[h];var w=p.call(r,b,P,r.sourceMagnet||P.el,"source",r);this.resetAnchor("source",w)}m&&this.resetAnchor("source",i.sourceAnchorDef)}var A=r.targetView,E=r.targetBBox,M=!1,$=!1;if(C?o===f.length-2?E.containsPoint(C)?(f.pop(),M=!0):(C[h]=c[h],$=!0):C[h]=c[h]:(C=r.targetAnchor.toJSON(),C[h]=c[h],E.containsPoint(C)?M=!0:(f.push(C),$=!0)),p&&A){if(M){var F=i.targetAnchor.clone();F[h]=c[h];var j=p.call(r,F,A,r.targetMagnet||A.el,"target",r);this.resetAnchor("target",j)}$&&this.resetAnchor("target",i.targetAnchorDef)}if(f.some(R=>!R))throw new Error("Segments: incompatible router in use");d.vertices(f,{ui:!0,tool:this.cid}),this.updateHandle(t,S,C,u),n.stopPropagation||r.notifyPointermove(a,l.x,l.y)},onHandleChangeStart:function(t,e){const{options:n,handles:i,relatedView:r}=this,{model:s,paper:o}=r;var a=t.options.index;if(Array.isArray(i)){for(var l=0,c=i.length;l<c;l++)l!==a&&i[l].hide();this.focus(),this.eventData(e,{sourceAnchor:r.sourceAnchor.clone(),targetAnchor:r.targetAnchor.clone(),sourceAnchorDef:be(s.prop(["source","anchor"])),targetAnchorDef:be(s.prop(["target","anchor"])),originalVertices:ke(s.vertices()),firstHandleShifted:!1}),s.startBatch("segment-move",{ui:!0,tool:this.cid}),n.stopPropagation||r.notifyPointerdown(...o.getPointerArgs(e))}},onHandleChangeEnd:function(t,e){const{options:n,relatedView:i}=this,{paper:r,model:s}=i;n.redundancyRemoval&&i.removeRedundantLinearVertices({ui:!0,tool:this.cid});const o=ot(e),a=r.snapToGrid(o.clientX,o.clientY);this.render(),this.blur(),s.stopBatch("segment-move",{ui:!0,tool:this.cid}),n.stopPropagation||i.notifyPointerup(o,a.x,a.y),i.checkMouseleave(o)},updateHandle:function(t,e,n,i){var r=Math.abs(e.x-n.x)<this.precision,s=Math.abs(e.y-n.y)<this.precision;if(r||s){var o=new pt(e,n),a=o.length();if(a<this.options.segmentLengthThreshold)t.hide();else{var l=o.midpoint(),c=r?"x":"y";l[c]+=i||0;var h=o.vector().vectorAngle(new L(1,0));t.position(l.x,l.y,h,this.relatedView),t.show(),t.options.axis=c}}else t.hide()},onRemove:function(){this.resetHandles()}},{SegmentHandle:Cm}),Yx=Rr.extend({name:"boundary",tagName:"rect",options:{padding:10,useModelGeometry:!1},attributes:{fill:"none",stroke:"#33334F","stroke-width":.5,"stroke-dasharray":"5, 5","pointer-events":"none"},onRender:function(){this.update()},update:function(){const{relatedView:t,options:e,vel:n}=this,{useModelGeometry:i,rotate:r}=e,s=Ne(e.padding);let o=yc(t,i).moveAndExpand({x:-s.left,y:-s.top,width:s.left+s.right,height:s.top+s.bottom});var a=t.model;if(a.isElement()){var l=a.angle();if(l)if(r){var c=a.getBBox().center();n.rotate(l,c.x,c.y,{absolute:!0})}else o=o.bbox(l)}return n.attr(o.toJSON()),this}}),tp=Rr.extend({name:"button",events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},options:{distance:0,offset:0,scale:null,rotate:!1},onRender:function(){this.renderChildren(this.options.markup),this.update()},update:function(){return this.position(),this},position:function(){const{vel:t}=this;t.transform(this.getCellMatrix(),{absolute:!0})},getCellMatrix(){return this.relatedView.model.isLink()?this.getLinkMatrix():this.getElementMatrix()},getElementMatrix(){const{relatedView:t,options:e}=this;let{x:n=0,y:i=0,offset:r={},useModelGeometry:s,rotate:o,scale:a}=e,l=yc(t,s);const c=t.model.angle();o||(l=l.bbox(c));const{x:h=0,y:u=0}=r;Ue(n)?n=parseFloat(n)/100*l.width:or(n)&&(n=Number(ar(n,l))),Ue(i)?i=parseFloat(i)/100*l.height:or(i)&&(i=Number(ar(i,l)));let d=k.createSVGMatrix().translate(l.x+l.width/2,l.y+l.height/2);return o&&(d=d.rotate(c)),d=d.translate(n+h-l.width/2,i+u-l.height/2),a&&(d=d.scale(a)),d},getLinkMatrix(){const{relatedView:t,options:e}=this,{offset:n=0,distance:i=0,rotate:r,scale:s}=e;let o,a,l;Ue(i)?o=t.getTangentAtRatio(parseFloat(i)/100):o=t.getTangentAtLength(i),o?(a=o.start,l=o.vector().vectorAngle(new L(1,0))||0):(a=t.getConnection().start,l=0);let c=k.createSVGMatrix().translate(a.x,a.y).rotate(l).translate(0,n);return r||(c=c.rotate(-l)),s&&(c=c.scale(s)),c},onPointerDown:function(t){if(!this.guard(t)){t.stopPropagation(),t.preventDefault();var e=this.options.action;typeof e=="function"&&e.call(this.relatedView,t,this.relatedView,this)}}}),jF=tp.extend({name:"remove",children:[{tagName:"circle",selector:"button",attributes:{r:7,fill:"#FF1D00",cursor:"pointer"}},{tagName:"path",selector:"icon",attributes:{d:"M -3 -3 3 3 M -3 3 3 -3",fill:"none",stroke:"#FFFFFF","stroke-width":2,"pointer-events":"none"}}],options:{distance:60,offset:0,action:function(t,e,n){e.model.remove({ui:!0,tool:n.cid})}}}),Wl=tp.extend({name:"connect",documentEvents:{mousemove:"drag",touchmove:"drag",mouseup:"dragend",touchend:"dragend",touchcancel:"dragend"},children:[{tagName:"circle",selector:"button",attributes:{r:7,fill:"#333333",cursor:"pointer"}},{tagName:"path",selector:"icon",attributes:{d:"M -4 -1 L 0 -1 L 0 -4 L 4 0 L 0 4 0 1 -4 1 z",fill:"#FFFFFF",stroke:"none","stroke-width":2,"pointer-events":"none"}}],options:{distance:80,offset:0,magnet:t=>t.el,action:(t,e,n)=>n.dragstart(t)},getMagnetNode:function(){const{options:t,relatedView:e}=this,{magnet:n}=t;let i;switch(typeof n){case"function":{i=n.call(this,e,this);break}case"string":{i=e.findNode(n);break}default:{i=n;break}}if(i||(i=e.el),i instanceof SVGElement)return i;throw new Error("Connect: magnet must be an SVGElement")},dragstart:function(t){const{paper:e,relatedView:n}=this,i=ot(t),{x:r,y:s}=e.clientToLocalPoint(i.clientX,i.clientY);n.dragLinkStart(i,this.getMagnetNode(),r,s),e.undelegateEvents(),this.delegateDocumentEvents(null,i.data),this.focus()},drag:function(t){const{paper:e,relatedView:n}=this,i=ot(t),{x:r,y:s}=e.snapToGrid(i.clientX,i.clientY);n.dragLink(i,r,s)},dragend:function(t){const{paper:e,relatedView:n}=this,i=ot(t),{x:r,y:s}=e.snapToGrid(i.clientX,i.clientY);n.dragLinkEnd(i,r,s),this.undelegateDocumentEvents(),e.delegateEvents(),this.blur(),n.checkMouseleave(i)}}),WF=Wl.extend({name:"hover-connect",defaultMarkup:[{tagName:"circle",attributes:{r:7,fill:"#333333",cursor:"pointer"}},{tagName:"path",attributes:{d:"M -4 -1 L 0 -1 L 0 -4 L 4 0 L 0 4 0 1 -4 1 z",fill:"#FFFFFF",stroke:"none","stroke-width":2}}],children(){const{options:t,defaultMarkup:e}=this;return[{tagName:"path",selector:"track",attributes:{fill:"none",stroke:"transparent","stroke-width":t.trackWidth||15,cursor:"pointer"}},{tagName:"g",selector:"button",attributes:{"pointer-events":"none",display:"none"},children:t.markup||e}]},events:Object.assign({mousemove:"onMousemove",mouseenter:"onMouseenter",mouseleave:"onMouseleave"},Wl.prototype.events),onRender:function(){this.renderChildren(),this.update()},trackPath:null,update(){const{childNodes:t}=this;this.trackPath=this.getTrackPath(),Wl.prototype.update.apply(this,arguments),t.track.setAttribute("d",this.trackPath.serialize())},position(){const{el:t,childNodes:e}=this;e.button.setAttribute("transform",k.matrixToTransformString(this.getButtonMatrix())),t.setAttribute("transform",k.matrixToTransformString(this.getTrackMatrix()))},getButtonMatrix(){const{options:t,trackPath:e}=this,{offset:n=0,distance:i=0,rotate:r,scale:s}=t;let o,a,l;Ue(i)?o=e.tangentAtRatio(parseFloat(i)/100):o=e.tangentAtLength(i),o?(a=o.start,l=o.vector().vectorAngle(new L(1,0))||0):(a=e.start,l=0);let c=k.createSVGMatrix().translate(a.x,a.y).rotate(l).translate(0,n);return r||(c=c.rotate(-l)),s&&(c=c.scale(s)),c},getTrackPath(){return this.relatedView.getConnection()},getTrackMatrix(){return k.createSVGMatrix()},getTrackRatioFromEvent(t){const{relatedView:e,trackPath:n}=this,i=e.paper.clientToLocalPoint(t.clientX,t.clientY),r=k.transformPoint(i,this.getTrackMatrix().inverse());return n.closestPointLength(r)},canShowButton(){return q.event.has(this.paper.el)},showButton(){this.childNodes.button.style.display="block"},hideButton(){this.childNodes.button.style.display=""},onMousemove(t){const{trackPath:e}=this;if(!e)return;const{options:n}=this;n.distance=this.getTrackRatioFromEvent(t),this.position()},onMouseenter(){this.canShowButton()&&this.showButton()},onMouseleave(){this.hideButton()}}),YF=Rr.extend({tagName:"g",children:[{tagName:"circle",selector:"handle",attributes:{cursor:"pointer","stroke-width":2,stroke:"#FFFFFF",fill:"#33334F",r:6}},{tagName:"rect",selector:"extras",attributes:{"pointer-events":"none",fill:"none",stroke:"#33334F","stroke-dasharray":"2,4",rx:5,ry:5}}],events:{mousedown:"onPointerDown",touchstart:"onPointerDown",dblclick:"onPointerDblClick",dbltap:"onPointerDblClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{handleAttributes:null,selector:"root",padding:6,scale:null},getPosition:function(){},setPosition:function(){},resetPosition:function(){},onRender:function(){this.renderChildren(),this.toggleExtras(!1),this.update()},update:function(){const{handle:t,extras:e}=this.childNodes;if(t)this.updateHandle(t);else throw new Error("Control: markup selector `handle` is required");return e&&this.updateExtras(e),this},updateHandle:function(t){const{relatedView:e,options:n}=this,{model:i}=e,r=this.getPosition(e,this),s=i.getAbsolutePointFromRelative(r),{handleAttributes:o,scale:a}=n;let l=`translate(${s.x},${s.y})`;if(a&&(l+=` scale(${a})`),t.setAttribute("transform",l),o)for(let c in o)t.setAttribute(c,o[c])},updateExtras:function(t){const{relatedView:e,options:n}=this,{selector:i}=this.options;if(!i){this.toggleExtras(!1);return}const r=e.findNode(i);if(!r)throw new Error("Control: invalid selector.");let s=n.padding;isFinite(s)||(s=0);const o=e.getNodeUnrotatedBBox(r),a=e.model,l=a.angle(),c=o.center();l&&c.rotate(a.getBBox().center(),-l),o.inflate(s),t.setAttribute("x",-o.width/2),t.setAttribute("y",-o.height/2),t.setAttribute("width",o.width),t.setAttribute("height",o.height),t.setAttribute("transform",`translate(${c.x},${c.y}) rotate(${l})`)},toggleExtras:function(t){const{extras:e}=this.childNodes;e&&(e.style.display=t?"":"none")},onPointerDown:function(t){const{relatedView:e,paper:n}=this;this.guard(t)||(t.stopPropagation(),t.preventDefault(),n.undelegateEvents(),this.delegateDocumentEvents(),this.focus(),this.toggleExtras(!0),e.model.startBatch("control-move",{ui:!0,tool:this.cid}))},onPointerMove:function(t){const{relatedView:e,paper:n}=this,{model:i}=e,{clientX:r,clientY:s}=ot(t),o=n.clientToLocalPoint(r,s),a=i.getRelativePointFromAbsolute(o);this.setPosition(e,a,this),this.update()},onPointerUp:function(t){const{relatedView:e,paper:n}=this;n.delegateEvents(),this.undelegateDocumentEvents(),this.blur(),this.toggleExtras(!1),e.model.stopBatch("control-move",{ui:!0,tool:this.cid})},onPointerDblClick:function(){const{relatedView:t}=this;this.resetPosition(t,this),this.update()}}),XF=WF.extend({getTrackPath(){const{relatedView:t,options:e}=this;let{useModelGeometry:n,trackPath:i="M 0 0 H calc(w) V calc(h) H 0 Z"}=e;if(typeof i=="function"&&(i=i.call(this,t)),or(i)){const r=yc(t,n);i=ar(i,r)}return new K(k.normalizePathData(i))},getTrackMatrix(){const{relatedView:t,options:e}=this;let{useModelGeometry:n,rotate:i}=e,r=yc(t,n);const s=t.model.angle();i||(r=r.bbox(s));let o=k.createSVGMatrix().translate(r.x+r.width/2,r.y+r.height/2);return i&&(o=o.rotate(s)),o=o.translate(-r.width/2,-r.height/2),o}}),qF=Object.freeze(Object.defineProperty({__proto__:null,Boundary:Yx,Button:tp,Connect:Wl,Control:YF,HoverConnect:XF,Remove:jF},Symbol.toStringTag,{value:"Module"})),KF={PortLabel:Ix,Port:Ex},jY=function(t,e){e=e||{},We(Sr,"setTheme",t,e),ae.prototype.defaultTheme=t};var ZF=Xt,JF=Te,QF=JF.prototype;const uu=ZF.define("standard.Record",{size:{width:100},padding:0,scrollTop:null,items:[],itemHeight:20,itemOffset:20,itemMinLabelWidth:10,itemButtonSize:10,itemIcon:{width:16,height:16,padding:2},itemOverflow:!1,itemAboveViewSelector:"root",itemBelowViewSelector:"root",attrs:{root:{cursor:"move"},wrapper:{scrollable:!0},bodiesGroups:{fill:"transparent",stroke:"none"},labelsGroups:{fill:"#333333"},buttonsGroups:{fill:"transparent",stroke:"#333333",strokeWidth:1},forksGroups:{stroke:"#333333"},groups:{groupPosition:!0},itemBodies:{groupWidth:!0,itemHighlight:{fill:"#eeeeee"}},itemLabels:{fontSize:16,textVerticalAnchor:"middle",itemText:{textWrap:!0,ellipsis:!0},itemHighlight:{fill:"red"}}}},{markup:[],metrics:null,markupAttributes:["items","itemHeight","itemOffset","itemIcon","itemMinLabelWidth","itemButtonSize","itemOverflow","padding"],initialize:function(){Xt.prototype.initialize.apply(this,arguments),this.on("change",this.onChange,this),this.buildMarkup()},anyHasChanged:function(t){return Array.isArray(t)?t.some(function(e){return this.hasChanged(e)},this):!1},onChange:function(t,e){e.record!==this.id&&this.hasChanged("markup")&&Ds("Markup can not be modified."),this.anyHasChanged(this.markupAttributes)&&this.buildMarkup(e)},getPadding:function(){return Ne(this.attributes.padding)},buildMarkup:function(t){var e=this.metrics={},n=e.items={},i=this.attributes,r=i.itemHeight,s=i.itemOffset,o=!!i.itemOverflow,a=i.items;Array.isArray(a)||(a=[]);var l=a.length,c=0,h=ke(this.markup);Array.isArray(h)||Ds("Expects Prototype JSON Markup.");var u=this.getPadding(),d=0,f=[];h.push({tagName:"g",selector:"wrapper",children:f});for(var p=0;p<l;p++){for(var g=[],v=[],x=[],S=[],C=[],P=Array.from(a[p]),O=this.createQueue(P,0,[],null),N=0,m=0;O.length>0;){var b=O.pop(),w=b.path,A=b.level,E=b.item,M=b.parent;A===0&&w.splice(1,0,p);var $=E.id,F=A!==-1,j=E.height||r,R=E.icon,H=E.items,z=!!E.highlighted,B=!!E.collapsed,_t=Array.isArray(H)&&H.length>0;$||Ds("Item id required."),n.hasOwnProperty($)&&Ds("Duplicated item id.");var gt=n[$]={path:w,visible:F,parent:M,label:E.label,height:j,group:p,hasSubItems:_t,highlighted:z,collapsed:B};if(_t&&(gt.children=H.map(function(W){return W.id}),Array.prototype.push.apply(O,this.createQueue(H,B||!F?-1:A+1,w,$))),!!F){var Rt=s*A;if(gt.x=Rt+s,gt.y=N,gt.cx=Rt+s/2,gt.cy=N+j/2,gt.span=E.span||1,$){var ne=this.getItemBodyMarkup(E,Rt,N,p,o&&p===0?u.left:0);g.push(ne);var bt=this.getItemLabelMarkup(E,Rt,N,p);v.push(bt),_t&&(x.push(this.getButtonMarkup(E,Rt,N,p)),B||C.push($)),R&&(S.push(this.getIconMarkup(E,Rt,N,p)),gt.x+=i.itemIcon.width+i.itemIcon.padding)}m=Math.max(m,gt.x+i.itemMinLabelWidth),N+=j}}d=Math.max(m,d),c=Math.max(c,N);var St=[];f.push({tagName:"g",selector:this.getSelector("group",p),groupSelector:"groups",attributes:{"record-group":p},children:St}),St.push({tagName:"g",selector:this.getSelector("bodiesGroup",p),groupSelector:"bodiesGroups",children:g},{tagName:"g",selector:this.getSelector("labelsGroup",p),groupSelector:"labelsGroups",children:v}),C.length>0&&St.push({tagName:"g",selector:this.getSelector("forksGroup",p),groupSelector:"forksGroups",children:C.map(this.getForkMarkup,this)}),x.length>0&&St.push({tagName:"g",selector:this.getSelector("buttonsGroup",p),groupSelector:"buttonsGroups",children:x}),S.length>0&&St.push({tagName:"g",selector:this.getSelector("iconsGroup",p),groupSelector:"iconsGroups",children:S})}e.padding=u,e.groupsCount=l,e.overflow=o,e.minHeight=c+u.top+u.bottom,e.minWidth=d*l+u.left+u.right;var Y=U({record:this.id,dry:!0},t);this.set("markup",h,Y),this.autoresize(Y)},autoresize:function(t){const e=this.getMinimalSize(),{size:n}=this.attributes,{height:i,width:r}=n,s=this.getScrollTop()===null?e.height:i,o=Math.max(r,e.width);this.resize(o,s,t)},getMinimalSize:function(){var t=this.metrics;return{width:t.minWidth,height:t.minHeight}},removeInvalidLinks:function(t){var e=this.graph;return e?e.getConnectedLinks(this).filter(this.isLinkInvalid,this).map(function(n){return n.remove(t)}):[]},isLinkInvalid:function(t){var e=this.id,n=this.metrics.items,i=t.source(),r=i.port;if(i.id===e&&r&&!(n[r]||this.hasPort(r)))return!0;var s=t.target(),o=s.port;return!!(s.id===e&&o&&!(n[o]||this.hasPort(o)))},createQueue:function(t,e,n,i){var r=t.length;return Array.from({length:r},function(s,o){var a=r-o-1;return{path:n.concat(["items",a]),item:t[a],level:e,parent:i}})},getGroupSelector:function(t){for(var e=Array.prototype.slice.call(arguments,1),n=[t],i=0,r=e.length;i<r;i++){var s=e[i];if(s!=null){Array.isArray(s)||(s=[s]);for(var o=0,a=s.length;o<a;o++)n.push(this.getSelector(t,s[o]))}}return n},getItemLabelMarkup:function(t,e,n,i){var r=this.attributes,s=r.itemOffset,o=t.height||r.itemHeight,a=t.id,l=e+s;return t.icon&&(l+=r.itemIcon.width+2*r.itemIcon.padding),{tagName:"text",className:"record-item-label",selector:this.getSelector("itemLabel",a),groupSelector:this.getGroupSelector("itemLabels",i,t.group),attributes:{x:l,y:n+o/2,"item-id":a}}},getItemBodyMarkup:function(t,e,n,i,r){var s=t.height||this.attributes.itemHeight,o=0;r&&(o-=r);var a={x:o,y:n,height:s,"item-id":t.id},l=t.span;return l&&(a["item-span"]=l),{tagName:"rect",selector:this.getSelector("itemBody",t.id),groupSelector:this.getGroupSelector("itemBodies",i,t.group),className:"record-item-body",attributes:a}},getButtonMarkup:function(t,e,n){var i=this.attributes,r=i.itemButtonSize,s=i.itemOffset,o=t.height||i.itemHeight;return{tagName:"path",className:"record-item-button",attributes:{d:this.getButtonPathData(e+s/2,n+o/2,r/2,t.collapsed),"item-id":t.id,cursor:"pointer","shape-rendering":"geometricprecision"}}},getIconMarkup:function(t,e,n,i){var r=this.attributes,s=r.itemOffset,o=r.itemIcon,a=t.height||r.itemHeight;return{tagName:"image",className:"record-item-icon",selector:this.getSelector("itemIcon",t.id),groupSelector:this.getGroupSelector("itemIcons",i,t.group),attributes:{x:e+s+o.padding,y:n+(a-o.height)/2,width:o.width,height:o.height,"xlink:href":t.icon,"item-id":t.id}}},getForkMarkup:function(t){return{tagName:"path",attributes:{d:this.getForkPathData(t),fill:"none"}}},getButtonPathData:function(t,e,n,i){var r=["M",t-n,e-n,t+n,e-n,t+n,e+n,t-n,e+n,"Z","M",t-n/2,e,t+n/2,e];return i&&Array.prototype.push.apply(r,["M",t,e-n/2,t,e+n/2]),r.join(" ")},getForkPathData:function(t){var e=this.metrics.items;if(!e)return null;var n=e[t];if(!n)return null;var i=n.children;if(!i||i.length===0)return null;for(var r=this.attributes.itemButtonSize,s=[],o,a=0,l=i.length;a<l;a++){o=e[i[a]];var c=o.cx+(o.hasSubItems?-1:1)*r/2;s.push("M",n.cx,o.cy,c,o.cy)}return s.push("M",n.cx,n.cy+r/2,n.cx,o.cy),s.join(" ")},item:function(t,e,n){var i=this.getItemPathArray(t);return i?e===void 0?this.prop(i):this.prop(i,e,n):null},toggleItemCollapse:function(t,e){var n=this.getItemPathArray(t);if(!n)return this;n.push("collapsed");var i=!!this.prop(n);return this.prop(n,!i,e),this},toggleItemHighlight:function(t,e){var n=this.getItemPathArray(t);if(!n)return this;n.push("highlighted");var i=!!this.prop(n);return this.prop(n,!i,e),this},isItemVisible:function(t){return this.getItemCacheAttribute(t,"visible")},isItemCollapsed:function(t){return this.getItemCacheAttribute(t,"collapsed")},isItemHighlighted:function(t){return this.getItemCacheAttribute(t,"highlighted")},getItemParentId:function(t){return this.getItemCacheAttribute(t,"parent")},getItemGroupIndex:function(t){return this.getItemCacheAttribute(t,"group")},getItemPathArray:function(t){var e=this.getItemCacheAttribute(t,"path");return e?e.slice():null},getItemSide:function(t){var e=this.getItemGroupIndex(t);if(e===null)return null;var n=this.metrics,i=n.groupsCount;if(i>1){if(e===0)return"left";if(e+n.items[t].span-1===i-1)return"right"}return"middle"},getItemCacheAttribute:function(t,e){if(!e)return null;const n=this.getItemCache(t);return n?n[e]:null},getItemCache:function(t){const e=this.metrics.items;if(!e)return null;const n=e[t];return n||null},getItemBBox:function(t){const e=this.getItemCache(t);if(!e)return null;const{x:n,y:i,width:r,height:s}=e;return new J(n,i,r,s)},getSelector:function(t,e){return t+"_"+e},removeItem:function(t,e){var n=this.getItemPathArray(t);if(!n)return this;var i=n.pop(),r=this.prop(n).slice();return r.length>1?(r.splice(i,1),this.prop(n,r,U({rewrite:!0},e))):n.length>2?this.removeProp(n,e):(i=n.pop(),r=this.get("items").slice(),r.splice(i,1,[]),this.prop(n,r,U({rewrite:!0},e))),this},addNextSibling:function(t,e,n){var i=this.getItemPathArray(t);if(!i)return this;var r=this.getItemParentId(t)||this.getItemGroupIndex(t),s=i[i.length-1]+1;return this.addItemAtIndex(r,s,e,n)},addPrevSibling:function(t,e,n){var i=this.getItemPathArray(t);if(!i)return this;var r=this.getItemParentId(t)||this.getItemGroupIndex(t),s=i[i.length-1];return this.addItemAtIndex(r,s,e,n)},addItemAtIndex:function(t,e,n,i){if(!n)return this;var r;switch(typeof t){case"number":var s=this.prop("items"),o=Math.min(Math.max(t,0),s.length);r=["items",o];break;case"string":if(r=this.getItemPathArray(t),!r)return this;r.push("items");break;default:Ds("Requires an item id.")}var a=this.prop(r);Array.isArray(a)?a=a.slice():a=[];var l=Math.min(Math.max(e,0),a.length);return a.splice(l,0,n),this.prop(r,a,U({rewrite:!0},i))},toJSON:function(){var t=Xt.prototype.toJSON.apply(this,arguments);return delete t.markup,t},getItemViewSign:function(t){this.isItemVisible(t)||Ds(`Item "${t}" does not exist or is not visible.`);const{attributes:e,metrics:n}=this,{y:i,height:r}=n.items[t],s=this.getScrollTop();if(s===null)return 0;const{height:o}=e.size,{top:a,bottom:l}=n.padding;return i-s<0?-1:o-a-l-(i+r-s)<0?1:0},isItemInView:function(t){return this.getItemViewSign(t)===0},isEveryItemInView:function(){if(this.getScrollTop()===null)return!0;const{minHeight:t}=this.metrics,{height:e}=this.size();return t<=e},clampScrollTop:function(t){const{height:e}=this.size(),{minHeight:n}=this.metrics;return Number.isFinite(t)?Math.min(Math.max(t,0),Math.max(n-e,0)):null},getScrollTop(){return this.clampScrollTop(this.get("scrollTop"))},setScrollTop(t,e){const n=this.get("scrollTop"),i=this.clampScrollTop(t);n!==i&&this.set("scrollTop",i,e)}},{attributes:{"item-text":{set:function(t,e,n,i){if(!Ee(t))return null;var r=this.model,s=n.getAttribute("item-id"),o=r.metrics.items[s];if(o){var a=o.label,l=r.metrics.padding,c=r.metrics.groupsCount,h=o.x,u=(e.width-l.left-l.right)/c*o.span-h,d=new J(h,o.y,u,o.height),f,p;t.textWrap?(f="text-wrap",p=U({text:a},t)):(f="text",p=a),this.getAttributeDefinition(f).set.call(this,p,d,n,i)}}},"item-highlight":{set:function(t,e,n,i){if(!Ee(t))return null;var r=this.model,s=n.getAttribute("item-id"),o=r.getItemCacheAttribute(s,"highlighted");switch(o){case!0:return t;case null:case!1:return Object.keys(t).reduce(function(a,l){return!i.hasOwnProperty(l)&&n.getAttribute(k.attributeNames[l])&&(a[l]=null),a},{})}}},"group-width":{set:function(t,e,n){var i=this.model.metrics,r=i.padding,s=i.groupsCount,o=(e.width-r.left-r.right)/s,a=Number(n.getAttribute("item-span")||1);if(isFinite(a)||(a=1),o*=a,i.overflow){var l=Number(this.findAttribute("record-group",n));l===0&&(o+=r.left),l+a===s&&(o+=r.right)}return{width:o}}},"group-position":{position:function(t,e,n){var i=Number(n.getAttribute("record-group")),r=this.model.metrics,s=r.groupsCount,o=r.padding,a=(e.width-o.left-o.right)/s,l=o.left+i*a,c=o.top;return new L(l,c)}},scrollable:{set:Pm(function(t,e){const{paper:{svg:n,defs:i},model:r,cid:s}=this,o=`scroll-clip-${s}`;let a,l=n.getElementById(o);l?(l=k(l),[a]=l.children()):(a=k("rect"),l=k("clipPath",{id:o},[a]),l.appendTo(i));const{padding:c,overflow:h}=r.metrics,{top:u,bottom:d,left:f,right:p}=c;let g=0,v=e.width;return h||(g+=f,v-=f+p),a.attr({y:t+u,x:g,width:v,height:Math.max(e.height-u-d,0)}),{"clip-path":`url(#${o})`}}),position:Pm(function(t){return new L(0,-t)})}}}),t5=uu.define("standard.BorderedRecord",{padding:0,attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#000000",fill:"#FFFFFF"}}},{markup:[{tagName:"rect",selector:"body"}]}),e5=uu.define("standard.HeaderedRecord",{padding:{top:30,left:0,right:0,bottom:0},itemAboveViewSelector:"header",itemBelowViewSelector:"header",attrs:{body:{refWidth:"100%",refHeight:"100%",stroke:"#000000",fill:"#FFFFFF"},header:{refWidth:"100%",height:30,stroke:"#000000",fill:"transparent"},headerLabel:{refX:"50%",refY:15,textAnchor:"middle",textVerticalAnchor:"middle",fontSize:20,fill:"#333333"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerLabel"}]});var n5=uu.prototype.markupAttributes.reduce(function(t,e){return t[e]=["UPDATE"],t},{scrollTop:["UPDATE","TOOLS"]});const ep=Te.extend({events:{"mousedown .record-item-button":"onItemButtonClick","touchstart .record-item-button":"onItemButtonClick"},presentationAttributes:Te.addPresentationAttributes(n5),getLinkEnd:function(t,...e){const n={id:this.model.id},i=this.findAttribute("item-id",t)||this.findAttribute("port",t);return i&&(n.port=i),this.customizeLinkEnd(n,t,...e)},getMagnetFromLinkEnd:function(t){for(var e=t.port,n=this.model;e&&!n.isItemVisible(e);)e=n.getItemParentId(e);if(!e)return QF.getMagnetFromLinkEnd.apply(this,arguments);const i=n.getItemViewSign(e);let r;switch(i){case-1:r=String(n.get("itemAboveViewSelector"));break;case 1:r=String(n.get("itemBelowViewSelector"));break;case 0:default:r=n.getSelector("itemBody",e);break}return this.findNode(r)},onItemButtonClick:function(t){if(t.button===2)return;t.stopPropagation(),t.preventDefault();const e=t.currentTarget.getAttribute("item-id");this.model.toggleItemCollapse(e,{ui:!0})}}),i5=ep,r5=ep;function Ds(t){throw new Error("shapes.standard.Record: "+t)}function Pm(t){return function(e,...n){if(!e)return;const{model:i}=this,r=i.getScrollTop();if(r!==null)return t.call(this,r,...n)}}const s5=Object.freeze(Object.defineProperty({__proto__:null,BorderedRecord:t5,BorderedRecordView:i5,HeaderedRecord:e5,HeaderedRecordView:r5,Record:uu,RecordView:ep},Symbol.toStringTag,{value:"Module"})),Ft='xmlns="http://www.w3.org/2000/svg"';function o5({color:t="#000",svg:e=!1}={}){const n={exclusive_blank:null,exclusive:`<svg ${Ft} viewBox="12 12 26 26"><path fill="${t}" stroke="${t}" d="M18.25 17.063L23.5 25.5l-5.25 8.438h4l3.25-5.25 3.25 5.25h3.906L27.438 25.5l5.218-8.438H28.75l-3.25 5.25-3.25-5.25h-4z"/></svg>`,inclusive:`<svg ${Ft} viewBox="12 12 26 26"><circle cx="25" cy="25" r="9.429" fill="none" stroke="${t}" stroke-width="3"/></svg>`,parallel:`<svg ${Ft} viewBox="12 12 26 26"><path fill="${t}" stroke="${t}" stroke-width="1.4" d="M16.388 21.821v5.625h5.86v6.328h5.624v-6.328H34.2v-5.625h-6.328v-5.86h-5.625v5.86z"/></svg>`,event:`<svg ${Ft} viewBox="12 12 26 26"><circle stroke-width="1.4" cx="25" cy="25" r="12.121" fill="none" stroke="${t}"/><circle stroke-width="1.4" cx="25" cy="25" r="10.121" fill="none" stroke="${t}"/><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.4" d="M29.828 31.845h-9.069l-2.801-8.625 7.337-5.33 7.335 5.33-2.802 8.625z"/></svg>`,exclusive_event:`<svg ${Ft} viewBox="12 12 26 26"><circle stroke-width="1.4" cx="25" cy="25" r="12.121" fill="none" stroke="${t}"/><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.4" d="M29.828 31.845h-9.069l-2.801-8.625 7.337-5.33 7.335 5.33-2.802 8.625z"/></svg>`,parallel_event:`<svg ${Ft} viewBox="12 12 26 26"><circle stroke-width="1.4" cx="25" cy="25" r="12.121" fill="none" stroke="${t}"/><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.4" d="M16.388 21.821v5.625h5.86v6.328h5.624v-6.328H34.2v-5.625h-6.328v-5.86h-5.625v5.86z"/></svg>`,complex:`<svg ${Ft} viewBox="13 13 25 25"><path fill="none" stroke="${t}" stroke-width="4" d="M16.25 25.5h19m-9.75-9.25v19m-6.644-2.96L32.29 18.857m-13.435.353L32.29 32.644"/></svg>`};if(e)return n;const i={};return Object.keys(n).forEach(r=>{i[r]=`data:image/svg+xml,${encodeURIComponent(n[r])}`}),i}function a5({color:t="#000",svg:e=!1}={}){const n={none:null,parallel:`<svg ${Ft} viewBox="-3 -3 16 16"><path fill="none" stroke="${t}" stroke-width="2" d="M0 0v10M3 0v10M6 0v10"/></svg>`,sequential:`<svg ${Ft} viewBox="-3 -3 16 16"><path fill="none" stroke="${t}" stroke-width="2" d="M0 2h10M0  5h10M0 8h10"/></svg>`,"sub-process":`<svg ${Ft} viewBox="-2 -2 14 14"><path fill="none" stroke="${t}" stroke-width="1" d="M0 0h10v10H0zm5 2v6M2 5h6"/></svg>`,compensation:`<svg ${Ft} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 13.438v13.124L12.437 20 19 13.437m6.563 0v13.126L19 20l6.563-6.563z"/></svg>`,"ad-hoc":`<svg ${Ft} viewBox="0 0 2000 2000"><path fill="${t}" d="M300 1039.87c58.332-138.228 134.894-282.23 266.546-360.085c97.784-58.392 218.701-22.42 308.428 34.819c138.188 85.207 246.292 211.842 382.606 299.507c82.335 48.265 184.733 8.718 244.748-58.056c72.401-84.446 155.215-164.023 197.672-269.981v330.038c-61.331 121.67-140.231 248.152-266.392 307.169c-103.228 44.44-223.148 17.789-312.524-46.586c-131.02-87.979-227.486-223.69-369.854-294.78c-69.172-36.004-157.377-27.545-215.331 26.623C431.412 1101.042 371.534 1231.858 300 1350v-310.13z"/></svg>`,loop:`<svg ${Ft} viewBox="0 0 2000 2000"><path fill="${t}" d="M1057.07 410.836C805.11 407.3 563.447 583.065 491.134 824.983c-55.584 173.977-23.105 373.061 85.522 520.027l-269.086-52.09l-22.804 117.814l483.865 93.664l93.687-479.986l-117.779-22.988l-56.861 291.316c-138.733-165.6-136.73-427.773 4.367-591.379c137.417-171.716 399.203-221.007 590.733-114c183.232 94.568 284.888 318.597 234.896 518.746c-44.77 208.91-247.404 367.34-460.604 363.053c-55.485-3.935-83.374 76.196-37.436 107.561c40.104 24.986 90.846 7.364 134.808 4.475c248.181-37.748 457.52-249.452 489.52-498.91c36.994-238.025-91.384-488.935-304.803-600.241c-86.168-46.769-184.068-71.364-282.089-71.21z"/></svg>`};if(e)return n;const i={};return Object.keys(n).forEach(r=>{i[r]=`data:image/svg+xml,${encodeURIComponent(n[r])}`}),i}function l5({color:t="#000",svg:e=!1}={}){const n={none:null,"business-rule":`<svg ${Ft} viewBox="5 5 25 20"><path fill="${t}" stroke="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2" d="m 8,8 0,4 20,0 0,-4 z"/><path stroke="${t}" fill="none" d=" m 8,8 0,12 20,0 0,-12 zm 0,8 l 20,0 m -13,-4 l 0,8"/></svg>`,manual:`<svg ${Ft} viewBox="0 0 2000 2000"><path d="M919.379 382.988c-22.3.007-42.953 8.258-60.567 19.616l-.029.017-.027.02c-94.694 61.32-418.867 286.29-490.127 335.2l-.002.003h-.002c-64.371 44.196-107.733 110.904-132.662 189.935l-.004.016-.004.014c-25.952 82.515-22.622 172.403-22.371 247.685l.002.02v.02c.255 56.685 1.606 106.154 16.309 166.148l.003.015c21.373 87.802 62.768 151.336 121.23 190.285 58.46 38.948 130.615 52.768 211.575 53.018 292.284 1.097 584.741 1.49 877.182 0h.05c32.21-.211 62.96-13.752 82.135-37.678 19.174-23.923 27.017-54.865 27.43-88.81.29-22.768-2.91-44.287-10.307-63.512h32.375c31.532 0 60.434-8.984 81.153-27.916 20.711-18.926 31.304-44.62 36.808-71.68v-.007c7.683-37.64 4.055-74.807-10.916-105.997 32.946-2.661 62.034-15.102 80.74-37.906 21.024-25.627 27.148-58.205 27.256-92.72.115-36.034-8.629-70.421-28.812-97.766s-53.772-45.956-91.567-46.01H1666.21c-13.76-.011-26.16.008-41.781 0 7.516-18.744 10.82-39.826 10.752-62.006v-.113c-.228-35.772-9.251-69.954-29.535-97.127-20.284-27.173-53.809-45.753-91.586-45.754-224.42-.885-446.252 2.157-634.903 1.203 9.83-9.885 19.378-19.525 29.871-29.96 32.482-32.304 63.7-62.743 79.827-83.612 38.555-49.623 44.307-116.852 11.85-166.305-17.114-26.143-42.208-43.832-69.151-47.513a89.543 89.543 0 00-10.012-.8v.003a90.145 90.145 0 00-2.162-.026zm.547 70.028a17.31 17.31 0 012.148.152c5.305.725 10.986 2.62 20.07 16.506l.018.025.016.026c12.691 19.326 12.131 58.305-8.623 84.992l-.035.045-.036.045c-7.546 9.77-41.454 44.616-73.818 76.802-32.364 32.187-63.134 61.896-78.357 80.442-14.557 17.734-9.216 32.647-5.268 41.982 3.948 9.335 8.465 20.237 28.598 25.02 6.028 1.432 6.36 1.02 8.289 1.152 1.929.133 3.923.224 6.267.309 4.689.169 10.688.297 18.094.406 226.465 1.38 450.423-1.24 676.709-.92h.063c17.211 0 26.557 5.657 35.492 17.627 8.929 11.962 15.468 31.813 15.629 55.652.066 24.73-5.857 39.82-13.057 48.133-7.2 8.313-16.845 13.52-37.475 13.588H1030v70h484.791c66.478.006 101.54-.042 151.363 0 17.308.03 26.53 5.662 35.324 17.578 8.8 11.922 15.21 31.827 15.133 55.975v.002c-.08 25.822-5.346 41.196-11.375 48.545-6.029 7.349-14.638 12.732-39.482 12.902-8.43.058-68.808.014-93.863.043-.397-.005-.786-.042-1.184-.043-180.227-.85-360.455-.002-540.682-.002H1030l-.025 70h.025c.043 0 382.517.239 541.33.047 19.7.279 31.511 8.21 40.934 23.601 9.563 15.621 14.323 40.11 8.68 67.756v.028c-3.737 18.38-9.413 28.473-15.436 33.976-6.023 5.504-14.335 9.592-33.934 9.592-180.523-.086-361.044-.452-541.568 0h-.092l.092 70h409.414c14.707.096 21.247 4.008 27.96 12.977 6.715 8.968 12.44 25.642 12.132 49.652v.025c-.284 23.412-5.952 38.272-12.057 45.889-6.105 7.617-12.405 11.357-27.973 11.459-292.123 1.488-584.356 1.097-876.51 0h-.025c-73.053-.223-130.456-12.932-173-41.275-42.55-28.344-73.607-72.869-92.039-148.598l-.008-.03-.005-.029c-12.87-52.492-14.06-94.01-14.311-149.81v-.041c-.256-76.57-1.724-160.05 19.146-226.408 21.392-67.802 55.988-119.253 105.512-153.256l.004-.002c72.125-49.505 398.23-275.66 488.5-334.12l.004-.001c8.476-5.465 15.5-7.79 20.719-8.303.87-.086 1.689-.122 2.457-.113z" fill="${t}" /></svg>`,receive:`<svg ${Ft} viewBox="10 10 20 20"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2" d="M12.5 15.313v9.374h15v-9.375zm0 0l7.5 5.624 7.5-5.625"/></svg>`,script:`<svg ${Ft} viewBox="0 0 2000 2000"><path d="M759.41 378l-8.262 4.904-2.699 1.604C631.658 453.72 551.284 517.185 498.23 579.16c-53.13 62.06-78.817 124.548-79.547 184.787-1.454 119.88 86.972 209.719 165.425 290.067 78.394 80.286 148.323 156.002 154.905 218.664 3.354 31.938-4.195 64.019-39.02 107.943-34.678 43.74-97.616 96.128-198.24 154.785L353.193 1622h916.854l10.85-6.313.011-.01c106.636-62.16 178.477-119.59 224.254-177.33 45.914-57.91 64.594-118.499 58.62-175.378-11.838-112.702-103.646-194.827-180.829-273.873-77.243-79.108-139.852-153.721-139-224.024.43-35.49 14.072-75.084 57.219-125.484 43.073-50.314 115.696-109.181 227.031-175.158v-.002L1674.045 378H759.41zm25.842 92.918h564.643c-49.73 37.078-89.049 72.898-119.307 108.242-53.13 62.06-78.817 124.548-79.547 184.787-1.453 119.882 86.977 209.72 165.43 290.067 78.393 80.286 148.316 156 154.898 218.664 3.355 31.938-4.193 64.019-39.017 107.943-33.397 42.123-93.456 92.386-187.79 148.461h-566.09c39.27-30.627 70.469-60.635 94.33-90.732 45.914-57.911 64.594-118.5 58.62-175.38-11.838-112.701-103.645-194.826-180.828-273.872-77.243-79.108-139.85-153.721-138.998-224.024.43-35.49 14.07-75.084 57.216-125.484 41.627-48.624 111.275-105.346 216.44-168.672zM653.13 629.393v42.92h441.398v-42.92H653.131zm-16.402 231.175v42.918h456.384v-42.918H636.73zm206.794 231.17v42.918h441.989v-42.918H843.523zm63.198 231.174v42.918h457.986v-42.918H906.721z" fill="${t}"/></svg>`,send:`<svg ${Ft} viewBox="10 10 20 20"><path fill="${t}" d="M12.5 14.344l7.5 5.625 7.5-5.625zm0 .937v9.375h15v-9.375L20 20.906z"/></svg>`,service:`<svg ${Ft} viewBox="0 0 2000 2000"><path d="M825.746 438.174c-.046 36.998.01 73.998.106 110.996-31.554 8.927-60.387 21.384-87.616 36.644l-79.582-78.625-148.806 149.668 79.576 78.612a393.526 393.526 0 00-35.752 87.242l-112.725.205v210.79l113.903-.411c10.416 41.298 33.084 78.425 55.662 111.623V963.094l-99.565.357V892.79l99.069-.18 5.56-28.172c8.11-41.084 24.17-80.249 47.244-115.292l15.785-23.973-69.603-68.762 50.094-50.385 69.73 68.893 23.73-15.836c36.264-23.926 75.929-39.963 115.481-48.316l27.96-5.805-.25-96.785h71.966l-.557 96.281h188.834c-17.713-21.144-91.12-48.658-118.508-56.324l.635-109.957c-78.4-.002-139.865.004-212.37-.002zm199.158 201.658l.287 110.992c-31.554 8.927-60.387 21.383-87.617 36.645l-79.584-78.625-148.806 149.668 79.578 78.611a393.515 393.515 0 00-35.754 87.244l-112.723.203v210.79l113.9-.409c8.966 31.257 21.395 59.8 36.626 86.746l-81.495 81.176 150.465 147.879 81.201-80.824c27.815 15.444 57.38 27.436 88.034 35.781l.052 114.713c72.392.634 149.467.307 211.336.3v-116.07c31.578-8.904 60.501-21.45 87.737-36.705l81.134 79.996 148.905-149.48-81.305-80.123a394.444 394.444 0 0035.799-87.399l110.379-.681v-210.586l-111.618.68c-8.972-31.287-21.22-59.637-36.654-86.762l77.121-77.319-150.38-148.13-77.022 77.285a398.637 398.637 0 00-87.68-35.639l.633-109.957h-212.549zm70.18 70h71.967l-.555 96.283 28.426 5.578c41.272 8.1 80.83 24.14 116.015 47.073l23.825 15.529 67.216-67.445 50.618 49.86-67.31 67.483 16.194 23.907c23.765 35.872 39.529 74.65 48.428 114.58l5.856 28.011 97.28-.591v70.59l-96.737.595-5.557 28.012a324.606 324.606 0 01-47.299 115.398l-15.803 24.006 71.258 70.223-50.086 50.28-71.265-70.266-23.69 15.738c-36.275 23.706-75.624 40.123-115.324 48.21l-28.144 5.622v102.215c-19.241.046-40.231.016-71.37-.028l-.045-101.449-28.271-5.521c-41.33-8.071-80.823-24.038-115.947-47.067l-23.754-15.574-71.541 71.21-50.625-49.757 71.64-71.361-16.347-24.004c-23.787-35.794-39.523-74.612-48.438-114.496l-5.85-27.926-99.564.355v-70.66l99.069-.181 5.56-28.168c8.11-41.085 24.17-80.252 47.244-115.295l15.785-23.975-69.605-68.762 50.094-50.384 69.732 68.892 23.73-15.834c36.31-23.77 74.841-39.541 115.481-48.314l27.96-5.805-.251-96.787zm37.166 257.203c-86.647 0-157.639 70.994-157.639 157.64 0 86.648 70.992 157.638 157.639 157.638s157.639-70.99 157.639-157.637-70.992-157.64-157.639-157.64zm0 70c48.816 0 87.639 38.825 87.639 87.64 0 48.817-38.823 87.638-87.639 87.638-48.816 0-87.637-38.821-87.637-87.637s38.82-87.64 87.637-87.64z" fill="${t}"/></svg>`,user:`<svg ${Ft} viewBox="0 0 2000 2000"><path d="M991.75 365c-177.277 0-304.097 136.28-304.453 291.514v.088c.011 46.944 12.714 96.49 32.56 141.177 14.33 32.267 32.147 61.932 53.858 85.696-129.03 44.143-280.193 116.795-356.598 260.054L413 1151.25V1615h1157.5v-463.75l-4.117-7.72c-75.306-141.2-223.199-213.75-350.98-258.077 62.379-63.433 80.78-145.306 80.8-228.851v-.088C1295.847 501.28 1169.027 365 991.75 365zM870.709 530.299c8.194.02 17.191.294 27.11.879 79.022 4.657 105.618 18.882 126.062 32.373 20.443 13.49 34.855 26.333 88.883 27.908h.034c42.101-1.575 62.349-9.081 76.869-17.584 5.884-3.445 10.824-7.027 15.887-10.447 13.38 28.682 20.567 60.389 20.648 93.203-.028 93.44-16.092 158.876-101.768 212.424l8.381 63.17c17.833 5.415 36.266 11.357 54.975 17.873 2.613 10.9 5.632 25.196 7.662 40.394 2.127 15.923 2.964 32.489 1.652 44.928-1.311 12.439-5.173 19.154-5.851 19.832-43.547 43.547-120.847 68.943-199.252 68.943-78.406 0-155.705-25.396-199.252-68.943-.678-.678-4.54-7.393-5.852-19.832-1.311-12.439-.475-29.005 1.653-44.928 2.041-15.282 5.084-29.662 7.707-40.584 18.522-6.44 36.77-12.32 54.43-17.683l4.995-67.688c-4.068-5.217-8.213-8.673-13.16-12.385-19.121-14.345-42.31-45.903-58.69-82.785-16.373-36.868-26.517-79.01-26.532-112.744.101-40.444 10.985-79.211 30.976-112.697 3.577-1.332 7.349-2.739 11.588-4.133 14.908-4.903 35.337-9.583 70.846-9.494zM719.361 979.855c-.063.46-.133.907-.195 1.368-2.587 19.363-4.107 40.44-1.883 61.537 2.224 21.096 7.79 43.81 25.969 61.988 62.048 62.048 155.95 89.447 248.748 89.447 92.797 0 186.7-27.4 248.748-89.447 18.178-18.178 23.745-40.892 25.969-61.988 2.224-21.097.704-42.174-1.883-61.537-.051-.382-.11-.753-.162-1.133 94.334 41.369 185.515 100.615 235.828 189.074V1545H1333v-265h-70v265H719v-265h-70v265H483v-375.836c50.408-88.626 141.838-147.93 236.361-189.309z" fill="${t}" fill-rule="evenodd"/></svg>`};if(e)return n;const i={};return Object.keys(n).forEach(r=>{i[r]=`data:image/svg+xml,${encodeURIComponent(n[r])}`}),i}function c5({color:t="#000",svg:e=!1}={}){const n={none:null,message1:`<svg ${Ft} viewBox="10 10 20 20"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2" d="M12.5 15.313v9.374h15v-9.375zm0 0l7.5 5.624 7.5-5.625"/></svg>`,message2:`<svg ${Ft} viewBox="10 10 20 20"><path fill="${t}" d="M12.5 14.344l7.5 5.625 7.5-5.625zm0 .937v9.375h15v-9.375L20 20.906z"/></svg>`,timer1:`<svg ${Ft} viewBox="8 8 24 24"><g fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><circle cx="20" cy="20" r="10"/><path d="M20 10v3m5-2l-1.5 3m5.5 1l-3 1.5m4 3.5h-3m2 5l-3-1.5M25 29l-1.5-3M20 30v-3m-5 2l1.5-3M11 25l3-1.5M10 20h3m-2-5l3 1.5m1-5.5l1.5 3m5.5-1l-2 7h4"/></g></svg>`,conditional1:`<svg ${Ft} viewBox="6 6 28 28"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.563 11.563h16.874v16.874H11.563V11.563m2.813 2.813h11.25m-11.25 3.75h11.25m-11.25 3.75h11.25m-11.25 3.75h11.25z"/></svg>`,link1:`<svg ${Ft} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M14.406 18.125h8.438v-2.813L27.53 20l-4.687 4.688v-2.813h-9.375v-3.75"/></svg>`,link2:`<svg ${Ft} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M14.406 18.125h8.438v-2.813L27.53 20l-4.687 4.688v-2.813h-9.375v-3.75"/></svg>`,signal1:`<svg ${Ft}  viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13.17 24.851h13.706l-6.853-11.879-6.854 11.88z"/></svg>`,signal2:`<svg ${Ft}  viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M13.17 24.851h13.706l-6.853-11.879-6.854 11.88z"/></svg>`,error1:`<svg ${Ft} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M26.4 15.455l-3.238 12.58L17.7 18.37 13.76 23.8l3.478-12.412 5.576 8.72 3.586-4.652z"/></svg>`,error2:`<svg ${Ft} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M26.4 15.455l-3.238 12.58L17.7 18.37 13.76 23.8l3.478-12.412 5.576 8.72 3.586-4.652z"/></svg>`,escalation1:`<svg ${Ft} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 13.219l5.625 14.062L20 20.953l-5.625 6.328z"/></svg>`,escalation2:`<svg ${Ft} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M20 13.219l5.625 14.062L20 20.953l-5.625 6.328z"/></svg>`,termination1:`<svg ${Ft} viewBox="8 8 24 24"><circle cx="20" cy="20" r="10.5" fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"/></svg>`,termination2:`<svg ${Ft} viewBox="8 8 24 24"><circle cx="20" cy="20" r="10.5" fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"/></svg>`,compensation1:`<svg ${Ft} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 13.438v13.124L12.437 20 19 13.437m6.563 0v13.126L19 20l6.563-6.563z"/></svg>`,compensation2:`<svg ${Ft} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 13.438v13.124L12.437 20 19 13.437m6.563 0v13.126L19 20l6.563-6.563z"/></svg>`,cancel1:`<svg ${Ft} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.284 14.274l2.867-2.868 5.735 5.735 5.735-5.735 2.868 2.868-5.735 5.735 5.735 5.735-2.868 2.867-5.735-5.735-5.735 5.735-2.867-2.867 5.735-5.735-5.735-5.735z"/></svg>`,cancel2:`<svg ${Ft} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.284 14.274l2.867-2.868 5.735 5.735 5.735-5.735 2.868 2.868-5.735 5.735 5.735 5.735-2.868 2.867-5.735-5.735-5.735 5.735-2.867-2.867 5.735-5.735-5.735-5.735z"/></svg>`,multiple1:`<svg ${Ft} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M24.52 26.39h-9.443l-2.918-8.982 7.64-5.55 7.64 5.551-2.919 8.98z"/></svg>`,multiple2:`<svg ${Ft} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M24.52 26.39h-9.443l-2.918-8.982 7.64-5.55 7.64 5.551-2.919 8.98z"/></svg>`,parallel1:`<svg ${Ft} viewBox="8 8 24 24"><path fill="none" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.344 17.203v5.625h5.86v6.328h5.624v-6.328h6.328v-5.625h-6.328v-5.86h-5.625v5.86z"/></svg>`,parallel2:`<svg ${Ft} viewBox="8 8 24 24"><path fill="${t}" stroke="${t}" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.344 17.203v5.625h5.86v6.328h5.624v-6.328h6.328v-5.625h-6.328v-5.86h-5.625v5.86z"/></svg>`};if(e)return n;const i={};return Object.keys(n).forEach(r=>{i[r]=`data:image/svg+xml,${encodeURIComponent(n[r])}`}),i}const Qh=c5({color:"${color}",svg:!0}),u5=o5({color:"${color}",svg:!0}),Xx=a5({color:"${color}",svg:!0}),h5=l5({color:"${color}",svg:!0});function qx(t){return function(e,n,i,r){switch(e){case"double":{const o=n.clone().inflate(-3),{fill:a="none"}=r;return{d:`${t(n,r,0)} ${t(o,r,3)}`,fill:a}}case"thick":{const o=n.clone().inflate(-3),{stroke:a="black"}=r;return{d:`${t(n,r,0)} ${t(o,r,3)}`,fill:a}}default:case"single":return{d:t(n,r,0),fill:"none"}}}}function Kx(t,e,n,i){let r;switch(t){case"dashed":{const{width:s,height:o}=e,a=Math.floor(Math.min(s,o)/20);r=`${a*4},${a}`;break}case"dotted":{const s=i["stroke-width"];r=`${s},${s*2}`;break}default:case"solid":{r="none";break}}return{"stroke-dasharray":r}}function Zx(t,e,n={}){let i;const r=n[t];if(typeof r=="string"){const s=e["icon-color"]??"black",o=r.replace(/\${color}/g,s);i=`data:image/svg+xml,${encodeURIComponent(o)}`}else i=null;return{"xlink:href":i,"data-icon-type":t}}function _a(t){return function(n,i,r,s){return Zx(n,s,this.model.constructor[t])}}const lo={row:"row",column:"column"},co={topLeft:"left-top",bottomLeft:"left-bottom",topRight:"right-top",bottomRight:"right-bottom",topMiddle:"top",bottomMiddle:"bottom",rightMiddle:"right",leftMiddle:"left",center:"center"},Im=Object.keys(co).reduce((t,e)=>(t[co[e]]=e,t),{});function Jx(t){return function(e,n,i,r){const s="joint-icons",o=q.data.get(i,s),a=r["icon-color"]??"#333333",l=r["icon-size"]??30,c=r["icons-flow"]??lo.row,h=`${e.toString()} ${a} ${l} ${c}`;if(o!==h){const u=k(i);u.empty();const d=c===lo.column;if(!Array.isArray(e))return;const f=e.map((p,g)=>{const v=k("image");v.attr(Zx(p,r,this.model.constructor[t]));let x,S;return d?(x=0,S=g*l):(x=g*l,S=0),v.attr({x,y:S,width:l,height:l}),v});u.append(f)}q.data.set(i,s,h)}}function Qx(t,e,n,i){const r=i["icon-size"]??30,s=i["icons-flow"]??lo.row,o=i["icons-origin"]??co.topLeft;let a,l;const c=Array.isArray(t)?t.length:0;s===lo.column?(a=r,l=c*r):(a=c*r,l=r);const h=new J(0,0,-a,-l);return o in Im?h[Im[o]]():h.center()}function Om(t,e,n,i,r,s,o){const a=be(i),{left:l,right:c,top:h,bottom:u}=Ne(i["label-margin"]),d=d5[i["label-alignment"]],f=new J(l,h,r-l-c,s-h-u);d&&(a["text-anchor"]=d["text-anchor"],a["text-vertical-anchor"]=d["text-vertical-anchor"]);let p,g;return e.textWrap?(p="text-wrap",g={text:o,ellipsis:e.ellipsis}):(p="text",g=o),t.getAttributeDefinition(p).set.call(t,g,f,n,a),d}const nn=be(co),d5={"left-top":{"text-anchor":"start","text-vertical-anchor":"top"},"left-bottom":{"text-anchor":"start","text-vertical-anchor":"bottom"},"right-top":{"text-anchor":"end","text-vertical-anchor":"top"},"right-bottom":{"text-anchor":"end","text-vertical-anchor":"bottom"},top:{"text-anchor":"middle","text-vertical-anchor":"top"},bottom:{"text-anchor":"middle","text-vertical-anchor":"bottom"},right:{"text-anchor":"end","text-vertical-anchor":"middle"},left:{"text-anchor":"start","text-vertical-anchor":"middle"},center:{"text-anchor":"middle","text-vertical-anchor":"middle"}},f5=Xt.define("bpmn2.Event",{size:{width:40,height:40},attrs:{root:{cursor:"move",magnetSelector:"background",highlighterSelector:"background"},background:{refCx:"50%",refCy:"50%",refRx:"50%",refRy:"50%",fill:"#FFFFFF"},border:{stroke:"#333333",fillRule:"evenodd",borderType:"single",borderStyle:"solid",strokeWidth:2},icon:{iconColor:"#333333",iconType:"none",refX:"15%",refY:"15%",refWidth:"70%",refHeight:"70%"},label:{refDy:10,refX:"50%",textVerticalAnchor:"top",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold"}}},{markup:[{tagName:"ellipse",selector:"background"},{tagName:"image",selector:"icon"},{tagName:"path",selector:"border"},{tagName:"text",selector:"label"}]},{attributes:{"border-type":{set:qx(t=>p5(t))},"border-style":{set:Kx},"icon-type":{set:_a("EVENT_ICONS")}},EVENT_ICONS:Qh});function p5(t){const e=t.center(),n=k("ellipse",{cx:e.x,cy:e.y,rx:t.width/2,ry:t.height/2});return k.convertEllipseToPathData(n)}const g5=Xt.define("bpmn2.Gateway",{size:{width:58,height:58},attrs:{root:{cursor:"move",magnetSelector:"body",highlighterSelector:"body"},body:{refPoints:"1,0,2,1,1,2,0,1",fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},icon:{iconColor:"#333333",refX:"19%",refY:"19%",refWidth:"62%",refHeight:"62%"},label:{refDy:10,refX:"50%",textVerticalAnchor:"top",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"image",selector:"icon"},{tagName:"text",selector:"label"}]},{attributes:{"icon-type":{set:_a("GATEWAY_ICONS")}},GATEWAY_ICONS:u5});var Pl=10;const m5=Xt.define("bpmn2.DataStore",{size:{width:63,height:63},attrs:{root:{cursor:"move",magnetSelector:"body",highlighterSelector:"body"},body:{lateralArea:Pl,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},top:{refCx:"50%",cy:Pl,refRx:"50%",ry:Pl,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{textVerticalAnchor:"top",textAnchor:"middle",refX:"50%",refY:"100%",refY2:Pl,fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",fill:"#333333",textWrap:{width:"200%"}}}},{markup:[{tagName:"path",selector:"body"},{tagName:"ellipse",selector:"top"},{tagName:"text",selector:"label"}],topRy:function(t,e){if(t===void 0)return this.attr("body/lateralArea");var n=Ue(t),i={lateralArea:t},r={refY2:t},s=n?{refCy:t,refRy:t,cy:null,ry:null}:{refCy:null,refRy:null,cy:t,ry:t};return this.attr({body:i,top:s,label:r},e)}},{attributes:{"lateral-area":{set:function(t,e){var n=Ue(t);n&&(t=parseFloat(t)/100);var i=e.x,r=e.y,s=e.width,o=e.height,a=s/2,l=n?o*t:t,c=k.KAPPA,h=c*a,u=c*(n?o*t:t),d=i,f=i+s/2,p=i+s,g=r+l,v=g-l,x=r+o-l,S=r+o,C=["M",d,g,"L",d,x,"C",i,x+u,f-h,S,f,S,"C",f+h,S,p,x+u,p,x,"L",p,g,"C",p,g-u,f+h,v,f,v,"C",f-h,v,d,g-u,d,g,"Z"];const P=7;let O=g+P,N=g+l+P;return C.push("M",p,O,"C",p,O+u,f+h,N,f,N,"C",f-h,N,d,O+u,d,O),O+=P,N+=P,C.push("L",d,O,"C",d,O+u,f-h,N,f,N,"C",f+h,N,p,O+u,p,O,"Z"),{d:C.join(" ")}}}}}),v5=Xt.define("bpmn2.DataObject",{size:{width:48,height:65},attrs:{root:{cursor:"move",magnetSelector:"body",highlighterSelector:"body"},body:{objectD:10,fill:"#FFFFFF",stroke:"#333333",strokeWidth:2},label:{refY:"100%",refY2:10,refX:"50%",textVerticalAnchor:"top",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",textWrap:{width:"200%"}},dataTypeIcon:{iconColor:"#333333",iconType:"none",x:0,y:0,width:25,height:25},collectionIcon:{iconColor:"#333333",collection:!1,refX:"50%",refY:"100%",y:-16-2,x:-16/2+2,width:16,height:16}}},{markup:[{tagName:"path",selector:"body"},{tagName:"text",selector:"label"},{tagName:"image",selector:"dataTypeIcon"},{tagName:"image",selector:"collectionIcon"}]},{attributes:{"object-d":{set:function(t,e){const n=t,i=e.topLeft(),r=e.bottomLeft(),s=e.bottomRight(),o=e.topRight(),a=o.clone().offset(-n,n),l=o.clone().offset(0,n),c=o.clone().offset(-n,0),h=`M ${i.serialize()} ${r.serialize()} ${s.serialize()} ${l.serialize()} ${c.serialize()} Z`,u=`M ${c.serialize()} ${a.serialize()} ${l.serialize()}`;return{d:`${h} ${u}`}}},"icon-type":{set:_a("DATA_OBJECT_TYPE_ICONS")},collection:{set:_a("DATA_OBJECT_COLLECTION_ICONS")}},DATA_OBJECT_TYPE_ICONS:{none:null,input:Qh.link1,output:Qh.link2},DATA_OBJECT_COLLECTION_ICONS:{false:null,true:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="-3 -3 16 16"><path fill="none" stroke="${color}" stroke-width="2" d="M0 0v10M3 0v10M6 0v10"/></svg>'}}),hu={markup:[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],attrs:{label:{fill:"#333333",fontSize:12,textAnchor:"middle",textVerticalAnchor:"middle",fontFamily:"sans-serif"},body:{ref:"label",fill:"#ffffff",stroke:"none",refX:0,refY:0,refWidth:"100%",refHeight:"100%"}},position:{distance:.5}},y5=dr.define("bpmn2.DataAssociation",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",strokeDasharray:"2,5",targetMarker:{type:"path",d:"M 10 -7 0 0 10 7","stroke-width":2,fill:"none"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{defaultLabel:hu,markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),b5=Xt.define("bpmn2.Activity",{size:{width:120,height:100},attrs:{root:{cursor:"move",magnetSelector:"background",highlighterSelector:"background"},background:{refWidth:"100%",refHeight:"100%",fill:"#FFFFFF",rx:10,ry:10},border:{stroke:"#333333",fillRule:"evenodd",borderType:"single",borderStyle:"solid",borderRadius:10,strokeWidth:2},icon:{iconColor:"#333333",iconType:"none",x:5,y:0,width:30,height:30},label:{refY:"50%",refX:"50%",textVerticalAnchor:"middle",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",textWrap:{width:-10,height:-50,ellipsis:!0}},markers:{event:"element:marker:pointerdown",iconSize:16,iconColor:"#333333",iconTypes:[""],iconsOrigin:co.bottomMiddle,iconsFlow:lo.row,refX:"50%",refY:"100%",refY2:-5}}},{markup:[{tagName:"rect",selector:"background"},{tagName:"image",selector:"icon"},{tagName:"path",selector:"border"},{tagName:"text",selector:"label"},{tagName:"g",selector:"markers"}]},{attributes:{"border-type":{set:qx((t,e,n)=>{const i=e["border-radius"]??0,r=Math.max(Math.min(i,2),i-n),s=t.toJSON();return s.rx=s.ry=r,k.rectToPath(s)})},"border-style":{set:Kx},"icon-type":{set:_a("ACTIVITY_TYPE_ICONS")},"icon-types":{set:Jx("ACTIVITY_MARKER_ICONS"),position:Qx},"icon-size":{},"icons-origin":{},"icons-flow":{},"icon-color":{},"border-radius":{}},ACTIVITY_TYPE_ICONS:h5,ACTIVITY_MARKER_ICONS:Ze(Xx,"none")}),x5=Xt.define("bpmn2.Conversation",{size:{width:58,height:47},attrs:{root:{cursor:"move",magnetSelector:"body",highlighterSelector:"body"},body:{fill:"#FFFFFF",stroke:"#333333",refPoints:"1,0 3,0, 4,1 3,2 1,2 0,1, 1,0",strokeLinejoin:"round",strokeWidth:2},markers:{event:"element:marker:pointerdown",iconSize:16,iconColor:"#333333",iconTypes:[],iconsOrigin:co.bottomMiddle,iconsFlow:lo.row,refX:"50%",refY:"100%"},label:{refDy:10,refX:"50%",textVerticalAnchor:"top",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold"}}},{markup:[{tagName:"polygon",selector:"body"},{tagName:"text",selector:"label"},{tagName:"g",selector:"markers"}]},{attributes:{"icon-types":{set:Jx("CONVERSATION_MARKER_ICONS"),position:Qx},"icon-size":{},"icons-origin":{},"icons-flow":{},"icon-color":{}},CONVERSATION_MARKER_ICONS:Ze(Xx,"none")}),w5=dr.define("bpmn2.ConversationLink",{attrs:{line:{connection:!0,stroke:"#FFFFFF",strokeWidth:2,strokeLinejoin:"round"},outline:{connection:!0,stroke:"#333333",strokeWidth:6,strokeLinejoin:"round"},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{defaultLabel:hu,markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"outline",attributes:{fill:"none","pointer-events":"none"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),_5=Po["source-marker"].set,S5=Po["target-marker"].set,Yo={sequence:"sequence",default:"default",conditional:"conditional",message:"message"},E5=dr.define("bpmn2.Flow",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",flowType:"sequence"},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{defaultLabel:hu,markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]},{attributes:{"flow-type":{set:function(t,e,n,i){const r=i["marker-fill"]??"#FFFFFF",s=i["stroke-width"]??2,o={"stroke-dasharray":"none","marker-start":null,"marker-end":null};let a,l;switch(t){case Yo.default:{a={d:"M 5 -5 15 5","stroke-width":s},l={type:"path",d:"M 12 -5 0 0 12 5 z"};break}case Yo.conditional:{a={d:"M 0 0 9 -5 18 0 9 5 Z","stroke-width":s,fill:r},l={type:"path",d:"M 12 -5 0 0 12 5 z"};break}case Yo.message:{o["stroke-dasharray"]="5,2",a={type:"circle",cx:5,r:5,"stroke-width":s,fill:r},l={type:"path",d:"M 12 -5 0 0 12 5 z","stroke-width":s,fill:r};break}case Yo.sequence:default:{l={type:"path",d:"M 12 -5 0 0 12 5 z"};break}}return a&&U(o,_5.call(this,a,e,n,i)),l&&U(o,S5.call(this,l,e,n,i)),o}},"marker-fill":{}},FLOW_TYPES:Yo}),T5=Xt.define("bpmn2.Group",{size:{width:120,height:100},attrs:{root:{cursor:"move",magnetSelector:"body",highlighterSelector:"body"},body:{refWidth:"100%",refHeight:"100%",fill:"transparent",rx:10,ry:10,stroke:"#333333",borderStyle:"dashed",strokeWidth:2,strokeLinecap:"square",pointerEvents:"none"},wrapper:{refX:5,refY:5,refWidth:-10,refHeight:-10,pointerEvents:"stroke",strokeWidth:10,stroke:"transparent",fill:"none"},label:{refY:6,refX:"50%",textAnchor:"middle",fontSize:12,fontFamily:"sans-serif",fontWeight:"bold",textWrap:{width:-12,height:-12,ellipsis:!0}}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"wrapper"},{tagName:"text",selector:"label"}]},{attributes:{"border-style":{set:function(t,e,n,i){var r=2,s=i["stroke-width"]||1,o=r*s+","+r*s+","+s/r;return{"stroke-dasharray":o}}}}}),A5=Xt.define("bpmn2.Annotation",{size:{width:80,height:40},attrs:{root:{cursor:"move",magnetSelector:"body",highlighterSelector:"body"},body:{refWidth:"100%",refHeight:"100%",fill:"transparent"},border:{annotationD:{size:10},fill:"none",stroke:"#333333",strokeWidth:2},label:{refY:6,refX:4,fontSize:12,fontFamily:"sans-serif",textWrap:{width:-12,height:-12,ellipsis:!0}}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"path",selector:"border"},{tagName:"text",selector:"label"}]},{attributes:{"annotation-d":{set:function(t,e){const n=t.size||0,i=t.side,r=e.topLeft(),s=e.bottomLeft(),o=e.topRight(),a=e.bottomRight();switch(i){case"top":{const l=r.clone().offset(0,n),c=o.clone().offset(0,n);return{d:`${`M ${l.serialize()} ${r.serialize()} ${o.serialize()} ${c.serialize()}`}`}}case"right":{const l=o.clone().offset(-n,0),c=a.clone().offset(-n,0);return{d:`${`M ${l.serialize()} ${o.serialize()} ${a.serialize()} ${c.serialize()}`}`}}case"bottom":{const l=s.clone().offset(0,-n),c=a.clone().offset(0,-n);return{d:`${`M ${l.serialize()} ${s.serialize()} ${a.serialize()} ${c.serialize()}`}`}}case"left":default:{const l=r.clone().offset(n,0),c=s.clone().offset(n,0);return{d:`${`M ${l.serialize()} ${r.serialize()} ${s.serialize()} ${c.serialize()}`}`}}}}}}}),C5=dr.define("bpmn2.AnnotationLink",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",strokeDasharray:"2,5"},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"}}},{defaultLabel:hu,markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}}]}),np=Xt.define("bpmn2.Pool",{size:{width:600,height:300},lanes:null,milestones:null,milestonesSize:20,padding:0,headerSize:20,attrs:{body:{cursor:"move",refWidth:"100%",refHeight:"100%",fill:"transparent"},laneGroups:{laneContainerPosition:!0},laneHeaders:{fill:"#ffffff",stroke:"#333333",strokeWidth:2,headerSize:!0,shapeRendering:"optimizespeed"},laneLabels:{fontSize:14,fill:"#333333",transform:"rotate(-90)",textAnchor:"middle",textVerticalAnchor:"middle",labelAlignment:nn.center,labelMargin:{vertical:1,horizontal:10},fontFamily:"sans-serif",labelPosition:!0,laneLabel:{textWrap:!0,ellipsis:!0}},lanes:{stroke:"#333333",strokeWidth:2,fill:"#ffffff",laneSize:!0,shapeRendering:"optimizespeed"},milestoneGroups:{milestoneContainerPosition:!0},milestoneHeaders:{fill:"#ffffff",stroke:"#333333",strokeWidth:2,milestoneHeaderSize:!0,shapeRendering:"optimizespeed"},milestoneLabels:{fontSize:14,fill:"#333333",textAnchor:"end",textVerticalAnchor:"middle",labelAlignment:nn.rightMiddle,labelMargin:{vertical:1,horizontal:10},fontFamily:"sans-serif",milestoneLabelPosition:!0,milestoneLabel:{textWrap:!0,ellipsis:!0}},milestoneLines:{stroke:"#333333",strokeWidth:2,milestoneLinePosition:!0,shapeRendering:"optimizespeed"}}},{metrics:null,markup:[{tagName:"rect",selector:"body"}],markupAttributes:["lanes","padding","milestones","headerSize","milestonesSize"],initialize:function(){Xt.prototype.initialize.apply(this,arguments),this.on("change",this.onChange,this),this.buildMarkup()},anyHasChanged:function(t){return Array.isArray(t)?t.some(function(e){return this.hasChanged(e)},this):!1},onChange:function(t,e){e.pool!==this.id&&this.hasChanged("markup")&&Cn("Markup cannot be modified."),this.anyHasChanged(this.markupAttributes)&&this.buildMarkup(e)},buildMarkup:function(t){const e=ke(this.markup);Array.isArray(e)||Cn("Expects Prototype JSON Markup.");const n=this.attributes.lanes||[{}];Array.isArray(n)||Cn("Expects lanes to be an array.");const i=this.attributes.milestones||[];Array.isArray(i)||Cn("Expects milestones to be an array.");const r=this.metrics={};r.lanes={},r.lanesNameCache={},r.milestonesNameCache={},r.milestones={},r.totalTakenHeightSpace=0,r.topLaneGroupsCount=n.length,r.padding=Ne(this.attributes.padding),this.buildLanesMarkupRecursively(n,e,null,1,0),this.buildMilestones(i,e);const s=U({pool:this.id,dry:!0},t);this.set("markup",e,s),s.autoResize!==!1&&this.autoresize(s)},buildLanesMarkupRecursively:function(t,e,n,i,r){Array.isArray(t)||Cn("Expects lanes to be an array.");let s=0;return t.forEach((o,a)=>{let l=0;const c=o.id!==void 0&&o.id!==""?o.id:null,h=n!==null?`${n}_${a}`:`${a}`,u=this.getLaneGroupMarkup(h,c);e.push(u);const d=Number.isFinite(o.size)?Math.max(o.size,0):void 0,f=this.getLaneMarkup(h,c);u.children.push(f);const p=o.label,g=typeof o.label=="string",v=g?Number.isFinite(o.headerSize)?Math.max(o.headerSize,0):this.attributes.headerSize:0;if(g){const C=this.getHeaderMarkup(h,c),P=this.getLabelMarkup(h,c);u.children.push(C),u.children.push(P)}o.sublanes&&!Array.isArray(o.sublanes)&&Cn("Expects sublanes to be an array.");const x=o.sublanes||[];if(x.length){const C=u.children,P=i+1;l=this.buildLanesMarkupRecursively(x,C,h,P,x.length)}l=d&&d>l?d:l,s+=l;const S={nestLevel:i,laneIndexWithinGroup:a,parentId:n?`lanes_${n}`:null,parentSublanesCount:r,headerSize:v,label:p,hasLabel:g,size:d,takenUpSpaceByLaneAndSublanes:l,sublanesCount:x.length,customId:c};this.addLaneGroupMetrics(h,S)}),s},buildMilestones:function(t,e){const{metrics:n,attributes:i}=this,r=n.padding;n.milestonesCount=t.length,r.top+=t.length?i.milestonesSize:0,t.forEach((s,o)=>{const a=s.id,l=`milestone_${o}`,c=n.milestonesNameCache[l]!==void 0;if(a){const p=a!==l&&n.milestones[a]!==void 0;(n.milestonesNameCache[a]!==void 0||p)&&Cn("Duplicated milestone group id: "+a),n.milestonesNameCache[a]=l}c&&Cn("Duplicated milestone group id: "+l);const h=this.getMilestoneGroupMarkup(o,a);e.push(h);const u=this.getMilestoneHeaderMarkup(o,a),d=this.getMilestoneLabelMarkup(o,a),f=this.getMilestoneLineMarkup(o,a);n.milestones[l]={label:typeof s.label=="string"?s.label:"",indexWithin:o,size:Number.isFinite(s.size)?Math.max(s.size,0):void 0,customId:a},h.children.push(f),h.children.push(u),h.children.push(d)})},addLaneGroupMetrics:function(t,e){const n=`lanes_${t}`,{laneSize:i,customId:r}=e,{metrics:s}=this;if(s.lanesNameCache[n]!==void 0&&Cn("Duplicated lane group id: "+n),r!==null){const a=r!==n&&s.lanes[r]!==void 0;(s.lanesNameCache[r]!==void 0||a)&&Cn("Duplicated lane group id: "+r),s.lanesNameCache[r]=n}s.lanes[n]=e,Number.isFinite(i)&&(s.totalTakenHeightSpace+=i)},autoresize:function(t){const e=this.getMinimalSize(),n=this.attributes.size;this.resize(Math.max(e.width,n.width),Math.max(e.height,n.height),t)},getMinimalSize:function(){const{metrics:t}=this,e=t.padding;let n,i,r=0,s=0,o=0;const a=this.attributes.milestonesSize,l=t.lanes,c=t.milestones;return Object.keys(l).forEach(h=>{const u=l[h];let d=h,f=0;for(;d;){const p=t.lanes[d];f+=p.headerSize||0,d=p.parentId}r=f>r?f:r,u.nestLevel===1&&(s+=u.takenUpSpaceByLaneAndSublanes||0)}),Object.keys(c).forEach(h=>{o+=c[h].size||0}),n=r>o?r:o,i=t.milestonesCount&&a>s?0:s,{height:i+e.top+e.bottom,width:n+e.left+e.right}},getLaneGroupMarkup:function(t,e){const n=["laneGroups"];return e&&n.push(`lanes_${e}`),{tagName:"g",selector:`lanes_${t}`,groupSelector:n,attributes:{laneGroupId:`lanes_${t}`},children:[]}},getMilestoneGroupMarkup:function(t,e){const n=["milestoneGroups"];return e&&n.push(`milestone_${e}`),{tagName:"g",selector:`milestone_${t}`,groupSelector:n,attributes:{milestoneGroupId:`milestone_${t}`},children:[]}},getLaneMarkup:function(t,e){const n=["lanes"];return e&&n.push(`lane_${e}`),{tagName:"rect",selector:`lane_${t}`,groupSelector:n,children:[],attributes:{laneGroupId:`lanes_${t}`}}},getHeaderMarkup:function(t,e){const n=["laneHeaders"];return e&&n.push(`header_${e}`),{tagName:"rect",selector:`header_${t}`,groupSelector:n,attributes:{laneGroupId:`lanes_${t}`}}},getLabelMarkup:function(t,e){const n=["laneLabels"];return e&&n.push(`label_${e}`),{tagName:"text",selector:`label_${t}`,groupSelector:n,attributes:{laneGroupId:`lanes_${t}`}}},getMilestoneHeaderMarkup:function(t,e){const n=["milestoneHeaders"];return e&&n.push(`milestoneHeader_${e}`),{tagName:"rect",selector:`milestoneHeader_${t}`,groupSelector:n,attributes:{milestoneGroupId:`milestone_${t}`}}},getMilestoneLabelMarkup:function(t,e){const n=["milestoneLabels"];return e&&n.push(`milestoneLabel_${e}`),{tagName:"text",selector:`milestoneLabel_${t}`,groupSelector:n,attributes:{milestoneGroupId:`milestone_${t}`}}},getMilestoneLineMarkup:function(t,e){const n=["milestoneLines"];return e&&n.push(`milestoneLine_${e}`),{tagName:"line",selector:`milestoneLine_${t}`,groupSelector:n,attributes:{milestoneGroupId:`milestone_${t}`}}},getParentIndexesArray:function(t){let e=[],n=t;for(;n;)e.push(n),n=this.metrics.lanes[n].parentId;return e.reverse()},getFlexAndFixedLaneSizesWithinGroup:function(t){const{metrics:e}=this,n=e.lanes[t];let i=n.parentId,r=0,s=0,o=n.parentSublanesCount-1;for(i||(i="lanes",o=e.topLaneGroupsCount-1);o>=0;){const a=`${i}_${o}`,l=e.lanes[a];Number.isFinite(l.size)?r+=Math.max(l.size,l.takenUpSpaceByLaneAndSublanes):s++,o--}return{totalFixedSize:r,flexLanesWithinGroupCount:s}},getLaneWidth:function(t){const{metrics:e}=this,n=e.padding,i=this.getParentIndexesArray(t),r=this.attributes.size.width-n.left-n.right;let s=0;return i.forEach(o=>{const a=e.lanes[o];s+=a.headerSize}),Math.max(r-s,0)},getLaneHeight:function(t){const{metrics:e}=this,n=e.lanes[t],i=e.padding;let r=this.getParentIndexesArray(t);const s=this.attributes.size.height-i.top-i.bottom,o=n.parentId;let a=s;if(o){const d=e.lanes[o].sublanesCount;if(n.laneIndexWithinGroup===d-1){const{y:g}=this.getLaneContainerPosition(t),v=this.getLaneHeight(o);return Math.max(v-g,0)}}if(Number.isFinite(n.size))if(!o&&n.laneIndexWithinGroup===e.topLaneGroupsCount-1){const{y:u}=this.getLaneContainerPosition(t);return Math.max(this.attributes.size.height-u-i.bottom,0)}else{const u=n.takenUpSpaceByLaneAndSublanes;return Math.max(u,n.size,0)}const l=r.map(u=>u).reverse().find(u=>e.lanes[u].size);if(l){let u=r.map(f=>f);const d=u.indexOf(l);r=u.slice(d+1),a=e.lanes[l].size}r.forEach(u=>{const d=this.getFlexAndFixedLaneSizesWithinGroup(u),p=e.lanes[u].parentId,g=e.lanes[u].parentSublanesCount,v=e.topLaneGroupsCount;let x=0,S=0,C=(a-d.totalFixedSize)/(d.flexLanesWithinGroupCount||1),P=p?g-1:v-1;for(;P>=0;){const O=`${p||"lanes"}_${P}`;if(O===t){P--;continue}const N=e.lanes[O],m=N.takenUpSpaceByLaneAndSublanes;!N.size&&m>C&&(x+=m,S++),P--}a-=d.totalFixedSize+x,a/=Math.max(d.flexLanesWithinGroupCount-S,1)});const c=n.takenUpSpaceByLaneAndSublanes,h=c>a?c:a;return Math.max(h,0)},getMilestoneWidth:function(t){const{metrics:e}=this,n=e.padding,i=this.attributes.size.width-n.left-n.right,r=e.milestones[t],s=e.milestonesCount;if(Number.isFinite(r.size))return r.size;let o=s-1,a=0,l=0;for(;o>=0;){const h=`milestone_${o}`,u=e.milestones[h];Number.isFinite(u.size)&&(a+=u.size,l++),o--}const c=(i-a)/(s-l||1);return Math.max(c,0)},getLaneContainerPosition:function(t){const{metrics:e}=this,n=e.padding,i=e.lanes[t],{laneIndexWithinGroup:r,nestLevel:s,parentId:o}=i;let l=o?e.lanes[o].headerSize:0,c=0;s===1&&(l+=n.left,c+=n.top);let h=0,u=r-1;for(;u>=0;){const d=o?`${o}_${u}`:`lanes_${u}`;h+=this.getLaneHeight(d),u--}return new L(l,c+h)},getMilestoneContainerPosition:function(t){const{metrics:e}=this,i=e.milestones[t].indexWithin,r=e.padding;let s=i-1,o=0;for(;s>=0;){const h=`milestone_${s}`,u=this.getMilestoneWidth(h);o+=u,s--}const a=this.attributes.milestonesSize,l=o+r.left,c=r.top-a;return new L(l,c)},getLaneBBox:function(t){typeof t!="string"&&Cn("Expects id to be a string");const{metrics:e}=this,n=this.position();let i=e.lanes[t];if(i||(t=e.lanesNameCache[t],i=e.lanes[t]),!i)return null;const r=i.parentId,s=i.headerSize;let o={x:0,y:0};if(r){const u=this.getLaneBBox(r);o.x+=u.x-n.x,o.y+=u.y-n.y}const{x:a,y:l}=this.getLaneContainerPosition(t),c=this.getLaneWidth(t),h=this.getLaneHeight(t);return new J({x:a+o.x+n.x,y:l+o.y+n.y,width:c+s,height:h})},getParentLaneId(t){const{lanes:e,lanesNameCache:n}=this.metrics,i=n.hasOwnProperty(t)?n[t]:t;i in e||Cn(`Lane with ID ${t} wasn't found`);const r=e[i];if(r.parentId===null)return null;const s=e[r.parentId];return s.customId!==null?s.customId:r.parentId},getLanesIds:function(){const{lanes:t}=this.metrics;return Object.keys(t).map(n=>{const{customId:i}=t[n];return i!==null?i:n})},getMilestoneBBox:function(t){typeof t!="string"&&Cn("Expects id to be a string");const{metrics:e,attributes:n}=this,i=e.padding,r=e.milestones;let s=r[t];if(s||(t=e.milestonesNameCache[t],s=r[t]),!s)return null;const o=this.position(),a=this.getMilestoneWidth(t),l=n.milestonesSize,c=n.size.height-i.bottom-i.top+l,{x:h,y:u}=this.getMilestoneContainerPosition(t);return new J(h+o.x,u+o.y,a,c)},getLanesFromPoint:function(t){t||Cn("A point is required");const e=this.getBBox(),n=e.center(),i=this.angle(),r=new L(t).rotate(n,i);if(!e.containsPoint(r))return[];const s=this.metrics,o=s.lanes,a=[],l=c=>{let h=c?o[c].sublanesCount-1:s.topLaneGroupsCount-1;for(;h>=0;){const u=c?`${c}_${h}`:`lanes_${h}`;if(this.getLaneBBox(u).containsPoint(r)){const f=o[u].customId;a.push(f||u),l(u);break}h--}};return l(),a.reverse()},getMilestoneFromPoint:function(t){t||Cn("A point is required");const e=this.metrics,n=this.getBBox(),i=this.angle(),r=new L(t).rotate(n.center(),i);if(!n.containsPoint(r))return null;let s=e.milestonesCount-1;for(;s>=0;){const o=`milestone_${s}`;if(this.getMilestoneBBox(o).containsPoint(r)){const l=e.milestones[o].customId;return l===void 0?o:l}s--}return null},getLanePath:function(t){const e=this.metrics,n=e.lanes;let i=n[t];if(i===void 0){const o=e.lanesNameCache[t];i=n[o]}if(i===void 0)return[];const r=[i.laneIndexWithinGroup];let s=i;for(;s.parentId;){const o=n[s.parentId].laneIndexWithinGroup;r.unshift(o,"sublanes"),s=n[s.parentId]}return r.unshift("lanes"),r},toJSON:function(){const t=Xt.prototype.toJSON.apply(this,arguments);return delete t.markup,t}},{attributes:{"lane-container-position":{position:function(t,e,n){const i=n.getAttribute("lane-group-id");return this.model.getLaneContainerPosition(i)}},"lane-size":{set:function(t,e,n){const{model:i}=this,r=n.getAttribute("lane-group-id"),s=i.getLaneWidth(r),o=i.getLaneHeight(r),a=i.metrics.lanes[r].headerSize;return{width:s+a,height:o}}},"header-size":{set:function(t,e,n){const i=n.getAttribute("lane-group-id"),s=this.model.metrics.lanes[i].headerSize,o=Math.max(this.model.getLaneHeight(i),0);return{width:s,height:o}}},"label-position":{position:function(t,e,n,i){const{model:r}=this,s=n.getAttribute("lane-group-id"),a=r.metrics.lanes[s].headerSize,l=r.getLaneHeight(s),{left:c,top:h,right:u,bottom:d}=Ne(i["label-margin"]),f=l/2,p=a/2;switch(i["label-alignment"]){case nn.topMiddle:return{x:h,y:f+c-u};case nn.topLeft:return{x:h,y:l-u};case nn.topRight:return{x:h,y:c};case nn.leftMiddle:return{x:p+h-d,y:l-u};case nn.rightMiddle:return{x:p+h-d,y:c};case nn.bottomLeft:return{x:a-d,y:l-u};case nn.bottomMiddle:return{x:a-d,y:f+c-u};case nn.bottomRight:return{x:a-d,y:c};case nn.center:default:return{x:p+h-d,y:f+c-u}}}},"lane-label":{set:function(t,e,n,i){if(!Ee(t))return null;const{model:r}=this,s=n.getAttribute("lane-group-id"),o=r.metrics.lanes[s],a=o.headerSize,l=r.getLaneHeight(s),c=o.label;return Om(this,t,n,i,l,a,c)}},"milestone-container-position":{position:function(t,e,n){const i=n.getAttribute("milestone-group-id");return this.model.getMilestoneContainerPosition(i)}},"milestone-header-size":{set:function(t,e,n){const{model:i}=this,r=n.getAttribute("milestone-group-id"),s=i.getMilestoneWidth(r),o=i.attributes.milestonesSize;return{width:s,height:o}}},"milestone-label-position":{position:function(t,e,n,i){const{model:r}=this,s=n.getAttribute("milestone-group-id"),o=r.getMilestoneWidth(s),a=r.attributes.milestonesSize,{left:l,top:c,right:h,bottom:u}=Ne(i["label-margin"]),d=a/2,f=o/2;switch(i["label-alignment"]){case nn.topMiddle:return{x:f+l-h,y:c};case nn.topLeft:return{x:l,y:c};case nn.topRight:return{x:o-h,y:c};case nn.leftMiddle:return{x:l,y:d+c-u};case nn.bottomLeft:return{x:l,y:a-u};case nn.bottomMiddle:return{x:f+l-h,y:a-u};case nn.bottomRight:return{x:o-h,y:a-u};case nn.rightMiddle:return{x:o-h,y:d+c-u};case nn.center:default:return{x:f+l-h,y:d+c-u}}}},"milestone-label":{set:function(t,e,n,i){if(!Ee(t))return null;const{model:r}=this,s=n.getAttribute("milestone-group-id"),o=r.metrics.milestones[s],a=r.getMilestoneWidth(s),l=r.attributes.milestonesSize,c=o.label;return Om(this,t,n,i,a,l,c)}},"milestone-line-position":{set:function(t,e,n){const{model:i}=this,r=i.position(),s=i.metrics.padding,o=i.attributes.milestonesSize,a=n.getAttribute("milestone-group-id"),{x:l,width:c,height:h}=i.getMilestoneBBox(a);let u="block";const d=e.width-s.right;return Math.ceil(l)-r.x+Math.ceil(c)>=d&&(u="none"),{x1:c,x2:c,y1:o,y2:h,display:u}}},"text-vertical":{set:function(){return{transform:"rotate(-90)"}}},"text-wrap":{set:function(t,e,n,i){if(i["text-vertical"]){const r=e.width;e.width=e.height,e.height=r}Po["text-wrap"].set.call(this,t,e,n,i)}},"label-margin":{},"label-alignment":{}}}),P5=np.define("bpmn2.HeaderedPool",{padding:{top:0,left:30,right:0,bottom:0},attrs:{header:{width:30,refHeight:"100%",stroke:"#333333",strokeWidth:2,fill:"#ffffff",shapeRendering:"optimizespeed"},headerLabel:{textVertical:!0,textWrap:{width:-10,ellipsis:!0,maxLineCount:1},refX:15,refY:"50%",fontSize:20,fill:"#333333",fontFamily:"sans-serif",textAnchor:"middle",textVerticalAnchor:"middle"}}},{markup:[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"header"},{tagName:"text",selector:"headerLabel"}]}),I5=np.prototype.markupAttributes.reduce(function(t,e){return t[e]=["UPDATE","TOOLS"],t},{}),tw=Te.extend({presentationAttributes:Te.addPresentationAttributes(I5)}),O5=tw;function Cn(t){throw new Error("shapes.bpmn2.Pool: "+t)}const du=Xt.define("bpmn2.Choregraphy",{type:"bpmn2.Choreography",size:{width:100,height:120},attrs:{root:{cursor:"move"},body:{width:"calc(w)",height:"calc(h)",strokeWidth:2,stroke:"#333333",fill:"#ffffff"},fo:{width:"calc(w)",height:"calc(h)"},participants:{participantY:!0},participantsBodies:{width:"calc(w)",height:20,strokeWidth:2,stroke:"#333333",fill:"#aaaaaa"},participantsLabels:{x:"calc(w / 2)",y:10,textAnchor:"middle",dominantBaseline:"central",fontSize:12,fontFamily:"sans-serif"},initiatingParticipantBody:{fill:"transparent"},content:{contentAlignment:!0,style:{textAlign:"center",verticalAlign:"middle",display:"table-cell",fontFamily:"sans-serif"},html:""},subProcess:{d:"M -8 -20 H 8 V -4 H -8 Z M -6 -12 H 6 M 0 -18 V -6",fill:"transparent",transform:"translate(calc(w / 2), 0)",subProcessY:!0,stroke:"#000000",strokeWidth:2}},subProcess:!1,participants:[],participantHeight:20,initiatingParticipant:0},{markup:[{tagName:"rect",selector:"body"},{tagName:"foreignObject",selector:"fo",children:[{tagName:"div",selector:"content",namespaceURI:"http://www.w3.org/1999/xhtml"}]},{tagName:"text",selector:"label"}],markupAttributes:["participants","initiatingParticipant","subProcess"],initialize:function(){Xt.prototype.initialize.apply(this,arguments),this.on("change",(t,e)=>this.onChange(e)),this.buildMarkup()},anyHasChanged:function(t){return Array.isArray(t)?t.some(function(e){return this.hasChanged(e)},this):!1},onChange:function(t){if(t.choreography!==this.id&&this.hasChanged("markup"))throw new Error("bpmn2.Choreography: Markup can not be modified.");this.anyHasChanged(this.markupAttributes)&&this.buildMarkup(t)},buildParticipantMarkup:function(t,e,n){const i={tagName:"g",groupSelector:"participants",attributes:{"participant-id":t}},r={tagName:"rect",groupSelector:"participantsBodies"},s={tagName:"text",groupSelector:"participantsLabels",textContent:e};return n&&(i.selector="initiatingParticipant",r.selector="initiatingParticipantBody",s.selector="initiatingParticipantLabel"),i.children=[r,s],i},buildSubProcessMarkup:function(){return{tagName:"path",selector:"subProcess"}},buildMarkup:function(t){const{initiatingParticipantIndex:e,participants:n}=this,i=n.map((o,a)=>{const l=a>e?-(n.length-a):a;return this.buildParticipantMarkup(l,o,a===e)}),r=this.markup.concat(...i);this.get("subProcess")&&r.push(this.buildSubProcessMarkup());const s=U({choreography:this.id,dry:!0},t);this.set("markup",r,s)}},{attributes:{"participant-y":{position(t,e,n){const{participantHeight:i}=this.model,r=parseInt(n.getAttribute("participant-id"),10);return{x:0,y:r<0?e.height+r*i:r*i}}},"sub-process-y":{position(t,e,n){const{participantHeight:i,participants:r,initiatingParticipantIndex:s}=this.model,o=i*(r.length-s-1);return{x:0,y:e.height-o}}},"content-alignment":{set(t,e,n){const{participantHeight:i,participants:r,initiatingParticipantIndex:s}=this.model,o=i*(s+1);n.style.paddingTop=`${o}px`,n.style.height=`${e.height-r.length*i}px`,n.style.width=`${e.width}px`}}}});Object.defineProperty(du.prototype,"participants",{get(){const t=this.get("participants");return Array.isArray(t)?t:[]}});Object.defineProperty(du.prototype,"initiatingParticipantIndex",{get(){const t=this.get("initiatingParticipant");return Number.isFinite(t)?t:this.participants.indexOf(t)}});Object.defineProperty(du.prototype,"participantHeight",{get(){const t=this.get("participantHeight");return Number.isFinite(t)?t:20}});const k5=Object.freeze(Object.defineProperty({__proto__:null,Activity:b5,Annotation:A5,AnnotationLink:C5,Choreography:du,Conversation:x5,ConversationLink:w5,DataAssociation:y5,DataObject:v5,DataStore:m5,Event:f5,Flow:E5,Gateway:g5,Group:T5,HeaderedPool:P5,HeaderedPoolView:O5,Pool:np,PoolView:tw},Symbol.toStringTag,{value:"Module"})),ah=q,L5=Xt.extend({useCSSSelectors:!0,markup:['<clipPath class="clip"><rect/></clipPath>','<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="axis">','<g class="y-axis"><path/><g class="ticks"></g></g>','<g class="x-axis"><path/><g class="ticks"></g></g>','<g class="markings"></g>',"</g>",'<g class="data"><g class="series"></g></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>','<line class="guideline x-guideline" /><line class="guideline y-guideline" />',"</g>","</g>"].join(""),tickMarkup:'<g class="tick"><line/><text/></g>',pointMarkup:'<g class="point"><circle/><text/></g>',barMarkup:'<path class="bar"/>',markingMarkup:'<g class="marking"><rect/><text/></g>',serieMarkup:'<g><clipPath class="serie-clip"><rect/></clipPath><path/><g class="bars"></g><g class="points"></g></g>',legendItemMarkup:'<g class="legend-item"><circle/><text/></g>',defaults:$i({type:"chart.Plot",attrs:{root:{cursor:"move"},".data path":{fill:"none",stroke:"black"},".data .bars rect":{fill:"none",stroke:"black"},".background rect":{fill:"white",stroke:"#e5e5e5",opacity:1},".background text":{fill:"black",text:"No data available.",ref:".","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":10,"text-anchor":"middle","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":.5,"ref-y":23,"text-anchor":"middle","y-alignment":"middle","font-size":10},".point":{display:"inline-block"},".point circle":{r:2,stroke:"black",fill:"black",opacity:.3},".point text":{fill:"black","font-size":8,"text-anchor":"middle",display:"none"},".axis path":{fill:"none",stroke:"black"},".axis .tick":{fill:"none",stroke:"black"},".y-axis .tick line":{fill:"none",stroke:"black",x2:2,y2:0,opacity:1},".x-axis .tick line":{fill:"none",stroke:"black",x2:0,y2:-3,opacity:1},".y-axis .tick text":{fill:"black",stroke:"none","font-size":10,"text-anchor":"end"},".x-axis .tick text":{fill:"black",stroke:"none","font-size":10,"text-anchor":"middle"},".y-axis .tick text > tspan":{dy:"-.5em",x:-5},".x-axis .tick text > tspan":{dy:".5em",x:0},".axis .markings":{fill:"black",stroke:"none","fill-opacity":1},".axis .markings text":{fill:"black","text-anchor":"end","font-size":10,dy:-5,dx:-5},".guideline":{"pointer-events":"none",display:"none"},".x-guideline":{stroke:"black",visibility:"hidden"},".y-guideline":{stroke:"black",visibility:"hidden"},".legend":{"ref-x":10,"ref-y":10},".legend-item text":{fill:"black",transform:"translate(14, 0)","font-size":11},".legend-item circle":{r:5,transform:"translate(5,5)"},".legend-item":{cursor:"pointer"},".legend-item.disabled circle":{fill:"gray"},".legend-item.disabled text":{opacity:.5}}},Xt.prototype.defaults),legendPosition:function(t,e){e=e||{},this.trigger("batch:start"),[".legend/ref-x",".legend/ref-y",".legend/ref-dx",".legend/ref-dy",".legend/x-alignment",".legend/y-alignment"].forEach(function(r){this.removeAttr(r,{silent:!0})},this);var n=e.padding||10,i={n:{".legend":{"ref-x":.5,"x-alignment":-.5,"ref-y":n}},ne:{".legend":{"ref-dx":-n,"x-alignment":-.999,"ref-y":n}},e:{".legend":{"ref-dx":-n,"x-alignment":-.999,"ref-y":.5,"y-alignment":-.5}},se:{".legend":{"ref-dx":-n,"ref-dy":-n,"x-alignment":-.999,"y-alignment":-.999}},s:{".legend":{"ref-x":.5,"ref-dy":-n,"x-alignment":-.5,"y-alignment":-.999}},sw:{".legend":{"ref-x":n,"ref-dy":-n,"y-alignment":-.999}},w:{".legend":{"ref-x":n,"ref-y":.5,"y-alignment":-.5}},nw:{".legend":{"ref-x":n,"ref-y":n}},nnw:{".legend":{"ref-x":n,"ref-y":-n,"y-alignment":-.999}},nn:{".legend":{"ref-x":.5,"ref-y":-n,"x-alignment":-.5,"y-alignment":-.999}},nne:{".legend":{"ref-dx":-n,"ref-y":-n,"x-alignment":-.999,"y-alignment":-.999}},nnee:{".legend":{"ref-dx":n,"ref-y":-n,"y-alignment":-.999}},nee:{".legend":{"ref-y":n,"ref-dx":n}},ee:{".legend":{"ref-dx":n,"ref-y":.5,"y-alignment":-.5}},see:{".legend":{"ref-dx":n,"ref-dy":-n,"y-alignment":-.999}},ssee:{".legend":{"ref-dx":n,"ref-dy":n}},sse:{".legend":{"ref-dx":-n,"ref-dy":n,"x-alignment":-.999}},ss:{".legend":{"ref-x":.5,"ref-dy":n,"x-alignment":-.5}},ssw:{".legend":{"ref-x":n,"ref-dy":n}},ssww:{".legend":{"ref-x":-n,"ref-dy":n,"x-alignment":-.999}},sww:{".legend":{"ref-x":-n,"ref-dy":-n,"x-alignment":-.999,"y-alignment":-.999}},ww:{".legend":{"ref-x":-n,"ref-y":.5,"x-alignment":-.999,"y-alignment":-.5}},nww:{".legend":{"ref-x":-n,"ref-y":n,"x-alignment":-.999}},nnww:{".legend":{"ref-x":-n,"ref-y":-n,"x-alignment":-.999,"y-alignment":-.999}}};i[t]&&this.attr(i[t]),this.trigger("batch:stop")},addPoint:function(t,e,n){n=n||{};var i=this.get("series"),r=ft(i).findIndex(function(o){return o.name===e});if(r===-1)throw new Error("Serie "+e+" was not found.");var s=ke(i[r]);s.data.push(t),Number.isFinite(n.maxLen)&&s.data.length>n.maxLen&&s.data.shift(),i=i.slice(),i[r]=s,this.set("series",i,n)},lastPoint:function(t){var e=ft(this.get("series")).find(function(n){return n&&n.name===t}).data;return e[e.length-1]},firstPoint:function(t){return ft(this.get("series")).find(function(e){return e&&e.name===t}).data[0]}}),M5=Te.extend({events:{mousemove:"onMouseMove",mouseout:"onMouseOut"},presentationAttributes:Te.addPresentationAttributes({series:["UPDATE"],interpolate:["UPDATE"],padding:["UPDATE"],canvas:["UPDATE"],markings:["UPDATE"],axis:["UPDATE"]}),initialize:function(){Te.prototype.initialize.apply(this,arguments),this.on("cell:pointerdown",this.onPointerDown,this),this._disabledSeries=[]},renderMarkup:function(){Te.prototype.renderMarkup.apply(this,arguments),this.elDataClipPath=this.$(".clip")[0],this.elDataClipPathRect=this.elDataClipPath.firstChild,this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForeground=this.$(".foreground")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elDataSeries=this.$(".data .series")[0],this.elYAxisPath=this.$(".y-axis path")[0],this.elYAxisTicks=this.$(".y-axis .ticks")[0],this.elXAxisPath=this.$(".x-axis path")[0],this.elXAxisTicks=this.$(".x-axis .ticks")[0],this.elMarkings=this.$(".axis .markings")[0],this.elXGuideline=this.$(".x-guideline")[0],this.elYGuideline=this.$(".y-guideline")[0],this.elLegend=this.$(".legend")[0],this.elLegendItems=this.$(".legend-items")[0],this.elTick=k(this.model.tickMarkup),this.elMarking=k(this.model.markingMarkup),this.elLegendItem=k(this.model.legendItemMarkup),this.elPoint=k(this.model.pointMarkup),this.elBar=k(this.model.barMarkup),this.elSerie=k(this.model.serieMarkup),this.elDataClipPath.id="clip_"+this.cid,k(this.$(".data")[0]).attr("clip-path","url(#"+this.elDataClipPath.id+")"),k(this.elMarkings).attr("clip-path","url(#"+this.elDataClipPath.id+")")},update:function(){var t=this.filterSeries();this.calculateStats(t);var e=this.model.get("size"),n=e.width,i=e.height;this.canvas=U({x:0,y:0,width:n,height:i},this.model.get("canvas"));var r,s={top:0,right:0,bottom:0,left:0},o=this.model.get("padding");Nt(o)?r=U({},s,o):o!==void 0?r={top:o,right:2*o,bottom:2*o,left:o}:r=s,this.canvas=Ji(this.canvas).moveAndExpand(Ji(r.left,r.top,-r.right,-r.bottom));var a={x:0,y:0,width:n,height:i};k(this.elDataClipPathRect).attr(a),k(this.elBackgroundRect).attr(a),k(this.elForegroundRect).attr(a),this.updateAxis(),this.updateMarkings(),this.isEmpty()?this.elBackgroundText.style.display="block":this.elBackgroundText.style.display="none",this.updateSeries(t),this.updateLegend(),Te.prototype.update.apply(this,arguments)},calculateStats:function(t){t=t||this.model.get("series");var e=[],n=[],i={},r={},s={};ft(t).forEach(function(c,h){var u=s[c.name||h]||(s[c.name||h]={});u.decreasingX=!0,u.decreasingY=!0,u.nonDecreasingX=!0,u.nonDecreasingY=!0;var d;Kt(c.data,function(f){u.minX=u.minX===void 0?f.x:Math.min(u.minX,f.x),u.maxX=u.maxX===void 0?f.x:Math.max(u.maxX,f.x),u.minY=u.minY===void 0?f.y:Math.min(u.minY,f.y),u.maxY=u.maxY===void 0?f.y:Math.max(u.maxY,f.y),d&&(u.decreasingX=u.decreasingX&&f.x<d.x,u.decreasingY=u.decreasingY&&f.y<d.y,u.nonDecreasingX=u.nonDecreasingX&&f.x>=d.x,u.nonDecreasingY=u.nonDecreasingY&&f.y>=d.y),e.includes(f.x)||e.push(f.x),n.includes(f.y)||n.push(f.y),(i[f.x]||(i[f.x]=[])).push({serie:c,x:f.x,y:f.y}),(r[f.y]||(r[f.y]=[])).push({serie:c,x:f.x,y:f.y}),d=f})});var o=this.model.get("axis")||{},a=o["x-axis"]||{},l=o["y-axis"]||{};this.stats={minX:a.min===void 0?e.reduce(function(c,h){return h<c?h:c},1/0):a.min,maxX:a.max===void 0?e.reduce(function(c,h){return h>c?h:c},-1/0):a.max,minY:l.min===void 0?n.reduce(function(c,h){return h<c?h:c},1/0):l.min,maxY:l.max===void 0?n.reduce(function(c,h){return h>c?h:c},-1/0):l.max,bySerie:s,xValues:e,yValues:n,xMap:i,yMap:r}},isEmpty:function(){return!this.stats.xValues.length},updateSeries:function(t){if(t=t||this.model.get("series"),this.elDataSeries.textContent="",!this.isEmpty()){var e=[this.stats.minX,this.stats.maxX],n=[this.stats.minY,this.stats.maxY],i=[this.canvas.x,this.canvas.x+this.canvas.width],r=[this.canvas.y+this.canvas.height,this.canvas.y],s=this.model.get("attrs");ft(t).forEach(function(o,a){var l=o.data,c=[],h=this.elSerie.clone().attr("class",o.name||"serie-"+a);k(this.elDataSeries).append(h),Kt(l,(function(S){var C=qe.linear(e,i,S.x),P=qe.linear(n,r,S.y);c.push({x:C,y:P}),s[".point"]&&s[".point"].display!=="none"&&this.renderPoint(S,o),o.bars&&this.renderBar(S,o)}).bind(this));var u=h.findOne(".serie-clip"),d=this.model.get("size"),f=this.stats.bySerie[o.name||a],p=qe.linear(e,i,f.minX),g=qe.linear(e,i,f.maxX),v=u.findOne("rect");if(v.attr(Ji(p,0,g-p,d.height)),!o.bars){var x=h.findOne("path");x.attr({d:this.seriePathData(c,o,a),"clip-path":"url(#"+u.node.id+")"})}},this)}},seriePathClipData:function(t,e){var n=10,i=this.model.get("size"),r=t[0],s=["M",r.x,r.y,"V",i.height+n];return s.join(" ")},renderBar:function(t,e){var n=[this.stats.minX,this.stats.maxX],i=[this.stats.minY,this.stats.maxY],r=[this.canvas.x,this.canvas.x+this.canvas.width],s=[this.canvas.y+this.canvas.height,this.canvas.y],o=qe.linear(n,r,t.x),a=qe.linear(i,s,t.y),l=e.bars.barWidth||.8,c=l>1?l:this.canvas.width/(this.stats.maxX-this.stats.minX)*l,h=qe.linear(i,s,0)-a;i[0]===i[1]&&(a=this.canvas.y+this.canvas.height,h=0);var u=t["top-rx"]||e.bars["top-rx"],d=t["top-ry"]||e.bars["top-ry"],f=t["bottom-rx"]||e.bars["bottom-rx"],p=t["bottom-ry"]||e.bars["bottom-ry"],g={left:o,middle:o-c/2,right:o-c}[e.bars.align||"middle"],v=this.elBar.clone();v.attr({"data-serie":e.name,"data-x":t.x,"data-y":t.y,d:k.rectToPath({x:g,y:a,width:c,height:h,"top-rx":u,"top-ry":d,"bottom-rx":f,"bottom-ry":p})});var x=e.name||"serie-"+this.model.get("series").indexOf(e);return k(this.elDataSeries).findOne("."+x+" .bars").append(v),v.node},renderPoint:function(t,e){var n=[this.stats.minX,this.stats.maxX],i=[this.stats.minY,this.stats.maxY],r=[this.canvas.x,this.canvas.x+this.canvas.width],s=[this.canvas.y+this.canvas.height,this.canvas.y],o=qe.linear(n,r,t.x),a=qe.linear(i,s,t.y);i[0]===i[1]&&(a=this.canvas.y+this.canvas.height);var l=this.elPoint.clone();l.attr({"data-serie":e.name,"data-x":t.x,"data-y":t.y}),l.findOne("circle").attr({cx:o,cy:a}),l.findOne("text").attr({x:o,dy:a}).text(this.pointLabel(t,e));var c=e.name||"serie-"+this.model.get("series").indexOf(e);return k(this.elDataSeries).findOne("."+c+" .points").append(l),l.node},seriePathData:function(t,e,n){var i,r=t.length,s=[this.stats.minY,this.stats.maxY];if(s[0]===s[1])for(i=0;i<r;i++)t[i].y=this.canvas.y+this.canvas.height;var o,a=e.interpolate===void 0?this.model.get("interpolate"):e.interpolate;switch(a){case"bezier":o=new K(oe.throughPoints(t));break;case"step":for(o=new K,o.appendSegment(K.createSegment("M",t[0].x,t[0].y)),i=1;i<r;i++)o.appendSegment(K.createSegment("L",(t[i-1].x+t[i].x)/2,t[i-1].y)),o.appendSegment(K.createSegment("L",(t[i-1].x+t[i].x)/2,t[i].y));o.appendSegment(K.createSegment("L",t[r-1].x,t[r-1].y));break;case"stepBefore":for(o=new K,o.appendSegment(K.createSegment("M",t[0].x,t[0].y)),i=1;i<r;i++)o.appendSegment(K.createSegment("L",t[i-1].x,t[i].y)),o.appendSegment(K.createSegment("L",t[i].x,t[i].y));break;case"stepAfter":for(o=new K,o.appendSegment(K.createSegment("M",t[0].x,t[0].y)),i=1;i<r;i++)o.appendSegment(K.createSegment("L",t[i].x,t[i-1].y)),o.appendSegment(K.createSegment("L",t[i].x,t[i].y));break;default:for(o=new K,o.appendSegment(K.createSegment("M",t[0].x,t[0].y)),i=1;i<r;i++)o.appendSegment(K.createSegment("L",t[i].x,t[i].y));break}return this.fixPathForFill(o,t,e,n).serialize()},fixPathForFill:function(t,e,n,i){if(e.length===0||n.hideFillBoundaries)return t;var r=this.stats.bySerie[n.name||i];if(!r.nonDecreasingX)return t;var s=t.getSegment(0);t.replaceSegment(0,K.createSegment("L",s.end.x,s.end.y));var o=n.fillPadding&&n.fillPadding.left||0,a=n.fillPadding&&n.fillPadding.right||0,l=n.fillPadding&&n.fillPadding.bottom||10,c=this.model.get("size"),h=e[0],u=e[e.length-1];return t.insertSegment(0,K.createSegment("M",u.x+a,c.height+l)),t.insertSegment(1,K.createSegment("L",h.x-o,c.height+l)),t.insertSegment(2,K.createSegment("L",h.x-o,h.y)),n.showRightFillBoundary&&(t.appendSegment(K.createSegment("L",u.x+a,u.y)),t.appendSegment(K.createSegment("Z"))),t},updateAxis:function(){var t=this.model.get("axis"),e=this.model.get("size"),n=e.height,i=e.width;if(k(this.elXAxisPath).attr("d",["M",0,n,"L",i,n].join(" ")),k(this.elYAxisPath).attr("d",["M",0,0,"L",0,n].join(" ")),this.elXAxisTicks.textContent="",this.elYAxisTicks.textContent="",this.isEmpty())return;var r=[this.stats.minX,this.stats.maxX],s=[this.stats.minY,this.stats.maxY],o=[this.canvas.x,this.canvas.x+this.canvas.width],a=[0,this.canvas.height],l=t&&t["y-axis"]||{},c=t&&t["x-axis"]||{};h.call(this,c,e,r,o),u.call(this,l,e,s,a);function h(g,v,x,S){var C=function(b,w,A){b.translate(w,A.height),k(this.elXAxisTicks).append(b)},P=function(b,w,A){return qe.linear(b,w,A)},O=function(b){return b};if(!g.ticks){var N=this.stats.xValues;d.call(this,g,v,x,S,P,C,O,N);return}var m=this.canvas.width/(v.width-2*this.canvas.x);f.call(this,g,v,x,S,P,C,O,m)}function u(g,v,x,S){var C=function(m,b){m.translate(0,b),k(this.elYAxisTicks).append(m)},P=function(m,b,w){return m[0]===m[1]?this.canvas.y+this.canvas.height:qe.linear(m,b,w)},O=function(m,b,w){var A=b[1]-(m-b[0]);return A+=qe.linear(w,b,this.canvas.y)-b[0],A},N=this.canvas.height/v.height;f.call(this,g,v,x,S,P,C,O,N)}function d(g,v,x,S,C,P,O,N){N.forEach(function(m,b){b%(g.tickStep||1)===0&&p.call(this,g,v,x,S,C,P,O,m)},this)}function f(g,v,x,S,C,P,O,N){var m=x[1]-x[0],b=g.ticks||11;m===0&&(b=1);for(var w=m/b/N,A=x[0],E=0;E<b;E++)p.call(this,g,v,x,S,C,P,O,A),A+=w}function p(g,v,x,S,C,P,O,N){var m=this.elTick.clone(),b=C.call(this,x,S,N);if(!(b>v.width)){P.call(this,m,b,v);var w=O.call(this,N,x,S);m.findOne("text").text(this.tickLabel(w,g))}}},tickLabel:function(t,e){if(xt(e.tickFormat))return e.tickFormat(t);var n=e.tickFormat||".1f",i=ba.number(n,t);return i+(xt(e.tickSuffix)?e.tickSuffix(t):e.tickSuffix||"")},pointLabel:function(t,e){if(xt(e.pointFormat))return e.pointFormat(t);var n=e.pointFormat||".1f",i=ba.number(n,t.y);return i+(e.pointSuffix||"")},updateMarkings:function(){this.elMarkings.textContent="";var t=this.model.get("markings");if(!t||t.length===0)return;var e=this.model.get("size"),n=e.width,i=e.height,r=[this.stats.minX,this.stats.maxX],s=[this.stats.minY,this.stats.maxY],o=[this.canvas.x,this.canvas.x+this.canvas.width],a=[this.canvas.y,this.canvas.y+this.canvas.height];function l(c,h){return c===void 0?h:c}ft(t).forEach(function(c,h){var u=c.start||c.end,d=c.end||c.start,f=Math.min(l(u.x,this.stats.minX),l(d.x,this.stats.minX)),p=Math.max(l(u.x,this.stats.maxX),l(d.x,this.stats.maxX)),g=Math.min(l(u.y,this.stats.minY),l(d.y,this.stats.minY)),v=Math.max(l(u.y,this.stats.maxY),l(d.y,this.stats.maxY)),x=u.x===void 0||d.x===void 0,S=u.y===void 0||d.y===void 0;x&&(o=[0,n]),S&&(a=[0,i]);var C=qe.linear(r,o,f),P=qe.linear(r,o,p),O=qe.linear(s,a,g),N=qe.linear(s,a,v),m=C,b=a[1]-N+a[0],w=P-C,A=N-O;if(s[0]===s[1]&&g===v){if(s[0]!==g)return;b=this.canvas.y+this.canvas.height,A=1}w=Math.max(w,1),A=Math.max(A,1);var E=this.elMarking.clone();E.findOne("rect").attr({x:m,y:b,width:w,height:A}),E.findOne("text").text(c.label||"").attr({x:m+w,y:b});var M=E.attr("class")+" "+(c.name||"marking-"+h);E.attr(U({class:M},c.attrs)),k(this.elMarkings).append(E)},this)},updateLegend:function(){var t=this.model.get("series");this.elLegendItems.textContent="",ft(t).forEach(function(e,n){if(!(xt(e.showLegend)&&!e.showLegend(e,this.stats.bySerie[e.name||n]))&&e.showLegend!==!1){var i=this.elLegendItem.clone();this._disabledSeries.includes(e.name)&&i.addClass("disabled"),i.attr("data-serie",e.name),i.findOne("circle").attr({fill:this.getSerieColor(e.name)}),i.findOne("text").text(e.label||e.name),i.translate(0,n*(e.legendLabelLineHeight||16)),k(this.elLegendItems).append(i)}},this)},getSerieColor:function(t){var e=this.model.get("attrs"),n=Object.keys(e).find(function(i){return i.includes(t)});return n?e[n].stroke||e[n].fill:"black"},hideSerie:function(t){this._disabledSeries.includes(t)||this._disabledSeries.push(t);var e=this.filterSeries();this.update(e)},showSerie:function(t){this._disabledSeries=io(this._disabledSeries,t);var e=this.filterSeries();this.update(e)},filterSeries:function(t){return t=t||this.model.get("series"),t=ft(t).filter(function(e){return!this._disabledSeries.includes(e.name)},this),t},onPointerDown:function(t,e,n){var i=t.target.closest(".legend-item");i&&(k(i).toggleClass("disabled"),k(i).hasClass("disabled")?this.hideSerie(k(i).attr("data-serie")):this.showSerie(k(i).attr("data-serie")))},onMouseMove:function(t){this.showGuidelines(t.clientX,t.clientY,t)},onMouseOut:function(t){this.hideGuidelines(),this.trigger("mouseout",t)},showGuidelines:function(t,e,n){var i=this.model.get("angle"),r=this.model.getBBox(),s=new L(k(this.paper.layers).toLocalPoint(t,e)).rotate(r.center(),i);if(Ji(r).containsPoint(s)){var o=this.model.get("size"),a=s.x-r.x,l=s.y-r.y;k(this.elXGuideline).attr({x1:a,y1:0,x2:a,y2:o.height,visibility:"visible"}),k(this.elYGuideline).attr({x1:0,y1:l,x2:o.width,y2:l,visibility:"visible"});var c=qe.linear([this.canvas.x,this.canvas.x+this.canvas.width],[this.stats.minX,this.stats.maxX],a),h=qe.linear([this.canvas.y,this.canvas.y+this.canvas.height],[this.stats.minY,this.stats.maxY],l),u={x:c,y:this.stats.minY+this.stats.maxY-h},d={x:t,y:e},f=this.closestPoints(c);this.trigger("mouseover",u,d,f,n)}},closestPoints:function(t){var e=ou(this.stats.xValues,t),n=this.stats.xValues[e],i=this.stats.xValues[e-1],r=i===void 0||Math.abs(t-n)<Math.abs(t-i)?n:i;return this.stats.xMap[r]},hideGuidelines:function(){k(this.elXGuideline).attr("visibility","hidden"),k(this.elYGuideline).attr("visibility","hidden")}}),Yl=Xt.extend({useCSSSelectors:!0,markup:['<g class="rotatable">','<g class="scalable"></g>','<g class="background"><rect/><text/></g>','<g class="data"></g>','<g class="foreground">','<rect/><text class="caption"/><text class="subcaption"/>','<g class="legend"><g class="legend-items"></g></g>',"</g>","</g>"].join(""),sliceMarkup:'<g class="slice"/>',sliceFillMarkup:'<path class="slice-fill"/>',sliceBorderMarkup:'<path class="slice-border"/>',sliceInnerLabelMarkup:'<text class="slice-inner-label"/>',legendSerieMarkup:'<g class="legend-serie"><text/></g>',legendSliceMarkup:'<g class="legend-slice"><circle/><text/></g>',defaults:$i({type:"chart.Pie",size:{width:200,height:200},pieHole:0,serieDefaults:{startAngle:0,degree:360,label:null,showLegend:!0,labelLineHeight:6},sliceDefaults:{innerLabel:"{percentage:.0f}%",innerLabelMargin:6,legendLabel:"{label}: {value}",legendLabelLineHeight:6,legendLabelMargin:14,offset:0,onClickEffect:{type:"offset",offset:20},onHoverEffect:null},series:[],attrs:{root:{cursor:"move"},".background > rect":{opacity:0},".background > text":{fill:"black",text:"No data available.",ref:".background > rect","ref-x":.5,"ref-y":.5,"text-anchor":"middle","y-alignment":"middle",display:"none"},".foreground > rect":{fill:"white",stroke:"#e5e5e5",opacity:0,"pointer-events":"none"},".foreground .caption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":6,"text-anchor":"start","y-alignment":"middle","font-size":14},".foreground .subcaption":{fill:"black",text:"",ref:".foreground > rect","ref-x":2,"ref-y":18,"text-anchor":"start","y-alignment":"middle","font-size":10},".data":{ref:".background","ref-x":.5,"ref-y":.5},".slice":{cursor:"pointer"},".slice > .slice-fill":{stroke:"#ffffff","stroke-width":1,"fill-opacity":1},".slice.hover > .slice-fill":{"fill-opacity":.8},".slice > .slice-border":{"stroke-width":6,"stroke-opacity":.4,"fill-opacity":1,fill:"none",display:"none"},".slice.hover > .slice-border":{display:"block"},".slice > .slice-inner-label":{"text-anchor":"middle","font-size":"12",stroke:"none","stroke-width":"0",fill:"#ffffff"},".slice > .slice-inner-label > tspan":{dy:"-.5em"},".legend":{"ref-dx":20,"ref-y":5},".legend-serie text":{fill:"grey",transform:"translate(2, 0)","font-size":13},".legend-slice":{cursor:"pointer"},".legend-slice text":{"font-weight":"normal",fill:"black","font-size":11},".legend-slice.hover text":{"font-weight":"bold"},".legend-slice circle":{r:5,transform:"translate(5,5)"}}},Xt.prototype.defaults),addSlice:function(t,e,n){n=n||{},e=e||0;var i=this.get("series");i[e]===void 0&&(i[e]={data:[]});var r=ke(i[e]);r.data.push(t),i=i.slice(),i[e]=r,n=r.data.length>1?U(n,{changedSerieIndex:e}):n,this.set("series",i,n)},editSlice:function(t,e,n,i){i=i||{},n=n||0;var r=this.get("series");if(r[n]===void 0||r[n].data[e]===void 0)throw new Error("Slice "+e+" on serie "+n+" was not found.");var s=ke(r[n]);s.data[e]=U(s.data[e],t),r=r.slice(),r[n]=s,this.set("series",r,U(i,{changedSerieIndex:n}))}}),ew=Te.extend({events:{"mouseover .slice":"onMouseOverSlice","mouseout .slice":"onMouseOverSlice","mousemove .slice":"onMouseMoveSlice","mouseover .legend-slice":"onEventLegendItem","mouseout .legend-slice":"onEventLegendItem"},presentationAttributes:Te.addPresentationAttributes({series:["UPDATE"],serieDefaults:["UPDATE"],sliceDefaults:["UPDATE"],pieHole:["UPDATE"]}),initialize:function(){Te.prototype.initialize.apply(this,arguments),this.on("cell:pointerclick",this.onClickSlice,this),this.on("cell:pointerclick",this.onEventLegendItem,this)},renderMarkup:function(){Te.prototype.renderMarkup.apply(this,arguments),this.elBackgroundRect=this.$(".background rect")[0],this.elBackgroundText=this.$(".background text")[0],this.elForegroundRect=this.$(".foreground rect")[0],this.elLegendItems=this.$(".legend-items")[0],this.elPie=this.$(".data")[0],this.elSlice=k(this.model.sliceMarkup),this.elSliceFill=k(this.model.sliceFillMarkup),this.elSliceBorder=k(this.model.sliceBorderMarkup),this.elSliceInnerLabel=k(this.model.sliceInnerLabelMarkup),this.elLegendSerie=k(this.model.legendSerieMarkup),this.elLegendSlice=k(this.model.legendSliceMarkup)},update:function(t,e,n){n=n||{};var i=n.changedSerieIndex,r=this.calculateSeries(i);i in r?ah(this.elPie).find(".serie-"+i).remove():ah(this.elPie).empty();var s=this.model.get("size");k(this.elBackgroundRect).attr(s),k(this.elForegroundRect).attr(s),r.length?this.elBackgroundText.style.display="none":this.elBackgroundText.style.display="block",ft(r).forEach(function(o,a){i!==void 0&&i!==a||Kt(o.data,this.updateSlice.bind(this))},this),this.updateLegend(),Te.prototype.update.apply(this,arguments)},calculateSeries:function(t){var e=ke(this.model.get("series")),n=this.model.get("serieDefaults"),i=this.model.get("sliceDefaults"),r=this.model.get("size"),s=Math.min(r.width,r.height)/2,o=this.model.get("pieHole");o=o>1?o:s*o;var a=s,l=(s-o)/e.length;return this._series=e.map(function(c,h){if(t!==void 0&&t!==h)return c;c=me(c,n);var u=c.startAngle,d=c.data.reduce(function(g,v){return g+v.value},0),f=c.degree/d||0,p=100/d;return c.data=c.data.map(function(g,v){g=me(g,Ze(i,"offset","onClickEffect","onHoverEffect")),g.outerRadius=a,g.innerRadius=a-l,h||(g=me(g,uc(i,"offset","onClickEffect","onHoverEffect")),g.isOuter=!0,g.offset=g.offset>1?g.offset:g.offset*g.outerRadius,g.onClickEffect.offset=g.onClickEffect.offset>1?g.onClickEffect.offset:g.onClickEffect.offset*g.outerRadius),g.serieIndex=h,g.sliceIndex=v,g.innerLabelMargin=g.innerLabelMargin<-1||g.innerLabelMargin>1?g.innerLabelMargin:g.innerLabelMargin*g.outerRadius,g.percentage=g.value*p;var x=g.value*f;return g.degree={angle:x,start:u,end:x+u},g.rad={angle:an(g.degree.angle,!0),start:an(g.degree.start,!0),end:an(g.degree.end,!0)},g.middleangle=(g.rad.start+g.rad.end)/2,u=g.degree.end,g}),a-=l,c}),this._series},updateLegend:function(){var t=this._series;this.elLegendItems.textContent="";var e=0,n=parseInt(this.model.attr(".legend-serie text/font-size"),10),i=parseInt(this.model.attr(".legend-slice text/font-size"),10);ft(t).forEach(function(r,s){if(r.showLegend){if(r.label){var o=this.elLegendSerie.clone();r.name&&o.addClass(r.name),o.attr({"data-serie":s}),o.findOne("text").text(r.label),o.translate(0,e),k(this.elLegendItems).append(o),e+=n+r.labelLineHeight}Kt(r.data,(function(a,l){var c=this.elLegendSlice.clone(),h=this.getSliceFillColor(l,s);a.name&&c.addClass(a.name),c.attr({"data-serie":s,"data-slice":l}),c.findOne("text").text(ba.string(a.legendLabel,a)),c.findOne("text").translate(a.legendLabelMargin),c.translate(0,e),e+=i+a.legendLabelLineHeight,Nt(h)?this.applyGradient(c.node.querySelector("circle"),"fill",h):c.findOne("circle").attr({fill:h}),k(this.elLegendItems).append(c)}).bind(this))}},this)},applyGradient:function(t,e,n){var i=te(t)?this.findNodes(t):ah(t).toArray(),r=this.paper.defineGradient(n);i.forEach(function(s){k(s).attr(e,"url(#"+r+")")})},updateSlice:function(t){var e=this.elSlice.clone();k(this.elPie).append(e);var n=this.elSliceFill.clone(),i=this.getSliceFillColor(t.sliceIndex,t.serieIndex);n.attr({fill:i,d:k.createSlicePathData(t.innerRadius,t.outerRadius,t.rad.start,t.rad.end)}),e.append(n),Nt(i)&&this.applyGradient("#"+n.attr("id"),"fill",i);var r=this.elSliceBorder.clone(),s=parseInt(this.model.attr(".slice > .slice-border/stroke-width"),10),o=re.fromPolar(t.outerRadius+s/2,-t.rad.start,re(0,0)),a=re.fromPolar(t.outerRadius+s/2,-t.rad.end,re(0,0));r.attr({stroke:i,d:this.drawArc(o,a,t.outerRadius+s/2,t.rad.start,t.rad.end)}),e.append(r),Nt(i)&&this.applyGradient("#"+r.attr("id"),"stroke",i);var l=this.elSliceInnerLabel.clone();l.text(ba.string(t.innerLabel,t)),e.append(l);var c=l.bbox(),h=t.outerRadius-c.width/2-t.innerLabelMargin;l.translate(h*Math.cos(-t.middleangle),-h*Math.sin(-t.middleangle)),e.attr({"data-serie":t.serieIndex,"data-slice":t.sliceIndex,"data-value":t.value});var u=this._series[t.serieIndex].name;return u&&e.addClass(u),t.name&&e.addClass(t.name),e.addClass("serie-"+t.serieIndex+" slice-"+t.sliceIndex),t.isOuter&&(e.addClass("outer"),t.offset&&(e.addClass("clicked"),this.effectOnSlice(e,t,{type:"offset",offset:t.offset}))),e},getSliceFillColor:function(t,e){e=e||0;var n=this.model.get("attrs"),i=Object.keys(n).find(function(r){return r.indexOf(".serie-"+e+".slice-"+t+" > .slice-fill")>-1});return i?n[i].fill:this._series[e].data[t].fill},onMouseMoveSlice:function(t){var e=k(t.currentTarget),n=e.attr("data-serie"),i=e.attr("data-slice"),r=this._series[n].data[i];this.trigger(t.type,r,t)},mouseOverSlice:function(t,e){e=e||0;var n=k(this.$('.slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0]),i=this._series[e].data[t];n.toggleClass("hover"),i.isOuter&&!xn(i.onHoverEffect)&&this.effectOnSlice(n,i,i.onHoverEffect,!n.hasClass("hover"));var r=k(this.$('.legend-slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0]);r&&r.toggleClass("hover");var s=Object.keys(this.model.get("attrs")).filter(function(o){return o.indexOf(".slice")>-1||o.indexOf(".legend-slice")>-1});Te.prototype.update.call(this,this.model,uc(this.model.get("attrs"),s))},onMouseOverSlice:function(t){var e=k(t.currentTarget),n=e.attr("data-serie"),i=e.attr("data-slice");this.mouseOverSlice(i,n);var r=this._series[n].data[i];this.trigger(t.type,r,t)},clickSlice:function(t,e){e=e||0;var n=k(this.$('.slice[data-serie="'+e+'"][data-slice="'+t+'"]')[0]),i=this._series[e].data[t];i.isOuter&&(n.hasClass("clicked")?(n.removeClass("clicked"),this.model.get("series")[e].data[t].offset=0,this.effectOnSlice(n,i,i.onClickEffect,!0)):(n.addClass("clicked"),this.model.get("series")[e].data[t].offset=i.onClickEffect.offset,this.effectOnSlice(n,i,i.onClickEffect)))},onClickSlice:function(t){var e=k(t.target.closest(".slice.outer"));if(e){var n=e.attr("data-serie"),i=e.attr("data-slice");this.clickSlice(i,n);var r=this._series[n].data[i];this.trigger(t.type,r,t)}},onEventLegendItem:function(t){var e=k(t.target.closest(".legend-slice"));if(e){var n=e.attr("data-serie"),i=e.attr("data-slice");switch(t.type){case"click":this.clickSlice(i,n);break;case"mouseover":case"mouseout":this.mouseOverSlice(i,n);break}}},effectOnSlice:function(t,e,n,i){switch(i=i||!1,n.type){case"enlarge":i?t.scale(1):t.scale(n.scale||1.05);break;case"offset":i?t.translate(0,0,{absolute:!0}):t.translate(n.offset*Math.cos(-e.middleangle),-n.offset*Math.sin(-e.middleangle));break}},svgArcMax:2*Math.PI-1e-6,drawArc:function(t,e,n,i,r){var s=0,o=1,a=r-i;return a>Math.PI&&(s=1,a>=this.svgArcMax&&(s=0,o=0)),"M"+t.x+","+t.y+" A"+n+","+n+" 0 "+s+","+o+" "+e.x+","+e.y}}),D5=Yl.extend({defaults:$i({type:"chart.Knob",sliceDefaults:{legendLabel:"{value:.0f}",outer:{offsetOnClick:0}},pieHole:.7,value:0,attrs:{".legend":{"ref-x":.5,"ref-y":.5,"ref-dx":null,"x-alignment":-.5,"y-alignment":-.5},".legend-slice text":{"font-size":30},".legend-slice circle":{display:"none"},".slice-inner-label":{display:"none"},".slice-fill":{stroke:"none"}}},Yl.prototype.defaults),initialize:function(){this.set("series",this.getKnobSeries(),{silent:!0}),Yl.prototype.initialize.apply(this,arguments),this.on("change:value change:min change:max change:fill",this.updateKnob,this)},getKnobSeries:function(){var t=Array.isArray(this.get("value"))?this.get("value"):[this.get("value")],e=Array.isArray(this.get("fill"))?this.get("fill"):[this.get("fill")],n=Array.isArray(this.get("min"))?this.get("min"):[this.get("min")],i=Array.isArray(this.get("max"))?this.get("max"):[this.get("max")],r=t.map(function(s,o){var a=n[o]===void 0?n[0]:n[o],l=i[o]===void 0?i[0]:i[o],c=e[o]===void 0?e[0]:e[o];return{degree:qe.linear([a,l],[0,360],s),data:[{value:s,fill:c}],showLegend:!(o>0)}});return r},updateKnob:function(){this.set("series",this.getKnobSeries())}}),N5=ew,R5=Xt.extend({useCSSSelectors:!0,markup:['<g class="rotatable">','<g class="scalable">','<g class="background"><rect/></g>','<g class="cells"/>','<g class="foreground"/>',"</g>",'<g class="labels">','<g class="rows"/>','<g class="columns"/>',"</g>","</g>"].join(""),cellMarkup:'<rect class="cell"/>',labelMarkup:'<text class="label"/>',gridLineMarkup:'<path class="grid-line"/>',defaults:$i({type:"chart.Matrix",attrs:{root:{cursor:"move"},".background rect":{fill:"#eeeeee"},".grid-line":{stroke:"white","stroke-width":2},".label":{fill:"black","alignment-baseline":"middle"},".labels .rows .label":{"text-anchor":"end"},".labels .columns .label":{"text-anchor":"start"}}},Xt.prototype.defaults)}),$5=Te.extend({presentationAttributes:Te.addPresentationAttributes({size:["LABELS"],cells:[Te.Flags.RENDER]}),confirmUpdate:function(t,e){return this.hasFlag(t,"LABELS")&&!this.hasFlag(t,Te.Flags.RENDER)&&(this.renderLabels(),t=this.removeFlag(t,"LABELS")),Te.prototype.confirmUpdate.call(this,t,e)},renderMarkup:function(){Te.prototype.renderMarkup.apply(this,arguments),this.elCells=this.$(".cells")[0],this.elRowLabels=this.$(".labels .rows")[0],this.elColumnLabels=this.$(".labels .columns")[0],this.elForeground=this.$(".foreground")[0],this.elCell=k(this.model.cellMarkup),this.elGridLine=k(this.model.gridLineMarkup);var t=this.model.get("cells")||[],e=this.model.get("size");if(this.elBackgroundRect=this.$(".background rect")[0],k(this.elBackgroundRect).attr(e),!(!Array.isArray(t)||t.length===0||!Array.isArray(t[0])||t[0].length===0)){var n=e.height/t.length,i=e.width/t[0].length,r=document.createDocumentFragment();this.elCells.textContent="",this.elForeground.textContent="";for(var s=document.createDocumentFragment(),o,a,l,c,h,u=0;u<t.length;u++)for(l=this.elGridLine.clone(),l.addClass("horizontal"),l.attr("d","M 0 "+u*n+" "+e.width+" "+u*n),s.appendChild(l.node),o=t[u],a=0;a<o.length;a++)u===0&&(l=this.elGridLine.clone(),l.addClass("vertical"),l.attr("d","M "+a*i+" 0 "+a*i+" "+e.height),s.appendChild(l.node)),c=o[a],c&&(h=this.elCell.clone(),h.attr(U({x:a*i,y:u*n,width:i,height:n},c)),r.appendChild(h.node));this.elForeground.appendChild(s),this.elCells.appendChild(r),this.renderLabels()}},renderLabels:function(){this.elLabel=k(this.model.labelMarkup);var t=this.model.get("cells")||[];if(!(!Array.isArray(t)||t.length===0||!Array.isArray(t[0])||t[0].length===0)){var e=this.model.get("labels")||{},n=e.rows||[],i=e.columns||[],r=this.model.get("size"),s=r.height/t.length,o=r.width/t[0].length,a,l;this.elRowLabels.textContent="",this.elColumnLabels.textContent="";for(var c=document.createDocumentFragment(),h=0;h<n.length;h++)a=e.rows[h],l=this.elLabel.clone(),l.text(a.text),l.attr(U({x:-(e.padding||5),y:h*s+s/2,"text-anchor":"end","dominant-baseline":"central","font-size":s,"data-row":h},Ze(a,"text"))),c.appendChild(l.node);this.elRowLabels.appendChild(c);for(var u,d,f=document.createDocumentFragment(),p=0;p<i.length;p++)a=e.columns[p],l=this.elLabel.clone(),u=p*o+o/2,d=-(e.padding||5),l.attr("x",u),l.text(a.text),l.attr(U({y:d,"text-anchor":"start","dominant-baseline":"central","font-size":o,"data-column":p},Ze(a,"text"))),l.rotate(-90,u,d),f.appendChild(l.node);this.elColumnLabels.appendChild(f)}}}),B5=Object.freeze(Object.defineProperty({__proto__:null,Knob:D5,KnobView:N5,Matrix:R5,MatrixView:$5,Pie:Yl,PieView:ew,Plot:L5,PlotView:M5},Symbol.toStringTag,{value:"Module"})),{Link:nw,attributes:iw}=Wx,F5=new L(1,0),V5=nw.define("measurement.Distance",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round",targetMarker:{type:"path","stroke-width":2,d:"M 0 10 0 -10 M 10 10 0 0 10 -10",fill:"none"},sourceMarker:{type:"path","stroke-width":2,d:"M 0 10 0 -10 M 10 10 0 0 10 -10",fill:"none"}},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"},anchorLines:{stroke:"#333333",strokeWidth:1,strokeDasharray:"1,2"},sourceAnchorLine:{dAnchor:"source"},targetAnchorLine:{dAnchor:"target"},distanceLabel:{distanceText:{unit:"px",fixed:0},fontFamily:"sans-serif",fontWeight:"lighter",fontSize:14,labelPosition:{ratio:.5,offset:12},textAnchor:"middle",textVerticalAnchor:"middle"}}},{markup:[{tagName:"path",selector:"sourceAnchorLine",groupSelector:"anchorLines"},{tagName:"path",selector:"targetAnchorLine",groupSelector:"anchorLines"},{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}},{tagName:"text",selector:"distanceLabel"}],getDistanceText:function(t,e={}){const{fixed:n=0,unit:i=""}=e,r=t.getConnectionLength().toFixed(n);return i?`${r} ${i}`:`${r}`}},{attributes:{"distance-text":{set:function(t,...e){iw.text.set.call(this,this.model.getDistanceText(this,t),...e)}},"d-anchor":{set:function(t){return{d:`M ${new pt(this.getEndAnchor(t),this.getEndConnectionPoint(t)).serialize()}`}}},"label-position":{set:function(t){const{ratio:e=.5,offset:n=0}=t;let i,r;const s=this.getTangentAtRatio(e);s?(r=s.vector().vectorAngle(F5),i=s.start):(i=this.path.start,r=0);let o,a=n;if(r===0)o=`translate(${i.x},${i.y})`;else{const l=Qe((r+90)%180-90);r!==l&&(a=-n),o=`translate(${i.x},${i.y}) rotate(${l})`}return{transform:o,y:a}}}}}),qs={self:"self",source:"source",target:"target"},we={clockwise:"clockwise",anticlockwise:"anticlockwise",small:"small",large:"large"},z5=nw.define("measurement.Angle",{attrs:{line:{connection:!0,stroke:"#333333",strokeWidth:2,strokeLinejoin:"round"},wrapper:{connection:!0,strokeWidth:10,strokeLinejoin:"round"},angles:{stroke:"#333333",fill:"none",strokeWidth:1,angleRadius:40},sourceAngle:{angleD:"source"},targetAngle:{angleD:"target"},angleLabels:{textAnchor:"middle",textVerticalAnchor:"middle",fill:"#333333",fontSize:11,fontFamily:"sans-serif",angleTextDecimalPoints:0,angleTextDistance:23},sourceAngleLabel:{angleText:"source",angleTextPosition:"source"},targetAngleLabel:{angleText:"target",angleTextPosition:"target"}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round"}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none"}},{tagName:"path",selector:"sourceAngle",groupSelector:"angles",attributes:{cursor:"pointer"}},{tagName:"path",selector:"targetAngle",groupSelector:"angles",attributes:{cursor:"pointer"}},{tagName:"text",selector:"sourceAngleLabel",groupSelector:"angleLabels"},{tagName:"text",selector:"targetAngleLabel",groupSelector:"angleLabels"}],getAngleText:function(t={}){const{angle:e=0,decimalPoints:n=2}=t;return`${e.toFixed(n)}°`}},{AngleStarts:qs,AngleDirections:we,attributes:{"angle-d":{set:function(t,e,n,i){const{"angle-radius":r=40,"angle-start":s=qs.self,"angle-pie":o=!1,"angle-direction":a=we.small,angle:l}=i,c=lh(this,t,{angle:l,angleRadius:r,angleStart:s,angleDirection:a});if(!c)return{d:"M 0 0 0 0"};const{connectionPoint:h,linkArcPoint:u,otherArcPoint:d,arcAngle:f,largeArcFlag:p,sweepFlag:g}=c,v=[`M ${u.serialize()}`,`A ${r} ${r} ${f} ${p} ${g} ${d.serialize()}`];return o&&v.push(`L ${h.serialize()} Z`),{d:v.join(" ")}}},"angle-text":{set:function(t,e,n,i){let r="";const s=lh(this,t,{angleRadius:40});s&&(r=this.model.getAngleText({angle:s.angleBetween,decimalPoints:i["angle-text-decimal-points"]})),iw.text.set.call(this,r,e,n,i)}},"angle-text-position":{set:function(t,e,n,i){const{"angle-text-distance":r=60}=i,s=lh(this,t,{angleRadius:r});if(!s)return{};const{connectionPoint:o,otherArcPoint:a,linkArcPoint:l,angleBetween:c,largeArcFlag:h}=s;let u;if(Math.abs(c-180)<1e-6){const p=l.clone().rotate(o,h?90:-90);u=new pt(o,p).setLength(r)}else{const p=new pt(l,a).midpoint();u=new pt(o,p).setLength(r),h&&u.scale(-1,-1,u.start)}const d=u.end,f=Qe((u.angle()+90)%180-90);return{transform:`translate(${d.serialize()}) rotate(${f})`}}},angle:{},"angle-radius":{},"angle-text-distance":{},"angle-text-decimal-points":{},"angle-pie":{},"angle-start":{},"angle-direction":{}}});function lh(t,e,n){let i;const r="angleData",s=t.nodeCache(t.el);if(r in s){if(e in s[r])return s[r][e]}else s[r]={};const o=typeof n.angle=="number",a=t.getEndView(e);if(!a&&!o)return null;const l=e==="target",c=t.getTangentAtRatio(l?1:0);if(!c)return null;if(l&&c.scale(-1,-1,c.start),o)i=U5(c,n);else if(a.model.isLink())i=H5(c,a,n);else{const h=t.getEndMagnet(e);i=G5(c,a,h,n)}return s.angleData[e]=i,i}function U5(t,{angle:e,angleRadius:n}){const i=t.clone().rotate(t.start,-e);return rw(t,i,{angleRadius:n,angleStart:qs.target,angleDirection:e<0?we.clockwise:we.anticlockwise})}function H5(t,e,n){const i=e.getClosestPointLength(t.start),r=e.getTangentAtLength(i);return rw(t,r,n)}function rw(t,e,{angleRadius:n,angleStart:i,angleDirection:r}){const{start:s,end:o}=t.setLength(n),a=t.angle();let{end:l}=e.setLength(n),c=s.angleBetween(o,l),h=1,u=0,d=!1,f=!1,p=!0;const g=Math.floor(c/90);switch(i){case qs.target:{switch(r===we.small?r=c<180?we.clockwise:we.anticlockwise:r===we.large&&(r=c>180?we.clockwise:we.anticlockwise),r){case we.anticlockwise:{c>0&&c<180&&(u^=1),f=!0;break}default:case we.clockwise:{c>=180&&(u^=1),h^=1;break}}p=!1;break}case qs.source:{switch(r===we.small?r=c>180?we.clockwise:we.anticlockwise:r===we.large&&(r=c<180?we.clockwise:we.anticlockwise),r){case we.anticlockwise:{c>180&&(u^=1),h=1,f=!0;break}default:case we.clockwise:{c<180&&(u^=1),h=0;break}}p=!1,d=!0,c=Qe(c+180);break}default:case qs.self:{switch(r){case we.anticlockwise:{d=g===0||g===1,h=1,f=!0;break}case we.clockwise:{d=g===2||g===3,h=0,f=!1;break}case we.small:{d=g===1||g===2,h=g===0||g===2?0:1,f=g===1||g===3;break}case we.large:{d=g===0||g===3,h=g===1||g===3?0:1,f=g===0||g===2;break}}break}}return d&&(l=l.reflection(s)),p&&c>=180&&(c=Qe(c-180)),f&&(c=Qe((p?180:360)-c)),{angleBetween:c,connectionPoint:s,linkArcPoint:o,otherArcPoint:l,largeArcFlag:u,sweepFlag:h,arcAngle:a}}function G5(t,e,n,{angleRadius:i,angleDirection:r}){const{model:s}=e,o=s.getBBox(),a=s.angle(),l=o.center(),c=e.getNodeUnrotatedBBox(n),{end:h}=t.clone().setLength(1),u=h.rotate(l,a);if(c.containsPoint(u))return null;let d=0,f=0,p=t.angle()-a;u.y>c.y+c.height||u.y<c.y?(p+=90,d=i):f=i,p=Qe(p);let g;const v=Math.floor(p/90);switch(v){case 0:{g=1;break}case 1:{g=0;break}case 2:{d*=-1,f*=-1,g=1;break}case 3:{d*=-1,f*=-1,g=0;break}}let x=!1;switch(r){case we.large:x=!0;break;case we.anticlockwise:x=v===0||v===2;break;case we.clockwise:x=v===1||v===3;break}x&&(d*=-1,f*=-1,g^=1);const S=0,{start:C,end:P}=t.setLength(i),O=C.clone().offset(d,f).rotate(C,-a);let N=C.angleBetween(P,O);return N>180&&(N=360-N),{arcAngle:p,angleBetween:N,sweepFlag:g,largeArcFlag:S,otherArcPoint:O,linkArcPoint:P,connectionPoint:C}}const j5=Object.freeze(Object.defineProperty({__proto__:null,Angle:z5,Distance:V5},Symbol.toStringTag,{value:"Module"})),W5=hn.extend({defaults:{linkDistance:10,linkStrength:1,charge:10,x:0,y:0},cacheAttribute:"_fcache",initialize:function(){var t=this.get("graph"),e,n;if(Array.isArray(t)){var i=t;e=[],n=[];for(var r=0,s=i.length;r<s;r++){var o=i[r];o.isLink()?e.push(o):n.push(o)}}else n=t.getElements(),e=t.getLinks();this.links=e,this.elements=n,this.x=this.get("x"),this.y=this.get("y"),this.width=this.get("width"),this.height=this.get("height"),this.gravityCenter=this.get("gravityCenter"),this.t=1,this.energy=1/0,this.progress=0},start:function(){var t=this.width,e=this.height,n=this.x,i=this.y;this.elements.forEach(function(r){var s=ga(n,n+t),o=ga(i,i+e);r.position(s,o,{forceDirected:!0});var a=r[this.cacheAttribute]={};a.charge=r.get("charge")||this.get("charge"),a.weight=r.get("weight")||1,a.x=a.px=s,a.y=a.py=o,a.fx=0,a.fy=0},this),this.links.forEach(function(r){var s=r[this.cacheAttribute]={};s.source=r.getSourceElement(),s.target=r.getTargetElement(),s.strength=r.get("strength")||this.get("linkStrength"),s.distance=r.get("distance")||this.get("linkDistance")},this)},step:function(){if(this.t*.99<.005)return this.notifyEnd();var t=this.cacheAttribute,e=this.width,n=this.height,i=this.x,r=this.y,s=.1,o=this.gravityCenter,a=this.energy;this.energy=0;var l=0,c=0,h=0,u=0,d,f,p=this.elements.length,g=this.links.length,v,x,S,C,P,O,N,m,b;for(d=0;d<p-1;d++)for(v=this.elements[d][t],l+=v.x,c+=v.y,f=d+1;f<p;f++)x=this.elements[f][t],S=x.x-v.x,C=x.y-v.y,P=S*S+C*C,O=Math.sqrt(P),N=this.t*v.charge/P,m=N*S,b=N*C,v.fx-=m,v.fy-=b,x.fx+=m,x.fy+=b,this.energy+=m*m+b*b;var w=this.elements[p-1][t];l+=w.x,c+=w.y;var A,E,M;for(d=0;d<g;d++)A=this.links[d][t],v=A.source[t],x=A.target[t],S=x.x-v.x,C=x.y-v.y,P=S*S+C*C,O=Math.sqrt(P),E=this.t*A.strength*(O-A.distance)/O,m=E*S,b=E*C,M=v.weight/(v.weight+x.weight),v.x+=m*(1-M),v.y+=b*(1-M),x.x-=m*M,x.y-=b*M,this.energy+=m*m+b*b;var $,F,j;for(d=0;d<p;d++){$=this.elements[d],F=$[t],j={x:F.x,y:F.y},o&&(j.x+=(o.x-j.x)*this.t*s,j.y+=(o.y-j.y)*this.t*s),j.x+=F.fx,j.y+=F.fy,j.x=Math.max(i,Math.min(i+e,j.x)),j.y=Math.max(r,Math.min(i+n,j.y));var R=.9;j.x+=(F.px-j.x)*R,j.y+=(F.py-j.y)*R,F.px=j.x,F.py=j.y,F.fx=F.fy=0,F.x=j.x,F.y=j.y,h+=F.x,u+=F.y,this.notify($,d,j)}this.t=this.cool(this.t,this.energy,a);var H=l-h,z=c-u,B=Math.sqrt(H*H+z*z);B<1&&this.notifyEnd()},cool:function(t,e,n){if(e<n){if(this.progress+=1,this.progress>=5)return this.progress=0,t/.99}else return this.progress=0,t*.99;return t},notify:function(t,e,n){t.set("position",n,{forceDirected:!0})},notifyEnd:function(){this.trigger("end")}});function Y5(t,e,n){const{size:i,position:r}=e;if(i){const{width:s,height:o}=i;t.resize(s,o,n)}if(r){const{x:s,y:o}=r;t.position(s,o,n)}}const td={layout:function(t,e){var n;t instanceof li?n=t:n=new li().resetCells(t,{dry:!0,sort:!1}),t=null,e=e||{};var i=n.getElements(),r=e.columns||1,s=Math.ceil(i.length/r),o=e.verticalAlign||"middle",a=e.horizontalAlign||"middle",l=!!e.resizeToFit,c=e.marginX||0,h=e.marginY||0,u=e.columnGap||0,d=e.rowGap||0,f=e.setAttributes;typeof f!="function"&&(f=Y5);var p=[],g=e.columnWidth;if(g==="compact")for(var v=0;v<r;v++){var x=this._elementsAtColumn(i,v,r);p.push(this._maxDim(x,"width"))}else{(!g||te(g))&&(g=this._maxDim(i,"width"));for(var S=0;S<r;S++)p.push(g)}var C=this._accumulate(p,c).map((E,M)=>E+(M-.5)*u),P=[],O=e.rowHeight;if(O==="compact")for(var N=0;N<s;N++){var m=this._elementsAtRow(i,N,r);P.push(this._maxDim(m,"height"))}else{(!O||te(O))&&(O=this._maxDim(i,"height"));for(var b=0;b<s;b++)P.push(O)}var w=this._accumulate(P,h).map((E,M)=>E+(M-.5)*d);n.startBatch("layout"),i.forEach(function(E,M){var $=M%r,F=Math.floor(M/r),j=p[$],R=P[F],H=0,z=0,B=E.get("size"),_t={};if(l){var gt=j,Rt=R,ne=B.height*(B.width?gt/B.width:1),bt=B.width*(B.height?Rt/B.height:1);ne>R?gt=bt:Rt=ne,B={width:gt,height:Rt},_t.size=B}switch(o){case"top":break;case"bottom":z=R-B.height;break;case"middle":z=(R-B.height)/2;break}switch(a){case"left":break;case"right":H=j-B.width;break;case"middle":H=(j-B.width)/2;break}_t.position={x:C[$]+H+u/2,y:w[F]+z+d/2},f.call(n,E,_t,e)}),n.stopBatch("layout"),r>0&&(C[0]+=u/2,C[r]-=u/2),s>0?(w[0]+=d/2,w[s]-=d/2):w.length===0&&(w=[h,h]);const A=new J(c,h,C[r]-C[0],w[s]-w[0]);return{rowHeights:P,columnWidths:p,gridY:w,gridX:C,bbox:A}},_maxDim:function(t,e){return t.reduce(function(n,i){return Math.max(i.get("size")[e],n)},0)},_elementsAtRow:function(t,e,n){for(var i=[],r=n*e,s=Math.min(r+n,t.length);r<s;r++)i.push(t[r]);return i},_elementsAtColumn:function(t,e,n){for(var i=[],r=e,s=t.length;r<s;r+=n)i.push(t[r]);return i},_accumulate:function(t,e){return t.length===0?[]:t.reduce(function(n,i,r){return n.push(n[r]+i),n},[e||0])}},zn={TopBottom:"TB",BottomTop:"BT",LeftRight:"LR",RightLeft:"RL"},Il={Start:"start",Middle:"middle",End:"end"},X5=(t,e,n)=>{const{size:i,position:r}=e;if(i){const{width:s,height:o}=i;t.resize(s,o,n)}if(r){const{x:s,y:o}=r;t.position(s,o,n)}},un={Directions:zn,Alignments:Il,layout:function(t,e={}){const{direction:n=zn.TopBottom,topLeft:i,bottomLeft:r,topRight:s,bottomRight:o,stackGap:a=10,stackElementGap:l=10,stackSize:c=100,stackCount:h,setAttributes:u=X5,alignment:d=Il.Middle,stackIndexAttributeName:f="stackIndex",stackElementIndexAttributeName:p="stackElementIndex"}=e;let g,v,x;t instanceof li?(v=t.getElements(),x=t):(v=t,v[0]&&(x=v[0].graph)),h?g=Array(h).fill(null).map(()=>Array()):g=[],v.forEach(E=>{const M=E.get(f)||0;g[M]||(g[M]=[]),g[M].push(E)});const S=n===zn.TopBottom||n===zn.BottomTop,C=n===zn.LeftRight||n===zn.RightLeft,P=g.length;let O,N;S&&(O=g.reduce((E,M)=>Math.max(E,M.reduce(($,F)=>$+F.size().height,0)+(M.length-1)*l),0),N=P*c+(P-1)*a),C&&(N=g.reduce((E,M)=>Math.max(E,M.reduce(($,F)=>$+F.size().width,0)+(M.length-1)*l),0),O=P*c+(P-1)*a);const b=(()=>i?new J(i.x,i.y,N,O):s?new J(s.x-N,s.y,N,O):r?new J(r.x,r.y-O,N,O):o?new J(o.x-N,o.y-O,N,O):new J(0,0,N,O))(),w=b.topLeft(),A=[];for(let E=0;E<g.length;E++)g[E]=Je(g[E],M=>M.get(p)||0),S&&(A.push({bbox:new J(w.x,w.y,c,O),elements:g[E],index:E}),w.x+=c+a),C&&(A.push({bbox:new J(w.x,w.y,N,c),elements:g[E],index:E}),w.y+=c+a);x&&x.startBatch("layout");for(let E=0;E<A.length;E++){const M=A[E];if(M.elements.length){const $=M.bbox.topLeft();n===zn.BottomTop&&($.y+=M.bbox.height),n===zn.RightLeft&&($.x+=M.bbox.width),M.elements.forEach(F=>{const j=F.size();n===zn.BottomTop&&($.y-=j.height),n===zn.RightLeft&&($.x-=j.width);const R=$.toJSON();switch(d){case Il.Middle:{S?R.x+=(c-j.width)/2:R.y+=(c-j.height)/2;break}case Il.End:{S?R.x+=c-j.width:R.y+=c-j.height;break}}u(F,{position:R},e),n===zn.BottomTop&&($.y-=l),n===zn.TopBottom&&($.y+=j.height+l),n===zn.RightLeft&&($.x-=l),n===zn.LeftRight&&($.x+=j.width+l)})}}return x&&x.stopBatch("layout"),{bbox:b,stacks:A}}};function fu(t,e,n){n=me(n||{},{siblingGap:0}),this.width=0,this.height=0,this.layoutAreas=this.sortLayoutAreas(t),this.parentArea=e,this.siblingGap=n.siblingGap,this.exists()&&this.computeSize(n)}U(fu.prototype,{sortLayoutAreas:function(t){var e=Je(t,"siblingRank");return e.forEach(function(n,i){n.siblingRank=i}),e},move:function(t,e){for(var n=0,i=this.layoutAreas.length;n<i;n++)this.layoutAreas[n].dx+=t,this.layoutAreas[n].dy+=e},exists:function(){return this.layoutAreas.length>0},sumGaps:function(t){var e=Math.max(this.layoutAreas.length-1,0);return e*t},getSiblingRankByPoint:function(t){if(!this.exists())return-1;var e=this.findAreaByPoint(t);return e?e.siblingRank-1:this.layoutAreas.length-1},getFirstChildConnectionPoints:function(){return[]},getConnectionPoints:function(t,e){if(!this.exists())return this.getFirstChildConnectionPoints(t);var n={dx:t.x-this.parentArea.rootCX,dy:t.y-this.parentArea.rootCY};return this.layoutAreas[0].getRootVertices(n,e)},getParentConnectionPoint:function(){var t=this.parentArea,e=this.proxyLayoutArea("getConnectionPoint",t.rootSize),n=re(t.rootCX,t.rootCY);return n.offset(e.x,e.y)},getChildConnectionPoint:function(t,e){var n=this.proxyLayoutArea("getConnectionPoint",e);return re(t).difference(n)},proxyLayoutArea:function(t){var e=Array.prototype.slice.call(arguments,1);return Dn.fromDirection(this.direction).prototype[t].apply(this.parentArea,e)}});fu.extend=hn.extend;var Io=fu.extend({getTopDY:function(){return-this.height/2},findAreaByPoint:function(t){return this.layoutAreas.find(function(e){return e.rootCY>t.y})},computeSize:function(t){this.height=this.sumGaps(t.siblingGap);var e=this.layoutAreas;if(t.symmetrical){const n=e.reduce(function(i,r){return Math.max(i,r.height+r.prevSiblingGap+r.nextSiblingGap)},0);this.height+=n*e.length,e.reduce((i,r)=>(this.width=Math.max(this.width,r.getExtendedWidth()),r.dy+=i+n/2,i+n+t.siblingGap),this.getTopDY())}else this.height+=e.reduce(function(n,i){return n+i.height+i.prevSiblingGap+i.nextSiblingGap},0),e.reduce((n,i)=>(this.width=Math.max(this.width,i.getExtendedWidth()),i.dy+=n+i.getCY(),n+i.prevSiblingGap+i.height+i.nextSiblingGap+t.siblingGap),this.getTopDY())},getYTowardsParent:function(){return this.parentArea.rootCY},getXTowardsParent:function(){var t=this.parentArea;return t.rootCX+this.LRSign*(t.rootSize.width/2+t.gap)},getNeighborPointFromRank:function(t){var e,n=this.siblingGap;if(!this.exists())e=this.getYTowardsParent();else{var i=this.layoutAreas[t],r=this.layoutAreas[t+1];i?r?e=(i.y+i.height+r.y)/2:e=i.y+i.height+n/2:e=r.y-n/2}return{x:this.getXTowardsParent(),y:e}}}),q5=Io.extend({direction:"L",LRSign:-1}),K5=Io.extend({direction:"R",LRSign:1}),pu={getXTowardsParent:function(){var t=this.parentArea;return t.rootCX+this.LRSign*t.gap},getYTowardsParent:function(){var t=this.parentArea,e=t.getLRHeight(t.siblings)/2;return e+=Math.min(t.firstChildGap,this.siblingGap/2),t.rootCY+this.TBSign*e},getFirstChildConnectionPoints:function(t){return[re(this.parentArea.rootCX,t.y)]},getChildConnectionPoint:function(t,e){return re(t).offset(-this.LRSign*e.width/2,0)},getParentConnectionPoint:function(){var t=this.parentArea,e=re(t.rootCX,t.rootCY);return e.offset(0,this.TBSign*(t.rootSize.height-t.rootMargin)/2)}},sw={getTopDY:function(){return 0}},ow={getTopDY:function(){return-this.height}},aw=Io.extend({direction:"BR",LRSign:1,TBSign:1});U(aw.prototype,pu,sw);var lw=Io.extend({direction:"BL",LRSign:-1,TBSign:1});U(lw.prototype,pu,sw);var cw=Io.extend({direction:"TR",LRSign:1,TBSign:-1});U(cw.prototype,pu,ow);var uw=Io.extend({direction:"TL",LRSign:-1,TBSign:-1});U(uw.prototype,pu,ow);var hw=fu.extend({getLeftDX:function(){return-this.width/2},findAreaByPoint:function(t){return this.layoutAreas.find(function(e){return e.rootCX>t.x})},computeSize:function(t){this.width=this.sumGaps(t.siblingGap);var e=this.layoutAreas;if(t.symmetrical){const n=e.reduce(function(i,r){return Math.max(i,r.width+r.prevSiblingGap+r.nextSiblingGap)},0);this.width+=n*e.length,e.reduce((i,r)=>(this.height=Math.max(this.height,r.getExtendedHeight()),r.dx+=i+n/2,i+n+t.siblingGap),this.getLeftDX())}else this.width+=e.reduce(function(n,i){return n+i.width+i.prevSiblingGap+i.nextSiblingGap},0),e.reduce((n,i)=>(this.height=Math.max(this.height,i.getExtendedHeight()),i.dx+=n+i.getCX(),n+i.prevSiblingGap+i.width+i.nextSiblingGap+t.siblingGap),this.getLeftDX())},getNeighborPointFromRank:function(t){var e;if(!this.exists())e=this.parentArea.rootCX;else{var n=this.layoutAreas[t],i=this.layoutAreas[t+1];n?i?e=(n.x+n.width+i.x)/2:e=n.x+n.width+this.siblingGap/2:e=i.x-this.siblingGap/2}return{x:e,y:this.getYTowardsParent()}}}),Z5=hw.extend({direction:"T",getYTowardsParent:function(){var t=this.parentArea;return t.rootCY-t.getLRHeight()/2-t.gap}}),J5=hw.extend({direction:"B",getYTowardsParent:function(){var t=this.parentArea;return t.rootCY+t.getLRHeight()/2+t.gap}});function Dn(t,e){this.root=t;var n=U({},e,this.getRootAttributes(t,e.attributeNames)),i=e.gap||0;me(n,{parentGap:i,siblingGap:i,firstChildGap:i}),this.siblingRank=n.siblingRank,this.rootOffset=n.rootOffset,this.rootMargin=n.rootMargin,this.siblingGap=n.siblingGap,this.gap=this.parentGap=n.parentGap,this.nextSiblingGap=n.nextSiblingGap,this.prevSiblingGap=n.prevSiblingGap,this.firstChildGap=n.firstChildGap,this.dx=0,this.dy=0,this.width=0,this.height=0,this.symmetrical=n.symmetrical}U(Dn,{create:function(t,e,n){var i=Dn.fromDirection(t,n);return new i(e,n)},fromDirection:function(t,e){var n;switch(t){case"L":n=tV;break;case"T":n=eV;break;case"R":n=Q5;break;case"B":n=nV;break;case"BR":n=iV;break;case"BL":n=rV;break;case"TR":n=sV;break;case"TL":n=oV;break;default:n=Dn}return n}});U(Dn.prototype,{direction:null,compute:function(t){this.childAreas=t,this.computeRelativePosition(this.root,t)},getHeight:function(t,e){return this.getTHeight(t)+this.getBHeight(t)+this.getLRHeight()},getWidth:function(t,e){var n=Math.max(t.T.width,t.B.width)/2,i=Math.max(this.getLWidth(t,e)+e.width/2,n),r=Math.max(this.getRWidth(t,e)+e.width/2,n);return i+r},getLRHeight:function(){return Math.max(this.rootSize.height,this.siblings.L.height,this.siblings.R.height)},getTHeight:function(t){return t.T.height+this.getTXHeight(t)},getBHeight:function(t){return t.B.height+this.getBXHeight(t)},getXLRWidth:function(t,e){return this.getLWidth(t,e)+e.width+this.getRWidth(t,e)},getXRWidth:function(t,e){var n=Math.max(t.BR.width,t.TR.width);return n>0&&(n-=e.width/2),n},getTXHeight:function(t){var e=Math.max(t.TR.height,t.TL.height);return e>0&&(e+=this.firstChildGap),e},getBXHeight:function(t){var e=Math.max(t.BR.height,t.BL.height);return e>0&&(e+=this.firstChildGap),e},getXLWidth:function(t,e){var n=Math.max(t.BL.width,t.TL.width);return n>0&&(n-=e.width/2),n},getRWidth:function(t,e){return Math.max(t.R.width,this.getXRWidth(t,e))},getLWidth:function(t,e){return Math.max(t.L.width,this.getXLWidth(t,e))},getTBOverlap:function(t,e){var n=Math.max(t.T.width,t.B.width);return n>0&&(n-=e.width,n/=2),n},getRootDX:function(t,e){var n=this.getTBOverlap(t,e),i=Math.max(this.getLWidth(t,e),n);return i-=Math.max(this.getRWidth(t,e),n),i/2},getMinimalGap:function(t){return Math.min(t.siblingGap,this.firstChildGap,this.parentGap)},getBBox:function(t){var e=Ji(this),n=t&&t.expandBy;return n&&e.moveAndExpand({x:-n,y:-n,width:n*2,height:n*2}),e},containsPoint:function(t,e){return this.getBBox(e).containsPoint(t)},getLayoutSiblings:function(t){return this.siblings[t]},getExtendedWidth:function(){return this.width+this.gap+this.rootOffset},getExtendedHeight:function(){return this.height+this.gap+this.rootOffset},findMinimalAreaByPoint:function(t,e){if(!this.containsPoint(t,e))return null;var n;return this.childAreas.some(function(i){return n=i.findMinimalAreaByPoint(t,e),!!n}),n||this},getType:function(){return Object.keys(this.siblings).reduce((t,e)=>{var n=this.siblings[e];return n.exists()?t.concat(e):t},[]).sort().join("-")},getRootAttributes:function(t,e){var n={rootOffset:t.get(e.offset||"offset")||0,rootMargin:t.get(e.margin||"margin")||0,prevSiblingGap:t.get(e.prevSiblingGap||"prevSiblingGap")||0,nextSiblingGap:t.get(e.nextSiblingGap||"nextSiblingGap")||0},i=t.get(e.siblingRank||"siblingRank");Ot(i)&&(n.siblingRank=i);var r=t.get(e.firstChildGap||"firstChildGap");return Ot(r)&&(n.firstChildGap=r),n},getRootSize:function(t,e){var n=t.size();return n[this.marginDimension]+=e,n},createSiblings:function(t,e){var n=Vf(t,"direction");return{L:new q5(n.L,this,e),T:new Z5(n.T,this,e),R:new K5(n.R,this,e),B:new J5(n.B,this,e),BR:new aw(n.BR,this,e),BL:new lw(n.BL,this,e),TR:new cw(n.TR,this,e),TL:new uw(n.TL,this,e)}},computeSize:function(t,e){return{width:this.getWidth(t,e),height:this.getHeight(t,e)}},computeOrigin:function(){var t=this.siblings,e=this.rootSize,n=Math.max(this.getLWidth(t,e)+e.width/2,this.getXLWidth(t,e)+e.width/2,t.T.width/2,t.B.width/2);return{x:this.rootCX-n,y:this.rootCY-this.getTHeight(t)-this.getLRHeight()/2}},moveSiblings:function(t,e){if(this.hasHorizontalSiblings(t)){var n=e.width/2;t.L.move(-n,0),t.R.move(n,0)}if(this.hasVerticalSiblings(t)){var i=this.getLRHeight()/2;t.T.move(0,-i),t.B.move(0,i),t.BR.move(0,i),t.BL.move(0,i),t.B.move(0,this.getBXHeight(t)),t.TR.move(0,-i),t.TL.move(0,-i),t.T.move(0,-this.getTXHeight(t))}},moveRootToConnectionPoint:function(t){var e=this.getConnectionPoint(t);this.dx+=e.x,this.dy+=e.y},computeRelativePosition:function(t,e){var n=this.siblings=this.createSiblings(e,{siblingGap:this.siblingGap,symmetrical:this.symmetrical}),i=this.rootSize=this.getRootSize(t,this.rootMargin);U(this,this.computeSize(n,i)),this.moveSiblings(n,i),this.moveRootToConnectionPoint(i),this.moveRootBehindSiblings(n,i),this.moveRootFromParent()},computeAbsolutePosition:function(){if(this.parentArea)this.rootCX=this.parentArea.rootCX+this.dx,this.rootCY=this.parentArea.rootCY+this.dy,this.level=this.parentArea.level+1;else{var t=this.root.getBBox().center();this.rootCX=t.x,this.rootCY=t.y,this.level=0}U(this,this.computeOrigin())},hasVerticalSiblings:function(t){return t.T.exists()||t.B.exists()||t.BR.exists()||t.BL.exists()||t.TR.exists()||t.TL.exists()},hasHorizontalSiblings:function(t){return t.L.exists()||t.R.exists()},isSourceArea:function(){return!this.parentArea},isSinkArea:function(){return this.childAreas.length===0},getRootPosition:function(){var t=this.root.get("size");return{x:this.rootCX-t.width/2,y:this.rootCY-t.height/2}},getRootVertices:function(t,e){if(e=e||{},t=t||this,t[this.deltaCoordinate]===0||!this.parentArea)return[];var n=this.parentArea.getInnerSize(),i;if(!e.ignoreSiblings&&this.hasSiblingsBetweenParent()){var r=this.siblings[this.oppositeDirection];i=this.getRelativeVerticesAvoidingSiblings(n,t,r)}else i=this.getRelativeVertices(n,t);return We(i,"offset",this.parentArea.rootCX,this.parentArea.rootCY)},getInnerSize:function(){return{width:this.rootSize.width,height:this.getLRHeight()}},getConnectionPoint:function(){return null},getRelativeVertices:function(){return null},moveRootFromParent:function(){},moveRootBehindSiblings:function(){},hasSiblingsBetweenParent:function(){return!this.isSourceArea()&&this.siblings[this.oppositeDirection].exists()},getCY:function(){return this.height/2+this.prevSiblingGap},getCX:function(){return this.width/2+this.prevSiblingGap}});Dn.extend=hn.extend;var Q5=Dn.extend({direction:"R",oppositeDirection:"L",deltaCoordinate:"dx",marginDimension:"height",getConnectionPoint:function(t){return re(t.width/2,0)},moveRootBehindSiblings:function(t,e){this.dx+=Math.max(this.getLWidth(t,e),this.getTBOverlap(t,e)),this.dy+=(this.getTHeight(t)-this.getBHeight(t))/2},moveRootFromParent:function(){this.dx+=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var n=this.getConnectionPoint(t),i=this.parentGap/2;return[n.clone().offset(i,0),n.clone().offset(i,e.dy)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=this.getConnectionPoint(t),r=n.siblingGap/2,s=this.dx>0?-1:1,o=e.dy+s*(n.height+r)/2,a=e.dy+s*this.rootSize.height/4,l=this.gap/2,c=1.5*l+Math.max(this.getLWidth(this.siblings,this.rootSize),this.getTBOverlap(this.siblings,this.rootSize));return[i.clone().offset(l,0),i.clone().offset(l,o),i.clone().offset(c,o),i.clone().offset(c,a)]}}),tV=Dn.extend({direction:"L",oppositeDirection:"R",deltaCoordinate:"dx",marginDimension:"height",getConnectionPoint:function(t){return re(-t.width/2,0)},moveRootBehindSiblings:function(t,e){this.dx-=Math.max(this.getRWidth(t,e),this.getTBOverlap(t,e)),this.dy+=(this.getTHeight(t)-this.getBHeight(t))/2},moveRootFromParent:function(){this.dx-=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var n=this.getConnectionPoint(t),i=-this.parentGap/2;return[n.clone().offset(i,0),n.clone().offset(i,e.dy)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=this.getConnectionPoint(t),r=this.dx>0?-1:1,s=e.dy+r*(n.height+n.siblingGap/2)/2,o=e.dy+r*this.rootSize.height/4,a=this.gap/2,l=1.5*a+Math.max(this.getRWidth(this.siblings,this.rootSize),this.getTBOverlap(this.siblings,this.rootSize));return[i.clone().offset(-a,0),i.clone().offset(-a,s),i.clone().offset(-l,s),i.clone().offset(-l,o)]}}),eV=Dn.extend({direction:"T",oppositeDirection:"B",deltaCoordinate:"dy",marginDimension:"width",getConnectionPoint:function(t){return re(0,-t.height/2)},moveRootBehindSiblings:function(t,e){this.dx+=this.getRootDX(t,e),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2),this.dy-=this.getBHeight(t)},moveRootFromParent:function(){this.dy-=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var n=this.getConnectionPoint(t),i=-this.getTXHeight(this.parentArea.siblings)-this.parentGap/2;return[n.clone().offset(0,i),n.clone().offset(e.dx,i)]},getRelativeVerticesAvoidingSiblings:function(t,e){var n=this.getConnectionPoint(t),i=this.siblings,r=i.B,s=this.getTXHeight(this.parentArea.siblings)+this.parentGap/2,o=s+r.height;o+=this.getBXHeight(this.siblings)+this.parentGap/4;var a=this.dy<0?-1:1,l=i[a>0?"BR":"BL"].width,c=e.dx;c+=a*(Math.max(l,r.width/2)+r.siblingGap/4);var h=e.dx+a*this.rootSize.width/4;return[n.clone().offset(0,-s),n.clone().offset(c,-s),n.clone().offset(c,-o),n.clone().offset(h,-o)]}}),nV=Dn.extend({direction:"B",oppositeDirection:"T",deltaCoordinate:"dy",marginDimension:"width",getConnectionPoint:function(t){return re(0,t.height/2)},moveRootBehindSiblings:function(t,e){this.dx+=this.getRootDX(t,e),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){this.dy+=this.parentGap+this.rootOffset},getRelativeVertices:function(t,e){var n=this.getConnectionPoint(t),i=this.getBXHeight(this.parentArea.siblings)+this.parentGap/2;return[n.clone().offset(0,i),n.clone().offset(e.dx,i)]},getRelativeVerticesAvoidingSiblings:function(t,e){var n=this.getConnectionPoint(t),i=this.siblings,r=i.T,s=this.getBXHeight(this.parentArea.siblings)+this.parentGap/2,o=s+r.height;o+=this.getTXHeight(i)+this.parentGap/4;var a=this.dy<0?-1:1,l=i[a>0?"TR":"TL"].width,c=e.dx;c+=a*(Math.max(l,r.width/2)+r.siblingGap/4);var h=e.dx+a*this.rootSize.width/4;return[n.clone().offset(0,s),n.clone().offset(c,s),n.clone().offset(c,o),n.clone().offset(h,o)]}}),iV=Dn.extend({direction:"BR",oppositeDirection:"L",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return re(0,t.height/2)},getCY:function(){return this.prevSiblingGap},moveRootBehindSiblings:function(t,e){var n=Math.max(t.T.width,t.B.width);this.dx+=Math.max(this.getLWidth(t,e),(n-e.width)/2),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy+=t.firstChildGap),this.dx+=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){const n=this.getConnectionPoint(t),{dx:i,dy:r}=e,{width:s,height:o}=t;let a;return r-o/2<0?a=(s/2+(i-this.rootSize.width/2))/2:a=0,[n.clone().offset(a,r-o/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=e.dx-this.rootSize.width/4,r=e.dy;return r+=Math.max(n.height,this.rootSize.height)/2,r+=this.getMinimalGap(n)/2,[re(0,r),re(i,r)]}}),rV=Dn.extend({direction:"BL",oppositeDirection:"R",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return re(0,t.height/2)},getCY:function(){return this.prevSiblingGap},moveRootBehindSiblings:function(t,e){var n=Math.max(t.T.width,t.B.width);this.dx-=Math.max(this.getRWidth(t,e),(n-e.width)/2),this.dy+=this.getTHeight(t),this.hasHorizontalSiblings(t)&&(this.dy+=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy+=t.firstChildGap),this.dx-=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){const n=this.getConnectionPoint(t),{dx:i,dy:r}=e,{width:s,height:o}=t;let a;return r-o/2<0?a=(-s/2+(i+this.rootSize.width/2))/2:a=0,[n.clone().offset(a,r-o/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=e.dx+this.rootSize.width/4,r=e.dy;return r+=Math.max(n.height,this.rootSize.height)/2,r+=this.getMinimalGap(n)/2,[re(0,r),re(i,r)]}}),sV=Dn.extend({direction:"TR",oppositeDirection:"L",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return re(0,t.height/2)},getCY:function(){return this.height-this.rootSize.height+this.prevSiblingGap},moveRootBehindSiblings:function(t,e){this.dx+=Math.max(this.getLWidth(t,e),this.getTBOverlap(t,e)),this.dy-=this.getBHeight(t),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy-=t.firstChildGap),this.dx+=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){const n=this.getConnectionPoint(t),{dx:i,dy:r}=e,{width:s,height:o}=t;let a;return r+o/2>0?a=(s/2+(i-this.rootSize.width/2))/2:a=0,[n.clone().offset(a,r-o/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=e.dx-this.rootSize.width/4,r=e.dy;return r-=Math.max(n.height,this.rootSize.height)/2,r-=this.getMinimalGap(n)/2,[re(0,r),re(i,r)]}}),oV=Dn.extend({direction:"TL",oppositeDirection:"R",deltaCoordinate:"dy",marginDimension:"height",getConnectionPoint:function(t){return re(0,t.height/2)},getCY:function(){return this.height-this.rootSize.height+this.prevSiblingGap},moveRootBehindSiblings:function(t,e){this.dx-=Math.max(this.getRWidth(t,e),this.getTBOverlap(t,e)),this.dy-=this.getBHeight(t),this.hasHorizontalSiblings(t)&&(this.dy-=(this.getLRHeight()-e.height)/2)},moveRootFromParent:function(){var t=this.parentArea;t&&(this.dy-=t.firstChildGap),this.dx-=this.rootSize.width/2+this.rootOffset+this.parentGap},getRelativeVertices:function(t,e){const n=this.getConnectionPoint(t),{dx:i,dy:r}=e,{width:s,height:o}=t;let a;return r+o/2>0?a=(-s/2+(i+this.rootSize.width/2))/2:a=0,[n.clone().offset(a,r-o/2)]},getRelativeVerticesAvoidingSiblings:function(t,e,n){var i=e.dx+this.rootSize.width/4,r=e.dy;return r-=Math.max(n.height,this.rootSize.height)/2,r-=this.getMinimalGap(n)/2,[re(0,r),re(i,r)]}}),km={rotate:function(t){var e="LRBT",n=e.indexOf(t[0])-e.indexOf(t[1]);return function(i){var r=e.indexOf(i);return r>=0?e[(4+r-n)%4]:i}},flip:function(t){var e=t[0],n=t[1];return function(i){return i===e?n:i===n?e:i}},straighten:function(t){return function(){return t[1]}}};const aV=hn.extend({defaults:{graph:void 0,gap:20,parentGap:20,siblingGap:20,firstChildGap:20,direction:"R",directionRule:km.straighten,updatePosition:function(t,e,n){t.set("position",e,n)},updateVertices:function(t,e,n){t.set("vertices",e,n)},updateAttributes:null,filter:null,attributeNames:{}},initialize:function(){this._cacheOptions(this.attributes),this.layoutAreas={}},layout:function(t){this.layoutAreas={};for(var e=this.getGraphSources(t),n=0,i=e.length;n<i;n++)this.layoutTree(e[n],t);return this.trigger("layout:done",t),this},layoutTree:function(t,e){e=e||{},e.treeLayout=!0;var n=this._computeLayoutAreas(t,null,e);return this._computeAbsolutePositions(n),this._updateCells(n,e),this},getLayoutBBox:function(){return this.getRootLayoutAreas().reduce(function(t,e){var n=e.getBBox();return t?t.union(n):n},null)},getLayoutArea:function(t){return this.layoutAreas[t.id||t]||null},getRootLayoutAreas:function(){return this.getGraphSources().map(this.getLayoutArea,this)},getGraphSources:function(t){var e=this.graph.getSources();return this.filter&&e.length>0&&(e=this.filter(e,null,t)||e),e},getMinimalRootAreaByPoint:function(t){var e=this.getRootLayoutAreas().filter(function(n){return n.containsPoint(t)});return xn(e)?null:e.reduce(function(n,i){return i.width*i.height<n.min&&(n.min=i.width*i.height,n.item=i),n},{min:1/0,item:void 0}).item},_computeLayoutAreas:function(t,e,n){var i=e?e.direction:this.get("direction"),r=t.get(this.getAttributeName("direction"))||i,s=Dn.create(r,t,this.attributes);s.parentArea=e,s.link=this.graph.getConnectedLinks(t,{inbound:!0})[0];var o=this._getChildren(t,n);this.layoutAreas[t.id]=s;for(var a=[],l=0,c=o.length;l<c;l++)a.push(this._computeLayoutAreas(o[l],s,n));return s.compute(a),s},_cacheOptions:function(t){var e=["updateAttributes","updateVertices","updatePosition","filter"];e.forEach(function(n){this[n]=xt(t[n])?t[n]:null},this),this.graph=t.graph},_getChildren:function(t,e){if(this.layoutAreas[t.id])return[];var n=this.graph.getNeighbors(t,{outbound:!0});return this.filter&&n.length>0&&(n=this.filter(n,t,e)||n),n},_computeAbsolutePositions:function(t){t.computeAbsolutePosition(t);for(var e=0,n=t.childAreas.length;e<n;e++)this._computeAbsolutePositions(t.childAreas[e])},_updateCells:function(t,e){var n=t.root,i=t.link||null;i&&(this.updatePosition&&this.updatePosition(n,t.getRootPosition(),e),this.updateVertices&&this.updateVertices(i,t.getRootVertices(),e)),this.changeSiblingRank(n,t.siblingRank,e),this.updateAttributes&&this.updateAttributes(t,n,i,e);for(var r=0,s=t.childAreas.length;r<s;r++)this._updateCells(t.childAreas[r],e)},updateDirections:function(t,e,n){n=n||{};var i=this.getAttributeName("direction"),r=this.get("directionRule")(e);this.graph.search(t,(s,o)=>{if(o!==0){var a=r(s.get(i));this.changeDirection(s,a,n)}},{outbound:!0})},reconnectElement:function(t,e,n){n=n||{};var i=this.getLayoutArea(t),r=i.link;if(r){r.set("source",{id:e.id||e},n);var s=i.direction,o=n.direction||s,a=n.siblingRank||void 0;return this.changeSiblingRank(t,a,n),this.changeDirection(t,o,n),s!==o&&this.updateDirections(t,[s,n.direction],n),!0}return!1},changeSiblingRank:function(t,e,n){t.set(this.getAttributeName("siblingRank"),e,n)},changeDirection:function(t,e,n){t.set(this.getAttributeName("direction"),e,n)},getAttributeName:function(t){return this.get("attributeNames")[t]||t},getAttribute:function(t,e){return t.get(this.getAttributeName(e))},prepare:function(){return this},removeElement:function(t,e={}){const[n]=this.graph.getNeighbors(t,{inbound:!0});if(n){const i=t.get("siblingRank"),r=this.graph.getConnectedLinks(t,{outbound:!0});r.forEach(s=>{s.source(n);const o=s.getTargetCell(),a=qe.linear([0,r.length],[0,1],o.get("siblingRank"));o.set("siblingRank",i+a,e)})}t.remove(e),e.layout!==!1&&this.layout(e)}},{directionRules:km}),lV=Rr.extend({name:"scroll-bar",tagName:"rect",options:{margin:2,width:8,rightAlign:!1},attributes:{fill:"#333",rx:4,ry:4,"fill-opacity":.4,cursor:"grab"},events:{mousedown:"onPointerDown",touchstart:"onPointerDown"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},onRender:function(){this.update()},update:function(){const t=this.getBBox();return t?(this.enable(),this.vel.attr(t.toJSON())):this.disable(),this},getTrackHeight(){const{relatedView:t,options:e}=this,n=t.model,{metrics:i}=n,{padding:r}=i,s=e.margin,o=r.top+r.bottom+2*Math.abs(s),{height:a}=n.attributes.size;return a-o},getScale(){const{relatedView:t}=this,e=t.model,{metrics:n,attributes:i}=e,{minHeight:r}=n,{height:s}=i.size,o=this.getTrackHeight();return o/(r-(s-o))},getBBox:function(){const{relatedView:t,options:e}=this,n=t.model;if(n.isEveryItemInView())return null;const{metrics:i,attributes:r}=n,{width:s}=r.size,{padding:o,overflow:a}=i,l=this.getTrackHeight();if(l<=0)return null;const{margin:c,width:h}=e,u=this.getScale(),d=l*u,{x:f,y:p}=r.position,g=p+Math.abs(c)+o.top;let v=f;return e.rightAlign?(v+=s-c,c>=0&&(v-=h),a||(v-=o.right)):(v+=c,c<0&&(v-=h),a||(v+=o.left)),new J({x:v,y:g+u*n.getScrollTop(),width:h,height:d})},disable:function(){this.vel.attr("display","none")},enable:function(){this.vel.attr("display","")},onPointerDown:function(t){if(this.guard(t))return;t.stopPropagation(),t.preventDefault();const{relatedView:e}=this,n=e.model;n.startBatch("scroll-record",{ui:!0,tool:this.cid}),this.focus(),this.delegateDocumentEvents(null,{y:t.clientY,scrollTop:n.getScrollTop()}),e.paper.undelegateEvents()},onPointerMove:function(t){const e=ot(t),{y:n,scrollTop:i,lastScrollTop:r}=e.data,{relatedView:s}=this,o=s.model,a=this.getScale(),l=i+(e.clientY-n)/a;r!==l&&(e.data.lastScrollTop=l,o.setScrollTop(l))},onPointerUp:function(){this.undelegateDocumentEvents(),this.paper.delegateEvents(),this.blur(),this.el.style.pointerEvents="",this.relatedView.model.stopBatch("scroll-record",{ui:!0,tool:this.cid})}}),cV=Yx.extend({name:"swimlane-boundary",tagName:"rect",options:{padding:10,laneId:""},update:function(){const{vel:t,relatedView:e,options:n}=this,i=e.model,r=i.angle(),s=i.getBBox().center(),o=this.getBoundaryBBox(i,n.laneId,n.padding);return o===null?t.attr({width:0,height:0}):(t.attr(o.toJSON()),t.rotate(r,s.x,s.y,{absolute:!0})),this},getBoundaryBBox:function(t,e,n){const{left:i,top:r,right:s,bottom:o}=Ne(n),a=t.getLaneBBox(e);return a===null?null:(a.moveAndExpand({x:-i,y:-r,width:i+s,height:r+o}),a.width<0&&(a.width=0),a.height<0&&(a.height=0),a)}}),Xi=function(t,e,n){this.top=t.topLine().rotate(e,-n),this.left=t.leftLine().rotate(e,-n),this.right=t.rightLine().rotate(e,-n),this.bottom=t.bottomLine().rotate(e,-n)};Xi.inflatedOnSide=function(t,e,n,i,r){const s=new Xi(t,e,n),o=s.getLine(r);switch(r){case"top":case"right":s[r]=o.parallel(-i);break;case"bottom":case"left":s[r]=o.parallel(i);break}return s};Xi.prototype={getLine:function(t){switch(t){case"top":return this.top;case"right":return this.right;case"bottom":return this.bottom;case"left":return this.left}},isPointOnLine:function(t,e){return Math.round(this.getLine(e).closestPoint(t).distance(t))===0},isPointToTheLeftOfLine:function(t,e){const n=Math.round(this.getLine(e).pointOffset(t));switch(e){case"top":case"right":return n>0;case"bottom":case"left":return n<0}},isPointToTheRightOfLine:function(t,e){const n=Math.round(this.getLine(e).pointOffset(t));switch(e){case"top":case"right":return n<0;case"bottom":case"left":return n>0}},isPointInside:function(t){let e=this.isPointToTheLeftOfLine(t,"top"),n=this.isPointToTheLeftOfLine(t,"right"),i=this.isPointToTheLeftOfLine(t,"bottom");return this.isPointToTheLeftOfLine(t,"left")&&e&&n&&i},isPointInsideOrOnLine:function(t){const e=this.isPointInside(t),n=this.isPointOnLine(t,"top"),i=this.isPointOnLine(t,"right"),r=this.isPointOnLine(t,"bottom"),s=this.isPointOnLine(t,"left");return e||n||i||r||s},findClosestPointToLine:function(t,e){const n=new L;let i=1/0;return t.forEach(r=>{const s=this.getDistanceFromLineToPoint(r,e);s<i&&(n.update(r.x,r.y),i=s)}),n},findFurthestPointFromLine:function(t,e){const n=new L;let i=-1/0;return t.forEach(r=>{const s=this.getDistanceFromLineToPoint(r,e);s>i&&(n.update(r.x,r.y),i=s)}),n},getDistanceFromLineToPoint:function(t,e){const n=this.getLine(e),i=this.isPointToTheRightOfLine(t,e)?1:-1,r=Math.abs(n.pointOffset(t))*i;return Math.round(r)}};const Lm=GF.SegmentHandle.extend({className:"swimlane-transform-handle",children:[{tagName:"rect",selector:"handle",attributes:{width:20,height:8,x:-10,y:-4,rx:4,ry:4,fill:"#3498db",stroke:"#FFFFFF","stroke-width":2}}],position:function(t,e,n){const i=this.childNodes.handle,r=k.createSVGMatrix().translate(t,e).rotate(n);i.setAttribute("transform",k.matrixToTransformString(r)),i.setAttribute("cursor",n%180===0?"row-resize":"col-resize")}}),Ge={Top:"top",Right:"right",Bottom:"bottom",Left:"left"},Fr={X:"x",Y:"y"},uV=Rr.extend({name:"swimlane-transform",options:{laneId:void 0,minSize:30,padding:10,stopPropagation:!0,constraintsPadding:10,handleClass:Lm,minSizeConstraints:void 0,maxSizeConstraints:void 0},handles:null,minConstraintPoints:null,maxConstraintPoints:null,initialize:function(){const t=this.options;t.minSizeConstraints===void 0&&(t.minSizeConstraints=(e,n,i)=>this.getMinConstraintsToEmbeds(e,n,i)),t.maxSizeConstraints===void 0&&(t.maxSizeConstraints=(e,n,i)=>this.getMaxConstraintsToEmbeds(e,n,i))},update:function(){return this.render(),this},onRender:function(){return this.removeHandles(),this.doesLaneExist()&&this.renderHandles(),this},onRemove:function(){this.removeHandles()},doesLaneExist:function(){return this.relatedView.model.getLaneBBox(this.options.laneId)!==null},removeHandles:function(){const t=this.handles;if(this.handles=[],this.stopListening(),!!Array.isArray(t))for(let e=0;e<t.length;e++)t[e].remove()},renderHandles:function(){this.getHandlesPositionInfo().forEach(e=>{const n=this.renderHandle(e);this.simulateRelatedView(n.el),this.handles.push(n)})},getHandlesPositionInfo:function(){const{options:t,relatedView:e}=this,n=t.laneId,i=e.model,r=i.angle(),s=i.getBBox().center(),o=this.getHandlesBoundaryBBox(i,n,t.padding);return[{position:o.topMiddle().rotate(s,-r),axis:Fr.Y,side:Ge.Top},{position:o.leftMiddle().rotate(s,-r),axis:Fr.X,side:Ge.Left},{position:o.rightMiddle().rotate(s,-r),axis:Fr.X,side:Ge.Right},{position:o.bottomMiddle().rotate(s,-r),axis:Fr.Y,side:Ge.Bottom}]},getHandlesBoundaryBBox:function(t,e,n){const{left:i,top:r,right:s,bottom:o}=Ne(n),a=t.getLaneBBox(e).moveAndExpand({x:-i,y:-r,width:i+s,height:r+o});return a.width<0&&(a.width=0),a.height<0&&(a.height=0),a},renderHandle:function(t){const e=new this.options.handleClass({paper:this.paper,axis:t.axis,side:t.side,guard:n=>this.guard(n)});return e.render(),e.vel.appendTo(this.el),this.updateHandlePosition(e,t.position),this.startHandleListening(e),e},updateHandlePosition:function(t,e){let n=this.relatedView.model.angle();t.options.axis===Fr.X&&(n+=90),t.position(e.x,e.y,n)},startHandleListening:function(t){this.listenTo(t,"change:start",this.onHandleChangeStart),this.listenTo(t,"changing",this.onHandleChanging),this.listenTo(t,"change:end",this.onHandleChangeEnd)},onHandleChangeStart:function(t,e){const n=t.options.side,{options:i,handles:r,relatedView:s}=this,{model:o,paper:a}=s;Array.isArray(r)&&(this.hideNonSelectedHandles(r,t),this.updateConstraintPoints(n),this.focus(),o.startBatch("lane-resize",{ui:!0,tool:this.cid}),i.stopPropagation||s.notifyPointerdown(...a.getPointerArgs(e)))},hideNonSelectedHandles:function(t,e){t.forEach(n=>n===e?n.show():n.hide())},updateConstraintPoints:function(t){const{relatedView:e,options:n}=this,i=n.laneId,r=e.model,s=n.minSizeConstraints,o=n.maxSizeConstraints;let a,l;xt(s)&&(a=s(r,i,t)),xt(o)&&(l=o(r,i,t)),this.minConstraintPoints=Array.isArray(a)?a.map(c=>new L(c)):[],this.maxConstraintPoints=Array.isArray(l)?l.map(c=>new L(c)):[]},onHandleChanging:function(t,e){const{options:n,relatedView:i}=this,{model:r,paper:s}=i,{laneId:o,stopPropagation:a}=n,l=r.getBBox(),c=r.angle(),h=l.center(),u=t.options,d=u.axis,f=u.side,p=this.getHandlesPositionInfo().find(N=>N.side===f).position,g=ot(e),v=s.snapToGrid(g.clientX,g.clientY),x=v.clone().rotate(h,c).round(),S=p.clone().rotate(h,c).round(),C=x.difference(S),P=C.y!==0,O=C.x!==0;if(d===Fr.Y&&P){const N=f===Ge.Top?-C.y:C.y;this.updateLaneHeight(o,N,f,l,c)}else if(d===Fr.X&&O){const N=f===Ge.Left?-C.x:C.x;this.updateLaneWidth(o,N,r,f,l,c)}this.updateHandlePosition(t,p),a||i.notifyPointermove(g,v.x,v.y)},onHandleChangeEnd:function(t,e){const{options:n,relatedView:i}=this,{paper:r,model:s}=i,o=ot(e),{x:a,y:l}=r.snapToGrid(o.clientX,o.clientY);this.render(),this.blur(),s.stopBatch("lane-resize",{ui:!0,tool:this.cid}),n.stopPropagation||i.notifyPointerup(o,a,l),i.checkMouseleave(o)},updateLaneHeight:function(t,e,n,i,r){const s=this.relatedView.model,o=s.metrics.lanes,a=ke(s.prop("lanes")),l=this.getNeighbourLanesIds(o,t,n),c=this.getSublanesAndMostEmbeddedLaneId(o,t,n),h=l.foundNeighbourLaneId===void 0,u=[l.foundNeighbourLaneId,...l.sublaneIds],d=[t,...c.sublaneIds,...l.laneIdsPathToNeighbour];e=this.getDiffWithinConstraints(t,e,n,i.center(),r),e=this.getDiffWithinLaneSizeLimits(s,e,c.mostEmbeddedLaneId,l.mostEmbeddedLaneId),d.forEach(f=>this.addSizeToLane(s,a,f,e)),h?this.resizeShape(s,i.width,i.height+e,n):u.forEach(f=>this.addSizeToLane(s,a,f,-e)),s.prop("lanes",a,{ui:!0,tool:this.cid,autoResize:!1})},getSublanesAndMostEmbeddedLaneId:function(t,e,n){const i=this.getIdsOfClosestSublanesToTheSide(t,e,n),r=i[0]||e;return{sublaneIds:i,mostEmbeddedLaneId:r}},getOppositeHandleSide:function(t){switch(t){case Ge.Top:return Ge.Bottom;case Ge.Right:return Ge.Left;case Ge.Bottom:return Ge.Top;case Ge.Left:return Ge.Right}},getNeighbourLanesIds:function(t,e,n){const i=this.getOppositeHandleSide(n),{foundNeighbourLaneId:r,laneIdsPathToNeighbour:s}=this.findNeighbourLane(t,e,n),o=this.getIdsOfClosestSublanesToTheSide(t,r,i),a=o[0]||r;return{foundNeighbourLaneId:r,laneIdsPathToNeighbour:s,sublaneIds:o,mostEmbeddedLaneId:a}},addSizeToLane:function(t,e,n,i){const s=this.getLaneBBoxHeight(t,n)+i,o=t.getLanePath(n);o.push("size"),so({lanes:e},o,s)},updateLaneWidth:function(t,e,n,i,r,s){e=this.getDiffWithinConstraints(t,e,i,r.center(),s);const o=n.getMinimalSize().width,a=Math.max(r.width+e,o);this.resizeShape(n,a,r.height,i)},resizeShape:function(t,e,n,i){t.resize(e,n,{ui:!0,tool:this.cid,direction:i})},getLaneBBoxHeight:function(t,e){return t.getLaneBBox(e).height},getDiffWithinLaneSizeLimits:function(t,e,n,i){const r=Math.sign(e),s=i!==void 0,o=this.getLaneBBoxHeight(t,n),a=s?this.getLaneBBoxHeight(t,i):1/0,l=o+e,c=a-e,h=this.getMinSize();return l<h?e=(o-h)*r:c<h&&(e=(a-h)*r),Math.round(e)},getMinSize:function(){let t=this.options.minSize;const e=this.options.constraintsPadding*2;return e>t&&(t=e),t},getDiffWithinConstraints:function(t,e,n,i,r){const o=this.relatedView.model.getLaneBBox(t),a=this.getConstraintPaddingRelativeToHandleSide(e),l=Xi.inflatedOnSide(o,i,r,a,n),c=Xi.inflatedOnSide(o,i,r,e+a,n),h=this.getMaxConstraintPointsInsideLane(c),u=this.getMinConstraintPointsOutsideLane(c,n);if(h.length>0){const d=l.findClosestPointToLine(h,n);e=l.getDistanceFromLineToPoint(d,n)}else if(u.length>0){const d=l.findFurthestPointFromLine(u,n);e=l.getDistanceFromLineToPoint(d,n)}return e},getConstraintPaddingRelativeToHandleSide:function(t){const e=t<0?-1:1;return this.options.constraintsPadding*e},getMaxConstraintPointsInsideLane:function(t){return this.maxConstraintPoints.filter(e=>t.isPointInside(e))},getMinConstraintPointsOutsideLane:function(t,e){return this.minConstraintPoints.filter(n=>{const i=t.isPointToTheRightOfLine(n,e),r=t.isPointOnLine(n,e);return i||r})},findNeighbourLane:function(t,e,n){const i=[],r=n===Ge.Top;let s,o=e;for(;o;){const a=t[o],l=a.parentId,c=a.laneIndexWithinGroup;if(r?c===0:c===a.parentSublanesCount-1)l&&i.unshift(l),o=l;else{const u=r?c-1:c+1;s=this.getSublaneIdOfParent(t,l,u);break}}return{foundNeighbourLaneId:s,laneIdsPathToNeighbour:i}},getSublaneIdOfParent:function(t,e,n){return Object.keys(t).find(r=>{const s=t[r],o=s.parentId===e,a=s.laneIndexWithinGroup===n;return o&&a})},getIdsOfClosestSublanesToTheSide:function(t,e,n){const i=[];let r=e;for(;r;){const o=t[r].sublanesCount,a=n===Ge.Top?0:o-1,l=`${r}_${a}`;t[l]!==void 0?(i.unshift(l),r=l):r=void 0}return i},getMinConstraintsToEmbeds:function(t,e,n){const i=[],s=t.getBBox().center(),o=t.angle(),a=t.getLaneBBox(e),l=new Xi(a,s,o),c=t.getEmbeddedCells({deep:!0}),h=n===Ge.Left||n===Ge.Right;if(this.getEmbedPointsInsideLane(l,c,n).forEach(d=>i.push(d)),h&&c.length>0){const{leftMostPoint:d,rightMostPoint:f}=this.findLeftMostAndRightMostEmbedPoints(t,l,c);i.push(d),i.push(f)}return i},getMaxConstraintsToEmbeds:function(t,e,n){const i=[],r=t.angle(),s=t.metrics.lanes,o=t.getBBox().center(),a=t.getEmbeddedCells({deep:!0}),l=this.findNeighbourLane(s,e,Ge.Top).foundNeighbourLaneId,c=this.findNeighbourLane(s,e,Ge.Bottom).foundNeighbourLaneId;if(l!==void 0){const h=t.getLaneBBox(l),u=new Xi(h,o,r);this.getEmbedPointsInsideLane(u,a,n,{addOverflowingEmbedsOnlyOnHandleSide:!0}).forEach(f=>i.push(f))}if(c!==void 0){const h=t.getLaneBBox(c),u=new Xi(h,o,r);this.getEmbedPointsInsideLane(u,a,n,{addOverflowingEmbedsOnlyOnHandleSide:!0}).forEach(f=>i.push(f))}return i},getEmbedPointsInsideLane:function(t,e,n,i){const r=[];return e.forEach(s=>{const o=s.angle(),a=s.getBBox(),l=a.center();if(!s.isLink()){const c=this.getBBoxCornerPoints(a,l,o);this.isElementInsideLane(t,c,l,n,i)&&c.forEach(u=>r.push(u))}}),r},isElementInsideLane:function(t,e,n,i,r={}){const s=r.addOverflowingEmbedsOnlyOnHandleSide,o=t.isPointInsideOrOnLine(n);if(s){const a=this.getOppositeHandleSide(i),l=e.every(d=>t.isPointInsideOrOnLine(d));let c;const h=e.some(d=>{const f=t.isPointToTheLeftOfLine(d,a),p=t.isPointOnLine(d,a);return f||p}),u=e.some(d=>t.isPointToTheRightOfLine(d,a));return c=h&&u,o&&(l||c)}return o},getBBoxCornerPoints:function(t,e,n){const i=t.topLeft().rotate(e,-n).round(),r=t.topRight().rotate(e,-n).round(),s=t.bottomLeft().rotate(e,-n).round(),o=t.bottomRight().rotate(e,-n).round();return[i,r,s,o]},findLeftMostAndRightMostEmbedPoints:function(t,e,n){const i=t.angle(),r=t.getBBox(),s=r.center(),o=new Xi(r,s,i),a=[];n.forEach(u=>{if(!u.isLink()){const d=u.getBBox(),f=d.center(),p=u.angle();this.getBBoxCornerPoints(d,f,p).forEach(g=>a.push(g))}});const l=o.findFurthestPointFromLine(a,Ge.Left),c=this.getLeftMostPointCorrectedToPoolHeaders(t,l,o.left,e.left),h=o.findFurthestPointFromLine(a,Ge.Right);return{leftMostPoint:c,rightMostPoint:h}},getLeftMostPointCorrectedToPoolHeaders:function(t,e,n,i){const r=this.getTotalLaneHeadersWidth(t),s=t.metrics.padding.left,o=i.pointOffset(n.start)-s-r,a=n.closestPoint(e),l=new pt(a,e),c=l.length()+o;return l.setLength(c),l.end},getTotalLaneHeadersWidth:function(t){const e=t.metrics.lanes;let n=0;return Object.keys(e).forEach(i=>{let r=i,s=0;for(;r;){const o=t.metrics.lanes[r];s+=o.headerSize||0,r=o.parentId}n=s>n?s:n}),n}},{TransformHandle:Lm});function ch(t,...e){const n={};return e.forEach(i=>{if(Array.isArray(i))i.forEach(r=>{t&&t.hasOwnProperty(r)&&(n[r]=t[r])},n);else if(xt(i))for(const r in t){if(!t.hasOwnProperty(r))continue;const s=t[r];i(s,r)&&(n[r]=s)}}),n}function Mm(t){return Array.isArray(t)?t:[t]}const bc=hn.extend({defaults:{cmdBeforeAdd:null,cmdNameRegex:/^(?:add|remove|change:\w+)$/,applyOptionsList:["propertyPath"],revertOptionsList:["propertyPath"],storeReducedOptions:!0,stackLimit:1/0},PREFIX_LENGTH:7,initialize:function(t){ln(this,"initBatchCommand","storeBatchCommand"),this.graph=t.graph,this.reset(),this.listen()},listen:function(){this.listenTo(this.graph,"all",this.addCommand,this),this.listenTo(this.graph,"batch:start",this.initBatchCommand,this),this.listenTo(this.graph,"batch:stop",this.storeBatchCommand,this),this.listenTo(this.graph,"reset",this.reset,this)},createCommand:function(t){var e={action:void 0,data:{id:void 0,type:void 0,previous:{},next:{}},batch:t&&t.batch};return e},push:function(t,e){this.redoStack=[],t.batch?(this.lastCmdIndex=Math.max(this.lastCmdIndex,0),this.trigger("batch",t)):(this._push(this.undoStack,t),this.notifyStackChange("push",t,e),this.trigger("add",t))},_push:function(t,e){const{stackLimit:n=1/0}=this.attributes;t.push(e),t.length>n&&t.splice(0,t.length-n)},squashUndo:function(t){this.constructor.squashCommands(this.undoStack,t)},squashRedo:function(t){this.constructor.squashCommands(this.redoStack,t)},addCommand:function(t,e,n,i){if(i||(i={}),i.dry||!this.get("cmdNameRegex").test(t)||typeof this.get("cmdBeforeAdd")=="function"&&!this.get("cmdBeforeAdd").apply(this,arguments))return;var r=void 0,s=e instanceof li;if(this.batchCommand){r=this.batchCommand[Math.max(this.lastCmdIndex,0)];var o=s&&!r.graphChange||r.data.id!==e.id,a=r.action!==t;if(this.lastCmdIndex>=0&&(o||a)){var l=this.batchCommand.findIndex(function(u,d){return(s&&u.graphChange||u.data.id===e.id)&&u.action===t});l<0||t==="add"||t==="remove"?r=this.createCommand({batch:!0}):(r=this.batchCommand[l],this.batchCommand.splice(l,1)),this.lastCmdIndex=this.batchCommand.push(r)-1}}else r=this.createCommand({batch:!1});const{storeReducedOptions:c}=this.attributes;if(t==="add"||t==="remove"){r.action=t,r.data.id=e.id,r.data.type=e.attributes.type,r.data.attributes=_e({},e.toJSON()),r.options=c?this.reduceOptions(i):i,this.push(r,i);return}var h=t.substr(this.PREFIX_LENGTH);(!r.batch||!r.action)&&(r.action=t,r.data.previous[h]=be(e.previous(h)),r.options=c?this.reduceOptions(i):i,s?r.graphChange=!0:(r.data.id=e.id,r.data.type=e.attributes.type)),r.data.next[h]=be(e.get(h)),this.push(r,i)},reduceOptions:function(t){const{applyOptionsList:e,revertOptionsList:n}=this.attributes;return ch(t,e,n)},initBatchCommand:function(){this.batchCommand?this.batchLevel++:(this.batchCommand=[this.createCommand({batch:!0})],this.lastCmdIndex=-1,this.batchLevel=0)},storeBatchCommand:function(t){if(this.batchCommand&&this.batchLevel<=0){var e=this.constructor.filterBatchCommand(this.batchCommand);e.length>0&&(this.redoStack=[],this._push(this.undoStack,e),this.notifyStackChange("push",e,t),this.trigger("add",e)),this.batchCommand=null,this.lastCmdIndex=null,this.batchLevel=null}else this.batchCommand&&this.batchLevel>0&&this.batchLevel--},revertCommand:function(t,e){this.stopListening();var n;Array.isArray(t)?n=this.constructor.sortBatchCommand(t):n=[t];for(var i=this.graph,r=n.length-1;r>=0;r--){var s=n[r],o=U({commandManager:this.id||this.cid},e,ch(s.options,this.get("revertOptionsList")));switch(s.action){case"add":{const a=i.getCell(s.data.id);a&&a.remove(o);break}case"remove":{i.addCell(s.data.attributes,o);break}default:{const a=s.graphChange?i:i.getCell(s.data.id),l=s.action.substr(this.PREFIX_LENGTH);a.set(l,s.data.previous[l],o);break}}}this.listen()},applyCommand:function(t,e){this.stopListening();var n;Array.isArray(t)?n=this.constructor.sortBatchCommand(t):n=[t];for(var i=this.graph,r=0;r<n.length;r++){var s=n[r],o=s.graphChange?i:i.getCell(s.data.id),a=U({commandManager:this.id||this.cid},e,ch(s.options,this.get("applyOptionsList")));switch(s.action){case"add":i.addCell(s.data.attributes,a);break;case"remove":o.remove(a);break;default:var l=s.action.substr(this.PREFIX_LENGTH);o.set(l,s.data.next[l],a);break}}this.listen()},undo:function(t){var e=this.undoStack.pop();e&&(this.revertCommand(e,t),this.redoStack.push(e),this.notifyStackChange("undo",e,t))},redo:function(t){var e=this.redoStack.pop();e&&(this.applyCommand(e,t),this.undoStack.push(e),this.notifyStackChange("redo",e,t))},cancel:function(t){var e=this.undoStack.pop();e&&(this.revertCommand(e,t),this.redoStack=[],this.notifyStackChange("cancel",e,t))},reset:function(t){this.undoStack=[],this.redoStack=[],this.notifyStackChange("reset",null,t)},hasUndo:function(){return this.undoStack.length>0},hasRedo:function(){return this.redoStack.length>0},notifyStackChange:function(t,e,n={}){let i;e?i=[Mm(e),n]:i=[n],this.trigger(`stack:${t}`,...i),this.trigger("stack",n)},toJSON(){const{undoStack:t,redoStack:e}=this,n=this.exportBatchCommands(t),i=this.exportBatchCommands(e);return{undo:n,redo:i}},fromJSON(t,e){if(!t||!Array.isArray(t.undo)||!Array.isArray(t.redo))throw new Error("dia.CommandManager: JSON must contain undo and redo arrays.");this.undoStack=ke(t.undo),this.redoStack=ke(t.redo),this.notifyStackChange("reset",null,e)},exportBatchCommands:function(t){const{storeReducedOptions:e}=this.attributes;return t.map(n=>Mm(n).map(i=>{const r=be(i);return e||(r.options=this.reduceOptions(r.options)),ke(r)}))}},{squashCommands:function(t,e=1/0){const{length:n}=t;if(n<2)return;e=Math.min(n,e);const i=[];for(;e>0;){let s=t.pop();Array.isArray(s)||(s.batch=!0,s=[s]),i.unshift(...s),e--}const r=this.filterBatchCommand(i);return t.push(r),r},sortBatchCommand:function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n],r=null;if(i.action==="add"){for(var s=i.data.id,o=0;o<n;o++)if(t[o].data.id===s){r=o;break}}r!==null?e.splice(r,0,i):e.push(i)}return e},filterBatchCommand:function(t){for(var e=t.slice(),n=[];e.length>0;){var i=e.shift(),r=i.data.id;if(!(i.action==null||r==null&&!i.graphChange)){if(i.action==="add"){var s=e.findIndex(function(a){return a.action==="remove"&&a.data&&a.data.id===r});if(s>=0){e=e.filter(function(a,l){return l>s||a.data.id!==r});continue}}else if(i.action==="remove"){var o=e.findIndex(function(a){return a.action==="add"&&a.data&&a.data.id==r});if(o>=0){e.splice(o,1);continue}}else if(i.action.indexOf("change")===0&&Ie(i.data.previous,i.data.next))continue;n.push(i)}}return n}});bc.sortBatchCommands=bc.sortBatchCommand;bc.prototype.filterBatchCommand=function(t){return this.constructor.filterBatchCommand(t)};const hV=hn.extend({initialize:function(t){this._map={},this._commandManager=t.commandManager,this.listenTo(this._commandManager,"add",this._onCommand)},defaults:{cancelInvalid:!0},_onCommand:function(t){return Array.isArray(t)?t.find(function(e){return!this._validateCommand(e)},this):this._validateCommand(t)},_validateCommand:function(t){if(t.options&&t.options.validation===!1)return!0;var e;return ft(this._map[t.action]).forEach(function(n){var i=0;function r(s){var o=n[i++];try{if(o)o(s,t,r);else{e=s;return}}catch(a){r(a)}}r(e)}),e?(this.get("cancelInvalid")&&this._commandManager.cancel(),this.trigger("invalid",e),!1):!0},validate:function(t){var e=Array.prototype.slice.call(arguments,1);e.forEach(function(i){if(!xt(i))throw new Error(t+" requires callback functions.")});const n=this._map;return t.split(" ").forEach(i=>{let r=n[i];r||(r=n[i]=[]),r.push(e)}),this}}),dV=lr.extend({LOCAL_STORAGE_KEY:"joint.ui.Clipboard.cells",defaults:{useLocalStorage:!0,deep:!1,origin:"center",translate:{dx:20,dy:20}},constructor:function(t){lr.prototype.constructor.call(this,[],t),this.defaults=U({},this.defaults,t),this.cid=Pr()},copyElements:function(t,e,n){n=U({},this.defaults,n);const i=Array.isArray(t)?t:t.toArray();let r;n.deep?(r=[],i.forEach(o=>{r.push(o,...o.getEmbeddedCells({deep:!0}))})):r=i;const s=Je(Object.values(e.cloneSubgraph(r,n)),o=>o.attributes.z||0);return this.reset(s),n.useLocalStorage&&window.localStorage&&localStorage.setItem(this.LOCAL_STORAGE_KEY,JSON.stringify(this.toJSON())),r},cutElements:function(t,e,n){n=U({},this.defaults,n);var i=this.copyElements(t,e,n);const r=n.removeCellOptions||{};return r.clipboard=this.cid,e.startBatch("cut"),We(i,"remove",r),e.stopBatch("cut"),i},pasteCells:function(t,e){e=U({},this.defaults,e),e.useLocalStorage&&this.updateFromStorage(t);let n=t.maxZIndex();const i=this.toArray().map(o=>(n+=1,this.modifyCell(o,e,n))),r=e.addCellOptions||{};r.clipboard=this.cid;const s=Je(i,o=>o.isLink()?2:1);return t.startBatch("paste"),t.addCells(s,r),t.stopBatch("paste"),this.copyElements(this,t,e),s},pasteCellsAtPoint:function(t,e,n){n=U({},this.defaults,n),n.useLocalStorage&&this.updateFromStorage(t);const i=Je(Object.values(t.cloneSubgraph(this.toArray(),n)),d=>d.attributes.z||0),r=t.get("cells").cellNamespace,s=new li([],{cellNamespace:r});s.resetCells(i,{sort:!1});const o=this.getOriginPoint(i,s,n.origin);if(!o)return[];const a={dx:e.x-o.x,dy:e.y-o.y};n.translate=a;let l=t.maxZIndex();const c=this.toArray().map(d=>(l+=1,this.modifyCell(d,n,l))),h=n.addCellOptions||{};h.clipboard=this.cid;const u=Je(c,d=>d.isLink()?2:1);return t.startBatch("paste"),t.addCells(u,h),t.stopBatch("paste"),this.copyElements(i,s,n),u},isEmpty:function(t){if(t=U({},this.defaults,t),this.length>0)return!1;if(t.useLocalStorage){const e=this.getJSONFromStorage();if(e&&e.length)return!1}return!0},clear:function(t){t=U({},this.defaults,t),this.reset([]),t.useLocalStorage&&window.localStorage&&localStorage.removeItem(this.LOCAL_STORAGE_KEY)},modifyCell:function(t,e,n){if(t.set("z",n),t.isLink()&&e.link&&t.set(e.link),e.translate){const{dx:i,dy:r}=e.translate;t.translate(isFinite(i)?i:0,isFinite(r)?r:0)}return t.collection=null,t},updateFromStorage:function(t){const e=this.getJSONFromStorage();if(!e)return;const n={cells:e},i=t.get("cells").cellNamespace,r=new li([],{cellNamespace:i}).fromJSON(n,{sort:!1,dry:!0});this.reset(r.getCells())},getJSONFromStorage:function(){return window.localStorage&&JSON.parse(localStorage.getItem(this.LOCAL_STORAGE_KEY))||null},getOriginPoint:function(t,e,n){const i=e.getCellsBBox(t);return i?ns(i,n):null}}),Sn=q,Sa=ae.extend({className:"select-box",events:{"click .select-box-selection":"onToggle"},options:{options:[],width:void 0,openPolicy:"auto",target:null,keyboardNavigation:!0,selected:void 0,selectBoxOptionsClass:void 0,disabled:!1},init:function(){this.options.target=this.options.target||document.body,ln(this,"onOutsideClick","onOptionSelect"),Sn(document).on("click.selectBox",this.onOutsideClick),Sn.data.set(this.el,"view",this),this.options.selected===void 0?this.selection=ft(this.options.options).find(function(t){return t.selected===!0})||this.options.options[0]:this.selection=this.options.options[this.options.selected]},render:function(){return this.$el.empty(),this.$selection=null,this.renderSelection(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions();var t=this.options,e={selectBoxView:this,parentClassName:Qt(this,"className")||null,extraClassName:Qt(t,"selectBoxOptionsClass")||null,options:t.options};t.width&&(e.width=t.width),t.theme&&(e.theme=t.theme);var n=this.optionsView=new this.constructor.OptionsView(e);n.render(),this.listenTo(n,"option:select",this.onOptionSelect),this.listenTo(n,"option:hover",this.onOptionHover),this.listenTo(n,"options:mouseout",this.onOptionsMouseOut),this.$options=n.$el,this.$optionsArrow=n.$arrow,this.$target=Sn(t.target)},setOptions:function(t,e){this.options.options=t;let n=this.getSelectionValue(this.selection);!n&&e!=null&&(n=t[e].value);const i=this.options.options||[];for(let r=0;r<i.length;r++){const s=i[r];if(s.value===void 0&&s.content===n)return this.select(r);if(s.value!==void 0&&Ie(s.value,n))return this.select(r)}this.selection=null,this.renderSelection(),this.trigger("option:select"),this.selectByValue(n,null)},onOptionHover:function(t,e){this.trigger("option:hover",t,e)},onOptionsMouseOut:function(t){this.trigger("options:mouseout",t)},onOptionSelect:function(t,e){this.select(t,e)},removeOptions:function(){this.optionsView&&(this.stopListening(this.optionsView),this.optionsView.remove(),this.optionsView=null)},renderSelection:function(t){if(this.$selection||(this.$selection=Sn("<div/>").addClass("select-box-selection"),this.$el.append(this.$selection)),this.$selection.empty(),t){var e=this.constructor.OptionsView.prototype.renderOptionContent.call(void 0,t);this.$selection.append(e)}else if(this.options.placeholder){var n=Sn("<div/>").addClass("select-box-placeholder").html(this.options.placeholder);this.$selection.append(n)}},onToggle:function(t){this.toggle()},onOutsideClick:function(t){!this.el.contains(t.target)&&this.$el.hasClass("opened")&&this.close()},getSelection:function(){return this.selection},getSelectionValue:function(t){return t=t||this.selection,t&&(t.value===void 0?t.content:t.value)},getSelectionIndex:function(){return ft(this.options.options).findIndex((function(t){return t===this.selection}).bind(this))},select:function(t,e={}){this.selection=this.options.options[t],this.renderSelection(this.selection),this.trigger("option:select",this.selection,t,e),this.close()},selectByValue:function(t,e){for(var n=this.options.options||[],i=0;i<n.length;i++){var r=n[i];if(r.value===void 0&&r.content===t)return this.select(i,e);if(r.value!==void 0&&Ie(r.value,t))return this.select(i,e)}},isOpen:function(){return this.$el.hasClass("opened")},toggle:function(){this.isOpen()?this.close():this.open()},position:function(){var t=this.$(".select-box-selection"),e=t.outerHeight(),n=t.offset(),i=n.left,r=n.top,s=this.$options.outerHeight(),o={left:0,top:0};this.options.target!==document.body?(o=this.$target.offset(),o.width=this.$target.outerWidth(),o.height=this.$target.outerHeight(),o.left-=this.$target.scrollLeft(),o.top-=this.$target.scrollTop()):(o.width=Sn(window).width(),o.height=Sn(window).height());var a=i,l="auto",c=this.options.openPolicy;switch(c==="selected"&&!this.selection&&(c="auto"),c){case"above":l=r-s;break;case"coverAbove":l=r-s+e;break;case"below":l=r+e;break;case"coverBelow":l=r;break;case"selected":var h=this.$options.find(".selected").position();l=r-h.top;break;default:var u=r-this.$target.scrollTop()+s>o.top+o.height;l=u?r-s+e:r;break}a-=o.left,l-=o.top,this.$options.css({left:a,top:l})},open:function(){this.isDisabled()||(this.renderOptions(),this.$options.appendTo(this.options.target),this.$options.addClass("rendered"),this.position(),this.$el.addClass("opened"),this.respectWindowBoundaries(),this.alignOptionsArrow())},respectWindowBoundaries:function(){var t=this.calculateElOverflow(this.$options,this.$target),e={left:0,top:0};this.$options.outerWidth()<=this.$target.innerWidth()&&(t.left&&t.right||(t.left?e.left=t.left:t.right&&(e.left=-t.right))),this.$options.outerHeight()<=this.$target.innerHeight()&&(t.top&&t.bottom||(t.top?e.top=t.top:t.bottom&&(e.top=-t.bottom)));const n=parseFloat(this.$options.css("left"))||0,i=parseFloat(this.$options.css("top"))||0;this.$options.css({left:n+e.left,top:i+e.top})},alignOptionsArrow:function(){var t=this.$el[0].getBoundingClientRect(),e=this.$options[0].getBoundingClientRect(),n=t.left+t.width/2;n-=e.left,n-=this.$optionsArrow.outerWidth()/2,this.$optionsArrow.css({left:n})},close:function(){this.removeOptions(),this.$el.removeClass("opened"),this.trigger("close")},onRemove:function(){this.removeOptions(),Sn(document).off(".selectBox",this.onOutsideClick)},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.close(),this.$el.addClass("disabled")},onSetTheme:function(t,e){this.$options&&(t&&this.$options.removeClass(this.themeClassNamePrefix+t),this.$options.addClass(this.themeClassNamePrefix+e))},calculateElOverflow:function(t,e){e||(e=window),t instanceof Sn&&(t=t[0]),e instanceof Sn&&(e=e[0]);var n={},i=t.getBoundingClientRect(),r;if(e===window){var s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;r={width:s,height:o,left:0,top:0,right:s,bottom:o}}else r=e.getBoundingClientRect();return["left","top"].forEach(function(a){n[a]=Math.min(0,i[a]-r[a])}),["right","bottom"].forEach(function(a){n[a]=Math.min(0,r[a]-i[a])}),Kt(n,function(a,l){n[l]=Math.abs(Math.round(a))}),n}},{OptionsView:ae.extend({events:{"mouseover .select-box-option":"onOptionHover","click .select-box-option":"onOptionClick"},className:function(){var t=["select-box-options"],e=this.options.parentClassName;return e&&t.push(e),t.join(" ")},init:function(){ln(this,"onMouseout","onKeydown"),Sn(document).on({"keydown.selectBoxOptions":this.onKeydown,"mouseleave.selectBoxOptions mouseout.selectBoxOptions":this.onMouseout})},render:function(){var t=this.options.extraClassName;return t&&this.$el.addClass(t),this.options.width&&this.$el.css("width",this.options.width),ft(this.options.options).forEach(function(e,n){var i=this.renderOption(e,n);this.options.selectBoxView.selection===e&&i.addClass("selected hover"),this.$el.append(i)},this),this.$arrow=Sn("<div/>").addClass("select-box-options-arrow").appendTo(this.$el),this},renderOption:function(t,e){var n=this.renderOptionContent(t);return n.addClass("select-box-option"),n.data("index",e),n},renderOptionContent:function(t){var e=Sn("<div/>").addClass("select-box-option-content").html(t.content);return t.icon&&e.prepend(Sn("<img/>").addClass("select-box-option-icon").attr("src",t.icon)),e},select:function(t,e={}){this.trigger("option:select",t,e)},hover:function(t){var e=this.options.options[t];this.markOptionHover(t),this.trigger("option:hover",e,t)},onOptionClick:function(t){var e=this.getOptionIndex(t.target);this.select(e,{ui:!0})},onOptionHover:function(t){var e=this.getOptionIndex(t.target);this.hover(e)},onMouseout:function(t){this.trigger("options:mouseout",t)},onKeydown:function(t){var e=this.options.selectBoxView;if(e.options.keyboardNavigation&&e.isOpen()){var n;switch(t.which){case 39:case 40:n=1;break;case 38:case 37:n=-1;break;case 13:var i=this.getOptionHoverIndex();i>=0&&this.select(i);return;case 27:return e.close();default:return}t.preventDefault();var r=this.getOptionHoverIndex(),s=r+n,o=this.options.options;s<0&&(s=o.length-1),s>=o.length&&(s=0),this.hover(s)}},onRemove:function(){Sn(document).off(".selectBoxOptions")},markOptionHover:function(t){this.$el.find(".hover").removeClass("hover"),Sn(this.$el.find(".select-box-option")[t]).addClass("hover")},getOptionHoverIndex:function(){const t=this.el.querySelector(".select-box-option.hover");return Array.prototype.indexOf.call(t.parentNode.children,t)},getOptionIndex:function(t){return Number(t.closest(".select-box-option").dataset.index)}})}),uh=q,dw=Sa.extend({className:"select-box color-palette",position:function(){var t=this.$(".select-box-selection"),e=t.outerHeight(),n=t.offset(),i=n.left,r=n.top+e;if(this.options.target!==document.body){this.$target=this.$target||uh(this.options.target);var s=this.$target.offset();i-=s.left-this.$target.scrollLeft(),r-=s.top-this.$target.scrollTop()}this.$options.css({left:i,top:r})}},{OptionsView:Sa.OptionsView.extend({renderOptionContent:function(t){var e=uh("<div/>").addClass("select-box-option-content");return e.css("background-color",t.content),t.icon&&e.prepend(uh("<img/>").addClass("select-box-option-icon").attr("src",t.icon)),e}})}),Ol=q,fw=ae.extend({className:"context-toolbar",eventNamespace:"context-toolbar",events:{"click .tool":"onToolPointerdown","touchstart .tool":"onToolPointerdown"},options:{padding:20,autoClose:!0,vertical:!1,anchor:"top",position:"bottom",scale:1},documentEvents:{mousedown:"onDocumentPointerdown",touchstart:"onDocumentPointerdown"},init:function(){ln(this,"onDocumentPointerdown")},render:function(){const t=this.options,e=this.constructor;return e.opened&&e.close(),t.autoClose&&setTimeout(this.delegateAutoCloseEvents.bind(this),0),t.type&&(this.el.dataset.type=t.type),this.beforeMount(),this.getRoot().append(this.el),this.renderContent(),this.position(),this.scale(),e.opened=this,this},delegateAutoCloseEvents:function(){this.delegateDocumentEvents(),document.addEventListener("mousedown",this.onDocumentPointerdown,!0),document.addEventListener("touchstart",this.onDocumentPointerdown,!0)},undelegateAutoCloseEvents:function(){this.undelegateDocumentEvents(),document.removeEventListener("mousedown",this.onDocumentPointerdown,!0),document.removeEventListener("touchstart",this.onDocumentPointerdown,!0)},beforeMount:function(){this.$el.toggleClass("joint-vertical",!!this.options.vertical)},renderContent:function(){const t=Ol("<div/>").addClass("tools");this.options.tools&&ft(this.options.tools).forEach(function(e){var n;e.icon?n=Ol("<img/>").prop("src",e.icon):n=e.content;var i=Ol("<button/>").addClass("tool").html(n).data("action",e.action);e.attrs&&i.attr(e.attrs),t.append(i)}),this.$el.append(t)},getRoot:function(){return Ol(this.options.root||document.documentElement)[0]},position:function(){const{target:t,padding:e,position:n,anchor:i}=this.options,{$el:r}=this,s={x:0,y:0};if(k.toNode(t)!==void 0){const h=Xr(t),u=ns(h,n);s.x=u.x,s.y=u.y;const d=ns(new J().inflate(e),n);s.x+=d.x,s.y+=d.y}else{const h=new L(t);s.x=h.x,s.y=h.y}const o=r.outerWidth(),a=r.outerHeight(),l=ns(new J(0,0,o,a),i);s.x-=l.x,s.y-=l.y;const c=Xr(this.getRoot());s.x-=c.x,s.y-=c.y,r.css({left:s.x,top:s.y})},scale(){const{scale:t,anchor:e}=this.options;if(t){this.el.style.transform=`scale(${t}, ${t})`;const n=ex(e).split("-");n[0]==="corner"&&(n[0]="bottom",n[1]="right"),n[0]==="origin"&&(n[0]="top",n[1]="left"),n[1]==="middle"&&(n[1]=null),this.el.style.transformOrigin=`${n[0]} ${n[1]?n[1]:""}`}},onRemove:function(){this.undelegateAutoCloseEvents(),this.constructor.opened=void 0},onToolPointerdown:function(t){const e=t.currentTarget.dataset.action;e&&this.trigger("action:"+e,t)},onDocumentPointerdown:function(t){const{el:e,options:n}=this,{target:i}=n,r=t.target;k.toNode(i)!==void 0&&(!i||i.contains(r))||e.contains(r)||(this.constructor.close(),this.remove())}},{opened:void 0,close:function(){const{opened:t}=this;t&&(t.trigger("close"),t.remove(),this.opened=null)},update:function(){this.opened&&this.opened.position()}}),br=q,In=ae.extend({className:"dialog",events:{"click .bg":"action","click .btn-close":"action","click .controls button":"action","mousedown .titlebar":"onDragStart","touchstart .titlebar":"onDragStart"},options:{draggable:!1,closeButtonContent:"&times;",closeButton:!0,inlined:!1,modal:!0,width:0,title:"",buttons:null,type:"",content:null},init:function(){ln(this,"onDrag","onDragEnd"),this.buttons=this.options.buttons},render:function(){var t=br("<div/>").addClass("bg").data("action","close"),e=br("<div/>").addClass("fg"),n=br("<div/>").addClass("titlebar"),i=br("<div/>").addClass("body"),r=br("<button/>").addClass("btn-close").html(this.options.closeButtonContent).data("action","close"),s=br("<div/>").addClass("controls");if(this.$el.toggleClass("draggable",!!this.options.draggable),this.options.type&&(this.el.dataset.type=this.options.type),this.options.inlined&&this.$el.addClass("inlined"),this.options.modal&&this.$el.addClass("modal"),this.options.width&&e.css("width",this.options.width),this.options.title?n.append(this.options.title):n.addClass("empty"),this.options.content&&i.append(this.options.content),this.buttons){var o=[],a=[],l=[];this.buttons.forEach(function(c){var h=br("<button/>").addClass("control-button").html(c.content).data("action",c.action);c.position?c.position==="left"?(h.addClass(c.position),l.push(h)):c.position==="center"?(h.addClass(c.position),a.push(h)):(h.addClass(c.position),o.push(h)):o.push(h)}),o.reverse().forEach(function(c){s.append(c)}),l.forEach(function(c){s.append(c)}),a.forEach(function(c){s.append(c)})}return e.append(n,i,s),this.options.closeButton&&e.append(r),this.$el.empty().append(t,e),this},open:function(t){return this.delegateEvents(),this.on("action:close",this.close,this),br(t||document.body).append(this.render().el),this.$el.addClass("rendered"),this},close:function(){return this.remove(),this.trigger("close"),this},action:function(t){var e=t.target.closest("[data-action]"),n=e.dataset.action;n&&this.trigger("action:"+n)},onDragStart:function(t){if(this.options.draggable){t.preventDefault(),t=ot(t);const e=this.$el.find(".fg").offset();this.delegateDocumentEvents({mousemove:this.onDrag,touchmove:this.onDrag,mouseup:this.onDragEnd,touchend:this.onDragEnd},{dx:t.clientX-e.left,dy:t.clientY-e.top})}},onDrag:function(t){t=ot(t);const{data:e}=t;this.$(".fg").offset({top:t.clientY-e.dy,left:t.clientX-e.dx})},onDragEnd:function(){this.undelegateDocumentEvents()}}),pw=In.extend({className:In.prototype.className+" flash-message",options:_e({},In.prototype.options,{closeButton:!0,modal:!1,cascade:!0,closeAnimation:{delay:2e3,duration:200,easing:"ease-in-out",properties:{opacity:0}},openAnimation:{duration:200,easing:"ease-in-out",properties:{opacity:1}}}),init:function(){ln(this,"startCloseAnimation"),In.prototype.init.apply(this,arguments),this.on("close:animation:complete",this.close,this)},open:function(){In.prototype.open.apply(this,arguments);var t=this.$(".fg");return this._foregroundHeight=t.height(),this.addToCascade(),t.css("height",0),this.startOpenAnimation(),this.options.closeAnimation&&this.options.closeAnimation.delay&&setTimeout(this.startCloseAnimation,this.options.closeAnimation.delay),this},close:function(){return In.prototype.close.apply(this,arguments),this.removeFromCascade(),this},addToCascade:function(){if(this.options.cascade){var t=this.constructor.top;this.$(".fg").css("top",t),this.constructor.top+=this._foregroundHeight+this.constructor.padding}this.constructor.opened.push(this)},removeFromCascade:function(){if(this.options.cascade){for(var t=this.constructor.opened,e=!1,n=0;n<t.length;n++){var i=t[n];if(i.options.cascade&&e){var r=parseInt(i.$(".fg").css("top"),10);i.$(".fg").css("top",r-this._foregroundHeight-this.constructor.padding)}i===this&&(e=!0)}e&&(this.constructor.top-=this._foregroundHeight+this.constructor.padding)}this.constructor.opened=io(this.constructor.opened,this)},startCloseAnimation:function(){const{closeAnimation:t}=this.options,{properties:e}=t;this.$(".fg").animate(e,U({complete:()=>this.trigger("close:animation:complete")},Ze(t,"delay")))},startOpenAnimation:function(){const{openAnimation:t}=this.options,e=U({},t.properties,{height:this._foregroundHeight});this.$(".fg").animate(e,U({complete:()=>this.trigger("open:animation:complete")},t))}},{top:20,padding:15,opened:[],open:function(t,e,n){return n=n||{},new pw(U({title:e,type:"info",content:t},n)).open(n.target)},close:function(){We(this.opened,"close")}}),kl=q,gw=ae.extend({className:"free-transform",events:{"mousedown .resize":"startResizing","mousedown .rotate":"startRotating","touchstart .resize":"startResizing","touchstart .rotate":"startRotating"},DIRECTIONS:["nw","n","ne","e","se","s","sw","w"],POSITIONS:["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"],options:{cellView:void 0,rotateAngleGrid:15,resizeGrid:void 0,preserveAspectRatio:!1,minWidth:0,minHeight:0,maxWidth:1/0,maxHeight:1/0,allowOrthogonalResize:!0,resizeDirections:null,allowRotation:!0,clearAll:!0,clearOnBlankPointerdown:!0,usePaperScale:!1,padding:3},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup"},init:function(){var t=this.options;t.cellView?me(t,{cell:t.cellView.model,paper:t.cellView.paper,graph:t.cellView.paper.model}):t.paper&&t.cell&&me(t,{cellView:t.cell.findView(t.paper),graph:t.paper.model});const{paper:e,clearAll:n}=t;n&&this.constructor.clear(e),this.startListening(),e.$el.append(this.el),this.constructor.registerInstanceToPaper(this,e)},startListening:function(){const{cell:t,paper:e,graph:n,clearOnBlankPointerdown:i}=this.options;this.listenTo(t,"change:size change:position change:angle",this.onCellAttributeChange),this.listenTo(e,"transform",()=>this.requestUpdate()),this.listenTo(n,"reset",()=>this.remove()),this.listenTo(t,"remove",()=>this.remove()),i&&this.listenTo(e,"blank:pointerdown",()=>this.remove())},onCellAttributeChange:function(t,e,n){n.updateHandled||this.requestUpdate()},renderHandles:function(){const{options:t,POSITIONS:e}=this;var n=kl("<div/>").prop("draggable",!1),i=n.clone().addClass("rotate"),r=e.map(o=>n.clone().addClass("resize").data("position",o));const{resizeDirections:s}=t;Array.isArray(s)&&r.forEach((o,a)=>{s.includes(e[a])||o.css("display","none")}),this.$el.empty().append(r,i)},render:function(){const{options:t,$el:e}=this,{cell:n,preserveAspectRatio:i,allowRotation:r,allowOrthogonalResize:s}=t;e.data("type",n.get("type")),e.toggleClass("no-orthogonal-resize",i||!s),e.toggleClass("no-rotation",!r),this.renderHandles(),this.requestUpdate()},requestUpdate:function(t){const{UPDATE_PRIORITY:e,options:n}=this;n.paper.requestViewUpdate(this,1,e,t)},confirmUpdate:function(){this.update()},update:function(){this.options.usePaperScale?this.updateFrameScaled():this.updateFrameNoScale(),this.updateHandleDirections()},updateFrameScaled:function(){const{paper:t,cell:e,padding:n}=this.options,{left:i,right:r,top:s,bottom:o}=Ne(n);let{x:a,y:l,width:c,height:h}=e.getBBox().moveAndExpand({x:-i,y:-s,width:i+r,height:s+o});const u=e.angle(),d=t.matrix().translate(a,l).translate(c/2,h/2).rotate(u).translate(-c/2,-h/2),f=k.matrixToTransformString(d);this.$el.css({width:c,height:h,left:0,top:0,"transform-origin":"0 0",transform:f,"-webkit-transform":f,"-ms-transform":f})},updateFrameNoScale:function(){const{paper:t,cell:e,padding:n}=this.options,{left:i,right:r,top:s,bottom:o}=Ne(n),{a,d:l,e:c,f:h}=t.matrix(),u=e.getBBox(),d=e.angle();u.x*=a,u.x+=c,u.y*=l,u.y+=h,u.width*=a,u.height*=l,u.moveAndExpand({x:-i,y:-s,width:i+r,height:s+o});const f=`rotate(${d}deg)`;this.$el.css({width:u.width,height:u.height,left:u.x,top:u.y,"transform-origin":"50% 50%",transform:f,"-webkit-transform":f,"-ms-transform":f})},updateHandleDirections:function(){var t=this.options.cell.angle(),e=Math.floor(t*(this.DIRECTIONS.length/360));if(e!=this._previousDirectionsShift){var n=this.DIRECTIONS.slice(e).concat(this.DIRECTIONS.slice(0,e));Array.from(this.$(".resize").removeClass(this.DIRECTIONS.join(" "))).forEach(function(i,r){kl(i).addClass(n[r])}),this._previousDirectionsShift=e}},calculateTrueDirection:function(t){var e=this.options.cell,n=Qe(e.get("angle")),i=this.POSITIONS.indexOf(t);return i+=Math.floor(n*(this.POSITIONS.length/360)),i%=this.POSITIONS.length,this.POSITIONS[i]},startResizing:function(t){t.stopPropagation();const{options:e}=this,{cell:n,graph:i,paper:r}=e;i.startBatch("free-transform",{freeTransform:this.cid});var s=t.target.dataset.position,o=this.calculateTrueDirection(s),a=0,l=0;s.split("-").forEach(function(P){a={left:-1,right:1}[P]||a,l={top:-1,bottom:1}[P]||l});var c=this.toValidResizeDirection(s),h={"top-right":"bottomLeft","top-left":"corner","bottom-left":"topRight","bottom-right":"origin"}[c];const{minWidth:u,minHeight:d,maxWidth:f,maxHeight:p}=e,g=typeof u=="function"?u.call(this,n,this):u,v=typeof d=="function"?d.call(this,n,this):d,x=typeof f=="function"?f.call(this,n,this):f,S=typeof p=="function"?p.call(this,n,this):p,C={action:"resize",angle:n.angle(),resizeX:a,resizeY:l,selector:h,direction:c,relativeDirection:s,trueDirection:o,maxHeight:S,minHeight:v,maxWidth:x,minWidth:g,cellView:n.findView(r)};this.startOp(t.target),this.eventData(t,C),this.trigger(`${C.action}:start`,t),this.delegateDocumentEvents(null,t.data)},toValidResizeDirection:function(t){return{top:"top-left",bottom:"bottom-right",left:"bottom-left",right:"top-right"}[t]||t},startRotating:function(t){t.stopPropagation();const e=ot(t);this.options.graph.startBatch("free-transform",{freeTransform:this.cid});var n=this.options.cell.getBBox().center(),i=this.options.paper.snapToGrid({x:e.clientX,y:e.clientY});const r={action:"rotate",centerRotation:n,modelAngle:Qe(this.options.cell.get("angle")||0),startAngle:re(i).theta(n)};this.startOp(t.target),this.eventData(t,r),this.trigger(`${r.action}:start`,t),this.delegateDocumentEvents(null,t.data)},pointermove:function(t){var e=this.eventData(t);const{action:n,maxHeight:i,maxWidth:r,minHeight:s,minWidth:o,cellView:a}=e;if(n){t=ot(t);var l=this.options,c=l.cell,h=l.paper.snapToGrid({x:t.clientX,y:t.clientY}),u=l.paper.options.gridSize,d=l.resizeGrid||{},f=d.width||u,p=d.height||u;switch(n){case"resize":var g=c.getBBox(),v=re(h).rotate(g.center(),e.angle),x=v.difference(g[e.selector]()),S=e.resizeX?x.x*e.resizeX:g.width,C=e.resizeY?x.y*e.resizeY:g.height;if(S=ii(S,f),C=ii(C,p),S=Math.max(S,o||f),C=Math.max(C,s||p),S=Math.min(S,r),C=Math.min(C,i),l.preserveAspectRatio){var P=g.width*C/g.height,O=g.height*S/g.width;P>S?C=O:S=P}if(g.width!=S||g.height!=C){const m={freeTransform:this.cid,direction:e.direction,relativeDirection:e.relativeDirection,trueDirection:e.trueDirection,ui:!0,minWidth:o,minHeight:s,maxWidth:r,maxHeight:i,preserveAspectRatio:l.preserveAspectRatio};a.scalableNode&&(m.async=!1),c.resize(S,C,m)}break;case"rotate":var N=e.startAngle-re(h).theta(e.centerRotation);c.rotate(ii(e.modelAngle+N,l.rotateAngleGrid),!0,null,{freeTransform:this.cid});break}this.trigger(`${n}`,t)}},pointerup:function(t){this.undelegateDocumentEvents();const e=this.eventData(t);e.action&&(this.stopOp(),this.trigger(`${e.action}:stop`,t),this.options.graph.stopBatch("free-transform",{freeTransform:this.cid}))},onRemove:function(){gw.unregisterInstanceFromPaper(this,this.options.paper)},startOp:function(t){t&&(kl(t).addClass("in-operation"),this._elementOp=t),this.$el.addClass("in-operation"),this.options.paper.undelegateEvents()},stopOp:function(){this._elementOp&&(kl(this._elementOp).removeClass("in-operation"),this._elementOp=null),this.$el.removeClass("in-operation"),this.options.paper.delegateEvents()}},{instancesByPaper:{},clear:function(t){t.trigger("freetransform:create"),this.removeInstancesForPaper(t)},removeInstancesForPaper:function(t){We(this.getInstancesForPaper(t),"remove")},getInstancesForPaper:function(t){return this.instancesByPaper[t.cid]||{}},registerInstanceToPaper:function(t,e){this.instancesByPaper[e.cid]||(this.instancesByPaper[e.cid]={}),this.instancesByPaper[e.cid][t.cid]=t},unregisterInstanceFromPaper:function(t,e){this.instancesByPaper[e.cid]&&(this.instancesByPaper[e.cid][t.cid]=null)}}),Xo=q,fV={N:"n",NW:"nw",W:"w",SW:"sw",S:"s",SE:"se",E:"e",NE:"ne"};var mw=function(){this.options={handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElement"},icon:null},{name:"direction",position:"se",events:{pointerdown:"directionSwap"},icon:null}],bbox:function(t){const{paper:e}=t;return e.localToPaperPoint(t.getPointAtRatio(.5))},typeCssName:"type-link",tinyThreshold:-1,smallThreshold:-1,boxContent:!1}};mw.prototype.directionSwap=function(){var t=this.options.cellView.model;t.set({source:t.get("target"),target:t.get("source")},{halo:this.cid})};var sn=function(){this.options={handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElement"},icon:null},{name:"resize",position:"se",events:{pointerdown:"startResizing",pointermove:"doResize",pointerup:"stopBatch"},icon:null},{name:"clone",position:"n",events:{pointerdown:"startCloning",pointermove:"doClone",pointerup:"stopCloning"},icon:null},{name:"link",position:"e",events:{pointerdown:"startLinking",pointermove:"doLink",pointerup:"stopLinking"},icon:null},{name:"fork",position:"ne",events:{pointerdown:"startForking",pointermove:"doFork",pointerup:"stopForking"},icon:null},{name:"unlink",position:"w",events:{pointerdown:"unlinkElement"},icon:null},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"},icon:null}],bbox:function(t,e){return t.getBBox({useModelGeometry:e.options.useModelGeometry})},typeCssName:"type-element",tinyThreshold:40,smallThreshold:80,boxContent:function(t,e){var n=Hn("x: <%= x %>, y: <%= y %>, width: <%= width %>, height: <%= height %>, angle: <%= angle %>"),i=t.model,r=i.getBBox();return n({x:Math.floor(r.x),y:Math.floor(r.y),width:Math.floor(r.width),height:Math.floor(r.height),angle:Math.floor(i.get("angle")||0)})},magnet:function(t){return t.el},loopLinkPreferredSide:"top",loopLinkWidth:40,rotateAngleGrid:15,rotateEmbeds:!1,linkAttributes:{},smoothLinks:void 0}};sn.prototype.startLinking=function(t,e,n){this.startBatch();var i=this.options,r=i.paper,s=i.graph,o=this.createLinkConnectedToSource(t);o.set({target:{x:e,y:n}}).addTo(s,{validation:!1,halo:this.cid,async:!1}),r.undelegateEvents();var a=this._linkView=o.findView(r);a.startArrowheadMove("target",{whenNotAllowed:"remove"})};sn.prototype.startForking=function(t,e,n){var i=this.options,r=i.paper,s=i.graph;this.startBatch();const[o,...a]=this.cloneCell({fork:!0}),l=[o,...Je(a,f=>f.isLink())];s.addCells(l,{halo:this.cid,async:!1}),this.centerElementAtCursor(o,e,n);var c=this.createLinkConnectedToSource(t),h=o.findView(r),u=this.getElementMagnet(h,"target",t),d=this.getLinkEnd(h,u,t);c.set("target",d).addTo(s,{halo:this.cid,async:!1}),h.pointerdown(t,e,n),this.eventData(t,{cloneView:h})};sn.prototype.getElementMagnet=function(t,e,n){var i=this.options.magnet;if(xt(i)){var r=i.call(this,t,e,n);if(r instanceof SVGElement)return r}throw new Error("ui.Halo: magnet() has to return an SVGElement.")},sn.prototype.getLinkEnd=function(t,e,n){var i={id:t.model.id};if(e!==t.el){var r=t.findAttribute("port",e);r?i.port=r:i.selector=t.getSelector(e)}return i},sn.prototype.createLinkConnectedToSource=function(t){var e=this.options,n=e.paper,i=e.cellView,r=this.getElementMagnet(i,"source",t),s=this.getLinkEnd(i,r,t),o=n.getDefaultLink(i,r).set("source",s);return o.attr(e.linkAttributes),Ff(e.smoothLinks)&&o.set("smooth",e.smoothLinks),o},sn.prototype.startResizing=function(t){this.startBatch(),this._flip=[1,0,0,1,1,0,0,1][Math.floor(Qe(this.options.cellView.model.get("angle"))/45)]};sn.prototype.startRotating=function(t,e,n){this.startBatch();var i=this.options.cellView.model,r=i.getBBox().center(),s=[i];this.options.rotateEmbeds&&i.getEmbeddedCells({deep:!0}).reduce(function(o,a){return a.isElement()&&o.push(a),o},s),this.eventData(t,{center:r,elements:s,rotationStartAngles:s.map(function(o){return o.angle()}),clientStartAngle:new L(e,n).theta(r)})};sn.prototype.doResize=function(t,e,n,i,r){var s=this.options.cellView.model.get("size"),o=Math.max(s.width+(this._flip?i:r),1),a=Math.max(s.height+(this._flip?r:i),1);this.options.cellView.model.resize(o,a,{absolute:!0,halo:this.cid})};sn.prototype.doRotate=function(t,e,n){var i=this.eventData(t),r=i.clientStartAngle-new L(e,n).theta(i.center);i.elements.forEach(function(s,o){var a=i.rotationStartAngles[o],l=ii(a+r,this.options.rotateAngleGrid);s.rotate(l,!0,i.center,{halo:this.cid})},this)};sn.prototype.doClone=function(t,e,n){var i=this.eventData(t),r=i.cloneView;r&&r.pointermove(t,e,n)};sn.prototype.startCloning=function(t,e,n){const{options:i}=this,{paper:r}=i,{model:s}=r;this.startBatch();const[o,...a]=this.cloneCell({clone:!0}),l=[o,...Je(a,h=>h.isLink())];s.addCells(l,{halo:this.cid,async:!1}),this.centerElementAtCursor(o,e,n);const c=o.findView(r);c.pointerdown(t,e,n),this.eventData(t,{cloneView:c})};sn.prototype.centerElementAtCursor=function(t,e,n){var i=t.getBBox().center(),r=e-i.x,s=n-i.y;t.translate(r,s,{deep:!0,halo:this.cid})};sn.prototype.doFork=function(t,e,n){var i=this.eventData(t),r=i.cloneView;r&&r.pointermove(t,e,n)};sn.prototype.doLink=function(t,e,n){this._linkView&&this._linkView.pointermove(t,e,n)};sn.prototype.stopLinking=function(t,e,n){var i=this._linkView;if(i){i.pointerup(t,e,n);var r=i.model;r.hasLoop()&&this.makeLoopLink(r),this.triggerAction("link","add",r),this.stopBatch(),this._linkView=null}this.options.paper.delegateEvents()};sn.prototype.stopForking=function(t,e,n){var i=this.eventData(t),r=i.cloneView;r&&r.pointerup(t,e,n),this.stopBatch()};sn.prototype.stopCloning=function(t,e,n){var i=this.eventData(t),r=i.cloneView;r&&r.pointerup(t,e,n),this.stopBatch()};sn.prototype.unlinkElement=function(t){this.startBatch(),this.options.graph.removeLinks(this.options.cellView.model),this.stopBatch()};sn.prototype.makeLoopLink=function(t){const{loopLinkPreferredSide:e,loopLinkWidth:n,paper:i}=this.options,{width:r,height:s}=i.getComputedSize(),o=new J({x:0,y:0,width:r,height:s}),a=i.paperToLocalRect(this.options.cellView.getBBox());let l,c;mi([e,"top","bottom","left","right"]).find(function(d){let f,p=0,g=0;switch(d){case"top":f=new L(a.x+a.width/2,a.y-n),p=n/2;break;case"bottom":f=new L(a.x+a.width/2,a.y+a.height+n),p=n/2;break;case"left":f=new L(a.x-n,a.y+a.height/2),g=n/2;break;case"right":f=new L(a.x+a.width+n,a.y+a.height/2),g=n/2;break}return l=f.clone().offset(-p,-g),c=f.clone().offset(p,g),o.containsPoint(l)&&o.containsPoint(c)},this)&&t.set("vertices",[l,c],{halo:this.cid})};const pV=ae.extend({PIE_INNER_RADIUS:20,PIE_OUTER_RADIUS:50,className:"halo",events:{"mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown","mousedown .pie-toggle":"onPieTogglePointerDown","touchstart .pie-toggle":"onPieTogglePointerDown"},documentEvents:{mousemove:"pointermove",touchmove:"pointermove",mouseup:"pointerup",touchend:"pointerup"},options:{clearAll:!0,clearOnBlankPointerdown:!0,useModelGeometry:!1,clone:function(t,e){return t.clone().unset("z")},type:"surrounding",pieSliceAngle:45,pieStartAngleOffset:0,pieIconSize:14,pieToggles:[{name:"default",position:"e"}]},init:function(){var t=this.options,e=t.cellView,n=e.model,i=n.isLink()?new mw:new sn;U(this,Ze(i,"options"));var r=e.paper,s=r.model;me(t,i.options,{paper:r,graph:s}),ln(this,"render","update"),t.clearAll&&this.constructor.clear(r),this.listenTo(s,"reset",this.close),this.listenTo(n,"remove",this.close),this.listenTo(r,"halo:create",this.close),t.clearOnBlankPointerdown&&this.listenTo(r,"blank:pointerdown",this.close),this.listenTo(s,"all",this.update),this.listenTo(r,"transform",this.update),this.handles=[],ft(t.handles).forEach(this.addHandle,this)},render:function(){var t=this.options;switch(this.$el.empty(),this.$handles=Xo("<div/>").addClass("handles").appendTo(this.el),this.$box=Xo("<label/>").addClass("box").appendTo(this.el),this.$pieToggles={},this.$el.addClass(t.type),this.$el.addClass(this.cellTypeCssClass()),this.el.dataset.type=t.cellView.model.get("type"),this.$handles.append(ft(this.handles).map(this.renderHandle,this)),t.type){case"toolbar":case"surrounding":this.hasHandle("fork")&&this.toggleFork();break;case"pie":ft(this.options.pieToggles).forEach(function(e){var n=Xo("<div/>");n.addClass("pie-toggle "+(e.position||"e")),n.data("name",e.name),os(n,e.attrs),n.appendTo(this.el),this.$pieToggles[e.name]=n},this);break;default:throw new Error("ui.Halo: unknown type")}return this.update(),this.$el.addClass("animate").appendTo(t.paper.el),this.setPieIcons(),this},setPieIcons:function(){if(this.options.type!=="pie")return;const t=this.$el.find(".handle");for(let l=0;l<t.length;l++){const c=t[l];var e,n=Xo(c),i=c.dataset.action,r=this.getHandle(i);if(r&&r.icon)return;var s=window.getComputedStyle(c,":before").getPropertyValue("content");s&&s!=="none"&&(e=n.find(".slice-text-icon"),e.length>0&&k(e[0]).text(s.replace(/['"]/g,"")));const u=window.getComputedStyle(c).backgroundImage;if(u){var o=u.match(/url\(['"]?([^'"]+)['"]?\)/);if(o){var a=o[1];e=n.find(".slice-img-icon"),e.length>0&&k(e[0]).attr("xlink:href",a)}}}},update:function(){if(this.isRendered()){this.updateBoxContent();var t=this.getBBox();this.$el.toggleClass("tiny",t.width<this.options.tinyThreshold&&t.height<this.options.tinyThreshold),this.$el.toggleClass("small",!this.$el.hasClass("tiny")&&t.width<this.options.smallThreshold&&t.height<this.options.smallThreshold),this.$el.css({width:t.width,height:t.height,left:t.x,top:t.y}),this.hasHandle("unlink")&&this.toggleUnlink()}},getBBox:function(){var t=this.options.cellView,e=this.options.bbox,n=xt(e)?e(t,this):e;return n=me({},n,{x:0,y:0,width:1,height:1}),Ji(n)},cellTypeCssClass:function(){return this.options.typeCssName},updateBoxContent:function(){var t=this.options.boxContent,e=this.options.cellView;if(xt(t)){var n=t.call(this,e,this.$box[0]);n&&this.$box.html(n)}else t?this.$box.html(t):this.$box.remove()},extendHandles:function(t){Kt(t,(function(e){var n=this.getHandle(e.name);n&&U(n,e)}).bind(this))},addHandles:function(t){return ft(t).forEach(this.addHandle,this),this},addHandle:function(t){var e=this.getHandle(t.name);return e||(this.handles.push(t),Kt(t.events,(function(n,i){te(n)?this.on("action:"+t.name+":"+i,this[n],this):this.on("action:"+t.name+":"+i,n)}).bind(this)),this.$handles&&this.renderHandle(t).appendTo(this.$handles)),this},renderHandle:function(t){var e=this.getHandleIdx(t.name),n=Xo("<div/>").addClass("handle").addClass(t.name).data("action",t.name).prop("draggable",!1);switch(this.options.type){case"toolbar":case"surrounding":n.addClass(t.position),t.content&&n.html(t.content);break;case"pie":var i=this.PIE_OUTER_RADIUS,r=this.PIE_INNER_RADIUS,s=(i+r)/2,o=re(i,i),a=an(this.options.pieSliceAngle),l=e*a+an(this.options.pieStartAngleOffset),c=l+a,h=k.createSlicePathData(r,i,l,c),u=k("svg").addClass("slice-svg"),d=k("path").attr("d",h).translate(i,i).addClass("slice"),f=re.fromPolar(s,-l-a/2,o),p=this.options.pieIconSize,g=k("image").attr(f).addClass("slice-img-icon");f.y=f.y+p-2;var v=k("text",{"font-size":p}).attr(f).addClass("slice-text-icon");g.attr({width:p,height:p}),g.translate(-p/2,-p/2),v.translate(-p/2,-p/2),u.append([d,g,v]),n.append(u.node);break}return t.icon&&this.setHandleIcon(n,t.icon),os(n,t.attrs),n},setHandleIcon:function(t,e){switch(this.options.type){case"pie":var n=t.find(".slice-img-icon");k(n[0]).attr("xlink:href",e);break;case"toolbar":case"surrounding":t.css("background-image","url("+e+")");break}},removeHandles:function(){for(;this.handles.length;)this.removeHandle(this.handles[0].name);return this},removeHandle:function(t){var e=this.getHandleIdx(t),n=this.handles[e];return n&&(Kt(n.events,(function(i,r){this.off("action:"+t+":"+r)}).bind(this)),this.$(".handle."+t).remove(),this.handles.splice(e,1)),this},changeHandle:function(t,e){var n=this.getHandle(t);return n&&(this.removeHandle(t),this.addHandle(_e({name:t},n,e))),this},hasHandle:function(t){return this.getHandleIdx(t)!==-1},getHandleIdx:function(t){return ft(this.handles).findIndex(function(e){return e.name===t})},getHandle:function(t){return ft(this.handles).find(function(e){return e.name===t})},toggleHandle:function(t,e){var n=this.getHandle(t);if(n){var i=this.$(".handle."+t);e===void 0&&(e=!i.hasClass("selected")),i.toggleClass("selected",e);var r=e?n.iconSelected:n.icon;r&&this.setHandleIcon(i,r)}return this},selectHandle:function(t){return this.toggleHandle(t,!0)},deselectHandle:function(t){return this.toggleHandle(t,!1)},deselectAllHandles:function(){return ft(this.handles).forEach(function(t){this.deselectHandle(t.name)},this),this},onHandlePointerDown:function(t){var e=this._action=t.currentTarget.dataset.action;if(!e)return;t.preventDefault(),t.stopPropagation(),t=ot(t);const{x:n,y:i}=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY});this._localX=n,this._localY=i,this._evt=t,t.type==="mousedown"&&t.button===2?this.triggerAction(e,"contextmenu",t,n,i):(this.triggerAction(e,"pointerdown",t,n,i),this.delegateDocumentEvents(null,t.data))},onPieTogglePointerDown:function(t){t.stopPropagation();var e=t.target.closest(".pie-toggle"),n=e.dataset.name;this.isOpen(n)?this.toggleState(n):this.isOpen()?(this.toggleState(),this.toggleState(n)):this.toggleState(n)},triggerAction:function(t,e,n){var i=Array.prototype.slice.call(arguments,2);i.unshift("action:"+t+":"+e),this.trigger.apply(this,i)},stopBatch:function(){const{graph:t}=this.options;t.hasActiveBatch("halo")&&t.stopBatch("halo",{halo:this.cid})},startBatch:function(){this.options.graph.startBatch("halo",{halo:this.cid})},pointermove:function(t){if(this._action){t.preventDefault(),t.stopPropagation(),t=ot(t);var e=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY}),n=e.x-this._localX,i=e.y-this._localY;this._localX=e.x,this._localY=e.y,this._evt=t,this.triggerAction(this._action,"pointermove",t,e.x,e.y,n,i)}},pointerup:function(t){var e=this._action;if(e){this._action=null,this._evt=null;var n=this.options.paper.snapToGrid({x:t.clientX,y:t.clientY});this.triggerAction(e,"pointerup",t,n.x,n.y),this.undelegateDocumentEvents()}},onRemove:function(){this._action&&this._evt&&this.pointerup(this._evt),this.stopBatch()},close:function(){return this.closed||(this.closed=!0,this.remove(),this.trigger("close")),this},onSetTheme:function(){this.setPieIcons()},removeElement:function(){this.options.cellView.model.remove()},toggleUnlink:function(){var t=this.options.graph.getConnectedLinks(this.options.cellView.model).length>0;this.$handles.children(".unlink").toggleClass("hidden",!t)},toggleFork:function(){const t=this.canFork();this.$handles.children(".fork").toggleClass("hidden",!t)},canFork:function(){const{cellView:t,paper:e}=this.options,{validateConnection:n}=e.options;if(typeof n!="function")return!0;const[i]=this.cloneCell({fork:!0,validation:!0}),r=e.createViewForModel(i),s=n.call(e,t,null,r,null,"target");return r.remove(),s},cloneCell:function(t={}){const{cellView:e,clone:n}=this.options,i=n(e.model,t);if(i instanceof rn)return[i];if(Array.isArray(i)&&i.length>0&&i.every(r=>r instanceof rn))return i;throw new Error('ui.Halo: option "clone" has to return a cell.')},toggleState:function(t){if(this.isRendered()){var e=this.$el;if(Kt(this.$pieToggles,function(i){i.removeClass("open")}),this.isOpen())this.trigger("state:close",t),e.removeClass("open");else{if(this.trigger("state:open",t),t){var n=ft(this.options.pieToggles).find(function(i){return i.name===t});n&&(this.el.dataset.pieTogglePosition=n.position,this.el.dataset.pieToggleName=n.name),this.$pieToggles[t].addClass("open")}e.addClass("open")}}},isOpen:function(t){return this.isRendered()?t?this.$pieToggles[t].hasClass("open"):this.$el.hasClass("open"):!1},isRendered:function(){return this.$box!==void 0}},{clear:function(t){t.trigger("halo:create")},HandlePosition:fV}),Vr=q,ip=ae.extend({className:"select-button-group",events:{"click .select-button-group-button":"onSelect","mouseover .select-button-group-button":"onOptionHover",mouseleave:"onMouseOut","mousedown .select-button-group-button":"pointerdown","touchstart .select-button-group-button":"pointerdown","mouseup .select-button-group-button":"pointerup","touchend .select-button-group-button":"pointerup"},options:{options:[],disabled:!1,multi:!1,selected:void 0,singleDeselect:!1,noSelectionValue:void 0,width:void 0,buttonWidth:void 0,buttonHeight:void 0,iconWidth:void 0,iconHeight:void 0},init:function(){ln(this,"onSelect","pointerup"),Vr.data.set(this.el,"view",this);var t=this.options.options,e=this.options.multi,n=this.options.selected;if(n===void 0){var i=ft(t).filter(function(r){return r&&r.selected===!0});e?this.selection=i:this.selection=i[0]}else e?this.selection=Array.isArray(n)?t.filter(function(r,s){return n.includes(s)}):[t[n]]:this.selection=t[n]},render:function(){return this.renderOptions(this.selection),this.options.width&&this.$el.css("width",this.options.width),this.options.disabled&&this.disable(),this.$el.append(this.$options),this},renderOptions:function(){this.removeOptions(),ft(this.options.options).forEach(function(t,e){var n=this.options.multi?this.selection.includes(t):this.selection===t,i=this.renderOption(t,e,n);this.$el.append(i),n&&i.addClass("selected")},this)},removeOptions:function(){this.$el.empty()},renderOption:function(t,e,n){var i=this.renderOptionContent(t,n);i.data("index",e);var r=t.buttonWidth||this.options.buttonWidth;r&&i.css("width",r);var s=t.buttonHeight||this.options.buttonHeight;return s&&i.css("height",s),i},renderOptionContent:function(t,e){var n=Vr("<div/>").addClass("select-button-group-button").html(t.content);if(t.icon||e&&t.iconSelected){var i=Vr("<img/>").addClass("select-button-group-button-icon").attr("src",e&&t.iconSelected?t.iconSelected:t.icon),r=t.iconWidth||this.options.iconWidth;r&&i.css("width",r);var s=t.iconHeight||this.options.iconHeight;s&&i.css("height",s),n.prepend(i)}return os(n,t.attrs),n},setOptions:function(t,e){this.options.options=t,this.selection=e,this.render(),this.trigger("option:select",this.selection)},getOptionIndex:function(t){return Number(t.closest(".select-button-group-button").dataset.index)},onSelect:function(t){if(!this.isDisabled()){var e=this.getOptionIndex(t.target);this.select(e,{ui:!0})}},onOptionHover:function(t){if(!this.isDisabled()){var e=this.getOptionIndex(t.target);this.trigger("option:hover",this.options.options[e],e)}},onMouseOut:function(t){this.isDisabled()||this.trigger("mouseout",t)},getSelection:function(){return this.selection},getSelectionValue:function(t){t=t||this.selection;var e=this.options.noSelectionValue,n=this.options.multi;if(n){var i=ft(t);return i.length===0?e!==void 0?e:[]:i.map(function(s){var o=s.value;return o!==void 0?o:s.content})}if(!t)return e!==void 0?e:void 0;var r=t.value;return r!==void 0?r:t.content},select:function(t,e){var n=Vr(this.$(".select-button-group-button")[t]),i=this.options.options[t],r=null,s=null,o=null,a=null,l;if(this.options.multi)n.toggleClass("selected"),l=n.hasClass("selected"),l?(o=t,a=i,this.selection.indexOf(i)===-1&&this.selection.push(i),i.iconSelected&&n.find(".select-button-group-button-icon").attr("src",i.iconSelected)):(r=t,s=i,this.selection=io(this.selection,i),i.iconSelected&&n.find(".select-button-group-button-icon").attr("src",i.icon));else{var c=this.$(".selected");let d=-1;if(c.length>0){const[f]=c;d=Array.prototype.indexOf.call(f.parentNode.children,f)}var h=this.options.options[d];n.toggleClass("selected"),l=n.hasClass("selected"),l?(h&&(r=d,s=h,c.removeClass("selected"),h.iconSelected&&c.find(".select-button-group-button-icon").attr("src",h.icon)),o=t,a=i,this.selection=i,i.iconSelected&&n.find(".select-button-group-button-icon").attr("src",i.iconSelected)):this.options.singleDeselect?(r=t,s=i,this.selection=void 0,i.iconSelected&&n.find(".select-button-group-button-icon").attr("src",i.icon)):n.addClass("selected")}var u=U({},e);u.deselectedIndex=r,u.deselectedOption=s,u.selectedIndex=o,u.selectedOption=a,this.trigger("option:select",this.selection,t,u)},selectByValue:function(t,e){Array.isArray(t)||(t=[t]);for(var n=this.options.options||[],i=0;i<n.length;i++){var r=n[i];if(r.value===void 0&&t.includes(r.content))this.select(i,e);else if(r.value!==void 0){var s=t.find(function(o){return Ie(o,r.value)});s&&this.select(i,e)}}},deselect:function(){this.$(".selected").removeClass("selected"),this.options.multi?this.selection=[]:this.selection=void 0},isDisabled:function(){return this.$el.hasClass("disabled")},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},pointerdown:function(t){var e=this.getOptionIndex(t.target),n=Vr(this.$(".select-button-group-button")[e]);n.addClass("is-in-action"),Vr(document).on("mouseup.select-button-group touchend.select-button-group",this.pointerup)},pointerup:function(){this.$(".is-in-action").removeClass("is-in-action"),Vr(document).off("mouseup.select-button-group touchend.select-button-group")}}),vw=ae.extend({className:"radio-group",events:{"click input":"onOptionClick"},options:{options:[],name:void 0},currentValue:void 0,groupOptions:void 0,name:void 0,inputOptions:{},init:function(){this.groupOptions=this.options.options||[],this.name=this.options.name||this.cid},render:function(){return this.renderOptions(),this},renderOptions:function(){this.el.innerHTML="",this.inputOptions={},this.groupOptions.forEach((t,e)=>{this.renderOption(t,e)})},renderOption:function(t,e){const n=document.createElement("label");n.setAttribute("tabindex",0);const i=document.createElement("input");i.type="radio",i.value=t.value,i.name=this.name,n.appendChild(i),this.inputOptions[t.value]={input:i,index:e};const r=document.createElement("span");r.innerHTML=t.content,n.appendChild(r),this.el.appendChild(n)},getSelectionIndex:function(){return this.inputOptions[this.currentValue].index},getCurrentValue:function(){return this.currentValue},select:function(t){const e=this.groupOptions[t].value;e&&this.selectByValue(e)},selectByValue:function(t){const e=this.inputOptions[t];if(e){const n=e.input;n&&n.value!==this.currentValue&&(n.checked=!0,this.currentValue=n.value,this.trigger("option:select",this.currentValue,this))}},onOptionClick:function(t){const e=t.target;e.value!==this.currentValue&&this.selectByValue(e.value)},setOptions:function(t){this.groupOptions=t,this.renderOptions();const e=this.inputOptions[this.currentValue];e&&e.input?e.input.checked=!0:(this.currentValue=null,this.trigger("option:select",this.currentValue,this))}});class gV{constructor(){this.dependencies={}}subscribe(e,n){e.forEach(i=>{const r=i.path;this.dependencies[r]||(this.dependencies[r]=[]),this.dependencies[r].push({callback:n,dependency:i})})}changed(e){Object.getOwnPropertyNames(this.dependencies).filter(r=>this.isSubPathOrSuperPath(r,e)).forEach(r=>{this.dependencies[r].forEach(s=>{s.callback(s.dependency,e)})})}clear(){this.dependencies={}}isSubPathOrSuperPath(e,n){const i=e.split("/"),r=n.split("/");return i.length>r.length?!r.some((s,o)=>!Ie(s,i[o])):!i.some((s,o)=>!Ie(s,r[o]))}}class mV{constructor(e,n,i){this.inspector=e,this.dependencyService=n,this.sources={},this.options=i||{}}add(e,n,i){if(this.sources[e]={sourceOption:n,updateFunction:i,initialized:!1},n.dependencies){const r=n.dependencies.map(s=>({name:s,path:this.resolveDependency(e,s)}));this.dependencyService.subscribe(r,(s,o)=>{const a={};a[s.name]={path:s.path,changedPath:o},this.refresh(e,{dependencies:a})})}}initSources(){for(const e in this.sources){const n=this.sources[e];n.initialized||(this.refresh(e,{initialized:!0}),n.initialized=!0)}}refresh(e,n={}){const i=this.sources[e];if(i){const r=this.inspector.getModel(),s=n.dependencies||{};i.sourceOption.dependencies&&i.sourceOption.dependencies.forEach(a=>{const l=this.resolveDependency(e,a);s[a]||(s[a]={path:l,changedPath:null}),s[a].value=r.prop(l)});const o=i.sourceOption.source({dependencies:s,inspector:this.inspector,model:r,initialized:!!n.initialized,path:e});o instanceof Promise?o.then(a=>{i.updateFunction(a)}).catch(a=>{console.error("Inspector source resolving: "+a)}):i.updateFunction(o)}}refreshAll(){for(const e in this.sources)this.refresh(e)}resolveDependency(e,n){const i=this.options.wildcard,r=n.split("/"),s=e.split("/");return r.reduce((o,a,l)=>a===i?o+s[l]+"/":o+a+"/","").slice(0,-1)}clear(){this.sources={}}}const At=q;function Dm(t,e){const n=[];for(let i=0;i<t.length;i++){const r=t[i];r.matches(e)||n.push(r)}return n}const na=ae.extend({className:"inspector",options:{cellView:void 0,cell:void 0,live:!0,validateInput:function(t,e,n,i){return t.validity?t.validity.valid:!0},renderFieldContent:void 0,renderLabel:void 0,focusField:void 0,operators:{},multiOpenGroups:!0,container:null,stateKey:function(t){return t.id}},events:{"change [data-attribute]:not([data-custom-field])":"onChangeInput","click .group-label":"onGroupLabelClick","click .btn-list-add":"addListItem","click .btn-list-del":"deleteListItem","mousedown .field":"pointerdown","touchstart .field":"pointerdown","focusin .field":"pointerfocusin","focusout .field":"pointerfocusout"},HTMLEntities:{lt:"<",gt:">",amp:"&",nbsp:" ",quot:'"',cent:"¢",pound:"£",euro:"€",yen:"¥",copy:"©",reg:"®"},init:function(){var t=this.options.groups=this.options.groups||{};ln(this,"stopBatchCommand","pointerup","onContentEditableBlur","replaceHTMLEntity"),this.DEFAULT_PATH_WILDCARD="${index}",this.pathWildcard=this.options.pathWildcard,this.widgets={},this._byPath={},this._attributeKeysInUse=[],this.flatAttributes=this.flattenInputs(this.options.inputs),this.expandAttributes=this.expandAttrs(this.options.inputs||{}),this._when={},this.dependencyService=new gV,this.sourceService=new mV(this,this.dependencyService,{wildcard:this.pathWildcard||this.DEFAULT_PATH_WILDCARD});var e=Object.keys(this.flatAttributes).map(function(s){var o=this.flatAttributes[s];return this._registerDependants.call(this,o,s),o.path=s,o},this);for(var n in t){var i=t[n];i&&t.hasOwnProperty(n)&&this.extractExpressionPaths(i.when).forEach(function(s){this._when[s]||(this._when[s]=[])},this)}var r=Je(e,"index");this.groupedFlatAttributes=Je(r,(function(s){var o=this.options.groups[s.group];return o&&o.index||Number.MAX_VALUE}).bind(this)),this.listenTo(this.getModel(),"all",this.onCellChange,this)},_registerDependants:function(t,e){if(t.when){const n=t.when,i={expression:n,path:e};this.extractExpressionPaths(n).forEach(function(r){(this._when[r]||(this._when[r]=[])).push(i)},this)}this._registerNestedDependants.call(this,t,e)},_registerNestedDependants:function(t,e){const n=Array.isArray(e)?e:e.split("/");if(t.type==="object"&&t.properties){const i=t.properties;Object.keys(i).forEach(function(r){const s=i[r],o=n.concat(r);this._registerDependants(s,o)},this)}else if(t.type==="list"&&t.item){const i=t.item,r=n.concat(null);this._registerDependants(i,r)}else typeof t.type!="string"&&Object.keys(t).forEach(function(i){const r=t[i];if(typeof r=="object"){const s=n.concat(i);this._registerDependants(r,s)}},this)},cacheInputs:function(){var t={};Array.from(this.$("[data-attribute]")).forEach(function(e){var n=e.dataset.attribute;t[n]=At(e)},this),this._byPath=t,this._attributeKeysInUse=this.getAttributeKeysInUse()},updateGroupsVisibility:function(){for(var t=this.$groups,e=0,n=t.length;e<n;e++){var i=At(t[e]),r=i.data("name"),s=this.options.groups[r],o=i.find(":scope > .field:not(.hidden)").length===0;i.toggleClass("empty",o);var a=!!(s&&s.when&&!this.isExpressionValid(s.when));i.toggleClass("hidden",a)}},expandAttrs:function(t){for(var e={},n=Object.keys(t),i=0;i<n.length;i++){var r=n[i],s=t[r],o=r.split("/");so(e,o,Ee(s)?this.expandAttrs(s):s)}return e},flattenInputs:function(t){return Hf(t,"/",function(e){return typeof e.type=="string"})},getModel:function(){return this.options.cell||this.options.cellView.model},onCellChange:function(t,e,n,i){if(i=i||{},i.inspector!=this.cid)switch(t){case"remove":this.constructor.instance&&this.trigger("close"),this.remove();break;case"change:position":this.updateInputPosition();break;case"change:size":this.updateInputSize();break;case"change:angle":this.updateInputAngle();break;case"change:source":case"change:target":case"change:vertices":break;default:var r="change:";if(t.slice(0,r.length)===r){var s=t.slice(r.length);this._attributeKeysInUse.includes(s)?this.render({refresh:!0}):this.dependencyService.changed(s)}break}},render:function(t){var e=t&&t.refresh;e&&this.options.storeGroupsState&&this.storeGroupsState(),this.sourceService.clear(),this.dependencyService.clear(),this.$el.empty(),this.removeWidgets();var n,i=[],r;return this.groupedFlatAttributes.forEach(function(s){if(n!==s.group){var o=this.options.groups[s.group];r=At(this.renderGroup({name:s.group,label:o&&o.label})),e||(o&&o.closed?this.closeGroup(r,{init:!0}):this.openGroup(r,{init:!0})),i.push(r)}this.renderTemplate(r,s,s.path),n=s.group},this),this.$document=At(this.el.ownerDocument),this.$groups=At(i),this.$el.append(i),e&&this.options.restoreGroupsState&&this.restoreGroupsState(),this.afterRender(),this},getAttributeKeysInUse:function(){var t=Object.keys(this._byPath).map(function(i){return i.substring(0,i.indexOf("/"))||i}),e=ft(this._bound),n=Object.keys(this._when);return mi([].concat(t,e,n))},getCellAttributeValue:function(t,e){var n=this.getModel(),i=fn(n.attributes,t,"/");if(e=e||this.flatAttributes[t],!e)return i;if(i===void 0&&e.defaultValue!==void 0&&(i=e.defaultValue),e.valueRegExp){if(i===void 0)throw new Error("Inspector: defaultValue must be present when valueRegExp is used.");var r=i.match(new RegExp(e.valueRegExp));i=r&&r[2]}return i},resolvableTypes:["select","select-box","color-palette","select-button-group","radio-group"],resolveBindings:function(t){if(this.resolvableTypes.indexOf(t.type)>-1){var e=t.options||[];if(te(e)){const n=e;e={dependencies:[n],source:i=>{const{value:r}=i.dependencies[n];return Array.isArray(r)?r.map(s=>te(s)?{value:s,content:s}:s):[]}}}Array.isArray(e)&&!Nt(e[0])&&(e=ft(e).map(function(n){return{value:n,content:n}})),e.source?(t._optionsSource=e,t.items=[]):t.items=e}},renderFieldContent:function(t,e,n){var i;if(xt(this.options.renderFieldContent)&&(i=At(this.options.renderFieldContent(t,e,n,this)),i))return i.data("attribute",e),i.data("type",t.type),i.data("customField",!0),i.toArray();var r,s,o,a;switch(t.type){case"select-box":s=ft(t.items).findIndex(function(d){var f=d.value,p=n;if(f===void 0&&d.content===p)return!0;var g=t.key;return g&&(p=fn(p,g,"/"),f=fn(f,g,"/")),Ie(f,p)});var l=U({theme:this.options.theme,target:this.options.container},Ze(t,"type","group","index","selectBoxOptionsClass","options"),{options:t.items,selected:s,selectBoxOptionsClass:[En("inspector-select-box-options"),t.selectBoxOptionsClass].filter(function(d){return!!d}).join(" ")});r=new Sa(l),r.el.dataset.attribute=e,r.el.dataset.type=t.type,r.el.dataset.overwrite=t.overwrite,r.render(),a=At(this.renderOwnLabel(t,e)),i=At("<div/>").append(a,r.el),t.previewMode?(o=r.selection,r.on("options:mouseout close",function(){r.selection=o,this.processInput(r.el,{previewCancel:!0,dry:!0})},this),r.on("option:hover",function(d,f){r.selection=d,this.processInput(r.el,{dry:!0})},this),r.on("option:select",function(d,f){var p=o===void 0?void 0:r.getSelectionValue(o),g=r.getSelectionValue(d),v=p===g;this.processInput(r.el,{previewDone:!0,dry:v,originalValue:p}),o=d},this)):r.on("option:select",function(d,f){this.processInput(r.el)},this),t._optionsSource&&this.sourceService.add(e,t._optionsSource,d=>{const f=this.getModel().prop(e);let p=d.findIndex(g=>{var v=g.value,x=f;if(v===void 0&&g.content===x)return!0;var S=t.key;return S&&(x=fn(x,S,"/"),v=fn(v,S,"/")),Ie(v,x)});p===-1&&(p=void 0),r.setOptions(d,p)}),this.widgets[e]=r;break;case"color-palette":s=ft(t.items).findIndex(function(d){return d.value===n||d.value===void 0&&d.content===n});var c=U({theme:this.options.theme,target:this.options.container},Ze(t,"type","group","index","options"),{options:t.items,selected:s});r=new dw(c),r.el.dataset.attribute=e,r.el.dataset.type=t.type,r.render(),a=At(this.renderOwnLabel(t,e)),i=At("<div/>").append(a,r.el),t.previewMode?(o=r.selection,r.on("options:mouseout close",function(){r.selection=o,this.processInput(r.el,{previewCancel:!0,dry:!0})},this),r.on("option:hover",function(d,f){r.selection=d,this.processInput(r.el,{dry:!0})},this),r.on("option:select",function(d,f){var p=o===void 0?void 0:r.getSelectionValue(o),g=r.getSelectionValue(d),v=p===g;this.processInput(r.el,{previewDone:!0,dry:v,originalValue:p}),o=d},this)):r.on("option:select",function(d,f){this.processInput(r.el)},this),t._optionsSource&&this.sourceService.add(e,t._optionsSource,d=>{const f=this.getModel().prop(e);let p=d.findIndex(g=>g.value===f||g.value===void 0&&g.content===f);p===-1&&(p=void 0),r.setOptions(d,p)}),this.widgets[e]=r;break;case"select-button-group":{var h=(d,f)=>{var p,g,v=ft(d);return t.multi?(p=[],g=[],v.forEach(function(x,S){var C=x.value===void 0?x.content:x.value,P=t.key;P&&(C=fn(C,P,"/"));var O=ft(f).find(function(N){return P&&(N=fn(N,P,"/")),Ie(C,N)});O&&(g.push(x),p.push(S))})):(g=void 0,p=v.findIndex(function(x){var S=x.value,C=f;if(S===void 0&&x.content===C)return!0;var P=t.key;return P&&(C=fn(C,P,"/"),S=fn(S,P,"/")),Ie(S,C)}),p>-1&&(g=v[p])),{selectedIndex:p,selected:g}},u=U({theme:this.options.theme},Ze(t,"type","group","index","options"),{options:t.items,selected:h(t.items,n).selectedIndex});r=new ip(u),r.el.dataset.attribute=e,r.el.dataset.type=t.type,r.el.dataset.overwrite=t.overwrite,r.render(),a=At(this.renderOwnLabel(t,e)),i=At("<div/>").append(a,r.el),t.previewMode?(o=r.selection,r.on("mouseout",function(){r.selection=o,this.processInput(r.el,{previewCancel:!0,dry:!0})},this),r.on("option:hover",function(d,f){t.multi?r.selection=mi(r.selection.concat([d])):r.selection=d,this.processInput(r.el,{dry:!0})},this),r.on("option:select",function(d,f){var p=o===void 0?void 0:r.getSelectionValue(o),g=r.getSelectionValue(d),v=Ie(p,g);this.processInput(r.el,{previewDone:!0,dry:v,originalValue:p}),o=d},this)):r.on("option:select",function(d,f){this.processInput(r.el)},this),t._optionsSource&&this.sourceService.add(e,t._optionsSource,d=>{const f=this.getModel().prop(e);var p=h(d,f).selected;r.setOptions(d,p)}),this.widgets[e]=r;break}case"radio-group":{const d=U({theme:this.options.theme},Ze(t,"type","group","index","options"),{options:t.items,name:e}),f=new vw(d);f.render(),f.el.setAttribute("data-attribute",e),f.el.setAttribute("data-type",t.type),t.overwrite&&f.el.setAttribute("data-overwrite",t.overwrite),a=At(this.renderOwnLabel(t,e)),i=At("<div/>").append(a,f.el),f.selectByValue(n),f.on("option:select",p=>{this.processInput(f.el)}),t._optionsSource&&this.sourceService.add(e,t._optionsSource,p=>{f.setOptions(p)}),this.widgets[e]=f;break}default:return this.renderOwnFieldContent({options:t,type:t.type,overwrite:t.overwrite,label:t.label||e,attribute:e,value:n})}return i.toArray()},renderGroup:function(t){const e=document.createElement("div");e.classList.add("group"),e.dataset.name=t.name;const n=document.createElement("h3");return n.classList.add("group-label"),n.textContent=t.label||t.name,e.appendChild(n),e},renderOwnLabel:function(t,e){var n,i=this.options.renderLabel;return typeof i=="function"&&(n=i(t,e,this)),n!==void 0?At(n).toArray():At("<label/>").html(t.label||e).toArray()},renderOwnFieldContent:function(t){var e,n,i,r,s,o,a,l;switch(l=At(this.renderOwnLabel(t.options,t.attribute)),t.type){case"number":n=At("<input/>").attr({type:"number",min:t.options.min,max:t.options.max,step:t.options.step}).val(t.value),e=[l,At("<div/>").addClass("input-wrapper").append(n)];break;case"range":l.addClass("with-output"),r=At("<output/>").text(t.value),s=At("<span/>").addClass("units").text(t.options.unit),n=At("<input/>").attr({type:"range",name:t.type,min:t.options.min,max:t.options.max,step:t.options.step}).val(t.value),n.on("change input",function(){r.text(n.val())}),e=[l,r,s,n];break;case"textarea":n=At("<textarea/>").text(t.value),e=[l,At("<div/>").addClass("input-wrapper").append(n)];break;case"content-editable":{const{value:u,options:d={}}=t,{html:f=!0,readonly:p=!1}=d;let g;te(u)?g=(f?ox(u):this.encodeHTMLEntities(u)).replace(/\n/g,"<br>"):g="",n=At("<div/>").prop("contentEditable",!p).toggleClass("content-editable-readonly",!!p).css("display","inline-block").html(g).on("blur",this.onContentEditableBlur),e=[l,At("<div/>").addClass("input-wrapper").append(n)];break}case"select":var c=t.options.items;n=At("<select/>"),t.options.multiple&&(n.prop("size",t.options.size||c.length),n.prop("multiple",!0));var h=function(u){return t.options.multiple?ft(t.value).find(function(d){return Ie(u,d)}):Ie(u,t.value)};ft(c).forEach(function(u){var d=At("<option/>").text(u.content).val(u.value);h(u.value)&&d.attr("selected","selected"),n.append(d)}),t.options._optionsSource&&this.sourceService.add(t.attribute,t.options._optionsSource,u=>{n.empty();const d=this.getModel().prop(t.attribute),f=p=>t.options.multiple?ft(d).find(function(g){return Ie(p,g)}):Ie(p,d);u.forEach(p=>{var g=At("<option/>",{value:p.value}).text(p.content);f(p.value)&&g.attr("selected","selected"),n.append(g)})}),e=[l,n];break;case"toggle":o=At("<span><i/></span>"),n=At("<input/>").attr("type","checkbox").prop("checked",!!t.value),i=At("<div/>").addClass(t.type),e=[l,i.append(n,o)];break;case"color":n=At("<input/>").attr("type","color").val(t.value),e=[l,n];break;case"text":n=At("<input/>").attr("type","text").val(t.value),e=[l,At("<div/>").addClass("input-wrapper").append(n)];break;case"object":n=At("<div/>"),a=At("<div/>").addClass("object-properties"),e=[l,n.append(a)];break;case"list":o=At("<button/>").addClass("btn-list-add").text(t.options.addButtonLabel||"+"),a=At("<div/>").addClass("list-items"),n=At("<div/>"),e=[l,n.append(o,a)];break}if(n&&n.length>0){n.addClass(t.type);const[u]=n;u.dataset.type=t.type,u.dataset.attribute=t.attribute,u.dataset.overwrite=t.overwrite}return e.map(u=>u.toArray()).flat()},onContentEditableBlur:function(t){var e=At("<input/>").prop("disabled",!0).prop("tabIndex",-1).css({width:"1px",height:"1px",border:"none",margin:0,padding:0}).appendTo(this.$el);const[n]=e;n.focus(),n.setSelectionRange(0,0),n.blur(),e.remove(),t.target.dispatchEvent(new CustomEvent("change",{bubbles:!0}))},replaceHTMLEntity:function(t,e){return this.HTMLEntities[e]||""},encodeHTMLEntities:function(t){return t.replace(/[\u00A0-\u9999<>&]/g,function(e){return`&#${e.charCodeAt(0)};`})},renderObjectProperty:function(t={}){const e=document.createElement("div");return e.classList.add("object-property"),e.dataset.property=t.property,e},renderListItem:function(t={}){const e=document.createElement("button");e.classList.add("btn-list-del"),e.textContent=t.options.removeButtonLabel||"-";const n=document.createElement("div");return n.classList.add("list-item"),n.dataset.index=t.index,n.appendChild(e),n},renderFieldContainer:function(t={}){const e=document.createElement("div");return e.classList.add("field"),e.classList.add(`${t.type}-field`),e.dataset.field=t.path,e},renderTemplate:function(t,e,n,i){const r=At(t||this.el);i=i||{},this.resolveBindings(e),typeof e.type!="string"&&(e={type:"object",properties:e});const s=At(this.renderFieldContainer({path:n,type:e.type}));i.hidden&&s.addClass("hidden");const o=this.getCellAttributeValue(n,e),a=At(this.renderFieldContent(e,n,o));if(s.append(a),os(s,e.attrs),e.type==="list"&&e.item){ft(o).forEach(function(u,d){const f=this.renderListItem({index:d,options:e});this.renderTemplate(f,e.item,n+"/"+d),a.children(".list-items").append(f)},this);const l=o&&o.length,c=e&&e.min,h=e&&e.max;this.fixListButtons(a,l,c,h)}else if(e.type==="object"&&e.properties){const l=this.flattenInputs(e.properties);let c=Object.keys(l).map(function(h){const u=l[h];return u.path=h,u});c=Je(c,function(h){return h.index}),c.forEach(function(h){const u=this.renderObjectProperty({property:h.path});this.renderTemplate(u,h,n+"/"+h.path),a.children(".object-properties").append(u)},this)}if(i.replace){const[l]=r.find('[data-field="'+n+'"]');l&&s.length>0&&l.parentNode.replaceChild(s[0],l)}else r.append(s)},updateInputPosition:function(){var t=this._byPath["position/x"],e=this._byPath["position/y"],n=this.getModel().get("position");t&&t.val(n.x),e&&e.val(n.y)},updateInputSize:function(){var t=this._byPath["size/width"],e=this._byPath["size/height"],n=this.getModel().get("size");t&&t.val(n.width),e&&e.val(n.height)},updateInputAngle:function(){var t=this._byPath.angle,e=this.getModel().get("angle");t&&t.val(e)},validateInput:function(t,e,n){switch(t){case"select-box":case"color-palette":var i=this.widgets[n];return i?i.getSelectionIndex()!==-1:!1;case"select-button-group":return!!this.widgets[n];default:return this.options.validateInput(e,n,t,this)}},refreshSources:function(){this.sourceService.refreshAll()},refreshSource:function(t){this.sourceService.refresh(t)},focusField:function(t){const e=this.getOptionsFromPath(t),n=this._byPath[t];if(n)this._focusFieldInternal(e,t,n[0]);else throw"path not found"},_focusListField(t,e,n){const i=n.querySelector("[data-attribute]:not(.hidden)");i&&this._focusFieldInternal(t.item,i.getAttribute("data-attribute"),i)},_focusObjectField(t,e,n){const i=n.querySelector("[data-attribute]:not(.hidden)");if(i){const r=i.getAttribute("data-attribute"),s=this.getOptionsFromPath(r);this._focusFieldInternal(s,r,i)}},_focusFieldInternal(t,e,n){switch(t.type){case"number":case"text":case"range":case"color":case"toggle":case"select":case"textarea":case"content-editable":n.focus();break;case"object":this._focusObjectField(t,e,n);break;case"list":this._focusListField(t,e,n);break;default:this.options.focusField&&this.options.focusField(t,e,n,this);break}},onChangeInput:function(t){t.target===t.currentTarget&&this.processInput(t.target)},processInput:function(t,e){var n=t.dataset.attribute,i=t.dataset.type;if(this.validateInput(i,t,n)){this.options.live&&this.updateCell(t,n,e);var r=this.getFieldValue(t,i),s=this.parse(i,r,t);(!e||!e.dry)&&this.dependencyService.changed(n),this.trigger("change:"+n,s,t,e)}},updateFieldsVisibility:function(){this._attributeKeysInUse.forEach(t=>{this.updateDependants(t)})},updateDependants:function(t){const e=this._when,n=Object.keys(e),i=this._byPath,r=Object.keys(i),s=this.flatAttributes;l.call(this,n,t).forEach(d=>{const f=d.path;ft(e[f]).forEach(g=>{const v=g.path,x=g.expression,S=this._getBareExpression(x),C=this._getExpressionExtras(x);c(r,v).forEach(O=>{const N=O.path,m=O.comparisonWildcardValues,b=i[N],w=b.closest(".field"),A=w.hasClass("hidden"),E=a.call(this,S,m),M=this.isExpressionValid(E);w.toggleClass("hidden",!M);const $=C.otherwise;if($&&$.unset&&this.options.live)if(M)A&&this.updateCell(b,N);else{this.unsetProperty(N);const F=u(s,N);F&&this.renderTemplate(null,F,N,{replace:!0,hidden:!0}),this.afterPartialRender([N])}},this)},this)},this);function a(d,f){const p={};for(const v in d){const x=d[v];if(Array.isArray(x)){const S=v,C=x;p[S]=[];const P=C.length;for(let O=0;O<P;O++){const N=C[O],m=a.call(this,N,f);p[S].push(m)}}else if(this._isComposite(d)){const S=v,C=x,P=a.call(this,C,f);p[S]=P}else{const S=v,C=x;g.call(this,S,C,f,p)}}return p;function g(v,x,S,C){C[v]={};for(const O in x){const N=x[O],m=P.call(this,O,S);C[v][m]=N}function P(O,N){const m=this.pathWildcard||this.DEFAULT_PATH_WILDCARD,b=[];let w=0;const A=O.split("/"),E=A.length;for(let M=0;M<E;M++){let $=A[M];$===m&&($=N[w]||m,w+=1),b.push($)}return b.join("/")}}}function l(d,f){const p=f.split("/"),g=this.pathWildcard||this.DEFAULT_PATH_WILDCARD;return h(d,p,{pathWildcard:g})}function c(d,f){if(!Array.isArray(f))return[{path:f,pathWildcardValues:[],comparisonWildcardValues:[]}];const p=f;return p.indexOf(null)===-1?[{path:p.join("/"),pathWildcardValues:[],comparisonWildcardValues:[]}]:h(d,p,{comparisonWildcard:null})}function h(d,f,p){const{pathWildcard:g,comparisonWildcard:v}=p,x=[],S=f.length,C=d.length;for(let O=0;O<C;O++){const N=d[O],m=P(N),b=m.length;if(b!==S)continue;let w=!0;const A=[],E=[];for(let M=0;M<b;M++){const $=m[M],F=f[M],j=$===g,R=F===v;if($!==F&&!j&&!R){w=!1;break}j?A.push(F):R&&E.push($)}w&&x.push({path:N,pathWildcardValues:A,comparisonWildcardValues:E})}return x;function P(O){return Array.isArray(O)?O:O.split("/")}}function u(d,f){let p=d[f];if(p!=null)return p;const g=f.split("/"),v=g.length;let x=g[0];p=d[x];let S=p;for(let C=1;C<v;C++){const P=g[C];if(p===void 0){x+="/"+P,S===void 0?p=d[x]:p=S[x];continue}if(S=p,p.type==="object"&&p.properties)p=p.properties[P];else if(p.type==="list"&&p.item)p=p.item;else if(typeof p.type!="string")p=p[P];else break;x=P}return p}},unsetProperty:function(t,e){e=e||{},e.inspector=this.cid,e["inspector_"+this.cid]=!0,this.getModel().removeProp(t,e)},getOptions:function(t){if(t.length!==0){var e=t.data("attribute");return this.getOptionsFromPath(e)}},markForRemoval:function(t,e){var n=this.findParentListByPath(t);if(n){var i=t.substr(n.length+1),r=parseInt(i,10);Number.isFinite(r)&&(e.remove[n]=e.remove[n]||[],e.remove[n].includes(r)||e.remove[n].push(r))}},markForUpdate:function(t,e,n,i){var r=t.substr(i.length+1);e.update[i]&&so(e.update[i].value,r,n,"/")},updateCell:function(t,e,n){var i=this.getModel(),r={};t?r[e]=At(t):r=this._byPath,this.startBatchCommand();var s={},o={update:{},remove:{}};Kt(r,(function(l,c){if(l.closest(".field").hasClass("hidden"))return;const[h]=l;var u=h.dataset.type,d=h.dataset.overwrite,f=d!=="false"&&d!==void 0,p=l.hasClass("remove");switch(u){case"list":p&&this.markForRemoval(c,o);break;case"object":p&&this.markForRemoval(c,o);break;default:if(!this.validateInput(u,h,c))return;var g=this.getFieldValue(h,u),v=this.parse(u,g,h),x=this.getOptionsFromPath(c);if(x.valueRegExp){var S=fn(i.attributes,c,"/")||x.defaultValue;v=S.replace(new RegExp(x.valueRegExp),"$1"+v+"$3")}if(p)this.markForRemoval(c,o);else{var C=x.parent;if(C&&C.type==="object"&&C.overwrite!==void 0&&C.overwrite!==!1){var P={},O=c.split("/"),N=O[O.length-1];P[N]=v,o.update[C.path]={value:P,overwrite:!0}}else s[c]={value:v,overwrite:f}}break}}).bind(this)),Kt(s,(function(l,c){this.setProperty(c,l.value,U({overwrite:l.overwrite},n))}).bind(this));var a=Je(Object.keys(o.remove),function(l){return l.split("/").length}).reverse();a.forEach((function(l){var c=o.remove[l];this.removeProperty(l,c,U({rewrite:!0},n))}).bind(this)),Kt(o.update,(function(l,c){this.setProperty(c,this.compactDeep(l.value),U({rewrite:!0,overwrite:l.overwrite},n))}).bind(this)),this.updateFieldsVisibility(),this.updateGroupsVisibility(),this.stopBatchCommand()},compactDeep:function(t){return Array.isArray(t)?t.reduce((function(e,n){return n&&e.push(this.compactDeep(n)),e}).bind(this),[]):t},findParentListByPath:function(t){var e=t.split("/");e.pop();for(var n=e;n.length;){var i=this.getOptionsFromPath(n.join("/"));if(i&&i.type==="list")return e.slice(0,n.length).join("/");n.pop()}return null},getOptionsFromPath:function(t){for(var e=t.split("/"),n=this.expandAttributes,i,r=[];e.length;){var s,o=s;n&&n.type==="object"?s="properties":(s=e.shift(),(e.length||n.type==="list")&&(i=n,r.push(s)));var a=!Number.isNaN(parseInt(s));if(s=a&&n.type==="list"?"item":s,Object(n)===n&&(s in n||n[t]))n=n[s]||n[t];else return{}}return n=U({},n),i=U({},i),i.path=r.join("/"),o&&o==="properties"&&(i.type="object"),n.parent=i,n},getFieldValue:function(t,e){if(xt(this.options.getFieldValue)){var n=this.options.getFieldValue(t,e,this);if(n)return n.value}var i=At(t);switch(e){case"select-box":case"color-palette":case"select-button-group":var r=t.dataset.attribute;return this.widgets[r].getSelectionValue();case"radio-group":return this.widgets[t.dataset.attribute].currentValue;case"select":return t.multiple?Array.from(t.selectedOptions).map(s=>s.value):t.value;case"content-editable":return i.html().replace(/((<br\s*\/*>)?<\/div>)|(((&nbsp;)|(<br\s*\/*>))?<\/p>)|(<br\s*\/*>)/ig,`
`).replace(/(<([^>]+)>)/ig,"").replace(/&(\w+);/ig,this.replaceHTMLEntity).replace(/\n$/,"");default:return t.value}},removeProperty:function(t,e,n){var i=this.getModel(),r=rn.prototype.prop,s=r.call(i,t);if(s){var o=s.reduce(function(l,c,h){return e.includes(h)||l.push(c),l},[]),a=this.flatAttributes[t];Array.isArray(o)&&o.length===0&&!a&&(o=null),r.call(i,t,o,n)}},setProperty:function(t,e,n){n=n||{},n.inspector=this.cid;var i=rn.prototype.prop,r=this.getModel(),s=n.overwrite||!1;if(n.previewDone&&i.call(r,t,n.originalValue,{rewrite:!0,silent:!0}),e===void 0)rn.prototype.removeProp.call(r,t,n);else{var o;if(Nt(e)&&!s){var a=i.call(r,t),l=Array.isArray(e)?[]:{};o=_e(l,a,e)}else o=be(e);s&&(n.rewrite=!0),i.call(r,t,o,n)}},parse:function(t,e,n){switch(t){case"number":case"range":e=parseFloat(e);break;case"toggle":e=n.checked;break}return e},startBatchCommand:function(){if(!this.inBatch){this.inBatch=!0;var t=this.getModel();t instanceof rn&&t.startBatch("inspector",{cid:this.cid})}},stopBatchCommand:function(){if(this.inBatch){var t=this.getModel();t instanceof rn&&t.stopBatch("inspector",{cid:this.cid}),this.inBatch=!1}},afterRender:function(){this.cacheInputs(),this.updateFieldsVisibility(),this.updateGroupsVisibility(),this.sourceService.initSources(),this.trigger("render")},afterPartialRender:function(t){this.cacheInputs(),this.updateGroupsVisibility(),this.sourceService.initSources(),t&&t.forEach(e=>{this.dependencyService.changed(e)}),this.trigger("render")},addListItem:function(t){const e=t.target.parentNode;var n=e.matches("[data-attribute]")?At(e):At(),i=this.getOptions(n),r=n.children(".list-items"),s=r.children(".list-item"),o=At(s[s.length-1]),a=o.length===0?-1:Number(o.data("index")),l=a+1,c=this.renderListItem({index:l,options:i}),h=n.data("attribute")+"/"+l;this.renderTemplate(c,i.item,h),r.append(c),s=r.children(".list-item");var u=Dm(s,".remove").length;this.fixListButtons(n,u,i.min,i.max),this.afterPartialRender([h]);let d=c;i.item.type!=="object"&&i.item.type!=="list"&&(d=d.querySelector("[data-attribute]")),this.options.live&&this.updateCell(),this._focusFieldInternal(i.item,h,d)},deleteListItem:function(t){var e=At(t.target),n=e.closest("[data-attribute]"),i=this.getOptions(n),r=e.closest(".list-item");r.css("display","none"),r.addClass("remove"),r.find("[data-field]").css("display","none").addClass("remove"),r.find("[data-attribute]").css("display","none").addClass("remove");var s=n.children(".list-items"),o=s.children(".list-item"),a=Dm(o,".remove").length;this.fixListButtons(n,a,i.min,i.max);const l=n.data("attribute");this.afterPartialRender([l]),this.options.live&&this.updateCell()},fixListButtons:function(t,e,n,i){var r=function(h,u){return typeof u!="number"||typeof h!="number"?!0:h<u},s=function(h,u){return typeof u!="number"||u<=0?!0:typeof h!="number"||h<=0?!1:h>u},o=t.children(".btn-list-add"),a=r(e,i);a?o.removeClass("hidden"):o.addClass("hidden");var l=t.children(".list-items").children(".list-item").children(".btn-list-del"),c=s(e,n);c?l.removeClass("hidden"):l.addClass("hidden")},bindDocumentEvents:function(){var t=this.getEventNamespace();this.$document.on("mouseup"+t+" touchend"+t,this.pointerup)},unbindDocumentEvents:function(){this.$document.off(this.getEventNamespace())},pointerdown:function(t){t.stopPropagation(),this.bindDocumentEvents(),this.startBatchCommand(),this._$activeField=At(t.currentTarget).addClass("is-in-action")},pointerup:function(){this.unbindDocumentEvents(),this.stopBatchCommand(),this._$activeField&&(this._$activeField.removeClass("is-in-action"),this._$activeField=null)},pointerfocusin:function(t){t.stopPropagation(),At(t.currentTarget).addClass("is-focused")},pointerfocusout:function(t){t.stopPropagation(),At(t.currentTarget).removeClass("is-focused")},onRemove:function(){this.unbindDocumentEvents(),this.removeWidgets(),this===this.constructor.instance&&(this.constructor.instance=null)},removeWidgets:function(){var t=this.widgets;for(var e in t)t[e].remove();this.widgets={}},onGroupLabelClick:function(t){t.preventDefault(),this.options.multiOpenGroups||this.closeGroups();var e=At(t.target.closest(".group"));this.toggleGroup(e)},toggleGroup:function(t){var e=te(t)?this.$('.group[data-name="'+t+'"]'):At(t);e.hasClass("closed")?this.openGroup(e):this.closeGroup(e)},closeGroup:function(t,e){e=e||{};var n=te(t)?this.$('.group[data-name="'+t+'"]'):At(t);(e.init||!n.hasClass("closed"))&&(n.addClass("closed"),this.trigger("group:close",n.data("name"),e))},openGroup:function(t,e){e=e||{};var n=te(t)?this.$('.group[data-name="'+t+'"]'):At(t);(e.init||n.hasClass("closed"))&&(n.removeClass("closed"),this.trigger("group:open",n.data("name"),e))},closeGroups:function(){for(var t=0,e=this.$groups.length;t<e;t++)this.closeGroup(this.$groups[t])},openGroups:function(){for(var t=0,e=this.$groups.length;t<e;t++)this.openGroup(this.$groups[t])},COMPOSITE_OPERATORS:["not","and","or","nor"],PRIMITIVE_OPERATORS:["eq","ne","regex","text","lt","lte","gt","gte","in","nin","equal"],_isComposite:function(t){return Wh(this.COMPOSITE_OPERATORS,Object.keys(t)).length>0},_isPrimitive:function(t){var e=Object.keys(this.options.operators).concat(this.PRIMITIVE_OPERATORS);return Wh(e,Object.keys(t)).length>0},_evalCustomPrimitive:function(t,e,n,i){return!!this.options.operators[t].apply(this,[this.getModel(),e].concat(n).concat([i]))},_evalPrimitive:function(t){return Object.keys(t).reduce((function(e,n){var i=t[n];return Object.keys(i).reduce((function(r,s){var o=i[s],a=this.getCellAttributeValue(s);if(xt(this.options.operators[n]))return this._evalCustomPrimitive(n,a,o,s);switch(n){case"eq":return o==a;case"ne":return o!=a;case"regex":return new RegExp(o).test(a);case"text":return!o||te(a)&&a.toLowerCase().indexOf(o)>-1;case"lt":return a<o;case"lte":return a<=o;case"gt":return a>o;case"gte":return a>=o;case"in":return Array.isArray(o)&&o.includes(a);case"nin":return Array.isArray(o)&&!o.includes(a);case"equal":return Ie(o,a);default:return r}}).bind(this),!1)}).bind(this),!1)},_evalExpression:function(t){if(this._isPrimitive(t))return this._evalPrimitive(t);if(!this._isComposite(t))throw new Error('Inspector: Invalid custom operator used in an expression. The operator "'+Object.keys(t)[0]+'" must be registered in the `operators` property.');return Object.keys(t).reduce((function(e,n){var i=t[n];if(n=="not")return!this._evalExpression(i);var r=ft(i).map(this._evalExpression,this);switch(n){case"and":return r.every(function(s){return!!s});case"or":return r.some(function(s){return!!s});case"nor":return!r.some(function(s){return!!s});default:return e}}).bind(this),!1)},_getBareExpression:function(t){return Ze(t,"otherwise","dependencies")},_getExpressionExtras:function(t){return{otherwise:be(t.otherwise),dependencies:be(t.dependencies)}},_extractVariables:function(t){return Array.isArray(t)||this._isComposite(t)?ft(t).reduce((function(e,n){return e.concat(this._extractVariables(n))}).bind(this),[]):ft(t).reduce(function(e,n){return Object.keys(n)},[])},isExpressionValid:function(t){const e=this._getBareExpression(t);return this._evalExpression(e)},extractExpressionPaths:function(t){var e=t&&t.dependencies||[];const n=this._getBareExpression(t);return mi(this._extractVariables(n).concat(e))},getGroupsStateKey:function(){if(xt(this.options.stateKey))return this.options.stateKey(this.getModel());throw new Error("Inspector: Option stateKey must be a function")},storeGroupsState:function(){var t=this.getGroupsStateKey(),e=ft(this.$(".group.closed"));na.groupStates[t]=e.map(function(n){return n.dataset.name})},getGroupsState:function(){return na.groupStates[this.getGroupsStateKey()]},restoreGroupsState:function(){var t=function(n,i){Kt(i.options.groups,(function(r,s){n(r,s)?this.closeGroup(s):this.openGroup(s)}).bind(i))},e=this.getGroupsStateKey();na.groupStates[e]?t(function(n,i){return na.groupStates[e].includes(i)},this):t(function(n){return n.closed},this)}},{groupStates:{},instance:null,create:function(t,e){e=e||{},me(e,{updateCellOnClose:!0,restoreGroupsState:!0,storeGroupsState:!0});var n=e.cell||e.cellView.model,i=this.instance;return(!i||i.getModel()!==n)&&(i&&i.el.parentNode&&(e.storeGroupsState&&i.storeGroupsState(),e.updateCellOnClose&&i.updateCell(),i.trigger("close"),i.remove()),i=new this(e).render(),this.instance=i,At(t).html(i.el),e.restoreGroupsState&&i.restoreGroupsState()),i},close:function(){var t=this.instance;if(t){const{activeElement:e}=document;t.el!==e&&t.el.contains(e)&&e.blur(),t.trigger("close"),t.remove()}}}),$n=function(t={}){ln(this,"handleKey"),this.options=U({},t),this.parser=new Ks,this.enable()};U($n.prototype,tn);$n.prototype.on=function(t,e,n){return tn.on.call(this,this.normalizeEvent(t),e,n),this};$n.prototype.off=function(t,e,n){var i=t?this.normalizeEvent(t):null;return tn.off.call(this,i,e,n),this};$n.prototype.normalizeEvent=function(t){if(typeof t=="object"){for(var e=Object.keys(t),n={},i=0,r=e.length;i<r;i++){var s=e[i];n[this.normalizeEvent(s)]=t[s]}return n}return this.normalizeShortcut(t)};$n.prototype.normalizeShortcut=function(t){var e=t.toLowerCase();if(e in nd)return nd[e];for(var n=this.parser.toEventObjectList(t),i=[],r=0;r<n.length;r++)i.push(this.hash(n[r]));return i.join(" ")};$n.prototype.enable=function(){window.addEventListener?(document.addEventListener("keydown",this.handleKey,!1),document.addEventListener("keypress",this.handleKey,!1),document.addEventListener("keyup",this.handleKey,!1)):window.attachEvent&&(document.attachEvent("keydown",this.handleKey,!1),document.attachEvent("keypress",this.handleKey,!1),document.attachEvent("keyup",this.handleKey,!1))};$n.prototype.disable=function(){window.removeEventListener?(document.removeEventListener("keydown",this.handleKey,!1),document.removeEventListener("keypress",this.handleKey,!1),document.removeEventListener("keyup",this.handleKey,!1)):window.detachEvent&&(document.detachEvent("keydown",this.handleKey,!1),document.detachEvent("keypress",this.handleKey,!1),document.detachEvent("keyup",this.handleKey,!1))};$n.prototype.isActive=function(t,e){return this.isModifierActive(t,e)};$n.prototype.isModifierActive=function(t,e){for(var n=this.parser.toEventObjectList(t),i=0;i<n.length;i++)if(n[i].modifiersCompare(e))return!0;return!1};$n.prototype.isKeyPrintable=function(t){if(!t)return!1;const{key:e}=t;return e?e.length===1||e==="Unidentified":!1};$n.prototype.hash=function(t){var e=function(i){return i?1:0},n=[t.type,":",t.which,e(t.shiftKey),e(t.ctrlKey),e(t.altKey),e(t.metaKey)];return n.join("")};$n.prototype.handleKey=function(t){const e=this.options.filter;if(typeof e=="function"){if(!e.call(this,t,this))return}else if(this.isConsumerElement(t))return;var n=uo.fromNative(t);tn.trigger.call(this,this.hash(n),t),this.isKeyPrintable(t)&&tn.trigger.call(this,`${t.type}:printable`,t)};$n.prototype.isConsumerElement=function(t){const e=t.target||t.srcElement;if(e){const n=e.tagName.toUpperCase();return n==="INPUT"||n==="SELECT"||n==="TEXTAREA"||e.isContentEditable}return!1};var Ks=function(){};Ks.prototype={constructor:Ks,parseEventString:function(t){t=t||"";var e=t.split("+"),n,i=new uo(0),r;for(r=0;r<e.length;r++){n=e[r];var s=this.getModifierPropertyName(n);s&&(i[s]=!0),(e.length===1||s===void 0)&&(i.which=Ks.getCode(n))}return i},toEventObjectList:function(t){var e=t.replace(/\s*\+\s*/gi,"+").split(" ");return e.map(this.composeEventObject,this)},composeEventObject:function(t){var e=t.split(":"),n=Or.KEYDOWN,i=e[0];if(e.length>1&&(i=e[1],n=e[0]),vV.indexOf(n)===-1)throw t+": invalid shortcut definition";var r=this.parseEventString(i);return n===Or.KEYUP&&Zs[r.which]&&(r[Zs[r.which]]=!1),r.setType(n)},getModifierPropertyName:function(t){var e=yw[t];return Zs[e]}};Ks.getCode=function(t){return bw[t]||t.toUpperCase().charCodeAt(0)};var yw={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91,meta:91},Zs={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"},ed={226:"\\",57392:"ctrl",63289:"num",59:";",61:"=",173:"-"},bw={backspace:8,tab:9,shift:16,ctrl:17,alt:18,meta:91,clear:12,enter:13,return:13,esc:27,escape:27,capslock:20,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,insert:45,ins:45,pageup:33,pagedown:34,plus:187,minus:189,"-":189,",":188,".":190,"/":191,"`":192,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123},nd={all:"all",printable:"keypress:printable","keypress:printable":"keypress:printable","keydown:printable":"keydown:printable","keyup:printable":"keyup:printable"};U($n,{keyMap:bw,modifierMap:Zs,modifiers:yw,charCodeAlternatives:ed,eventNamesMap:nd});var Or={KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup"},vV=[Or.KEYPRESS,Or.KEYDOWN,Or.KEYUP],uo=function(t,e,n,i,r,s){this.which=t,this.shiftKey=e||!1,this.ctrlKey=n||!1,this.altKey=i||!1,this.metaKey=r||!1,this.type=s||Or.KEYDOWN};uo.fromNative=function(t){var e=t.which;t.type===Or.KEYPRESS&&(e=String.fromCharCode(t.which).toUpperCase().charCodeAt(0)),ed[e]&&(e=Ks.getCode(ed[e]));var n=new uo(e,t.shiftKey,t.ctrlKey,t.altKey,t.metaKey,t.type);return t.type===Or.KEYUP&&Zs[e]&&(n[Zs[e]]=!1),n};uo.prototype.modifiersCompare=function(t){return(this.shiftKey?this.shiftKey===t.shiftKey:!0)&&(this.ctrlKey?this.ctrlKey===t.ctrlKey:!0)&&(this.altKey?this.altKey===t.altKey:!0)&&(this.metaKey?this.metaKey===t.metaKey:!0)};uo.prototype.setType=function(t){return this.type=t,this};const hh=q,yV=In.extend({className:In.prototype.className+" lightbox",options:_e({},In.prototype.options,{closeButton:!0,modal:!0,downloadable:!1,downloadAction:"download",fileName:"Image",closeAnimation:{duration:200,easing:"ease-in-out",properties:{opacity:0}},top:100,windowArea:.8,openAnimation:!1}),init:function(){if(ln(this,"startCloseAnimation","positionAndScale"),In.prototype.init.apply(this,arguments),this.options.image&&(this.$image=hh("<img/>").on("load",this.positionAndScale),this.options.content=this.$image),this.options.downloadable){var t={action:this.options.downloadAction,content:"Download",position:"center"};this.buttons=Array.isArray(this.buttons)?this.buttons.slice():[],this.buttons.push(t)}this.on("action:"+this.options.downloadAction,this.download),hh(window).on("resize",this.positionAndScale),this.on("close:animation:complete",()=>{In.prototype.close.apply(this,arguments)})},open:function(){return In.prototype.open.apply(this,arguments),this.$image&&this.$image.attr("src",this.options.image),this.positionAndScale(),this.startOpenAnimation(),this},positionAndScale:function(){var t=this.$(".fg"),e=this.$(".body > img"),n=this.$(".titlebar"),i=this.$(".controls"),r=this.options.windowArea,s=window.innerWidth*r;this.$el.css("margin-top",this.options.top),n.css("width",s);var o=n.height(),a=i.height(),l=window.innerHeight*r-this.options.top-o-a;t.css({width:s,height:l});var c=e.width(),h=e.height();t.css({width:c,height:h}),n.css("width","auto"),n.hasClass("empty")||i.css("top",n.outerHeight())},download:function(){jf(this.options.image,(function(t,e){lx(e,this.options.fileName)}).bind(this))},close:function(){return this.options.closeAnimation?this.startCloseAnimation():In.prototype.close.apply(this,arguments),this},onRemove:function(){In.prototype.onRemove.apply(this,arguments),hh(window).off("resize",this.positionAndScale),this.$image&&this.$image.off("load",this.positionAndScale)},startCloseAnimation:function(){this.$el.animate(this.options.closeAnimation.properties,U({complete:(function(){this.trigger("close:animation:complete")}).bind(this)},this.options.closeAnimation))},startOpenAnimation:function(){this.$el.animate(U({},this.options.openAnimation.properties,{height:this._foregroundHeight}),U({complete:(function(){this.trigger("open:animation:complete")}).bind(this)},this.options.openAnimation))}}),Nm=q,bV=ae.extend({className:"navigator",events:{mousedown:"startAction",touchstart:"startAction"},documentEvents:{mousemove:"doAction",touchmove:"doAction",mouseup:"stopAction",touchend:"stopAction"},options:{paperConstructor:fi,paperOptions:{},zoomOptions:null,zoom:{min:.5,max:2},width:300,height:200,padding:10},init:function(){this.options.zoomOptions?this.options.zoom=U({},this.options.zoom,this.options.zoomOptions):this.options.zoom&&(this.options.zoom=me({},this.options.zoom,this.constructor.prototype.options.zoom)),ln(this,"updateCurrentView","doAction","stopAction","scrollTo"),this.updateCurrentView=Ga(this.updateCurrentView,0);var t=this.options.paperScroller,e=this.sourcePaper=t.options.paper;this.toggleUseContentBBox(this.options.useContentBBox),this.targetPaper=new this.options.paperConstructor(_e({model:e.model,interactive:!1,frozen:!0},this.options.paperOptions))},startListening:function(){const{options:t,sourcePaper:e}=this,{useContentBBox:n,paperScroller:i}=t;n?this.listenTo(e,"render:done",()=>this.updatePaper()):this.listenTo(e,"resize",()=>this.updatePaper()),this.listenTo(i,"scroll",()=>this.updateCurrentView())},render:function(){if(this.targetPaper.$el.appendTo(this.el),this.targetPaper.unfreeze(),this.$currentView=Nm("<div>").addClass("current-view"),this.options.zoom){var t=Nm("<div>").addClass("current-view-control");this.$currentView.append(t)}return this.$el.append(this.$currentView).css({width:this.options.width,height:this.options.height,padding:this.options.padding}),this.updatePaper(),this},freeze(t){this.targetPaper.freeze(t)},unfreeze(t){this.targetPaper.unfreeze(t)},CONTENT_BBOX_CLASS_NAME:"navigator-use-content-bbox",NO_CONTENT_CLASS_NAME:"navigator-no-content",toggleUseContentBBox:function(t=!1){const{CONTENT_BBOX_CLASS_NAME:e,$el:n,targetPaper:i}=this;this.options.useContentBBox=t,this.stopListening(),this.startListening(),n.toggleClass(e,!!t),i&&this.updatePaper()},updatePaper:function(){const{sourcePaper:t,targetPaper:e,options:n,$el:i,NO_CONTENT_CLASS_NAME:r}=this,{useContentBBox:s}=n,o=s?t.getContentBBox(s):t.getComputedSize(),a=i.hasClass(r);if(o.width>0&&o.height>0)a&&(i.removeClass(r),e.unfreeze({key:"navigator"})),this.updatePaperWithBBox(o),this.updateCurrentView();else{if(a)return;i.addClass(r),e.freeze({key:"navigator"})}},updatePaperWithBBox:function(t){let{width:e,height:n,x:i=0,y:r=0}=t;if(!e||!n)return;const{sourcePaper:s,targetPaper:o,options:a}=this,{a:l,d:c,e:h,f:u}=s.matrix(),{padding:d,preserveAspectRatio:f=!0}=a,p=a.width-2*d,g=a.height-2*d;e/=l,n/=c;let v=p/e,x=g/n;if(f){const O=Math.min(v,x);v=O,x=O}this.ratioX=v,this.ratioY=x,e*=v,n*=x;const S=(h-i)*v/l,C=(u-r)*x/c;o.setDimensions(e,n);const P=o.matrix();P.e=S,P.f=C,P.a=v,P.d=x,o.matrix(P)},updateCurrentView:function(){if(this.$currentView){var t=this.ratioX,e=this.ratioY,n=this.sourcePaper.scale(),i=this.options.paperScroller,r=i.clientToLocalPoint(0,0),s=this.targetPaper.$el.position(),o=this.targetPaper.translate();o.ty=o.ty||0,this.currentViewGeometry={top:s.top+r.y*e+o.ty,left:s.left+r.x*t+o.tx,width:i.el.clientWidth*t/n.sx,height:i.el.clientHeight*e/n.sy},this.$currentView.css(this.currentViewGeometry)}},startAction:function(t){t=ot(t);const{clientX:e,clientY:n}=t,i=t.target.classList.contains("current-view-control");!i&&!t.target.classList.contains("current-view")&&this.scrollTo(t);const s=i?"zooming":"panning",{options:o,currentViewGeometry:a,sourcePaper:l}=this,{paperScroller:c}=o;switch(this.delegateDocumentEvents(null,{action:s,startClientX:e,startClientY:n,startScrollLeft:c.el.scrollLeft,startScrollTop:c.el.scrollTop,startZoom:c.zoom(),startGeometry:a,startScale:l.scale()}),s){case"panning":{this.trigger("pan:start",t);break}case"zooming":{this.trigger("zoom:start",t);break}}},doAction:function(t){t=ot(t);const{clientX:e,clientY:n,data:i}=t,{sourcePaper:r,options:s,ratioX:o,ratioY:a}=this,{action:l,startClientX:c,startClientY:h,startScrollLeft:u,startScrollTop:d,startZoom:f,startGeometry:p,startScale:g,frameId:v}=i,{paperScroller:x,zoom:S}=s;switch(l){case"panning":{const{sx:C,sy:P}=r.scale(),O=(e-c)*C,N=(n-h)*P;x.el.scrollLeft=u+O/o,x.el.scrollTop=d+N/a;break}case"zooming":{const{width:C}=p,P=1+(c-e)/C/g.sx;ao(v),i.frameId=oo(()=>{x.zoom(P*f,me({absolute:!0},S))});break}}},stopAction:function(t){switch(this.undelegateDocumentEvents(),t.data.action){case"panning":{this.trigger("pan:stop",t);break}case"zooming":{this.trigger("zoom:stop",t);break}}},scrollTo:function(t){t=ot(t);const{x:e,y:n}=this.targetPaper.clientToLocalPoint({x:t.clientX,y:t.clientY}),{paperScroller:i}=this.options;i.scroll(e,n)},onRemove:function(){this.targetPaper.remove()}}),xs=function(t,e){this.options=U({friction:.92},e),this.onInertiaMove=t,this._isDragging=!1,this.initialize()};xs.prototype.initialize=function(){this._dragLastX=0,this._dragLastY=0,this._dragDeltaX=0,this._dragDeltaY=0,this._dragLastDeltaX=0,this._dragLastDeltaY=0,this._velocityX=0,this._velocityY=0,this._requestAnimationFrameId=-1};xs.prototype.approxZero=function(t){return Math.abs(t)<.5};xs.prototype.updateVelocity=function(){const{_velocityX:t,_velocityY:e,_isDragging:n,options:i,onInertiaMove:r}=this;if(!n&&this.approxZero(t)&&this.approxZero(e)){this.initialize();return}if(this._requestAnimationFrameId=oo(this.updateVelocity.bind(this)),n)this._dragLastDeltaX=this._dragDeltaX,this._dragLastDeltaY=this._dragDeltaY,this._dragDeltaX=this._dragLastX,this._dragDeltaY=this._dragLastY,this._velocityX=this._dragDeltaX-this._dragLastDeltaX,this._velocityY=this._dragDeltaY-this._dragLastDeltaY;else{const s=t,o=e,{friction:a}=i;this._velocityX*=a,this._velocityY*=a,typeof r=="function"&&r(s,o)}};xs.prototype.handleDragStart=function(t){this._isDragging=!0,ao(this._requestAnimationFrameId),this.initialize(),this._dragLastX=t.clientX,this._dragLastY=t.clientY,this._dragDeltaX=t.clientX,this._dragDeltaY=t.clientY,this.updateVelocity()};xs.prototype.handleDragMove=function(t){this._dragLastX=t.clientX,this._dragLastY=t.clientY};xs.prototype.handleDragEnd=function(t){this._isDragging=!1};function xV(t){return t<=0?0:t>=1?1:.5-Math.cos(t*Math.PI)/2}function wV(t,e,n){const{duration:i=400,timingFunction:r=xV,complete:s}=n,o=Date.now(),a=o+i,l=t.scrollLeft,c=t.scrollTop,h=e.scrollLeft||l,u=e.scrollTop||c,d=h-l,f=u-c;let p;function g(){const v=Date.now(),x=(v-o)/(a-o),S=r(x),C=Math.round(l+d*S),P=Math.round(c+f*S);if(t.scrollLeft=C,t.scrollTop=P,v>=a){s&&s();return}if(t.scrollLeft!==C&&t.scrollTop!==P){s&&s();return}p=setTimeout(g,0)}return g(),()=>clearTimeout(p)}const _V=q,Ea=ae.extend({className:"paper-scroller",events:{scroll:"onScroll"},options:{paper:void 0,padding:function(){var t=this.getClientSize(),e=Math.max(this.options.minVisiblePaperSize,1)||1,n={};return n.left=n.right=Math.max(t.width-e,0),n.top=n.bottom=Math.max(t.height-e,0),n},scrollWhileDragging:!1,minVisiblePaperSize:50,autoResizePaper:!1,baseWidth:void 0,baseHeight:void 0,contentOptions:void 0,cursor:"default",inertia:!1,borderless:!1},_padding:{left:0,top:0},init:function(){ln(this,"startPanning","stopPanning","pan","onBackgroundEvent");const{options:t,el:e}=this,{paper:n,autoResizePaper:i,scrollWhileDragging:r,cursor:s,inertia:o,baseWidth:a,baseHeight:l}=t;var c=n.scale();this._sx=c.sx,this._sy=c.sy;const{width:h,height:u}=n.options;if(!Number.isFinite(h)||!Number.isFinite(u))throw new Error("PaperScroller: paper dimension must be a number");a===void 0&&(t.baseWidth=h),l===void 0&&(t.baseHeight=u),this.$background=_V("<div/>").addClass("paper-scroller-background").css({width:n.options.width,height:n.options.height}).append(n.el).appendTo(e),this.listenTo(n,"scale",this.onScale).listenTo(n,"resize",this.onResize).listenTo(n,"beforeprint beforeexport",this.storeScrollPosition).listenTo(n,"afterprint afterexport",this.restoreScrollPosition),i&&this.listenTo(n,"render:done",this.onPaperRenderDone),r&&(this.listenTo(n,"cell:pointermove",this.onCellPointermove),this.listenTo(n,"cell:pointerup",this.onCellPointerup)),this.debouncedStoreCenter=Ga(()=>this.storeCenter()),this.storeCenter(n.options.width/2,n.options.height/2),this.delegateBackgroundEvents(),this.setCursor(s),o&&(this.inertia=new xs((function(f,p){const{el:g}=this;g.scrollTop-=p,g.scrollLeft-=f}).bind(this),o));const d=new ResizeObserver(()=>this.storeCenter());d.observe(e),this.resizeObserver=d},onCellPointermove:function(t,e,n,i){const{scrollWhileDragging:r}=this.options;r&&this.scrollWhileDragging(e,n,i,r)},onCellPointerup:function(t,e){this.stopScrollWhileDragging(e)},scrollWhileDragging:function(t,e,n,i={}){const{el:r}=this,{interval:s=25,padding:o=-20,scrollingFunction:a=w=>w<20?5:20}=i;let{scrollId:l}=this.eventData(t);const c=new L(e,n),{top:h,left:u,right:d,bottom:f}=Ne(o),p=this.getVisibleArea().moveAndExpand({x:-u,y:-h,width:u+d,height:h+f});if(p.containsPoint(c)){clearInterval(l),this.eventData(t,{scrollId:null});return}const v=p.pointNearestToPoint(c).distance(c),x=a.call(this,v,t),{x:S,y:C,width:P,height:O}=p,N=e<S?-1:e>S+P?1:0,m=n<C?-1:n>C+O?1:0;if(this.eventData(t,{scrollX:N,scrollY:m,scrollPerTick:x,container:r}),l)return;const b=this.eventData(t);l=setInterval(({scrollPerTick:w,scrollX:A,scrollY:E,container:M})=>{M.scrollLeft+=w*A,M.scrollTop+=w*E},s,b),b.scrollId=l},stopScrollWhileDragging:function(t){const{scrollId:e}=this.eventData(t);e&&clearInterval(e)},onPaperRenderDone:function(t){t.priority<2&&this.adjustPaper()},lock:function(){return this.$el.css("overflow","hidden"),this},unlock:function(){return this.$el.css("overflow","scroll"),this},setCursor:function(t){switch(t){case"grab":this.$el.css("cursor","");break;default:this.$el.css("cursor",t);break}return this.$el.attr("data-cursor",t),this.options.cursor=t,this},delegateBackgroundEvents:function(t){t||(t=Qt(this.options.paper,"events"));var e=this.paperEvents=Object.keys(t||{}).reduce(n.bind(this),{});Object.keys(e).forEach(i,this);function n(r,s){var o=t[s];return s.indexOf(" ")===-1&&(r[s]=xt(o)?o:this.options.paper[o]),r}function i(r){this.delegate(r,{guarded:!1},this.onBackgroundEvent)}return this},onBackgroundEvent:function(t){const[e]=this.$background;if(e===t.target){var n=this.paperEvents[t.type];xt(n)&&n.apply(this.options.paper,arguments)}},onScroll:function(t){this.trigger("scroll",t),this.debouncedStoreCenter()},onResize:function(){this.restoreCenter()},onScale:function(t,e,n,i){this.adjustScale(t,e),this._sx=t,this._sy=e,(n||i)&&this.center(n,i);const{contentOptions:r,borderless:s}=this.options;(typeof r=="function"||s)&&this.adjustPaper()},storeScrollPosition:function(){this._scrollLeftBeforePrint=this.el.scrollLeft,this._scrollTopBeforePrint=this.el.scrollTop},restoreScrollPosition:function(){this.el.scrollLeft=this._scrollLeftBeforePrint,this.el.scrollTop=this._scrollTopBeforePrint,this._scrollLeftBeforePrint=null,this._scrollTopBeforePrint=null},beforePaperManipulation:function(){(qr.test("msie")||qr.test("msedge"))&&this.$el.css("visibility","hidden")},afterPaperManipulation:function(){(qr.test("msie")||qr.test("msedge"))&&this.$el.css("visibility","visible")},clientToLocalPoint:function(t,e){var n=this.options.paper.matrix();return t+=this.getLTRScrollLeft()-this._padding.left-n.e,t/=n.a,e+=this.el.scrollTop-this._padding.top-n.f,e/=n.d,new L(t,e)},localToBackgroundPoint:function(t,e){var n=new L(t,e),i=this.options.paper.matrix(),r=this._padding;return k.transformPoint(n,i).offset(r.left,r.top)},getPadding:function(){var t=this.options.padding;return xt(t)&&(t=t.call(this,this)),Ne(t)},computeRequiredPadding:function(t){const{sx:e,sy:n}=this.options.paper.scale();let{x:i,y:r}=this.getCenter();i*=e,r*=n;const s=t.x,o=t.y,a=s+t.width,l=o+t.height,c=this.getClientSize(),h=c.width/2,u=c.height/2,{left:d,right:f,top:p,bottom:g}=this.getPadding();return{left:Math.max(h-d-i+s,0)+d,right:Math.max(h-f+i-a,0)+f,top:Math.max(u-p-r+o,0)+p,bottom:Math.max(u-g+r-l,0)+g}},addPadding:function(){const{borderless:t,paper:e}=this.options;let n,i,r,s;if(t)n=i=r=s=0;else{const{sx:l,sy:c}=e.scale(),h=e.getArea(),u=this.computeRequiredPadding(h.scale(l,c,{x:0,y:0}));n=Math.round(u.left),i=Math.round(u.right),r=Math.round(u.top),s=Math.round(u.bottom)}this._padding={left:n,top:r,bottom:s,right:i};const{width:o,height:a}=e.getComputedSize();return this.$background.css({width:n+o+i,height:r+a+s}),e.$el.css({left:n,top:r}),this},storeCenter:function(t,e){const n=Ot(t)?new L(t,e):this.computeCenter();this._center=n},restoreCenter:function(){const t=this._center;t&&this.center(t.x,t.y)},getCenter:function(){return this._center||(this._center=this.options.paper.getArea().center()),this._center},computeCenter:function(){const{width:t,height:e}=this.getClientSize();return this.clientToLocalPoint(t/2,e/2)},adjustPaper:function(){let{paper:t,borderless:e,contentOptions:n}=this.options;typeof n=="function"&&(n=n.call(this,this));var i=U({gridWidth:this.options.baseWidth,gridHeight:this.options.baseHeight,allowNewOrigin:"negative"},n);if(e){const r=t.getFitToContentArea(this.transformContentOptions(i)),{sx:s,sy:o}=t.scale();r.x*=s,r.y*=o,r.width*=s,r.height*=o;const{left:a,right:l,top:c,bottom:h}=this.computeRequiredPadding(r);r.moveAndExpand({x:-a,y:-c,width:a+l,height:c+h}),t.translate(-r.x,-r.y),t.setDimensions(r.width,r.height)}else t.fitToContent(this.transformContentOptions(i));return this},adjustScale:function(t,e){const{paper:n}=this.options,i=n.options,r=t/this._sx,s=e/this._sy,{tx:o,ty:a}=n.translate();n.translate(o*r,a*s),n.setDimensions(i.width*r,i.height*s)},transformContentOptions:function(t){var e=this._sx,n=this._sy;return t.gridWidth&&(t.gridWidth*=e),t.gridHeight&&(t.gridHeight*=n),t.minWidth&&(t.minWidth*=e),t.minHeight&&(t.minHeight*=n),Nt(t.padding)?t.padding={left:(t.padding.left||0)*e,right:(t.padding.right||0)*e,top:(t.padding.top||0)*n,bottom:(t.padding.bottom||0)*n}:Ot(t.padding)&&(t.padding=t.padding*e),t},center:function(t,e,n){const{paper:i}=this.options,{a:r,d:s,e:o,f:a}=i.matrix(),l=Ot(t),c=Ot(e);let h;if(!l&&!c){h=t;const u=i.getComputedSize(),d=-o,f=-a;t=(d+u.width)/2,e=(f+u.height)/2,t/=r,e/=s}else h=n,l||(t=this.getVisibleArea().center().x),c||(e=this.getVisibleArea().center().y);return this.storeCenter(t,e),this.addPadding(),this.scroll(t,e,h),this},centerContent:function(t){return this.positionContent("center",t)},centerElement:function(t,e){return this.checkElement(t,"centerElement"),this.positionElement(t,"center",e)},positionContent:function(t,e){var n=this.options.paper.getContentArea(e);return this.positionRect(n,t,e)},positionElement:function(t,e,n){this.checkElement(t,"positionElement");var i=t.getBBox();return this.positionRect(i,e,n)},positionRect:function(t,e,n){var i;switch(e){case"center":return i=t.center(),this.positionPoint(i,"50%","50%",n);case"top":return i=t.topMiddle(),this.positionPoint(i,"50%",0,n);case"top-right":return i=t.topRight(),this.positionPoint(i,"100%",0,n);case"right":return i=t.rightMiddle(),this.positionPoint(i,"100%","50%",n);case"bottom-right":return i=t.bottomRight(),this.positionPoint(i,"100%","100%",n);case"bottom":return i=t.bottomMiddle(),this.positionPoint(i,"50%","100%",n);case"bottom-left":return i=t.bottomLeft(),this.positionPoint(i,0,"100%",n);case"left":return i=t.leftMiddle(),this.positionPoint(i,0,"50%",n);case"top-left":return i=t.topLeft(),this.positionPoint(i,0,0,n);default:throw new Error("Provided positionName ('"+e+"') was not recognized.")}},positionPoint:function(t,e,n,i){i=i||{};var r=Ne(i.padding),s=new J(this.getClientSize()),o=s.clone().moveAndExpand({x:r.left,y:r.top,width:-r.right-r.left,height:-r.top-r.bottom}),a=Ue(e);e=parseFloat(e),a&&(e=e/100*Math.max(0,o.width)),e<0&&(e=o.width+e);var l=Ue(n);n=parseFloat(n),l&&(n=n/100*Math.max(0,o.height)),n<0&&(n=o.height+n);var c=o.origin().offset(e,n),h=s.center(),u=h.difference(c),d=this.zoom(),f=u.scale(1/d,1/d),p=t.clone().offset(f);return this.center(p.x,p.y,i)},scroll:function(t,e,n){const i=this.options.paper.matrix(),r=this.getClientSize(),s={};if(Ot(t)){var o=r.width/2;s.scrollLeft=this.getScrollLeftFromLTR(t*i.a-o+i.e+(this._padding.left||0))}if(Ot(e)){var a=r.height/2;s.scrollTop=e*i.d-a+i.f+(this._padding.top||0)}if(n&&n.animation)this._cancelAnimation&&this._cancelAnimation(),this._cancelAnimation=wV(this.el,s,n.animation);else{const{el:l}=this;s.scrollLeft!==void 0&&(l.scrollLeft=s.scrollLeft),s.scrollTop!==void 0&&(l.scrollTop=s.scrollTop)}},scrollToContent:function(t){var e=this.options.paper.getContentArea(t).center();return this.scroll(e.x,e.y,t)},scrollToElement:function(t,e){this.checkElement(t,"scrollToElement");var n=t.getBBox().center();return this.scroll(n.x,n.y,e)},zoom:function(t,e={}){if(t===void 0)return this._sx;var n=this.computeCenter(),i=t,r=t,s,o;if(!e.absolute){const h=(u,d)=>(u*1e12+d*1e12)/1e12;i=h(this._sx,i),r=h(this._sy,r)}if(e.grid&&(i=Math.round(i/e.grid)*e.grid,r=Math.round(r/e.grid)*e.grid),e.max&&(i=Math.min(e.max,i),r=Math.min(e.max,r)),e.min&&(i=Math.max(e.min,i),r=Math.max(e.min,r)),e.ox===void 0||e.oy===void 0)s=n.x,o=n.y;else{var a=i/this._sx,l=r/this._sy;s=e.ox-(e.ox-n.x)/a,o=e.oy-(e.oy-n.y)/l}return this.beforePaperManipulation(),this.options.paper.scale(i,r),this.center(s,o),this.afterPaperManipulation(),this},zoomToRect:function(t,e={}){t=new J(t);const n=this.options.paper,i=U({},n.options.origin);if(!e.fittingBBox){const s=this.el.getBoundingClientRect();e.fittingBBox=U({},new L(i),{width:s.width,height:s.height})}e.contentArea=t,this.beforePaperManipulation(),n.scaleContentToFit(e);const r=t.center();return this.adjustPaper(),this.center(r.x,r.y),this.afterPaperManipulation(),this},zoomToFit:function(t={}){const n=this.options.paper.getContentArea(t);return this.zoomToRect(n,t),this},transitionClassName:"transition-in-progress",transitionEventName:"transitionend.paper-scroller-transition",transitionToPoint:function(t,e,n){Nt(t)&&(n=e,e=t.y,t=t.x),n||(n={});var i=this._sx,r=Math.max(n.scale||i,1e-6),s=new L(t,e),o=this.computeCenter(),a,l;if(i===r){var c=o.difference(s).scale(i,i).round();a="translate("+c.x+"px,"+c.y+"px)"}else{var h=r/(i-r)*s.distance(o),u=o.clone().move(s,h),d=this.localToBackgroundPoint(u).round();a="scale("+r/i+")",l=d.x+"px "+d.y+"px"}return this.$el.addClass(this.transitionClassName),this.$background.off(this.transitionEventName).on(this.transitionEventName,(function(f){var p=this.paperScroller;p.syncTransition(this.scale,{x:this.x,y:this.y});var g=this.onTransitionEnd;xt(g)&&g.call(p,f)}).bind({paperScroller:this,scale:r,x:t,y:e,onTransitionEnd:n.onTransitionEnd})).css({transition:"transform",transitionDuration:n.duration||"1s",transitionDelay:n.delay,transitionTimingFunction:n.timingFunction,transformOrigin:l,transform:a}),this},syncTransition:function(t,e){return this.beforePaperManipulation(),this.options.paper.scale(t),this.removeTransition().center(e.x,e.y),this.afterPaperManipulation(),this},removeTransition:function(){return this.$el.removeClass(this.transitionClassName),this.$background.off(this.transitionEventName).css({transition:"",transitionDuration:"",transitionDelay:"",transitionTimingFunction:"",transform:"",transformOrigin:""}),this},transitionToRect:function(t,e={}){t=new J(t);const n=e.maxScale||1/0,i=e.minScale||Number.MIN_VALUE,r=e.scaleGrid||null,s=e.visibility||1,o=e.center?new L(e.center):t.center(),a=this.getClientSize(),l=a.width*s,c=a.height*s;let u=new J({x:o.x-l/2,y:o.y-c/2,width:l,height:c}).maxRectUniformScaleToFit(t,o);return u=Math.min(u,n),r&&(u=Math.floor(u/r)*r),u=Math.max(i,u),this.transitionToPoint(o,me({scale:u},e)),this},startPanning:function(t){t=ot(t),this._clientX=t.clientX,this._clientY=t.clientY,this.trigger("pan:start",t),this.delegatePanning(),this.options.inertia&&this.inertia.handleDragStart(t)},pan:function(t){t=ot(t);var e=t.clientX-this._clientX,n=t.clientY-this._clientY;this.el.scrollTop-=n,this.el.scrollLeft-=e,this._clientX=t.clientX,this._clientY=t.clientY,this.options.inertia&&this.inertia.handleDragMove(t)},stopPanning:function(t){this.undelegatePanning(),t&&(t=ot(t)),this.trigger("pan:stop",t),this.options.inertia&&this.inertia.handleDragEnd(t)},delegatePanning(){this.$el.addClass("is-panning"),this.delegateDocumentEvents({mousemove:"pan",touchmove:"pan",mouseup:"stopPanning",touchend:"stopPanning",touchcancel:"stopPanning"})},undelegatePanning(){this.$el.removeClass("is-panning"),this.undelegateDocumentEvents()},getClientSize:function(){const{clientWidth:t,clientHeight:e}=this.el;return{width:t,height:e}},getVisibleArea:function(){var t=this.options.paper.matrix(),e=this.getClientSize(),n={x:this.getLTRScrollLeft(),y:this.el.scrollTop||0,width:e.width,height:e.height},i=k.transformRect(n,t.inverse());return i.x-=(this._padding.left||0)/this._sx,i.y-=(this._padding.top||0)/this._sy,new J(i)},isElementVisible:function(t,e){this.checkElement(t,"isElementVisible"),e=e||{};var n=e.strict?"containsRect":"intersect";return!!this.getVisibleArea()[n](t.getBBox())},isPointVisible:function(t){return this.getVisibleArea().containsPoint(t)},checkElement:function(t,e){if(!(t&&t instanceof Xt))throw new TypeError("ui.PaperScroller."+e+"() accepts instance of dia.Element only")},onRemove:function(){this.undelegatePanning(),this.resizeObserver.disconnect()},isRTLDirection(){return getComputedStyle(this.el).direction==="rtl"},getLTRScrollLeft(){const{el:t}=this;if(this.isRTLDirection()){const{scrollLeft:e,scrollWidth:n,clientWidth:i}=t;return n-i+e}return t.scrollLeft},getScrollLeftFromLTR(t){if(this.isRTLDirection()){const{scrollWidth:e,clientWidth:n}=this.el;return t-(e-n)}return t}});qr.addTest("msie",function(){var t=window.navigator.userAgent;return t.indexOf("MSIE")!==-1||t.indexOf("Trident")!==-1});qr.addTest("msedge",function(){return/Edge\/\d+/.test(window.navigator.userAgent)});const SV=q,EV=ae.extend({tagName:"g",svgElement:!0,className:"path-drawer",events:{"mousedown .start-point":"onStartPointPointerDown",mousedown:"onPointerDown","touchstart .start-point":"onStartPointPointerDown",touchstart:"onPointerDown",dblclick:"onDoubleClick",contextmenu:"onContextMenu"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{pathAttributes:{class:null,fill:"#ffffff",stroke:"#000000","stroke-width":1,"pointer-events":"none"},startPointMarkup:'<circle r="5"/>',snapRadius:0,enableCurves:!0},init:function(){const t=this.svgTarget=k(this.options.target);this.path=new K,this.$document=SV(t.node.ownerDocument),this.action="awaiting-input",this.render()},onRemove:function(){const{pathNode:t}=this;t&&k(t).remove(),this.clear()},clear:function(){const{path:t,pathNode:e}=this;e&&t&&t.segments.length<=1&&k(e).remove(),this.svgStart.remove(),this.svgControl.remove(),this.pathNode=null,this.path=new K,this.undelegateDocumentEvents(),this.action="awaiting-input",this.trigger("clear")},render:function(){const{options:t}=this;return this.svgPathTemplate=k("path").attr(t.pathAttributes),this.svgStart=k(t.startPointMarkup).addClass("start-point"),this.svgControl=k("path").addClass("control-path"),this.vel.append(k("rect",{x:0,y:0,width:"100%",height:"100%",fill:"transparent",stroke:"none"})),this.svgTarget.append(this.el),this},createPath:function(t,e){const n=this.svgPathTemplate.clone(),i=this.pathNode=n.node,r=this.svgStart.translate(t,e,{absolute:!0});this.trigger("path:create",i),this.addMoveSegment(t,e),this.vel.before(n),this.vel.append(r)},closePath:function(){const{path:t,pathNode:e}=this,n=t.getSegment(0),i=t.getSegment(t.segments.length-1);i.type==="L"?t.replaceSegment(t.segments.length-1,K.createSegment("Z")):(i.end.x=n.end.x,i.end.y=n.end.y,t.appendSegment(K.createSegment("Z"))),e.setAttribute("d",t.toString()),this.finishPath("path:close")},finishPath:function(t){const{path:e,pathNode:n}=this;e&&this.numberOfVisibleSegments()>0?(this.trigger("path:finish",n),this.trigger(t,n)):this.trigger("path:abort",n),this.clear()},numberOfVisibleSegments:function(){const{path:t}=this;let e=t.segments.length;return e-=1,t.getSegment(t.segments.length-1).type==="Z"&&(e-=1),e},addMoveSegment:function(t,e){const{path:n,pathNode:i}=this,r=K.createSegment("M",t,e);n.appendSegment(r),i.setAttribute("d",n.toString()),this.trigger("path:segment:add",i),this.trigger("path:move-segment:add",i)},addLineSegment:function(t,e){const{path:n,pathNode:i}=this,r=K.createSegment("L",t,e);n.appendSegment(r),i.setAttribute("d",n.toString()),this.trigger("path:segment:add",i),this.trigger("path:line-segment:add",i)},addCurveSegment:function(t,e,n,i,r,s){const{path:o,pathNode:a}=this,l=K.createSegment("C",n,i,r||t,s||e,t,e);o.appendSegment(l),a.setAttribute("d",o.toString()),this.trigger("path:segment:add",a),this.trigger("path:curve-segment:add",a)},adjustLastSegment:function(t,e,n,i,r,s){const{path:o,pathNode:a}=this,l=this.options.snapRadius;if(l){const h=this.snapLastSegmentCoordinates(t,e,l);t=h.x,e=h.y}const c=o.getSegment(o.segments.length-1);t!=null&&(c.end.x=t),e!=null&&(c.end.y=e),n!=null&&(c.controlPoint1.x=n),i!=null&&(c.controlPoint1.y=i),r!=null&&(c.controlPoint2.x=r),s!=null&&(c.controlPoint2.y=s),a.setAttribute("d",o.toString()),this.trigger("path:edit",a),this.trigger("path:last-segment:adjust",a)},snapLastSegmentCoordinates:function(t,e,n){const{path:i}=this;let r=!1,s=!1,o=t,a=e;for(let l=i.segments.length-2;l>=0&&!(r&&s);l--){const c=i.getSegment(l),h=c.end.x,u=c.end.y;!r&&Math.abs(h-t)<n&&(o=h,r=!0),!s&&Math.abs(u-e)<n&&(a=u,s=!0)}return new L(o,a)},removeLastSegment:function(){const{path:t,pathNode:e}=this;t.removeSegment(t.segments.length-1),e.setAttribute("d",t.toString()),this.trigger("path:edit",e),this.trigger("path:last-segment:remove",e)},findControlPoint:function(t,e){const{path:n}=this,i=n.getSegment(n.segments.length-1);return new L(t,e).reflection({x:i.end.x,y:i.end.y})},replaceLastSegmentWithCurve:function(){const{path:t,pathNode:e}=this,n=t.getSegment(t.segments.length-1),i=t.getSegment(t.segments.length-2),r=K.createSegment("C",i.end.x,i.end.y,n.end.x,n.end.y,n.end.x,n.end.y);t.replaceSegment(t.segments.length-1,r),e.setAttribute("d",t.toString()),this.trigger("path:edit",e),this.trigger("path:last-segment:replace-with-curve",e)},adjustControlPath:function(t,e,n,i){const{pathNode:r}=this,s=this.svgControl.node,o=new K([K.createSegment("M",t,e),K.createSegment("L",n,i)]);s.setAttribute("d",o.toString()),this.vel.append(s),this.trigger("path:interact",r),this.trigger("path:control:adjust",r)},removeControlPath:function(){const{pathNode:t}=this,e=this.svgControl.node;e.removeAttribute("d"),this.vel.append(e),this.trigger("path:interact",t),this.trigger("path:control:remove",t)},onPointerDown:function(t){const e=ot(t);if(e.stopPropagation(),e.which>1||e.originalEvent.detail>1||!this.el.parentNode)return;const n=this.vel.toLocalPoint(e.clientX,e.clientY);switch(this.action){case"awaiting-input":this.createPath(n.x,n.y),this.options.enableCurves?this.action="path-created":(this.addLineSegment(n.x,n.y),this.action="adjusting-line-end"),this.delegateDocumentEvents();break;case"adjusting-line-end":this.options.enableCurves?this.action="awaiting-line-end":this.addLineSegment(n.x,n.y);break;case"adjusting-curve-end":this.action="awaiting-curve-control-2";break}this._timeStamp=e.timeStamp},MOVEMENT_DETECTION_THRESHOLD:150,onPointerMove:function(t){const e=ot(t);if(e.stopPropagation(),this.action=="awaiting-input")return;let n,i;const r=this.vel.toLocalPoint(e.clientX,e.clientY),s=this._timeStamp;if(s)if(s&&e.timeStamp-s<this.MOVEMENT_DETECTION_THRESHOLD)switch(this.action){case"path-created":this.options.enableCurves&&(n=this.svgStart.translate(),this.adjustControlPath(n.tx,n.ty,r.x,r.y));break;case"adjusting-line-end":case"awaiting-line-end":case"adjusting-curve-control-1":this.adjustLastSegment(r.x,r.y);break;case"awaiting-curve-control-2":this.adjustLastSegment(r.x,r.y,null,null,r.x,r.y);break}else switch(this.action){case"path-created":this.options.enableCurves&&(this.action="adjusting-curve-control-1");break;case"awaiting-line-end":this.options.enableCurves&&(this.replaceLastSegmentWithCurve(),this.action="adjusting-curve-control-2");break;case"adjusting-line-end":this.options.enableCurves||this.adjustLastSegment(r.x,r.y);break;case"awaiting-curve-control-2":this.action="adjusting-curve-control-2";break;case"adjusting-curve-control-1":n=this.svgStart.translate(),this.adjustControlPath(n.tx,n.ty,r.x,r.y);break;case"adjusting-curve-control-2":i=this.findControlPoint(r.x,r.y),this.adjustLastSegment(null,null,null,null,i.x,i.y),this.adjustControlPath(i.x,i.y,r.x,r.y);break}else switch(this.action){case"adjusting-line-end":this.adjustLastSegment(r.x,r.y);break;case"adjusting-curve-end":this.adjustLastSegment(r.x,r.y,null,null,r.x,r.y);break}},onPointerUp:function(t){this._timeStamp=null;const e=ot(t);if(e.stopPropagation(),e.which>1||e.originalEvent.detail>1)return;const n=this.vel.toLocalPoint(e.clientX,e.clientY);switch(this.action){case"path-created":case"awaiting-line-end":this.addLineSegment(n.x,n.y),this.action="adjusting-line-end";break;case"awaiting-curve-control-2":this.removeControlPath(),this.addLineSegment(n.x,n.y),this.action="adjusting-line-end";break;case"adjusting-curve-control-1":case"adjusting-curve-control-2":this.addCurveSegment(n.x,n.y,n.x,n.y),this.action="adjusting-curve-end";break}},onStartPointPointerDown:function(t){const e=ot(t);e.stopPropagation(),!(e.which>1)&&(e.originalEvent.detail>1||this.closePath())},onDoubleClick:function(t){const e=ot(t);e.preventDefault(),e.stopPropagation(),!(e.which>1)&&this.pathNode&&this.numberOfVisibleSegments()>0&&(this.removeLastSegment(),this.finishPath("path:stop"))},onContextMenu:function(t){const e=ot(t);e.preventDefault(),e.stopPropagation(),!(e.originalEvent.detail>1)&&this.pathNode&&this.numberOfVisibleSegments()>0&&(this.removeLastSegment(),this.finishPath("path:stop"))}}),qo=q,TV=ae.extend({tagName:"g",svgElement:!0,className:"path-editor",events:{"mousedown .anchor-point":"onAnchorPointPointerDown","mousedown .control-point":"onControlPointPointerDown","mousedown .segment-path":"onSegmentPathPointerDown","touchstart .anchor-point":"onAnchorPointPointerDown","touchstart .control-point":"onControlPointPointerDown","touchstart .segment-path":"onSegmentPathPointerDown","dblclick .anchor-point":"onAnchorPointDoubleClick","dblclick .control-point":"onControlPointDoubleClick","dblclick .segment-path":"onSegmentPathDoubleClick"},documentEvents:{mousemove:"onPointerMove",touchmove:"onPointerMove",mouseup:"onPointerUp",touchend:"onPointerUp",touchcancel:"onPointerUp"},options:{anchorPointMarkup:'<circle r="2.5"/>',controlPointMarkup:'<circle r="2.5"/>'},init:function(){const t=this.pathNode=k(this.options.pathElement).normalizePath().node;this.path=K.parse(this.options.pathElement.getAttribute("d")),this.svgRoot=k(t.ownerSVGElement),this.$document=qo(t.ownerDocument),this.render()},onRemove:function(){this.undelegateDocumentEvents(),this.clear()},clear:function(){const{vel:t}=this;t.empty(),this.directionPaths=[],this.segmentPaths=[],this.segmentPathElements=[],this.controlPoints=[],this.anchorPoints=[],this._subPathIndices=[0],this.trigger("clear",this.pathNode)},_transformPoint:function(t,e,n){return k.transformPoint(new L(t,e),n)},_getPathCTM:function(){return this.pathNode.getCTM()},render:function(){this.clear();const{path:t,vel:e,anchorPoints:n,controlPoints:i,directionPaths:r,segmentPaths:s,segmentPathElements:o}=this,a=this._getPathCTM(),l=k(this.options.anchorPointMarkup).addClass("anchor-point"),c=k(this.options.controlPointMarkup).addClass("control-point"),h=k('<path class="direction-path"/>'),u=k('<path class="segment-path"/>'),d=this._subPathIndices;for(let p=0,g=0,v=0;p<t.segments.length;p++){const x=t.getSegment(p),S=this._transformPoint(x.end.x,x.end.y,a);let C=S.x,P=S.y;if(x.type!=="Z"&&(n[p]=l.clone().attr({index:p,cx:C,cy:P})),x.type!=="M"){const O=new K;switch(O.appendSegment(new K.createSegment("M",g,v)),x.type){case"Z":{const m=t.getSegment(d[0]),b=this._transformPoint(m.end.x,m.end.y,a);C=b.x,P=b.y,O.appendSegment(new K.createSegment("L",C,P)),d.unshift(p+1);break}case"L":{O.appendSegment(new K.createSegment("L",C,P));break}case"C":{const m=this._transformPoint(x.controlPoint1.x,x.controlPoint1.y,a),b=c.clone().attr({index:p,"attribute-index":1,cx:m.x,cy:m.y}),w=this._transformPoint(x.controlPoint2.x,x.controlPoint2.y,a),A=c.clone().attr({index:p,"attribute-index":2,cx:w.x,cy:w.y});i[p]=[b,A],O.appendSegment(new K.createSegment("C",m.x,m.y,w.x,w.y,C,P)),r[p]=[h.clone().attr("d",["M",g,v,"L",m.x,m.y].join(" ")),h.clone().attr("d",["M",C,P,"L",w.x,w.y].join(" "))];break}}s[p]=O;const N=u.clone().attr("index",p).node;N.setAttribute("d",O.toString()),o[p]=N}g=C,v=P}const f=[];o.forEach(function(p){p&&f.push(p)}),r.forEach(function(p){p&&Array.prototype.push.apply(f,p)}),n.forEach(function(p){p&&f.push(p)}),i.forEach(function(p){p&&Array.prototype.push.apply(f,p)}),e.append(f),this.svgRoot.append(e)},startMoving:function(t){const e=ot(t),n=this.$point=qo(e.target);this.prevClientX=e.clientX,this.prevClientY=e.clientY;const i=parseInt(this.$point.attr("index"),10);if(this.trigger("path:interact"),n.hasClass("anchor-point"))this.trigger("path:anchor-point:select",i);else if(n.hasClass("control-point")){const r=parseInt(this.$point.attr("attribute-index"),10);this.trigger("path:control-point:select",i,r)}else this.trigger("path:segment:select",i);e.stopPropagation(),e.preventDefault(),this.index=void 0,this.controlPointIndex=void 0,this.segPoint=void 0,this.pathEditedEventType=void 0},move:function(t){const{$point:e}=this;if(!e)return;const n=ot(t),i=n.clientX-this.prevClientX,r=n.clientY-this.prevClientY,s=parseInt(e.attr("index"),10);if(e.hasClass("anchor-point"))this.adjustAnchorPoint(s,i,r,n);else if(e.hasClass("control-point")){const o=parseInt(e.attr("attribute-index"),10);this.adjustControlPoint(s,o,i,r,n)}else this.adjustSegment(s,i,r,n);this.prevClientX=n.clientX,this.prevClientY=n.clientY},adjustSegment:function(t,e,n,i,{dry:r=void 0}={}){this.adjustAnchorPoint(t-1,e,n,{dry:!0}),this.adjustAnchorPoint(t,e,n,{dry:!0}),r||(this.pathEditedEventType="path:segment:adjust",this.index=t,this.trigger("path:editing",this.pathNode,i),this.trigger("path:segment:adjusting",this.pathNode,i,{index:t}))},adjustControlPoint:function(t,e,n,i,r,{dry:s=void 0}={}){const o=this._getPathCTM(),{path:a,controlPoints:l}=this,c=a.getSegment(t),h=o.inverse();h.e=0,h.f=0;const u=this._transformPoint(n,i,h),d="controlPoint"+e;c[d].x+=u.x,c[d].y+=u.y;const f=this._transformPoint(c[d].x,c[d].y,o),p=new L(f);if(l[t][e-1].attr({cx:f.x,cy:f.y}).hasClass("locked")){const v=this.getBoundIndex(t,e),x=e===1?2:1,S=a.getSegment(v),C="controlPoint"+x,P=new L(e===1?S.end.x:c.end.x,e===1?S.end.y:c.end.y),O=new L(c[d].x,c[d].y),N=P.distance(new L(S[C].x,S[C].y)),m=P.move(O,N);S[C].x=m.x,S[C].y=m.y;const b=this._transformPoint(S[C].x,S[C].y,o);l[v][x-1].attr({cx:b.x,cy:b.y}),this.updateDirectionPaths(v),this.updateSegmentPath(v)}this.updateDirectionPaths(t),this.updateSegmentPath(t),s||(this.pathEditedEventType="path:control-point:adjust",this.index=t,this.controlPointIndex=e,this.segPoint=p,this.trigger("path:editing",this.pathNode,r),this.trigger("path:control-point:adjusting",this.pathNode,r,{index:t,controlPointIndex:e,segPoint:p}))},findSubpathIndex:function(t){const e=this._subPathIndices;for(let n=0,i=e.length;n<i;n++)if(e[n]<t)return e[n]},findReversedSubpathIndex:function(t){const e=this._subPathIndices;for(let n=e.length-1;n>=0;n--)if(e[n]>t)return e[n]},adjustAnchorPoint:function(t,e,n,i,{dry:r=void 0}={}){const s=this._getPathCTM(),{path:o,anchorPoints:a,controlPoints:l}=this;let c=o.getSegment(t);c.type==="Z"&&(t=this.findSubpathIndex(t),c=o.getSegment(t));const h=a.length-1;if((t===0||t===h)&&l[1]&&l[h]){const v=l[1][0],x=l[h][1];v&&v.hasClass("locked")&&v.removeClass("locked"),x&&x.hasClass("locked")&&x.removeClass("locked")}const u=s.inverse();u.e=0,u.f=0;const d=this._transformPoint(e,n,u);c.end.x+=d.x,c.end.y+=d.y;const f=this._transformPoint(c.end.x,c.end.y,s),p=new L(f);if(a[t].attr({cx:f.x,cy:f.y}),c.type==="C"){c.controlPoint2.x+=d.x,c.controlPoint2.y+=d.y;const v=this._transformPoint(c.controlPoint2.x,c.controlPoint2.y,s);l[t][1].attr({cx:v.x,cy:v.y})}const g=t+1<o.segments.length?o.getSegment(t+1):0;if(g){if(g.type==="C"){g.controlPoint1.x+=d.x,g.controlPoint1.y+=d.y;const v=this._transformPoint(g.controlPoint1.x,g.controlPoint1.y,s);l[t+1][0].attr({cx:v.x,cy:v.y}),this.updateDirectionPaths(t+1)}this.updateSegmentPath(t+1)}this.updateDirectionPaths(t),this.updateSegmentPath(t),r||(this.pathEditedEventType="path:anchor-point:adjust",this.index=t,this.segPoint=p,this.trigger("path:editing",this.pathNode,i),this.trigger("path:anchor-point:adjusting",this.pathNode,i,{index:t,segPoint:p}))},updateDirectionPaths:function(t){const e=this._getPathCTM(),{path:n}=this,i=n.getSegment(t),r=this._transformPoint(i.end.x,i.end.y,e),s=t>0?n.getSegment(t-1):null,o=s?this._transformPoint(s.end.x,s.end.y,e):null,a=this.directionPaths[t];Array.isArray(a)&&a.forEach(function(l,c){c++;const h=this._transformPoint(i["controlPoint"+c].x,i["controlPoint"+c].y,e);l.attr("d",["M",c>1||!s?r.x:o.x,c>1||!s?r.y:o.y,h.x,h.y].join(" "))},this)},updateSegmentPath:function(t){const{path:e,_subPathIndices:n}=this;if(n.includes(t)){let u=this.findReversedSubpathIndex(t)||this.path.segments.length;if(u--,e.getSegment(u).type!=="Z")return;t=u}let i=this.segmentPaths[t];if(!i)return;const r=this._getPathCTM(),s=e.getSegment(t-1),o=this._transformPoint(s.end.x,s.end.y,r);i=new K;let a=K.createSegment("M",o.x,o.y);i.appendSegment(a);const l=e.getSegment(t),c=this._transformPoint(l.end.x,l.end.y,r);switch(l.type){case"Z":{const u=e.getSegment(this.findSubpathIndex(t)),d=this._transformPoint(u.end.x,u.end.y,r);a=K.createSegment("L",d.x,d.y);break}case"L":{a=K.createSegment("L",c.x,c.y);break}case"C":{const u=this._transformPoint(l.controlPoint1.x,l.controlPoint1.y,r),d=this._transformPoint(l.controlPoint2.x,l.controlPoint2.y,r);a=K.createSegment("C",u.x,u.y,d.x,d.y,c.x,c.y);break}}i.appendSegment(a),this.segmentPaths[t]=i;const h=this.segmentPathElements[t];h&&h.setAttribute("d",i.toString()),this.pathNode.setAttribute("d",e.toString())},stopMoving:function(t){const e=ot(t);if(this.$point=void 0,this.pathEditedEventType){const{pathNode:n,index:i,controlPointIndex:r,segPoint:s}=this;this.trigger("path:edit",n,e),this.trigger(this.pathEditedEventType,n,e,{index:i,controlPointIndex:r,segPoint:s})}this.index=void 0,this.controlPointIndex=void 0,this.segPoint=void 0,this.pathEditedEventType=void 0},createAnchorPoint:function(t){const e=ot(t),n=k(e.target).attr("index"),{pathNode:i,path:r}=this,s=k(i).toLocalPoint(e.pageX,e.pageY),o=r.getSegment(n);switch(o.type){case"Z":{const l=new pt(o.start,o.end).closestPoint(s);r.insertSegment(n,K.createSegment("L",l.x,l.y));break}case"L":{const l=new pt(o.start,o.end).closestPoint(s);r.insertSegment(n,K.createSegment("L",l.x,l.y));break}case"C":{const l=new oe(o.start,o.controlPoint1,o.controlPoint2,o.end).closestPointT(s),c=o.divideAtT(l);r.insertSegment(n,c[0]),o.controlPoint1.x=c[1].controlPoint1.x,o.controlPoint1.y=c[1].controlPoint1.y,o.controlPoint2.x=c[1].controlPoint2.x,o.controlPoint2.y=c[1].controlPoint2.y;break}}this.render(),this.pathNode.setAttribute("d",r.toString()),this.trigger("path:edit",i,e),this.trigger("path:anchor-point:create",i,e)},removeAnchorPoint:function(t){const e=ot(t),n=parseInt(qo(e.target).attr("index"),10),{pathNode:i,path:r}=this,s=r.getSegment(n);let o,a;switch(s.type){case"M":o=r.getSegment(n+1),a=K.createSegment("M",o.end.x,o.end.y),r.replaceSegment(n+1,a),r.removeSegment(n);break;case"L":r.removeSegment(n);break;case"C":n+1<=r.segments.length-1&&(o=r.getSegment(n+1),o.type==="C"&&(o.controlPoint1.x=s.controlPoint1.x,o.controlPoint1.y=s.controlPoint1.y)),r.removeSegment(n);break}this.render(),this.pathNode.setAttribute("d",r.toString()),this.trigger("path:edit",i,e),this.trigger("path:anchor-point:remove",i,e);let l=r.segments.length;r.getSegment(r.segments.length-1).type==="Z"&&(l-=1),l<2&&this.trigger("path:invalid",i,e)},lockControlPoint:function(t){const e=ot(t),n=qo(e.target),i=parseInt(n.attr("index")),r=parseInt(n.attr("attribute-index"),10),s=this.getBoundIndex(i,r),o=r===1?2:1,a=this.controlPoints[s];if(a){const l=n.hasClass("locked");n.toggleClass("locked"),a[o-1].toggleClass("locked"),this.trigger("path:interact"),l?this.trigger("path:control-point:unlock",i,r):(this.trigger("path:control-point:lock",i,r),this.adjustControlPoint(i,r,0,0,{dry:!0}))}},getBoundIndex:function(t,e){let n;const{path:i,anchorPoints:r}=this;let s,o,a,l=r.length-1,c,h;return e===1?(n=t-1,n===0&&(s=i.segments.length-1,o=i.getSegment(s).type,a=o==="Z",c=r[0].attr("cx")===r[l].attr("cx"),h=r[0].attr("cy")===r[l].attr("cy"),a&&c&&h&&(n=l))):(n=t+1,n===l+1&&(s=i.segments.length-1,o=i.getSegment(s).type,a=o==="Z",c=r[0].attr("cx")===r[l].attr("cx"),h=r[0].attr("cy")===r[l].attr("cy"),a&&c&&h&&(n=1))),n},getControlPointLockedStates:function(){const{controlPoints:t}=this,e=[];for(let n=0;n<t.length;n++)if(t[n]){e[n]=[];for(let i=0;i<=1;i++){if(!t[n][i])continue;const r=i+1;t[n][i].hasClass("locked")?e[n][r]=!0:e[n][r]=!1}}return e},setControlPointLockedStates:function(t){const{controlPoints:e}=this;for(let n=0;n<e.length;n++)if(t[n]&&e[n])for(let i=1;i<=2;i++)t[n][i]&&e[n][i-1]&&(t[n][i]===!0?e[n][i-1].addClass("locked"):e[n][i-1].removeClass("locked"))},convertSegmentPath:function(t){const e=ot(t),n=k(e.target).attr("index"),{pathNode:i,path:r}=this,s=r.getSegment(n);switch(s.type){case"Z":r.insertSegment(n,K.createSegment("C",s.start.x,s.start.y,s.end.x,s.end.y,s.end.x,s.end.y));break;case"L":r.replaceSegment(n,K.createSegment("C",s.start.x,s.start.y,s.end.x,s.end.y,s.end.x,s.end.y));break;case"C":r.replaceSegment(n,K.createSegment("L",s.end.x,s.end.y));break}this.render(),this.pathNode.setAttribute("d",r.toString()),this.trigger("path:edit",i,e),this.trigger("path:segment:convert",i,e)},addClosePathSegment:function(t){const e=ot(t),n=parseInt(qo(e.target).attr("index"),10),{path:i,pathNode:r}=this;(n===0||n===i.segments.length-1)&&i.getSegment(i.segments.length-1).type!=="Z"&&(i.appendSegment(K.createSegment("Z")),this.render(),this.pathNode.setAttribute("d",i.toString()),this.trigger("path:edit",r,e),this.trigger("path:closepath-segment:add",r,e))},removeClosePathSegment:function(t){const e=ot(t),n=k(e.target).attr("index"),{path:i,pathNode:r}=this;i.getSegment(n).type==="Z"&&(i.removeSegment(n),this.render(),this.pathNode.setAttribute("d",i.toString()),this.trigger("path:edit",r,e),this.trigger("path:closepath-segment:remove",r,e))},isMoreThanFirstClick:function(){return this.clickCounter=this.clickCounter||0,this.clickCounter+=1,this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.clickCounter=0},400),this.clickCounter>=2?(this.clickCounter=0,clearTimeout(this.timeout),!0):!1},onAnchorPointPointerDown:function(t){const e=ot(t);e.stopPropagation(),e.which===1&&(this.isMoreThanFirstClick()||(this.startMoving(e),this.delegateDocumentEvents()))},onControlPointPointerDown:function(t){const e=ot(t);e.stopPropagation(),e.which===1&&(this.isMoreThanFirstClick()||(this.startMoving(e),this.delegateDocumentEvents()))},onSegmentPathPointerDown:function(t){const e=ot(t);e.stopPropagation(),e.which===1&&(this.isMoreThanFirstClick()||(this.startMoving(e),this.delegateDocumentEvents()))},onPointerMove:function(t){const e=ot(t);e.stopPropagation(),this.move(e)},onPointerUp:function(t){this.undelegateDocumentEvents();const e=ot(t);e.stopPropagation(),this.stopMoving(e)},onAnchorPointDoubleClick:function(t){const e=ot(t);e.stopPropagation(),e.preventDefault(),e.which===1&&this.removeAnchorPoint(e)},onControlPointDoubleClick:function(t){const e=ot(t);e.stopPropagation(),e.preventDefault(),e.which===1&&this.lockControlPoint(e)},onSegmentPathDoubleClick:function(t){const e=ot(t);e.stopPropagation(),e.preventDefault(),e.which===1&&this.createAnchorPoint(e)}}),AV=fw.extend({className:"popup",eventNamespace:"popup",events:{},beforeMount(){const{anchor:t,arrowPosition:e}=this.options;this.$el.removeClass("left right top bottom top-left top-right bottom-left bottom-right"),e?this.$el.addClass(e==="none"?"":e):this.$el.addClass(t==="center"?"":t)},renderContent:function(){const{content:t,arrowPosition:e,anchor:n}=this.options,i=xt(t)?t(this.el):t;if(i&&this.$el.html(i),e!=="none"||n==="center"){const r=document.createElement("div");r.classList.add("popup-arrow");const s=document.createElement("div");s.classList.add("popup-arrow-mask"),this.el.append(r,s)}}}),Ko=q,CV={N:"n",NW:"nw",W:"w",SW:"sw",S:"s",SE:"se",E:"e",NE:"ne"},Ll={NONE:"none",SUBGRAPH:"subgraph",ALL:"all"},PV=ae.extend({options:{paperScroller:void 0,paper:void 0,graph:void 0,boxContent:function(t){return Hn("<%= length %> elements selected.")({length:this.model.length})},handles:[{name:"remove",position:"nw",events:{pointerdown:"removeElements"}},{name:"rotate",position:"sw",events:{pointerdown:"startRotating",pointermove:"doRotate",pointerup:"stopBatch"}},{name:"resize",position:"se",events:{pointerdown:"startResizing",pointermove:"doResize",pointerup:"stopBatch"}}],useModelGeometry:!1,strictSelection:!1,rotateAngleGrid:15,allowTranslate:!0,translateConnectedLinks:Ll.ALL,allowCellInteraction:!1},className:"selection",events:{"mousedown .selection-box":"onSelectionBoxPointerDown","touchstart .selection-box":"onSelectionBoxPointerDown","mousedown .handle":"onHandlePointerDown","touchstart .handle":"onHandlePointerDown",mousewheel:"onMousewheel"},documentEvents:{mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"pointerup",touchend:"pointerup",touchcancel:"pointerup"},_action:null,init:function(){this.options.model&&(this.options.collection=this.options.model);var t=this.collection=this.options.collection||this.collection||new lr;t.comparator||(t.comparator=this.constructor.depthComparator,t.sort()),this.model=t;const e=this.options.paper;if(e instanceof fi)me(this.options,{graph:e.model});else if(typeof Ea=="function"&&e instanceof Ea)this.options.paperScroller=e,this.options.paper=e.options.paper,this.options.graph=e.options.paper.model;else throw new Error("Selection: paper required");ln(this,"startSelecting","stopSelecting","adjustSelection","pointerup"),this.options.paper.$el.append(this.$el),this._boxCount=0,this.$selectionWrapper=this.createSelectionWrapper(),this.handles=[],ft(this.options.handles).forEach(this.addHandle,this),this.startListening()},onCellPointerdown:function(t,e){const{collection:n}=this;n.length!==0&&n.has(t.model)&&(n.length>1&&t.preventDefaultInteraction(e),this.startSelectionInteraction(e,t))},startListening:function(){var t=this.options.paper;this.listenTo(t,"transform",this.onPaperTransformation),this.options.allowCellInteraction&&this.listenTo(t,"cell:pointerdown",this.onCellPointerdown,this);var e=this.options.graph;this.listenTo(e,"reset",this.cancelSelection),this.listenTo(e,"change remove",this.onGraphChange);var n=this.collection;this.listenTo(n,"remove",this.onRemoveElement),this.listenTo(n,"reset",this.onResetElements),this.listenTo(n,"add",this.onAddElement)},onPaperTransformation:function(){this.updateSelectionBoxes({async:!1})},onGraphChange:function(t,e){e.selection!==this.cid&&this.updateSelectionBoxes()},cancelSelection:function(){this.model.reset([],{ui:!0})},addHandle:function(t){this.handles.push(t);var e=Ko("<div/>").addClass("handle "+(t.position||"")+" "+(t.name||"")).data("action",t.name);return t.icon&&e.css("background-image","url("+t.icon+")"),e.html(t.content||""),os(e,t.attrs),this.$selectionWrapper.append(e),Kt(t.events,(function(n,i){te(n)?this.on("action:"+t.name+":"+i,this[n],this):this.on("action:"+t.name+":"+i,n)}).bind(this)),this},stopSelecting:function(t){var e,n=this.options.paper,i=this.eventData(t),r=i.action;switch(r){case"selecting":{var s=this.$el.offset(),o=this.$el.width(),a=this.$el.height();e=n.pageToLocalPoint(s.left,s.top);var l=n.scale();o/=l.sx,a/=l.sy;var c=Ji(e.x,e.y,o,a),h=this.getElementsInSelectedArea(c),u=this.options.filter;Array.isArray(u)?h=h.filter(function(f){return!u.includes(f.model)&&!u.includes(f.model.get("type"))}):xt(u)&&(h=h.filter(function(f){return!u(f.model)}));var d=h.map(function(f){return f.model});this.model.reset(d,{ui:!0});break}case"translating":{i.interactionPrevented||this.options.graph.stopBatch("selection-translate"),e=n.snapToGrid(t.clientX,t.clientY),this.notify("selection-box:pointerup",t,e.x,e.y);break}default:{r||this.cancelSelection();break}}this._action=null},removeHandle:function(t){var e=ft(this.handles).findIndex(function(i){return i.name===t}),n=this.handles[e];return n&&(Kt(n.events,(function(i,r){this.off("action:"+t+":"+r)}).bind(this)),this.$(".handle."+t).remove(),this.handles.splice(e,1)),this},startSelecting:function(t){t=ot(t),this.cancelSelection();const{paperScroller:e,paper:n}=this.options,i=n.localToPaperPoint(n.clientToLocalPoint({x:t.clientX,y:t.clientY}));this.$el.css({width:0,height:0,left:i.x,top:i.y}),this.showLasso();const r=e&&e.options.scrollWhileDragging;this.eventData(t,{action:"selecting",clientX:t.clientX,clientY:t.clientY,origin:i,scrollWhileDragging:r}),this.delegateDocumentEvents(null,t.data),this._action="selecting"},changeHandle:function(t,e){var n=ft(this.handles).find(function(i){return i&&i.name===t});return n&&(this.removeHandle(t),this.addHandle(_e({name:t},n,e))),this},onMousewheel:function(t){t.preventDefault()},onSelectionBoxPointerDown:function(t){t.stopPropagation(),t=ot(t);const e=this.getCellView(t.target);this.startSelectionInteraction(t,e)},startSelectionInteraction:function(t,e){const{paper:n,allowTranslate:i}=this.options,r=e;i&&(!r||r.can("elementMove"))?this.startTranslatingSelection(t):this.eventData(t,{action:"translating",interactionPrevented:!0}),this.eventData(t,{activeElementView:r});const s=n.snapToGrid(t.clientX,t.clientY);this.notify("selection-box:pointerdown",t,s.x,s.y),this.delegateDocumentEvents(null,t.data)},startTranslatingSelection:function(t){const{paperScroller:e,paper:n,graph:i}=this.options;i.startBatch("selection-translate");const r=n.snapToGrid(t.clientX,t.clientY),s=e&&e.options.scrollWhileDragging;this.eventData(t,{action:"translating",snappedClientX:r.x,snappedClientY:r.y,scrollWhileDragging:s}),this._action="translating"},adjustSelection:function(t){t=ot(t);let e,n;const{paperScroller:i,paper:r,graph:s}=this.options,o=r.clientToLocalPoint({x:t.clientX,y:t.clientY}),a=this.eventData(t),{action:l,scrollWhileDragging:c,interactionPrevented:h=!1}=a;switch(l){case"selecting":{const N=r.localToPaperPoint(o);e=N.x-a.origin.x,n=N.y-a.origin.y;const m=Math.abs(e),b=Math.abs(n),w=parseFloat(window.getComputedStyle(this.el).getPropertyValue("border-width"));this.$el.css({left:e<0?N.x:a.origin.x,top:n<0?N.y:a.origin.y,width:m-w*2,height:b-w*2});break}case"translating":{var u=r.snapToGrid(t.clientX,t.clientY),d=u.x,f=u.y;if(h){this.notify("selection-box:pointermove",t,d,f);break}e=d-a.snappedClientX,n=f-a.snappedClientY;var p=r.getRestrictedArea();if(p){var g=this.model.toArray(),v=s.getCellsBBox(g),x=p.x-v.x,S=p.y-v.y,C=p.x+p.width-(v.x+v.width),P=p.y+p.height-(v.y+v.height);e<x&&(e=x),n<S&&(n=S),e>C&&(e=C),n>P&&(n=P)}if(e||n){if(this.translateSelectedElements(e,n),this.boxesUpdated)(this.model.length>1||this.options.allowCellInteraction)&&this.updateSelectionBoxes();else{var O=r.scale();const N=this.$el.children(".selection-box").add(this.$selectionWrapper);for(let m=0;m<N.length;m++){const b=N[m],w=parseFloat(b.style.top)||0,A=parseFloat(b.style.left)||0;b.style.top=`${w+n*O.sy}px`,b.style.left=`${A+e*O.sx}px`}}a.snappedClientX=d,a.snappedClientY=f}this.notify("selection-box:pointermove",t,d,f);break}default:{l&&this.pointermove(t);break}}this.boxesUpdated=!1,c&&i.scrollWhileDragging(t,o.x,o.y,c)},translateSelectedElements:function(t,e){var n={};const{collection:i}=this,{graph:r,translateConnectedLinks:s}=this.options;i.toArray().forEach(o=>{if(n[o.id])return;const a={selection:this.cid};o.translate(t,e,a),n[o.id]=!0,o.getEmbeddedCells({deep:!0}).forEach(function(l){n[l.id]=!0}),s!==Ll.NONE&&r.getConnectedLinks(o).forEach(function(c){if(!n[c.id]){if(s===Ll.SUBGRAPH){const h=c.getSourceCell();if(h&&!i.get(h))return;const u=c.getTargetCell();if(u&&!i.get(u)||!h||!u)return}c.translate(t,e,a),n[c.id]=!0}})})},notify:function(t,e){var n=this.eventData(e),i=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t,n.activeElementView].concat(i))},getElementsInSelectedArea:function(t){var e=this.options.paper,n={strict:this.options.strictSelection};if(this.options.useModelGeometry){var i=e.model.findModelsInArea(t,n);return i.map(e.findViewByModel,e).filter(function(r){return!!r})}return e.findViewsInArea(t,n)},pointerup:function(t){const e=this.eventData(t),{action:n,scrollWhileDragging:i}=e;if(!n)return;t=ot(t);const{paper:r,paperScroller:s}=this.options,{x:o,y:a}=r.snapToGrid({x:t.clientX,y:t.clientY});n!=="selecting"&&n!=="translating"&&this.triggerAction(n,"pointerup",t,o,a),i&&s.stopScrollWhileDragging(t),this.stopSelecting(t),this.undelegateDocumentEvents(),this._action=null},destroySelectionBox:function(t){this.$('[data-model="'+t.get("id")+'"]').remove(),this.$el.children(".selection-box").length===0&&this.hide(),this._boxCount=Math.max(0,this._boxCount-1)},hide:function(){this.$el.removeClass("lasso selected")},showSelected:function(){this.$el.addClass("selected")},showLasso:function(){this.$el.addClass("lasso")},destroyAllSelectionBoxes:function(){this.hide(),this.$el.children(".selection-box").remove(),this._boxCount=0},createSelectionBox:function(t){const e=this.getCellBBox(t);if(!e)return;const n=Ko("<div/>").addClass("selection-box").data("model",t.id).css({left:e.x,top:e.y,width:e.width,height:e.height}).appendTo(this.el);this.options.allowCellInteraction&&n.addClass("selection-box-no-events"),this.showSelected(),this._boxCount++},createSelectionWrapper:function(){var t=Ko("<div/>").addClass("selection-wrapper").data("selectionLength",this.model.length),e=Ko("<div/>").addClass("box");return t.append(e),this.$el.prepend(t),t},getCellBBox(t){const{paper:e,useModelGeometry:n}=this.options,i=e.findViewByModel(t);return i?i.getBBox({useModelGeometry:n}):null},getWrapperBBox(){const t=[];return this.collection.models.forEach(e=>{const n=this.getCellBBox(e);n&&t.push(n)}),J.fromRectUnion(...t)},updateSelectionWrapper:function(){const{collection:t,$selectionWrapper:e}=this;let n,i,r,s;const o=this.getWrapperBBox();o?{x:n,y:i,width:r,height:s}=o:(n="",i="",r=0,s=0),e.css({left:n,top:i,width:r,height:s}),e.data("selectionLength",t.length),this.updateBoxContent()},updateBoxContent:function(){const{boxContent:t}=this.options;if(xt(t)){const e=this.$(".box"),n=t.call(this,e[0]);n&&e.html(n)}},updateSelectionBoxes:function(t){this.collection.length!==0&&(this.boxesUpdated=!0,this.options.paper.requestViewUpdate(this,1,this.UPDATE_PRIORITY,t))},confirmUpdate:function(){this._updateSelectionBoxes()},_updateSelectionBoxes:function(){if(this._boxCount){this.hide();for(var t=this.$el.children(".selection-box"),e=0,n=t.length;e<n;e++){var i=t[e],r=Ko(i).remove().data("model"),s=this.model.get(r);s&&this.createSelectionBox(s)}this.updateSelectionWrapper()}},onHandlePointerDown:function(t){var e=t.currentTarget.dataset.action;if(!e)return;const{paperScroller:n,paper:i}=this.options;t.preventDefault(),t.stopPropagation(),t=ot(t);const{x:r,y:s}=i.snapToGrid({x:t.clientX,y:t.clientY});if(t.type==="mousedown"&&t.button===2)this.triggerAction(e,"contextmenu",t,r,s);else{this.triggerAction(e,"pointerdown",t,r,s);const o=n&&n.options.scrollWhileDragging;this.eventData(t,{action:e,clientX:t.clientX,clientY:t.clientY,startClientX:t.clientX,startClientY:t.clientY,scrollWhileDragging:o}),this.delegateDocumentEvents(null,t.data)}this._action=e},getCellView:function(t){var e=this.model.get(t.getAttribute("data-model"));return e&&e.findView(this.options.paper)},pointermove:function(t){const e=this.eventData(t),{action:n}=e;if(!n)return;const{clientX:i,clientY:r}=t,{paper:s}=this.options,{x:o,y:a}=s.snapToGrid(i,r),{x:l,y:c}=s.snapToGrid(e.clientX,e.clientY),h=o-l,u=a-c;this.triggerAction(n,"pointermove",t,o,a,h,u),e.clientX=i,e.clientY=r},triggerAction:function(t,e,n){var i=Array.prototype.slice.call(arguments,2);i.unshift("action:"+t+":"+e),this.trigger.apply(this,i)},onRemoveElement:function(t){this.destroySelectionBox(t),this.updateSelectionWrapper()},onResetElements:function(t){this.destroyAllSelectionBoxes(),t.toArray().forEach(this.createSelectionBox.bind(this)),this.updateSelectionWrapper()},onAddElement:function(t){this.createSelectionBox(t),this.updateSelectionWrapper()},removeElements:function(t){var e=this.collection.toArray();this.cancelSelection(),this.options.graph.removeCells(e,{selection:this.cid})},startRotating:function(t){const{paper:e,graph:n}=this.options;n.trigger("batch:start");const i=this.collection.toArray(),r=n.getCellsBBox(this.model.models).center(),s=e.snapToGrid(t.clientX,t.clientY),o=i.reduce(function(l,c){return l[c.id]=c.angle(),l},{}),a=i.reduce(function(l,c){return c.isLink()&&(l[c.id]={source:c.getSourceCell()?null:c.get("source"),target:c.getTargetCell()?null:c.get("target"),vertices:c.vertices()}),l},{});this.eventData(t,{center:r,clientAngle:s.theta(r),initialAngles:o,initialPoints:a})},startResizing:function(t){const{options:e,collection:n}=this,{paperScroller:i,paper:r,graph:s}=e,{gridSize:o}=r.options,a=n.toArray(),{width:l,height:c}=s.getCellsBBox(a),{x:h,y:u}=r.snapToGrid(t.clientX,t.clientY),d=a.map(P=>{const O=P.angle(),N=P.getBBox(),m=N.bbox(O);let b;return O<=90?b=O/90:O<=270?b=Math.abs(180-O)/90:b=Math.abs(O-360)/90,{angle:O,unrotatedBBox:N,bbox:m,factor:b,center:m.center()}}),f=d.reduce((P,O)=>{const N=O.unrotatedBBox;return N.width<P?N.width:P},1/0),p=d.reduce((P,O)=>{const N=O.unrotatedBBox;return N.height<P?N.height:P},1/0),g=s.getSubgraph(a),v=g.filter(P=>P.isLink()),x=v.map(P=>({source:P.getSourceCell()?null:P.get("source"),target:P.getTargetCell()?null:P.get("target"),vertices:P.vertices()})),S=s.getCellsBBox(g),C=i&&i.options.scrollWhileDragging;this.eventData(t,{size:{width:l,height:c},rotatedBBox:s.getCellsBBox(a),minWidth:o*l/f,minHeight:o*c/p,x0:h,y0:u,pointerX:h,pointerY:u,elements:a,elementsRecords:d,links:v,linksRecords:x,cellsBBox:S,scrollWhileDragging:C}),s.trigger("batch:start")},doResize:function(t){const e=this.eventData(t),{size:n,rotatedBBox:i,minWidth:r,minHeight:s,x0:o,y0:a,pointerX:l,pointerY:c,elements:h,elementsRecords:u,links:d,linksRecords:f,cellsBBox:p}=e,{x:g,y:v}=this.options.paper.snapToGrid(t.clientX,t.clientY);if(g===l&&v===c)return;e.lastX=g,e.lastY=v;const{width:x,height:S}=n;let C=Math.max(x+g-o,r),P=Math.max(S+v-a,s);if(this.options.preserveAspectRatio){const m=x*P/S,b=S*C/x;m>C?P=b:C=m}const O=Math.max(C/x,0),N=Math.max(P/S,0);for(let m=0,b=h.length;m<b;m++){const w=h[m],{bbox:A,unrotatedBBox:E,factor:M,center:$,angle:F}=u[m],j=new L(O,N).lerp(new L(N,O),M),R=E.clone().scale(j.x,j.y,$),H=R.bbox(F);let z=H.width-A.width,B=H.height-A.height;Math.abs(z)<.001&&(z=0),Math.abs(B)<.001&&(B=0);const _t=new L(i.x,0).distance(new L(A.x,0)),gt=new L(0,i.y).distance(new L(0,A.y));let Rt=z/2+_t*O-_t,ne=B/2+gt*N-gt;if(Math.abs(Rt)<.001&&(Rt=0),Math.abs(ne)<.001&&(ne=0),R.translate(Rt,ne),m===0&&w.getBBox().equals(R))return;w.set({position:{x:R.x,y:R.y},size:{width:R.width,height:R.height}},{selection:this.cid})}for(let m=0,b=d.length;m<b;m++){const w=d[m],{source:A,target:E,vertices:M}=f[m],$={};if(M.length>0&&($.vertices=M.map(F=>{const j=new L(F);return j.scale(O,N,p.origin()),j.toJSON()})),A){const F=new L(A);F.scale(O,N,p.origin()),$.source=F.toJSON()}if(E){const F=new L(E);F.scale(O,N,p.origin()),$.target=F.toJSON()}w.set($,{selection:this.cid})}this.updateSelectionBoxes()},doRotate:function(t){var e=this.eventData(t),n=this.options.rotateAngleGrid,i=this.options.paper.snapToGrid(t.clientX,t.clientY),r=e.clientAngle-re(i).theta(e.center);Math.abs(r)>.001&&(this.collection.toArray().forEach(s=>{const o=ii(e.initialAngles[s.id]+r,n);if(s.isLink()){const{source:a,target:l,vertices:c}=e.initialPoints[s.id],h=d=>L(d).rotate(e.center,-o),u={};return a&&(u.source=h(a)),l&&(u.target=h(l)),c.length>0&&(u.vertices=c.map(h)),s.set(u,{selection:this.cid})}else s.rotate(o,!0,e.center,{selection:this.cid})}),this.updateSelectionBoxes())},stopBatch:function(){this.options.graph.trigger("batch:stop")},getAction:function(){return this._action}},{depthComparator:function(t){return t.getAncestors().length},HandlePosition:CV,ConnectedLinksTranslation:Ll}),Rm=q,IV={N:"n",NW:"nw",W:"w",SW:"sw",S:"s",SE:"se",E:"e",NE:"ne"},OV=ae.extend({options:{paper:void 0,usePaperGrid:!1,distance:10,canSnap:null,additionalSnapPoints:null},className:"snaplines",documentEvents:{mouseup:"hide",touchend:"hide"},init:function(){ln(this,"hide"),this.render(),this.enable(),this.prepareFilters()},render:function(){const{$el:t,options:e}=this,n=this.$horizontal=Rm("<div>").addClass("snapline horizontal"),i=this.$vertical=Rm("<div>").addClass("snapline vertical");t.css("display","none").append([n,i]).appendTo(e.paper.el)},startListening:function(){this.enable()},_isEnabled:!1,enable:function(){const{paper:t}=this.options;this.disable(),this.listenTo(t,"element:pointerdown",this.captureCursorOffset),this.listenTo(t,"element:pointermove",this.snapWhileMoving),this.listenTo(t.model,"batch:stop",this.onBatchStop),this.delegateDocumentEvents(),this._isEnabled=!0},disable:function(){const{paper:t}=this.options;this.stopListening(t,"element:pointerdown",this.captureCursorOffset),this.stopListening(t,"element:pointermove",this.snapWhileMoving),this.stopListening(t.model,"batch:stop",this.onBatchStop),this.undelegateDocumentEvents(),this._isEnabled=!1},isDisabled:function(){return!this._isEnabled},prepareFilters:function(){this.filterTypes={},this.filterCells={},this.filterFunction=void 0,Array.isArray(this.options.filter)?this.options.filter.forEach(function(t){te(t)?this.filterTypes[t]=!0:this.filterCells[t.id]=!0},this):xt(this.options.filter)&&(this.filterFunction=this.options.filter)},onBatchStop:function(t){t=t||{},t.batchName==="resize"&&this.snapWhileResizing(t.cell,t)},captureCursorOffset:function(t,e,n,i){var r=t.getDelegatedView();if(!r)return;var s=r.model.get("position");let o;xt(this.options.additionalSnapPoints)&&(o=this.options.additionalSnapPoints.call(this,t,{type:"move"})),this.eventData(e,{cursorOffset:{x:n-s.x,y:i-s.y},points:o})},snapWhileResizing:function(t,e){if(!(!e.ui||e.snapped||!e.direction||!e.trueDirection)){var n=this.options,i=n.paper,r=i.findViewByModel(t);if(!(!r||!r.model.isElement()||!this.canElementSnap(r))){var s=t.getBBox(),o=s.bbox(t.get("angle")),a=o.origin(),l=o.corner(),c=Qe(t.get("angle")),h=n.distance,u=null,d=null,f=i.options.gridSize,p={vertical:0,horizontal:0},g=e.direction,v=e.trueDirection,x=e.relativeDirection;if(v.indexOf("right")!==-1?p.vertical=l.x:p.vertical=a.x,v.indexOf("bottom")!==-1?p.horizontal=l.y:p.horizontal=a.y,xt(this.options.additionalSnapPoints)){const F=this.options.additionalSnapPoints.call(this,r,{type:"resize"});for(let j=0;j<F.length;j++){const R=F[j];if(u===null&&Math.abs(R.x-p.vertical)<h&&(u=R.x),d===null&&Math.abs(R.y-p.horizontal)<h&&(d=R.y),Ot(u)&&Ot(d))break}}if(Ot(u)&&Ot(d)||i.model.getElements().find(function(F){if(F.id===t.id||F.isEmbeddedIn(t)||this.filterTypes[F.get("type")]||this.filterCells[F.id]||this.filterFunction&&this.filterFunction(F))return!1;var j=F.getBBox().bbox(F.get("angle")),R=j.origin(),H=j.corner();n.usePaperGrid&&(R.snapToGrid(f),H.snapToGrid(f));var z={vertical:[R.x,H.x],horizontal:[R.y,H.y]};return Kt(z,function(B,_t){B=B.map(function(gt){return{position:gt,distance:Math.abs(gt-p[_t])}}),B=B.filter(function(gt){return gt.distance<h}),B=Je(B,function(gt){return gt.distance}),z[_t]=B}),u===null&&z.vertical.length>0&&(u=z.vertical[0].position),d===null&&z.horizontal.length>0&&(d=z.horizontal[0].position),Ot(u)&&Ot(d)},this),this.hide(),Ot(u)||Ot(d)){var S=0;Ot(u)&&(v.indexOf("right")!==-1?S=u-o.corner().x:S=o.origin().x-u);var C=0;Ot(d)&&(v.indexOf("bottom")!==-1?C=d-o.corner().y:C=o.origin().y-d);var P=0,O=0,N=!(c%90);if(N)c===90||c===270?(P=C,O=S):(P=S,O=C);else{var m;c>=0&&c<90?m=1:c>=90&&c<180?m=4:c>=180&&c<270?m=3:m=2,d&&u&&(C>S?(C=0,d=null):(S=0,u=null));var b=an(c%90);S&&(m===3?P=S/Math.cos(b):P=S/Math.sin(b)),C&&(m===3?O=C/Math.cos(b):O=C/Math.sin(b));var w=m===1||m===3;switch(x){case"top":case"bottom":C?O=C/(w?Math.cos(b):Math.sin(b)):O=S/(w?Math.sin(b):Math.cos(b));break;case"left":case"right":S?P=S/(w?Math.cos(b):Math.sin(b)):P=C/(w?Math.sin(b):Math.cos(b));break}}switch(x){case"top":case"bottom":P=0;break;case"left":case"right":O=0;break}var A=Math.max(s.width+P,f),E=Math.max(s.height+O,f);e.minWidth&&e.minWidth>f&&(A=Math.max(A,e.minWidth)),e.minHeight&&e.minHeight>f&&(E=Math.max(E,e.minHeight)),e.maxWidth&&(A=Math.min(A,e.maxWidth)),e.maxHeight&&(E=Math.min(E,e.maxHeight)),e.preserveAspectRatio&&(P>O?E=A*(s.height/s.width):A=E*(s.width/s.height)),(A!==s.width||E!==s.height)&&t.resize(A,E,{snaplines:this.cid,direction:g,relativeDirection:x,trueDirection:v,snapped:!0});var M=t.getBBox().bbox(c),$=1;u&&Math.abs(M.x-u)>$&&Math.abs(M.width+M.x-u)>$&&(u=null),d&&Math.abs(M.y-d)>$&&Math.abs(M.height+M.y-d)>$&&(d=null),this.show({vertical:u,horizontal:d})}}}},canElementSnap:function(t,e){let n=!0,i=!1;return xt(this.options.canSnap)&&(n=this.options.canSnap.call(this,t)),e&&(i=t.isDefaultInteractionPrevented(e)),n&&this.canElementMove(t)&&!i},canElementMove:function(t){return t&&t.model.isElement()&&t.can("elementMove")},snapWhileMoving:function(t,e,n,i){var r=t.eventData(e);const s=this.eventData(e);var o=r.delegatedView||t;if(this.canElementSnap(o,e)){var a=o.model,l=a.get("size"),c=Ji(U({x:n-s.cursorOffset.x,y:i-s.cursorOffset.y},l)),h=c.center(),u=c.bbox(a.get("angle")),d=u.origin(),f=u.corner(),p=this.options,g=p.paper,v=p.distance,x=null,S=null,C=0,P=0;if(s.points){const w=s.points;for(let A=0;A<w.length;A++){const E=w[A];if(x===null&&(Math.abs(E.x-h.x)<v?(x=E.x,C=.5):Math.abs(E.x-d.x)<v?x=E.x:Math.abs(E.x-f.x)<v&&(x=E.x,C=1)),S===null&&(Math.abs(E.y-h.y)<v?(S=E.y,P=.5):Math.abs(E.y-d.y)<v?S=E.y:Math.abs(E.y-f.y)<v&&(S=E.y,P=1)),Ot(x)&&Ot(S))break}}if(Ot(x)&&Ot(S)||g.model.getElements().find(function(w){if(w===a||w.isEmbeddedIn(a)||this.filterTypes[w.get("type")]||this.filterCells[w.id]||this.filterFunction&&this.filterFunction(w))return!1;var A=w.getBBox().bbox(w.get("angle")),E=A.center(),M=A.origin(),$=A.corner();return x===null&&(Math.abs(E.x-h.x)<v?(x=E.x,C=.5):Math.abs(M.x-d.x)<v?x=M.x:Math.abs(M.x-f.x)<v?(x=M.x,C=1):Math.abs($.x-f.x)<v?(x=$.x,C=1):Math.abs($.x-d.x)<v&&(x=$.x)),S===null&&(Math.abs(E.y-h.y)<v?(S=E.y,P=.5):Math.abs(M.y-d.y)<v?S=M.y:Math.abs(M.y-f.y)<v?(S=M.y,P=1):Math.abs($.y-f.y)<v?(S=$.y,P=1):Math.abs($.y-d.y)<v&&(S=$.y)),Ot(x)&&Ot(S)},this),this.hide(),Ot(x)||Ot(S)){Ot(x)&&(u.x=x-C*u.width),Ot(S)&&(u.y=S-P*u.height);var O=u.center(),N=O.x-c.width/2,m=O.y-c.height/2,b=new L(N,m);p.usePaperGrid&&b.snapToGrid(g.options.gridSize),a.position(b.x,b.y,{restrictedArea:g.getRestrictedArea(o,n,i),deep:!0,snapped:!0}),this.show({vertical:x,horizontal:S})}}},show:function(t={}){const{vertical:e,horizontal:n}=t,{options:i,$horizontal:r,$vertical:s,$el:o}=this,{a,d:l,e:c,f:h}=i.paper.matrix();Ot(n)?r.css("top",n*l+h).css("display",""):r.css("display","none"),Ot(e)?s.css("left",e*a+c).css("display",""):s.css("display","none"),o.css("display","")},hide:function(){this.$el.css("display","none")}},{HandlePosition:IV});class kV extends hn{constructor(e){super(e),this.update()}defaults(){return{stackGap:10,stackElementGap:10,direction:un.Directions.TopBottom,stackIndexAttributeName:"stackIndex",stackElementIndexAttributeName:"stackElementIndex"}}update(){const e=un.layout(this.elements,this.attributes);this.bbox=e.bbox,this.stacks=e.stacks,this.trigger("update")}getStackFromPoint(e){for(let n=0;n<this.stacks.length;n++){const i=this.stacks[n],{bbox:r}=i;if((this.direction===un.Directions.BottomTop||this.direction===un.Directions.TopBottom)&&e.x>=r.x&&e.x<r.x+r.width||(this.direction===un.Directions.RightLeft||this.direction===un.Directions.LeftRight)&&e.y>=r.y&&e.y<r.y+r.height)return i}return null}getInsertElementIndexFromPoint(e,n){const{elements:i}=e,r=i.length;if(r===0)return 0;switch(this.direction){case un.Directions.TopBottom:{for(let s=0;s<r;s++){const o=i[s],a=o.position().y+o.size().height/2;if(n.y<a)return s}return r}case un.Directions.BottomTop:{for(let s=0;s<r;s++){const o=i[s],a=o.position().y+o.size().height/2;if(n.y>a)return s}return r}case un.Directions.LeftRight:for(let s=0;s<r;s++){const o=i[s],a=o.position().x+o.size().width/2;if(n.x<a)return s}return r;case un.Directions.RightLeft:for(let s=0;s<r;s++){const o=i[s],a=o.position().x+o.size().width/2;if(n.x>a)return s}return r}}getStackFromElement(e){return this.stacks[e.get(this.stackIndexAttributeName)]}hasElement(e){return e.has(this.stackIndexAttributeName)}insertElement(e,n,i,r){const s=this.get("graph");s.startBatch("stack-layout-insert"),s.getCell(e)||s.addCell(e,r);const{stackIndexAttributeName:o,stackElementIndexAttributeName:a}=this,l=this.stacks[n];let c;if(l){const{elements:h}=l,u=h[i],{length:d}=h;if(u){c=u.get(a);for(let f=i;f<d;f++){const p=h[f],g=p.get(a)||0;p.set(a,g+1,r)}}else d>0?c=(h[h.length-1].get(a)||0)+1:c=0}else c=0;e.set({[o]:n,[a]:c},r),this.update(),s.stopBatch("stack-layout-insert")}get elements(){return this.get("graph").getElements().filter(n=>n.has(this.stackIndexAttributeName))}get direction(){return this.get("direction")}get stackIndexAttributeName(){return this.get("stackIndexAttributeName")}get stackElementIndexAttributeName(){return this.get("stackElementIndexAttributeName")}}const LV=(t,e)=>{const{direction:n}=e.model,{targetStack:i,invalid:r}=t,s=k("path",{stroke:r?"#ccc":"#333","stroke-width":2});switch(n){case un.Directions.RightLeft:case un.Directions.LeftRight:{const{height:o}=i.bbox;s.attr("d",`M 0 ${-o/2} v ${o}`);break}case un.Directions.TopBottom:case un.Directions.BottomTop:default:{const{width:o}=i.bbox;s.attr("d",`M ${-o/2} 0 h ${o}`);break}}return s.node},MV=(t,e)=>!0,DV=(t,e,n)=>t.insertElementIndex,NV=(t,e)=>e.model.hasElement(t.model);class RV extends ae{constructor(e){super(e),this.currentEventData={},this.paper=e.paper,this.model||(this.model=new kV(Object.assign({},e.layoutOptions,{graph:this.paper.model}))),this.previewFunction=e.preview||LV,this.validateMoving=e.validateMoving||MV,this.canInteract=e.canInteract||NV,this.modifyInsertElementIndex=e.modifyInsertElementIndex||DV,this.startListening()}preinitialize(){this.svgElement=!0,this.tagName="g"}startListening(){const{paper:e}=this;this.listenTo(e,"element:pointerdown",this.onPaperPointerdown),this.listenTo(e,"element:pointermove",this.onPaperPointermove),this.listenTo(e,"element:pointerup",this.onPaperPointerup)}getPreviewPosition(e,n){const i=this.model.get("stackElementGap")/2,{direction:r}=this.model,{bbox:s,elements:o}=e,a=o.length,l=o[n],c={x:0,y:0};switch(r){case un.Directions.TopBottom:{if(c.x=s.x+s.width/2,l)c.y=l.position().y-i;else{const h=o[a-1];h?c.y=h.position().y+h.size().height+i:c.y=s.y-i}break}case un.Directions.BottomTop:{if(c.x=s.x+s.width/2,l)c.y=l.position().y+l.size().height+i;else{const h=o[a-1];h?c.y=h.position().y-i:c.y=s.y+s.height+i}break}case un.Directions.LeftRight:if(c.y=s.y+s.height/2,l)c.x=l.position().x-i;else{const h=o[a-1];h?c.x=h.position().x+h.size().width+i:c.x=s.x-i}break;case un.Directions.RightLeft:if(c.y=s.y+s.height/2,l)c.x=l.position().x+l.size().width+i;else{const h=o[a-1];h?c.x=h.position().x-i:c.x=s.x+s.width+i}break}return c}createGhost(e){const{vel:n}=e,i=n.clone();return i.attr("opacity",.4),i.node.style.transform="",i.addClass("stack-layout-ghost"),i}dragstart(e,n,i){const r=this.model.getStackFromElement(e);this.currentEventData||(this.currentEventData={}),Object.assign(this.currentEventData,{sourceStack:r})}drag(e,n,i){if(!this.currentEventData)return;const r={x:n,y:i},{sourceStack:s}=this.currentEventData;let{preview:o}=this.currentEventData;const a=this.model.getStackFromPoint(r);if(a){let l;s&&(l=s.elements.findIndex(h=>h.id===e.id));let c=this.model.getInsertElementIndexFromPoint(a,r);if(c=this.modifyInsertElementIndex({sourceStack:s,sourceElement:e,targetStack:a,insertElementIndex:c},new L(r),this),a!==s||c!==l&&c!==l+1){if(a!==this.currentEventData.targetStack||c!==this.currentEventData.insertElementIndex){const h=!this.validateMoving({sourceStack:s,sourceElement:e,targetStack:a,insertElementIndex:c},this);o&&o.remove(),o=k(this.previewFunction({sourceStack:s,sourceElement:e,targetStack:a,insertElementIndex:c,invalid:h},this)),o.addClass("stack-layout-preview"),h&&o.addClass("stack-layout-preview-invalid"),o.appendTo(this.paper.getLayerNode(fi.Layers.FRONT));const u=this.getPreviewPosition(a,c);k(o).attr("transform",`translate(${u.x},${u.y})`),Object.assign(this.currentEventData,{invalid:h,preview:o,targetStack:a,insertElementIndex:c})}return}}o&&o.remove(),delete this.currentEventData.invalid,delete this.currentEventData.preview,delete this.currentEventData.targetStack,delete this.currentEventData.insertElementIndex}dragend(e,n,i){if(!this.currentEventData)return;const{preview:r,targetStack:s,insertElementIndex:o,invalid:a}=this.currentEventData;r&&r.remove(),!(!s||a)&&(this.model.insertElement(e,s.index,o,{stackLayoutView:this.cid}),delete this.currentEventData)}cancelDrag(){if(!this.currentEventData)return;const{preview:e}=this.currentEventData;e&&e.remove(),delete this.currentEventData}canDrop(){if(!this.currentEventData)return!1;const{targetStack:e,invalid:n}=this.currentEventData;return e&&!n}onPaperPointerdown(e,n,i,r){if(!this.canInteract(e,this)){delete this.currentEventData;return}if(e.can("elementMove"))throw new Error('ui.StackLayoutView: requires the "elementMove" interactivity set to false. e.g. paper.setInteractivity(false)');const{model:s}=e;this.dragstart(s,i,r);const o=s.position();Object.assign(this.currentEventData,{ghost:this.createGhost(e),dx:i-o.x,dy:r-o.y})}onPaperPointermove(e,n,i,r){const{currentEventData:s}=this;if(!s)return;const{model:o}=e;this.drag(o,i,r);const{ghost:a,dx:l,dy:c,invalid:h}=s;a&&(a.attr("transform",`translate(${i-l},${r-c})`),a.parent()||a.appendTo(this.paper.getLayerNode(fi.Layers.FRONT)),a.toggleClass("stack-layout-ghost-invalid",!!h))}onPaperPointerup(e,n,i,r){const{currentEventData:s}=this;if(!s)return;const{ghost:o}=s;o&&o.remove();const{model:a}=e;this.dragend(a,i,r)}}const Jn=q;var $m={options:function(){return{columnWidth:this.options.width/2-10,columns:2,rowHeight:80,rowGap:10,columnGap:10,marginX:10,marginY:10,resizeToFit:!0}},layoutGroup:function(t,e){var n=this.options.layout;if(e=e||{},!td)throw new Error("ui.Stencil: joint.layout.GridLayout is not available.");td.layout(t,U({},n,e.layout))}};const rp=ae.extend({className:"stencil",events:{"click .btn-expand":"openGroups","click .btn-collapse":"closeGroups","click .groups-toggle > .group-label":"openGroups","click .group > .group-label":"onGroupLabelClick","touchstart .group > .group-label":"onGroupLabelClick","input .search":"onSearch","focusin .search":"pointerFocusIn","focusout .search":"pointerFocusOut"},documentEvents:{mousemove:"onDrag",touchmove:"onDrag",mouseup:"onDragEnd",touchend:"onDragEnd",touchcancel:"onDragEnd"},options:{width:200,height:800,label:"Stencil",groups:null,groupsToggleButtons:!1,dropAnimation:!1,search:null,layout:null,snaplines:null,scaleClones:!1,usePaperGrid:!1,dragStartClone:function(t){return t.clone()},dragEndClone:function(t){return t.clone()},canDrag:null,layoutGroup:null,paperOptions:null,paperDragOptions:null,paperPadding:10,contentOptions:null,container:null},DEFAULT_GROUP:"__default__",init:function(){this.setPaper(this.options.paperScroller||this.options.paper),this.graphs={},this.papers={},this.$groups={},this.onSearch=Ga(this.onSearch,200),this.delegateEvents(),this.initializeLayout()},initializeLayout:function(){var t=this.options.layout;t&&(xt(t)?this.layoutGroup=t:(this.layoutGroup=$m.layoutGroup.bind(this),this.options.layout=Nt(t)?t:$m.options.call(this)))},setPaper:function(t){var e=this.options;if(t instanceof fi)e.paperScroller=null,e.paper=t,e.graph=t.model;else if(typeof Ea=="function"&&t instanceof Ea)e.paperScroller=t,e.paper=t.options.paper,e.graph=t.options.paper.model;else throw new Error("ui.Stencil: paper required")},freeze(t){const{papers:e}=this;Object.keys(e).forEach(n=>{e[n].freeze(t)})},unfreeze(t){const{papers:e}=this;Object.keys(e).forEach(n=>{e[n].unfreeze(t)})},renderContent:function(){return Jn("<div/>").addClass("content")},createDraggingPaper:function(){if(this._paperDrag)return;const{options:t}=this,e=document.createElement("div");e.classList.add("stencil-paper-drag");const n=Qt(t,"paperOptions")||{},i=Qt(t,"paperDragOptions")||{},r=this._graphDrag=i.model||n.model||new li({},{cellNamespace:this.defaultCellNamespace}),s=U({cellViewNamespace:this.defaultCellViewNamespace},i,{el:e,width:1,height:1,model:r,sorting:fi.sorting.NONE}),o=new fi(s);o.el.style.position="absolute",this._paperDrag=o},renderSearch:function(){const t=Jn("<input/>").addClass("search").attr({type:"search",placeholder:"search"});return Jn("<div/>").addClass("search-wrap").append(t)},renderToggleAll:function(){return[Jn("<div/>").addClass("groups-toggle").append(Jn("<label/>").addClass("group-label").html(this.options.label)).append(Jn("<button/>").addClass("btn btn-expand").text("+")).append(Jn("<button/>").addClass("btn btn-collapse").text("-"))]},renderElementsContainer:function(){return Jn("<div/>").addClass("elements")},renderGroup:function(t){t=t||{};var e=Jn("<div/>").addClass("group").data("name",t.name).toggleClass("closed",!!t.closed),n=Jn("<h3/>").addClass("group-label").html(t.label||t.name),i=this.renderElementsContainer();return e.append(n,i)},render:function(){this.dispose();var t=this.options;this.$content=this.renderContent(),this.$el.empty().append(this.$content),t.search&&this.$el.addClass("searchable").prepend(this.renderSearch()),t.groupsToggleButtons&&this.$el.addClass("collapsible").prepend(this.renderToggleAll()),this.el.dataset.textNoMatchesFound="No matches found";var e=Object.keys(t.groups||{}),n=e.length>0;if(t.paperOptions&&!xt(t.paperOptions)&&t.paperOptions.model)throw new Error("ui.Stencil: the `paperOptions` has to be a function if there is the property `model` defined.");if(n){var i=Je(e,(function(r){return this[r].index}).bind(t.groups));i.forEach(function(r){var s=this.options.groups[r],o=this.$groups[r]=this.renderGroup({name:r,label:s.label,closed:s.closed}).appendTo(this.$content);if(s.paperOptions&&s.paperOptions.model)throw new Error("ui.Stencil: the `model` property is not allowed in the `paperOptions` for the groups.");const[a]=o.find(".elements"),l=this.getGroupPaperOptions(r),c=this.createGroupGraph(r,l),h=U({cellViewNamespace:this.defaultCellViewNamespace},l,{el:a,model:c,interactive:!1,preventDefaultBlankAction:!1,width:s.width||t.width,height:s.height||t.height}),u=new fi(h);this.graphs[r]=c,this.papers[r]=u},this)}else{const[r]=this.renderElementsContainer().appendTo(this.$content),s=this.getGroupPaperOptions(null),o=this.createGroupGraph(null,s),a=U({cellViewNamespace:this.defaultCellViewNamespace},s,{el:r,model:o,width:t.width,height:t.height,interactive:!1,preventDefaultBlankAction:!1}),l=new fi(a);this.graphs[this.DEFAULT_GROUP]=o,this.papers[this.DEFAULT_GROUP]=l}return this.createDraggingPaper(),this.startListening(),this},getGroupPaperOptions:function(t){const{options:e}=this,n=Qt(e,"paperOptions"),i=[{},n];if(t){const r=Qt(this.getGroup(t),"paperOptions");i.push(r)}return U(...i)},createGroupGraph:function(t,e){let n;return e.model?n=e.model:n=new li({},{cellNamespace:this.defaultCellNamespace}),n.set("group",t),n},paperEvents:{"cell:pointerdown":"onDragStart"},startListening:function(){this.stopListening();const{paperEvents:t,papers:e}=this;for(let n in t){let i=t[n];typeof i!="function"&&(i=this[i]),i&&Kt(e,r=>{this.listenTo(r,n,i)})}},load:function(t,e){Array.isArray(t)?this.loadGroup(t,e):Nt(t)&&Kt(this.options.groups,(function(n,i){t[i]&&this.loadGroup(t[i],i)}).bind(this))},loadGroup:function(t,e){const{options:n}=this,i=this.getGraph(e);i.resetCells(t);let r=n.height;e&&(r=this.getGroup(e).height),this.isLayoutEnabled()&&this.layoutGroup(i,this.getGroup(e)),r||this.fitPaperToContent(this.getPaper(e))},isLayoutEnabled:function(){return!!this.options.layout},getGraph:function(t){var e=this.graphs[t||this.DEFAULT_GROUP];if(!e)throw new Error("ui.Stencil: group "+t+" does not exist.");return e},getPaper:function(t){return this.papers[t||this.DEFAULT_GROUP]},hasSnaplinesEnabled:function(){const{snaplines:t}=this.options;return!!t&&!t.isDisabled()},preparePaperForDragging:function(t,e,n){const{_paperDrag:i,_graphDrag:r,options:s}=this,{snaplines:o,usePaperGrid:a,scaleClones:l,paper:c,container:h}=s;this.stopListening(r),i.$el.stop(),i.$el.addClass("dragging").appendTo(h||document.body),this.positionCell(t,0,0),r.resetCells([t]);let u=5;if(o&&(u+=o.options.distance),o||a||l){const{sx:x,sy:S}=c.scale();i.scale(x,S),u*=Math.max(x,S)}else i.scale(1,1);i.fitToContent({padding:u,allowNewOrigin:"any"});const d=t.findView(i),f=d.getBBox({useModelGeometry:!0}),p=f.origin().difference(d.getBBox().origin()),g=this.setPaperDragOffset(e,n,{cloneGeometryBBox:f,cloneViewDeltaOrigin:p,paperDragPadding:u}),v=Jn(h).offset();return v&&(g.left-=v.left,g.top-=v.top),{clone:t,cloneView:d,cloneBBox:t.getBBox(),cloneGeometryBBox:f,cloneViewDeltaOrigin:p,paperDragPadding:u,paperDragInitialOffset:g}},removePaperAfterDragging:function(){const{_paperDrag:t,_graphDrag:e}=this;e.resetCells([]),this.$el.append(t.$el).removeClass("dragging"),t.$el.removeClass("dragging")},setPaperDragOffset:function(t,e,{cloneViewDeltaOrigin:n,cloneGeometryBBox:i,paperDragPadding:r}){const{body:s,documentElement:o}=document,a=s.scrollTop||o.scrollTop,l=t-n.x-i.width/2-r,c=e-n.y-i.height/2-r+a;return this._paperDrag.$el.offset({left:l,top:c}),{left:l,top:c}},onCloneSnapped:function(t,e,n){const{_dragging:i}=this;if(!i)return;const{snapped:r,tx:s,ty:o}=n;if(r){const{cloneBBox:a,cloneView:l}=i;this.positionCell(t,a.x+s,a.y+o,{silent:!0}),l.translate(),t.set("position",e,{silent:!0}),i.snapOffset={x:s,y:o}}else i.snapOffset=null},_dragging:null,onDragStart:function(t,e){const{canDrag:n,dragStartClone:i}=this.options,r=t.model,{group:s=null}=r.graph.attributes;if(typeof n=="function"&&!n.call(this,t,e,s))return;const o=i(r);if(r===o||!(o instanceof rn))throw new Error("ui.Stencil: `dragStartClone` must return a clone of the cell");this.startDragging(o,e)},startDragging(t,e){const{options:n,_graphDrag:i}=this,{snaplines:r,usePaperGrid:s}=n;this.createDraggingPaper(),this.$el.addClass("dragging");const{clientX:o=0,clientY:a=0}=e,l=this.preparePaperForDragging(t,o,a),{cloneView:c}=l;this._dragging=l;const h=!1,u=this.getCloneArea(c,e,h);U(l,{clientX:o,clientY:a,validDropTarget:h,cloneArea:u}),this.positionCell(t,u.x,u.y,{silent:!0}),t.isElement()&&this.hasSnaplinesEnabled()&&(r.captureCursorOffset(c,e,u.x,u.y),this.listenTo(i,"change:position",this.onCloneSnapped.bind(this)));const d=e.data||(e.data={});this.delegateDocumentEvents(null,d),this.trigger("element:dragstart",c,e,u.clone(),h),c.stopListening(),this.isDragCanceled()&&(this.notifyDragEnd(c,e,u,h),this._dragging=null)},onDrag:function(t){const{_dragging:e,options:n}=this;if(!e)return;t.preventDefault();const i=ot(t);if(this.isDragCanceled()){const{cloneView:v,validDropTarget:x,cloneArea:S}=e;this.notifyDragEnd(v,i,S,x),this._dragging=null;return}const{clone:r,cloneView:s}=e,{paper:o,snaplines:a,usePaperGrid:l}=n,c=this.insideValidArea({x:i.clientX,y:i.clientY}),h=this.getCloneArea(s,i,c&&l),{x:u,y:d}=h.center(),{x:f,y:p}=o.localToClientPoint(u,d);U(e,{clientX:f,clientY:p,validDropTarget:c,cloneArea:h}),this.setPaperDragOffset(f,p,e),this.positionCell(r,0,0,{silent:!0}),s.translate(),this.positionCell(r,h.x,h.y,{stencil:this.cid}),this.hasSnaplinesEnabled()&&(c?a.snapWhileMoving(s,i,h.x,h.y):a.hide());const{embeddingMode:g}=o.options;if(g&&r.isElement()){s.eventData(i,{paper:o});const v=e.cloneViewEventData=s.eventData(i);c?s.processEmbedding(v,t,u,d):s.clearEmbedding(v)}s.startListening(),this.trigger("element:drag",s,i,h.clone(),c),s.stopListening(),this.isDragCanceled()&&(this.notifyDragEnd(s,i,h,c),this._dragging=null)},onDragEnd:function(t){const{_dragging:e,options:n}=this;if(!e)return;const i=ot(t),{clone:r,clientX:s,clientY:o,validDropTarget:a,cloneArea:l,cloneView:c,cloneBBox:h,snapOffset:u}=e;let d=h.x,f=h.y;if(u&&(d+=u.x,f+=u.y),this.positionCell(r,d,f,{silent:!0}),this.notifyDragEnd(c,i,l,a),this.isDragCanceled()){this._dragging=null;return}const p=n.paper.clientToLocalPoint(s,o),g=!u;a?this.onDrop(c,i,p,g):this.onDropInvalid(c,i,p,g),this._dragging=null},notifyDragEnd:function(t,e,n,i){t.startListening(),this.trigger("element:dragend",t,e,n.clone(),i),t.stopListening(),this.undelegateDocumentEvents()},onDrop:function(t,e,n,i){const{options:r}=this,{paper:s,graph:o}=r,{embeddingMode:a}=s.options,{model:l}=t;o.startBatch("stencil-drag");const c=r.dragEndClone(l);if(l===c||!(c instanceof rn))throw new Error("ui.Stencil: `dragEndClone` must return a clone of the cell");this.drop(c,n,i),a&&l.isElement()&&(t.eventData(e,{model:c,paper:s,initialParentId:Gf(),whenNotAllowed:"remove"}),t.finalizeEmbedding(t.eventData(e))),o.getCell(c)?(this.trigger("element:drop",c.findView(s),e,n.x,n.y),this.removePaperAfterDragging(l)):this.onDropInvalid(t,e,n,i),o.stopBatch("stencil-drag")},onDropInvalid:function(t,e,n,i){const{model:r}=t,s=this.options.dragEndClone(r);this.trigger("drop:invalid",e,s,n.x,n.y),this.cancelDrag()},cancelDrag:function({dropAnimation:t}=this.options){const{_dragging:e,options:n,_paperDrag:i}=this;if(!e)return;const{clone:r,cloneView:s,cloneViewEventData:o,paperDragInitialOffset:a}=e,{paper:l,snaplines:c}=n;if(l.options.embeddingMode&&o&&r.isElement()&&s.clearEmbedding(o),this.hasSnaplinesEnabled()&&c.hide(),e.canceled=!0,t){const{duration:h=150,easing:u="ease-in-out"}=t;i.$el.animate(a,{duration:h,easing:u,complete:this.removePaperAfterDragging.bind(this,r)})}else this.removePaperAfterDragging(r)},isDragCanceled:function(){const{_dragging:t}=this;return t?!!t.canceled:!1},drop:function(t,e,n){const{options:i}=this,{paper:r,graph:s}=i,o=t.getBBox(),a=new L({x:e.x+o.x-o.width/2,y:e.y+o.y-o.height/2});n&&a.snapToGrid(r.options.gridSize),t.unset("z"),this.positionCell(t,a.x,a.y),s.addCell(t,{stencil:this.cid})},insideValidArea:function(t){const{paper:e,paperScroller:n}=this.options,i=this.getDropArea(this.el);let r;if(!n)r=this.getDropArea(e.el);else if(n.options.autoResizePaper)r=this.getDropArea(n.el);else{const s=this.getDropArea(n.el);r=this.getDropArea(e.el).intersect(s)}return!!(r&&r.containsPoint(t)&&!i.containsPoint(t))},getDropArea:function(t){const e=Jn(t),{left:n,top:i}=e.offset(),{body:r,documentElement:s}=document,o=r.scrollTop||s.scrollTop,a=r.scrollLeft||s.scrollLeft,l=parseInt(e.css("border-left-width"),10)||0,c=parseInt(e.css("border-top-width"),10)||0;return new J({x:n+l-a,y:i+c-o,width:t.clientWidth,height:t.clientHeight})},getCloneArea(t,e,n){const{paper:i}=this.options,{model:r}=t,{clientX:s,clientY:o}=e,{x:a,y:l}=i.clientToLocalPoint(s,o),{width:c,height:h}=r.getBBox();let u=a-c/2,d=l-h/2;if(n){const{x:f,y:p}=i.snapToGrid(i.localToClientPoint(u,d));u=f,d=p}return new J(u,d,c,h)},filter:function(t,e=this.options.search){var n=Object.keys(this.papers).reduce((i,r)=>{var s=this.papers[r],o=r===this.DEFAULT_GROUP?null:r,a=s.model.getCells().filter(u=>{var d=!1;e&&(xt(e)?d=e.call(this,u,t,o,this):d=this.isCellMatched(u,t,e,t.toLowerCase()!==t));var f=s.findViewByModel(u);return f&&f.vel.toggleClass("unmatched",!d),d}),l=!xn(a);const c=this.getGroupPaperOptions(o),h=this.createGroupGraph(o,c);return h.resetCells(a),this.trigger("filter",h,r,t),this.isLayoutEnabled()&&this.layoutGroup(h,this.getGroup(r)),this.$groups[r]&&this.$groups[r].toggleClass("unmatched",!l),this.fitPaperToContent(s),i||l},!1);this.$el.toggleClass("not-found",!n)},isCellMatched:function(t,e,n,i){return e?Object.keys(n).some(function(r){var s=n[r];if(r!="*"&&t.get("type")!=r)return!1;var o=s.some(function(a){var l=fn(t.attributes,a,"/");return l==null?!1:(l=l.toString(),i||(l=l.toLowerCase()),l.indexOf(e)>=0)});return o}):!0},fitPaperToContent:function(t){const{options:e}=this,{width:n}=t.getComputedSize(),i=U({minWidth:n,padding:e.paperPadding},e.contentOptions);t.fitToContent(i)},getGroup:function(t){return this.options.groups&&this.options.groups[t]||{}},onSearch:function(t){const e=t.target.value;this.$el.toggleClass("stencil-filtered",e.length>0),this.filter(e,this.options.search)},pointerFocusIn:function(){this.$el.addClass("is-focused")},pointerFocusOut:function(){this.$el.removeClass("is-focused")},onGroupLabelClick:function(t){if(t.type==="touchstart")this._groupLabelClicked=!0;else if(this._groupLabelClicked&&t.type==="click"){this._groupLabelClicked=!1;return}var e=t.target.closest(".group");this.toggleGroup(e.dataset.name)},toggleGroup:function(t){this.isGroupOpen(t)?this.closeGroup(t):this.openGroup(t)},closeGroup:function(t){var e=this.$groups[t];!e||!this.isGroupOpen(t)||(this.trigger("group:close",t),e.addClass("closed"))},openGroup:function(t){var e=this.$groups[t];!e||this.isGroupOpen(t)||(this.trigger("group:open",t),e.removeClass("closed"))},isGroupOpen:function(t){var e=this.$groups[t];return e?!e.hasClass("closed"):!1},closeGroups:function(){Object.keys(this.$groups).forEach(function(t){this.closeGroup(t)},this)},openGroups:function(){Object.keys(this.$groups).forEach(function(t){this.openGroup(t)},this)},positionCell:function(t,e,n,i){if(t.isElement())t.position(e,n,i);else{const r=t.getBBox();t.translate(e-r.x,n-r.y,i)}},onRemove:function(){this.dispose()},dispose:function(){We(this.papers,"remove"),this.papers={},this._paperDrag&&(this._paperDrag.remove(),this._paperDrag=null),this.undelegateDocumentEvents()}});Object.defineProperty(rp.prototype,"defaultCellNamespace",{enumerable:!0,get:function(){return this.options.paper.model.get("cells").cellNamespace}});Object.defineProperty(rp.prototype,"defaultCellViewNamespace",{enumerable:!0,get:function(){return this.options.paper.options.cellViewNamespace}});const{mergeAttrs:xw}=k,{isEqual:ww,isEmpty:Bm,flattenObject:Fm,setByPath:$V}=j$;function Hs(t,e,n={}){const{merge:i=xw}=n,r={};return t.forEach(s=>{const{start:o,end:a,attrs:l}=s;(o===void 0&&a===void 0||e>=o&&e<a)&&i(r,l)}),r}function id(t,e,n,i={}){const{delim:r="/",merge:s=xw}=i,o=k.findAnnotationsBetweenIndexes(t,e,n);if(e===n)return Hs(o,e,i);let a;for(let c=e;c<n;c++){var l=Hs(o,c,i);if(a&&!ww(a,l)){a=Fm(s({},a),r),l=Fm(s({},l),r);const h={};for(let u in l)a[u]===l[u]&&$V(h,u,l[u],r);a=h}else a=l}return a}function BV(t,e={}){const{compare:n=ww}=e,i=[],r=t.reduce((s,o)=>{const{end:a}=o;return a===void 0?s:Math.max(s,a)},0);for(let s=-1,o=r;s<o;s++){let a=null;for(let l=s+1;l<=o;l++){const c=id(t,l-1,l,e);if(!a){a=c;continue}n(c,a)||(l--,Bm(a)||i.push({start:s,end:l,attrs:a}),a=null,s=l)}if(a){s<o&&!Bm(a)&&i.push({start:s,end:o,attrs:a});break}}return i}const Pn=q,Oo=ae.extend({options:{text:void 0,newlineCharacterBBoxWidth:10,placeholder:void 0,focus:!0,debug:!1,selectAllThreshold:20,useNativeSelection:!0,annotateUrls:!1,urlAnnotation:{attrs:{class:"url-annotation",fill:"lightblue","text-decoration":"underline"}},textareaAttributes:{autocorrect:"off",autocomplete:"off",autocapitalize:"off",spellcheck:"false",tabindex:"0"}},className:"text-editor",events:{"keyup textarea":"onKeyup","input textarea":"onInput","copy textarea":"onCopy","cut textarea":"onCut","paste textarea":"onPaste","mousedown .char-selection-box":"onMousedown","dblclick .char-selection-box":"onDoubleClick","click .char-selection-box":"onTripleClick"},selection:{start:null,end:null},selecting:!1,_textCursor:null,AFTER_KEYDOWN_DELAY:10,DEFAULT_FONT_SIZE:12,init:function(){ln(this,"onMousedown","onMousemove","onMouseup","onDoubleClick","onTripleClick","onKeydown","onAfterPaste","onAfterKeydown","onDocumentPointerdown");const t=this.options.text;if(!t)throw new Error("ui.TextEditor: text option is mandatory");this.setTextElement(t),document.addEventListener("pointerdown",this.onDocumentPointerdown,{capture:!0}),Pn(document.body).on("mousemove",this.onMousemove),Pn(document.body).on("mouseup",this.onMouseup),Pn(document.body).on("keydown",this.onKeydown),this.$viewport=Pn(t),this.options.annotations&&this.setAnnotations(this.options.annotations)},setTextElement:function(t){this.options.text=t,this.bindTextElement(t)},bindTextElement:function(t){if(this.unbindTextElement(),!t)return;const e=Pn(t);e.on("mousedown",this.onMousedown),e.on("dblclick",this.onDoubleClick),e.on("click",this.onTripleClick),this.elText=t},unbindTextElement:function(){const{elText:t}=this;if(!t)return;const e=Pn(t);e.off("mousedown",this.onMousedown),e.off("dblclick",this.onDoubleClick),e.off("click",this.onTripleClick),this.elText=null},render:function(t){this.$caret=Pn("<div>").addClass("caret"),this.$selection=Pn("<div>"),this.$selectionBox=Pn("<div>").addClass("char-selection-box"),this.$el.append(this.$caret,this.$selection),this.$textareaContainer=Pn("<div>").addClass("textarea-container"),this.$textarea=Pn("<textarea>").attr(this.options.textareaAttributes),this.textarea=this.$textarea[0],this._textContent=this.textarea.value=this.getTextContent(),this._textareaValueBeforeInput=this.textarea.value,this.$textareaContainer.append(this.textarea),this.options.focus&&this.$el.append(this.$textareaContainer),Pn(t||document.body).append(this.$el);const e=k(this.options.text),n=e.bbox();return this.$textareaContainer.css({left:n.x,top:n.y}),this.focus(),this._textCursor=e.attr("cursor"),e.attr("cursor","text"),this.selectAll(),this},annotateURLBeforeCaret:function(t){if(t===0)return!1;const e=Math.max(t-1,0),n=this.getURLBoundary(e),i=this.getAnnotations()||[];return n?(this.annotateURL(i,n[0],n[1]),!0):!!k.findAnnotationsAtIndex(i,e).some(s=>s.url)},hasSelection:function(){return Ot(this.selection.start)&&Ot(this.selection.end)&&this.selection.start!==this.selection.end},textContentHasChanged:function(){return this._textContent!==this.textarea.value},restoreTextAreaSelectionDirection:function(){this._selectionDirection&&(this.textarea.selectionDirection=this._selectionDirection)},storeSelectionDirection:function(){this._selectionDirection=this.textarea.selectionDirection},updateSelectionFromTextarea:function(){const{selectionStart:t,selectionEnd:e}=this.textarea;t===e?this.setCaret(t):this.select(t,e)},textSelectionHasChanged:function(){const{selection:t,textarea:e}=this;return!t||!e?!1:t.start!==e.selectionStart||t.end!==e.selectionEnd},isModifierKey:function(t){var e=[16,18,17,91];return e.some(n=>t.which===n)},isArrowKey:function(t){return t.which>=37&&t.which<=40},copyToClipboard:function(){var t=document.queryCommandSupported&&document.queryCommandSupported("copy");t&&(this._copied=!0,document.execCommand("copy"))},findAnnotationsUnderCursor:function(t,e){return k.findAnnotationsAtIndex(t,e)},findAnnotationsInSelection:function(t,e,n){return k.findAnnotationsBetweenIndexes(t,e,n)},inferTextOperationType:function(t,e,n){if(t.start===t.end&&e.start===e.end&&n>0)return"insert";if(t.start===t.end&&e.start===e.end&&n<=0)return"delete-single";if(t.start!==t.end&&e.start===e.end&&e.start===t.start)return"delete";if(t.start!==t.end&&e.start!==t.start)return"delete-insert"},annotate:function(t,e,n,i){var r=[],s=this.inferTextOperationType(e,n,i);return ft(t).forEach(function(o){var a,l;switch(s){case"insert":o.start<e.start&&e.start<=o.end?o.end+=i:o.start>=e.start&&(o.start+=i,o.end+=i);break;case"delete-single":o.start<e.start&&e.start<=o.end&&e.start!==n.start||o.start<=e.start&&e.start<o.end&&e.start===n.start?o.end+=i:o.start>=e.start&&(o.start+=i,o.end+=i);break;case"delete":o.start<=e.start&&e.start<=o.end?e.end<=o.end?o.end+=i:o.end+=n.start-o.end:o.start>=e.start&&o.start<e.end?(a=o.end-o.start,l=e.end-o.start,o.start=e.start,o.end=o.start+a-l):o.start>=e.end&&(o.start+=i,o.end+=i);break;case"delete-insert":if(o.start<=e.start&&e.start<=o.end)e.start<o.end&&(e.end>o.end?o.end=n.end:o.end=n.end+(o.end-e.end));else if(o.start>=e.start&&o.start<=e.end){var c=n.start-e.start;l=e.end-o.start,a=o.end-o.start,o.start=e.start+c,o.end=o.start+a-l}else o.start>=e.start&&o.end<=e.end?o.start=o.end=0:o.start>=e.end&&(o.start+=i,o.end+=i);break;default:this.options.debug&&console.log("ui.TextEditor: Unknown text operation.");break}o.end>o.start&&r.push(o)},this),r},shiftAnnotations:function(t,e,n){return k.shiftAnnotations(t,e,n)},setCurrentAnnotation:function(t){this._currentAnnotationAttributes=t},setAnnotations:function(t){this._annotations=t},getAnnotations:function(){return this._annotations},getCombinedAnnotationAttrsAtIndex:function(t,e){return Hs(ft(e),t)},getSelectionAttrs:function(t,e){const{start:n,end:i=n}=t;return n===i?Hs(e,n-1):id(e,n,i)},getTextContent:function(){var t=this.options.text,e=k(t).find(".v-line");return e.length===0?t.textContent:e.reduce(function(n,i,r,s){var o=i.node.textContent;return i.hasClass("v-empty-line")&&(o=""),r===s.length-1?n+o:n+o+`
`},"")},startSelecting:function(){this.selecting=!0},stopSelecting:function(){this.selecting=!1},selectionInProgress:function(){return this.selecting===!0},selectAll:function(){return this.select(0,this.getNumberOfChars())},select:function(t,e){const{options:n,selection:i}=this;n.debug&&console.log("select(",t,e,")");const r=i.start,s=i.end;e===void 0&&(e=t),Ot(t)&&(i.start=t),Ot(e)&&(i.end=e),Ot(i.end)||(i.end=i.start);const{start:o,end:a}=i;if(Ot(o)&&Ot(a)){if((r!==o||s!==a)&&this.setCurrentAnnotation(null),o===a)this.clearSelection(),this.focus(),this.setCaret(o);else{this.hideCaret(),this.setTextAreaSelection(o,a);const c=this.textarea.value;o>a&&this.constructor.isLineEnding(c,a)?this.constructor.isLineStart(c,o)&&a!==o-1?this.renderSelection(a,o-2):this.renderSelection(a,o-1):this.renderSelection(o,a)}this.trigger("select:change",o,a)}return this},setTextAreaSelection:function(t,e){var n={start:t,end:e};n=this.normalizeSelectionRange(n),this.textarea.focus(),this.textarea.selectionStart=n.start,this.textarea.selectionEnd=n.end},renderSelection:function(t,e){this.options.debug&&console.log("renderSelection()");var n={start:t,end:e};if(n=this.normalizeSelectionRange(n),this.clearSelection(),this.options.useNativeSelection){this.$viewport&&(this._viewportUserSelectBefore=this.$viewport.css("user-select"),this.$viewport.css({"-webkit-user-select":"all","-moz-user-select":"all","user-select":"all"}));var i=n.end-n.start;this.selectTextInElement(this.options.text,n.start,i)}else this.renderSelectionBoxes(n.start,n.end)},normalizeSelectionStartAndLength:function(t,e,n){var i=t.substr(0,e),r=t.substr(e,n),s=this.countLineBreaks(i),o=this.countLineBreaks(r);e-=s,n-=o;var a=this.countEmptyLines(i),l=this.countEmptyLines(r);return e+=a,n+=a,n-=a,n+=l,{start:e,length:n}},selectTextInElement:function(t,e,n){if(xt(t.selectSubString)&&this.selectTextInElementUsingSelectSubString(t,e,n),!this.actualSelectionMatchesExpectedSelection(e,n))try{this.selectTextInElementUsingRanges(t,e,n)}catch(i){this.options.debug&&console.log(i),xt(t.selectSubString)&&this.selectTextInElementUsingSelectSubString(t,e,n)}},selectTextInElementUsingSelectSubString:function(t,e,n){var i=this.normalizeSelectionStartAndLength(this.getTextContent(),e,n);try{t.selectSubString(i.start,i.length)}catch(r){this.options.debug&&console.log(r)}},selectTextInElementUsingRanges:function(t,e,n){var i=window.getSelection();i.removeAllRanges();var r=this.normalizeSelectionStartAndLength(this.getTextContent(),e,n);e=0+r.start,n=0+r.length;for(var s=this.getTextNodesFromDomElement(t),o,a,l,c,h,u=0,d=e+n,f=document.createRange();n>0&&s.length>0;)o=s.shift(),a=u,l=u+o.length,(a>=e&&a<d||l>e&&l<=d||e>=a&&e<l||d>a&&d<=l)&&(c=Math.max(e-a,0),h=Math.min(c+Math.min(n,o.length),l),f.collapsed&&f.setStart(o,c),f.setEnd(o,h),n-=h-c),u+=o.length;f.collapsed||i.addRange(f)},actualSelectionMatchesExpectedSelection:function(t,e){var n=window.getSelection(),i=n.toString(),r=this.getExpectedSelectedContent(t,e);return i=i.replace(/\s/g," "),r===i},getExpectedSelectedContent:function(t,e){var n=this.getTextContent(),i=n.substr(t,e);return i.search(/(\n\r|\r|\n)/)===0&&(i="-"+i),i=i.replace(/(\n\r|\r|\n){2,}/g,r=>Array.from({length:r.length-1},()=>"-").join("")),i=i.replace(/\n\r|\r|\n/g,""),i=i.replace(/\s/g," "),i},getTextNodesFromDomElement:function(t){for(var e=[],n=0,i=t.childNodes.length;n<i;n++){var r=t.childNodes[n];r.tagName!==void 0?e=e.concat(this.getTextNodesFromDomElement(r)):e.push(r)}return e},renderSelectionBoxes:function(t,e){this.options.debug&&console.log("renderSelectionBoxes()"),this.$selection.empty();for(var n=this.getFontSize(),i=this.getTextTransforms(),r=i.rotation,s,o,a,l=t;l<e;l++){var c=this.$selectionBox.clone();try{a=this.getCharBBox(l)}catch{this.trigger("select:out-of-range",t,e);break}if(o&&r===0&&Math.round(a.y)===Math.round(o.y)&&Math.round(a.height)===Math.round(o.height)&&Math.round(a.x)===Math.round(o.x+o.width)){const h=parseInt(s.css("width"),10);s.css("width",h+a.width)}else c.css({left:a.x,top:a.y-a.height,width:a.width,height:a.height,"-webkit-transform":"rotate("+r+"deg)","-webkit-transform-origin":"0% 100%","-moz-transform":"rotate("+r+"deg)","-moz-transform-origin":"0% 100%"}),this.$selection.append(c),s=c;o=a}a&&this.$textareaContainer.css({left:a.x,top:a.y-n*i.scaleY})},clearSelection:function(){return this.options.debug&&console.log("clearSelection()"),this.$selection.empty(),this.options.text.selectSubString&&(this.$viewport&&this._viewportUserSelectBefore&&this.$viewport.css({"-webkit-user-select":this._viewportUserSelectBefore,"-moz-user-select":this._viewportUserSelectBefore,"user-select":this._viewportUserSelectBefore}),window.getSelection().removeAllRanges()),this},deselect:function(){return this.options.debug&&console.log("deselect()"),this.stopSelecting(),this.clearSelection(),this.setTextAreaSelection(this.selection.start,this.selection.end),this},getSelectionStart:function(){return this.selection.start},getSelectionEnd:function(){return this.selection.end},getSelectionRange:function(){return this.normalizeSelectionRange(this.selection)},normalizeSelectionRange:function(t){return t=be(t),t.start>t.end&&(t.end=[t.start,t.start=t.end][0]),t},getSelectionLength:function(){var t=this.getSelectionRange();return t.end-t.start},getSelection:function(){var t=this.getSelectionRange();return this.getTextContent().slice(t.start,t.end)},getWordBoundary:function(t){for(var e=this.textarea.value,n=/\W/,i=t;i;){if(n.test(e[i])){i+=1;break}i-=1}for(var r=this.getNumberOfChars(),s=t;s<r&&!n.test(e[s]);)s+=1;return i<s?[i,s]:[s,i]},getURLBoundary:function(t){for(var e=this.textarea.value,n=/\s/,i=/[-a-zA-Z0-9@:%_+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_+.~#?&//=]*)?/,r=t;r>-1;){if(n.test(e[r])){r+=1;break}r-=1}r=Math.max(r,0);for(var s=this.getNumberOfChars(),o=Math.max(r,t);o<=s&&!n.test(e[o]);)o+=1;if(o=Math.min(o,s),i.test(e.substring(r,o)))return[r,o]},annotateURL:function(t,e,n){const i=this.textarea.value.substring(e,n);if(t.some(o=>o.url===i&&o.start===e&&o.end===n))return t;let r;const{urlAnnotation:s}=this.options;if(typeof s=="function"){if(r=s(i),!r)return t}else r=U({},s);return U(r,{url:i,start:e,end:n}),t.push(r),t},getCharBBox:function(t){if(this.isLineEnding(t)){var e=this.getCharBBox(t-1);return e.x=e.x2,e.y=e.y2,e.width=this.options.newlineCharacterBBoxWidth||10,e}var n=this.realToSvgCharNum(t),i=this.options.text,r=i.getStartPositionOfChar(n),s=i.getEndPositionOfChar(n),o=i.getExtentOfChar(n);r=this.localToScreenCoordinates(r),s=this.localToScreenCoordinates(s);var a=this.getTextTransforms(),l=r.x,c=r.y,h=o.width*a.scaleX,u=o.height*a.scaleY;return{x:l,y:c,width:h,height:u,x2:s.x,y2:s.y}},realToSvgCharNum:function(t){for(var e=0,n=0;n<=t;n++)this.isLineEnding(n)&&(e+=1);return t-e},selectionStartToSvgCharNum:function(t){return t-this.nonEmptyLinesBefore(t)},svgToRealCharNum:function(t){for(var e=0,n=0;n<=t+e;n++)this.isLineEnding(n)&&(e+=1);return t+e},localToScreenCoordinates:function(t){return k.transformPoint(t,this.options.text.getCTM())},getNumberOfChars:function(){return this.getTextContent().length},getCharNumFromEvent:function(t){const e=this.options.text,n=k(e).toLocalPoint(t.clientX,t.clientY);return this.getCharNumAtPosition(n)},getCharNumAtPosition:function(t){var e=this.options.text,n=e.getCharNumAtPosition(t);if(n<0){var i=k(e).getBBox();i.inflate(-1);var r=i.containsPoint(t);if(!r&&this.hasSelection()&&i.clone().inflate(this.options.selectAllThreshold).containsPoint(t))return this.selection.end;var s=r?t:i.pointNearestToPoint(t),o=k.createSVGPoint(s.x,s.y),a=e.getCharNumAtPosition(o),l=t.x>i.x;if(a===-1){var c=i.x,h=i.x+i.width,u,d=(c+h)/2;do{o.x=d;var f=e.getCharNumAtPosition(o);f>-1&&(a=f),u=d,l&&f>-1||!l&&f===-1?(d=(d+h)/2,c=u):(d=(c+d)/2,h=u)}while(Math.abs(u-d)>1)}if(a>-1){const v=this.svgToRealCharNum(a);return!l||this.getTextContent()[v]===`
`?v:v+1}return t.x<i.x&&t.y<i.y+i.height?0:this.getNumberOfChars()}var p=this.localToScreenCoordinates(t),g=this.getCharBBox(this.svgToRealCharNum(n));return Math.abs(g.x-p.x)<Math.abs(g.x+g.width-p.x)?this.svgToRealCharNum(n):this.svgToRealCharNum(n)+1},lineNumber:function(t){var e=this.textarea.value.substr(0,t);return this.countLineBreaks(e)},emptyLinesBefore:function(t){for(var e=this.textarea.value.split(/\n\r|\r|\n/g),n=this.lineNumber(t),i=0,r=n-1;r>=0;r--)e[r]||(i+=1);return i},countLineBreaks:function(t){return(t.match(/\n\r|\r|\n/g)||[]).length},countEmptyLines:function(t){let e=(t.match(/(\n\r|\r|\n){2,}/g)||[]).reduce((n,i)=>n+(i.length-1),0);return t.search(/(\n\r|\r|\n)/)===0&&e++,e},nonEmptyLinesBefore:function(t){return this.lineNumber(t)-this.emptyLinesBefore(t)},isEmptyLine:function(t){var e=this.textarea.value.split(/\n\r|\r|\n/g);return!e[t]},isEmptyLineUnderSelection:function(t){var e=this.lineNumber(t);return this.isEmptyLine(e)},isLineEnding:function(t){return this.constructor.isLineEnding(this.textarea.value,t)},getTextTransforms:function(){var t=this.options.text.getCTM();return k.decomposeMatrix(t)},getFontSize:function(){const{DEFAULT_FONT_SIZE:t,options:e}=this,n=parseFloat(e.text.getAttribute("font-size"));return Number.isNaN(n)?t:n},getFontFill:function(){const{options:t}=this;return t.text.getAttribute("fill")||""},getTextAnchor:function(){const{options:t}=this;return t.text.getAttribute("text-anchor")||""},getCaretAttrs(t){const e=this.getAnnotations()||[],n=this._currentAnnotationAttributes;if(e.length===0&&!n)return{"font-size":this.getFontSize(),fill:this.getFontFill()};const i=[...e,{attrs:n}],r=Hs(i,t-1),s=parseFloat(r["font-size"]),o=r.fill;return{"font-size":Number.isNaN(s)?this.getFontSize():s,fill:o||this.getFontFill()}},setCaret:function(t,e){Nt(t)&&(e=t,t=void 0),e=e||{};var n=this.getNumberOfChars(),i=this.selection.start;return typeof t<"u"&&(t=Math.min(Math.max(t,0),n),i=this.selection.start=this.selection.end=t),e.silent||this.trigger("caret:change",i),this.options.debug&&console.log("setCaret(",t,e,")","selectionStart",i,"isLineEnding",this.isLineEnding(i),"isEmptyLineUnderSelection",this.isEmptyLineUnderSelection(i),"svgCharNum",this.selectionStartToSvgCharNum(i),"nonEmptyLinesBefore",this.nonEmptyLinesBefore(i)),this.updateCaret(),this.setTextAreaSelection(i,i),this.focus(),this},updateCaret:function(){const{$caret:t,$textareaContainer:e,selection:n,options:i,textarea:r}=this,s=n.start,{text:o,placeholder:a}=i,l=this.getNumberOfChars();let c;try{let x;!this.isEmptyLineUnderSelection(s)&&(this.isLineEnding(s)||r.value.length===s)?(x=this.selectionStartToSvgCharNum(s)-1,c=o.getEndPositionOfChar(x)):(x=this.selectionStartToSvgCharNum(s),c=o.getStartPositionOfChar(x))}catch{this.trigger("caret:out-of-range",s),c={x:0,y:0}}var{x:h,y:u}=this.localToScreenCoordinates(c);const{rotation:d,scaleY:f}=this.getTextTransforms(),p=this.getCaretAttrs(s),g=p["font-size"]*f,v=p.fill;if(a){const x=typeof a=="string"?a:"Enter text...";t.data("placeholderText",x),t.toggleClass("placeholder",l===0)}t.css({left:h,top:u-g,height:g,"line-height":`${g}px`,"font-size":`${g}px`,"-webkit-transform":`rotate(${d}deg)`,"-webkit-transform-origin":"0% 100%","-moz-transform":`rotate(${d}deg)`,"-moz-transform-origin":"0% 100%","background-color":v}).attr({"text-anchor":this.getTextAnchor()}),t.css("display",""),e.css({left:h,top:u-g})},focus:function(){return this.options.debug&&console.log("focus()"),this.showCaret(),this},blur:function(){return this.options.debug&&console.log("blur()"),this.hideCaret(),this},showCaret:function(){return this.options.debug&&console.log("showCaret()"),this.$caret.css("display",""),this},hideCaret:function(){return this.options.debug&&console.log("hideCaret()"),this.$caret.css("display","none"),this},onRemove:function(){const{text:t,cellView:e=null}=this.options;this.deselect(),this.unbindTextElement(),document.removeEventListener("pointerdown",this.onDocumentPointerdown,{capture:!0}),Pn(document.body).off("mousemove",this.onMousemove),Pn(document.body).off("mouseup",this.onMouseup),Pn(document.body).off("keydown",this.onKeydown),k(t).attr("cursor",this._textCursor),this.trigger("close",t,e)},onDocumentPointerdown:function(t){const{text:e,onOutsidePointerdown:n}=this.options,{target:i}=t;e!==i&&(e.contains(i)||typeof n=="function"&&n.call(this,t,this))},onKeydown:function(t){this.options.debug&&console.log("onKeydown(): ",t.keyCode);const e=this.options.onKeydown;typeof e=="function"&&(e.call(this,t,this),t.isPropagationStopped())||this.isModifierKey(t)||(this.hasSelection()&&(this.deselect(),this.restoreTextAreaSelectionDirection()),setTimeout(this.onAfterKeydown,this.AFTER_KEYDOWN_DELAY),this._copied=!1,this._selectionStartBeforeInput=this.textarea.selectionStart,this._selectionEndBeforeInput=this.textarea.selectionEnd)},onAfterKeydown:function(){this.textarea===document.activeElement&&(this.storeSelectionDirection(),this.setCurrentAnnotation(null),this.updateSelectionFromTextarea())},onKeyup:function(t){if(this.textContentHasChanged()&&this.onInput(t),this.textSelectionHasChanged()&&!this.isArrowKey(t)){const{selectionEnd:e,selectionStart:n}=this.textarea;e!==n&&this.updateSelectionFromTextarea()}},onCopy:function(t){this._copied||this.copyToClipboard()},onCut:function(t){this._copied||this.copyToClipboard()},onInput:function(t){if(this.textContentHasChanged()){var e=this.textarea.value.length-this._textareaValueBeforeInput.length,n={start:this._selectionStartBeforeInput,end:this._selectionEndBeforeInput},i={start:this.textarea.selectionStart,end:this.textarea.selectionEnd};this.selection.start=this.textarea.selectionStart,this.selection.end=this.textarea.selectionEnd,this.options.debug&&console.log("onInput()",t,"selectionBeforeInput",n,"selectionAfterInput",i,"diffLength",e);var r=this.inferTextOperationType(n,i,e),s=!1,o=this.getAnnotations();if(this.options.annotateUrls&&r==="insert"){var a=this.textarea.value.substr(n.start,e);this.options.debug&&console.log("onInput()","inserted text",a),/\s/.test(a)&&(s=this.annotateURLBeforeCaret(n.start),s&&(o=this.shiftAnnotations(o,i.end,e)))}if(o&&(s||(o=this.annotate(o,n,i,e)),this.options.debug&&console.log("onInput()","modified annotations",o),this._currentAnnotationAttributes&&r==="insert")){var l={start:n.start,end:i.end,attrs:this._currentAnnotationAttributes};o.push(l),this.setCurrentAnnotation(null),this.options.debug&&console.log("onInput()","insert annotation",l,"final annotations",o)}this._annotations=o,this.trigger("text:change",this.textarea.value,this._textareaValueBeforeInput,o,n,i),this._selectionBeforeInput=i,this._textareaValueBeforeInput=this.textarea.value,this._textContent=this.textarea.value}},onPaste:function(t){this.options.debug&&console.log("onPaste()"),this._textareaValueBeforeInput=this.textarea.value,setTimeout(this.onAfterPaste,0)},onAfterPaste:function(){this.setCaret(this.textarea.selectionStart)},onMousedown:function(t){if(t.originalEvent.detail!==3){this.options.debug&&console.log("onMousedown()");var e=this.getCharNumFromEvent(t);this.startSelecting(),this.select(e),t.preventDefault(),t.stopPropagation()}},onMousemove:function(t){if(this.selectionInProgress()){this.options.debug&&console.log("onMousemove()");let e=this.getCharNumFromEvent(t);this.storeSelectionDirection(),this.select(null,e),t.preventDefault(),t.stopPropagation()}},onMouseup:function(t){this.selectionInProgress()&&(this.options.debug&&console.log("onMouseup()"),this.stopSelecting(),this.trigger("select:changed",this.selection.start,this.selection.end))},onDoubleClick:function(t){this.options.debug&&console.log("onDoubleClick()");var e=this.getCharNumFromEvent(t),n=this.getWordBoundary(e);this.select(n[0],n[1]),t.preventDefault(),t.stopPropagation()},onTripleClick:function(t){t.originalEvent.detail===3&&(this.options.debug&&console.log("onTripleClick()"),this.hideCaret(),this.selectAll(),t.preventDefault(),t.stopPropagation())}},U({getTextElement:function(t){var e=t.tagName.toUpperCase();if(e==="TEXT"||e==="TSPAN"||e==="TEXTPATH")return e==="TEXT"?t:this.getTextElement(t.parentNode)},edit:function(t,e){e=e||{};var n=e.update!==!1;this.options=U({},e,{update:n});var i=this.getTextElement(t);if(!i){this.options.debug&&console.log("ui.TextEditor: cannot find a text element.");return}this.close(),this.ed=new Oo(U({text:i},e)),this.ed.on("all",this.trigger,this);const{cellView:r=null}=e;this.trigger("open",i,r);var s;if(r){if(s=r.paper.el,this.cellViewUnderEdit=r,this.cellViewUnderEditInteractiveOption=this.cellViewUnderEdit.options.interactive,this.cellViewUnderEdit.options.interactive=!1,e.annotationsProperty&&!this.ed.getAnnotations()){var o=this.cellViewUnderEdit.model.prop(e.annotationsProperty);o&&this.ed.setAnnotations(dh(o))}}else{var a=k(i).svg();s=a.parentNode}return n&&this.ed.on("text:change",(l,c,h)=>{r?this.updateCellView(r,l,h):this.updateSVGTextNode(i,l,h)}),this.ed.render(s),this},updateCellView:function(t,e,n){const{textProperty:i,annotationsProperty:r}=this.options,{cid:s}=this.ed,{model:o}=t;i&&o.prop(i,e,{textEditor:s,async:!1}),r&&o.prop(r,dh(n),{rewrite:!0,textEditor:s,async:!1})},updateSVGTextNode:function(t,e,n){k(t).text(e,{annotations:n})},close:function(){if(this.ed){if(this.ed.options.annotateUrls){var t=this.ed.getSelectionStart(),e=this.findAnnotationsUnderCursor(),n=e.find(function(r){return r.url?r:!1});if(!n){var i=this.ed.annotateURLBeforeCaret(t);i&&this.applyAnnotations(this.getAnnotations())}}this.ed.remove(),this.cellViewUnderEdit&&(this.cellViewUnderEdit.options.interactive=this.cellViewUnderEditInteractiveOption),this.ed=this.cellViewUnderEdit=this.cellViewUnderEditInteractiveOption=void 0}},applyAnnotations:function(t){var e=this.options,n=this.ed;if(n&&e.update){e.cellView&&e.annotationsProperty?(e.cellView.model.prop(e.annotationsProperty,dh(t),{rewrite:!0,textEditor:n.cid}),n.setAnnotations(t)):k(n.options.text).text(n.getTextContent(),{annotations:t});var i=this.getSelectionRange(),r=this.getSelectionLength();r>0?n.select(i.start,i.end):n.setCaret()}},proxy:function(t,e){const{ed:n}=this;if(n)return n[t].apply(n,e)},isEmptyLine:function(t,e){const n=t[e-1],i=t[e];return e===0&&i===`
`||i===`
`&&n===`
`||e===t.length&&n===`
`},isLineEnding:function(t,e){return t[e]===`
`&&e>0&&t[e-1]!==`
`},isLineStart:function(t,e){return t[e]===`
`?!1:e===0||t[e-1]===`
`},getCombinedAnnotationAttrsAtIndex:Hs,getCombinedAnnotationAttrsBetweenIndexes:id,normalizeAnnotations:BV},tn));Oo.findAnnotationsUnderCursor=function(){const{ed:t}=this;return t?this.proxy("findAnnotationsUnderCursor",[t.getAnnotations(),t.getSelectionStart()]):null};Oo.findAnnotationsInSelection=function(){const{ed:t}=this;if(!t)return null;const{start:e,end:n}=t.getSelectionRange();return this.proxy("findAnnotationsInSelection",[t.getAnnotations(),e,n])};Oo.getSelectionAttrs=function(t){const{ed:e}=this;return e?this.proxy("getSelectionAttrs",[e.getSelectionRange(),t]):null};["setCurrentAnnotation","getAnnotations","setCaret","deselect","selectAll","select","getNumberOfChars","getCharNumFromEvent","getWordBoundary","getSelectionLength","getSelectionRange"].forEach(t=>{Oo[t]=function(){return this.proxy(t,arguments)}});function dh(t){try{return JSON.parse(JSON.stringify(t))}catch{return}}const jn=ae.extend({className:"widget",references:[],constructor:function(t,e){this.availableReferences=e||{},ae.prototype.constructor.call(this,t)},updateAttrs:function(t){os(this.$el,t)},bindEvents:function(){},validateReferences:function(){var t=this.references||[],e=[];return t.forEach(function(n){this.availableReferences[n]===void 0&&e.push(n)},this),e},getReference:function(t){return this.availableReferences[t]},getReferences:function(){return this.availableReferences},enable:function(){},disable:function(){},isDisabled:function(){return!1}},{create:function(t,e,n={}){var i=ja(te(t)?t:t.type);if(!xt(n[i]))throw new Error('Widget: unable to find widget: "'+i+'"');var r=new n[i](t,e),s=r.validateReferences(e);if(s.length>0)throw new Error('Widget: "'+i+'" missing dependency: '+s.join(", "));return r.render(),r.updateAttrs(t.attrs),r.bindEvents(),r.el.dataset.type=i,t.name&&(r.el.dataset.name=t.name),r}}),on=q,FV=jn.extend({tagName:"label",events:{"input .input":"onInput","change .input":"onChange",mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick"},documentEvents:{mouseup:"pointerup",touchend:"pointerup"},init:function(){ln(this,"pointerup")},render:function(){var t=this.options,e=on("<span/>").text(t.label||"");return this.$input=on("<input/>").addClass("input").attr("type","checkbox").prop("checked",!!t.value),this.$span=on("<span/>"),this.$el.append([e,this.$input,this.$span]),this},onChange:function(t){this.trigger("change",!!t.target.checked,t)},onInput:function(t){this.trigger("input",!!t.target.checked,t)},pointerdown:function(t){t=ot(t),this.$el.addClass("is-in-action"),this.trigger("pointerdown",t),this.delegateDocumentEvents()},pointerclick:function(t){t=ot(t),this.trigger("pointerclick",t)},pointerup:function(t){t=ot(t),this.undelegateDocumentEvents(),this.trigger("pointerup",t),this.$el.removeClass("is-in-action"),t.type==="touchend"&&(this.$input[0].click(),t.preventDefault())},isDisabled:function(){return this.$input.prop("disabled")},enable:function(){this.$el.removeClass("disabled"),this.$input.prop("disabled",!1)},disable:function(){this.$el.addClass("disabled"),this.$input.prop("disabled",!0)}}),VV=jn.extend({tagName:"label",events:{"input input.toggle":"onInput","change input.toggle":"onChange","click input.toggle":"pointerclick",mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup"},documentEvents:{mouseup:"pointerup",touchend:"pointerup"},init:function(){ln(this,"pointerup")},render:function(){var t=this.options,e=on("<span/>").text(t.label||""),n=on("<span><i/></span>");this.$input=on("<input/>").addClass("toggle").attr("type","checkbox").prop("checked",!!t.value);var i=on("<div/>").addClass(t.type);return this.$el.append([e,i.append(this.$input,n)]),this},onInput:function(t){this.trigger("input",!!t.target.checked,t)},onChange:function(t){this.trigger("change",!!t.target.checked,t)},pointerclick:function(t){t=ot(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=ot(t),this.$el.addClass("is-in-action"),this.trigger("pointerdown",t),this.delegateDocumentEvents()},pointerup:function(t){t=ot(t),this.undelegateDocumentEvents(),this.$el.removeClass("is-in-action"),this.trigger("pointerup",t),t.type==="touchend"&&(this.$input[0].click(),t.preventDefault())},isDisabled:function(){return this.$input.prop("disabled")},enable:function(){this.$el.removeClass("disabled"),this.$input.prop("disabled",!1)},disable:function(){this.$el.addClass("disabled"),this.$input.prop("disabled",!0)}}),zV=jn.extend({render:function(){return this.options.width&&this.$el.css({width:this.options.width}),this}}),UV=jn.extend({tagName:"label",render:function(){return this.$el.text(this.options.text),this}}),_w=jn.extend({events:{"change .input":"onChange","input .input":"onChange"},render:function(){var t=this.options,e;return this.$output=on("<output/>").text(t.value),e=on("<span/>").addClass("units").text(t.unit),this.$input=on("<input/>").addClass("input").attr({type:"range",name:t.type,min:t.min,max:t.max,step:t.step}).val(t.value),this.$el.append([this.$input,this.$output,e]),this},onChange:function(t){var e=this.getValue();e!==this.currentValue&&(this.currentValue=e,this.$output.text(e),this.trigger("change",e,t))},getValue:function(){return parseInt(this.$input.val(),10)},setValue:function(t,e={}){this.$input.val(t),e.silent?(t=this.getValue(),this.currentValue=t,this.$output.text(t)):this.$input[0].dispatchEvent(new CustomEvent("change",{bubbles:!0}))},isDisabled:function(){return this.$input.prop("disabled")},enable:function(){this.$input.prop("disabled",!1)},disable:function(){this.$input.prop("disabled",!0)}}),HV=jn.extend({render:function(){var t=Ze(this.options,"type","group","index");return this.selectBox=new Sa(t),this.selectBox.render().$el.appendTo(this.el),this},bindEvents:function(){this.selectBox.on("all",this.trigger,this)},isDisabled:function(){return this.selectBox.isDisabled()},enable:function(){this.selectBox.enable()},disable:function(){this.selectBox.disable()}}),Mi=jn.extend({events:{mousedown:"pointerdown",mouseup:"pointerup",touchend:"pointerup",touchstart:"pointerdown",click:"pointerclick"},tagName:"button",render:function(){var t=this.options;return this.$el.text(t.text),this},pointerclick:function(t){t=ot(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=ot(t),this.trigger("pointerdown",t)},pointerup:function(t){t=ot(t),this.trigger("pointerup",t),t.type==="touchend"&&(this.el.click(),t.preventDefault())},isDisabled:function(){return this.$el.prop("disabled")},enable:function(){this.$el.prop("disabled",!1)},disable:function(){this.$el.prop("disabled",!0)}}),GV=jn.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout",input:"onInput",change:"onChange"},tagName:"div",render:function(){var t=this.options;return this.$label=on("<label/>").text(t.label),this.$text=on("<input/>").addClass("input").attr("type","text").val(t.value),this.$input=on("<div/>").addClass("input-wrapper").append(this.$text),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t=ot(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=ot(t),this.trigger("pointerdown",t),t.type==="touchstart"&&this.$text[0].focus()},pointerup:function(t){t=ot(t),this.trigger("pointerup",t),t.type==="touchend"&&(this.$text[0].click(),t.preventDefault())},pointerfocusin:function(t){t=ot(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=ot(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)},onInput:function(t){this.trigger("input",t.target.value,t)},onChange:function(t){this.trigger("change",t.target.value,t)},isDisabled:function(){return this.$text.prop("disabled")},enable:function(){this.$text.prop("disabled",!1)},disable:function(){this.$text.prop("disabled",!0)}}),jV=jn.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout",input:"onInput",change:"onChange"},tagName:"div",render:function(){var t=this.options;return this.$label=on("<label/>").text(t.label),this.$number=on("<input/>").addClass("number").attr({type:"number",max:t.max,min:t.min}).val(t.value),this.$input=on("<div/>").addClass("input-wrapper").append(this.$number),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t=ot(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=ot(t),this.trigger("pointerdown",t),t.type==="touchstart"&&this.$number[0].focus()},pointerup:function(t){t=ot(t),this.trigger("pointerup",t),t.type==="touchend"&&(this.$number[0].click(),t.preventDefault())},pointerfocusin:function(t){t=ot(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=ot(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)},onInput:function(t){this.trigger("input",t.target.value,t)},onChange:function(t){this.trigger("change",t.target.value,t)},isDisabled:function(){return this.$number.prop("disabled")},enable:function(){this.$number.prop("disabled",!1)},disable:function(){this.$number.prop("disabled",!0)}}),WV=jn.extend({events:{mousedown:"pointerdown",touchstart:"pointerdown",mouseup:"pointerup",touchend:"pointerup",click:"pointerclick",focusin:"pointerfocusin",focusout:"pointerfocusout",input:"onInput",change:"onChange"},tagName:"div",render:function(){var t=this.options;return this.$label=on("<label/>").text(t.label),this.$textarea=on("<textarea/>").addClass("textarea").text(t.value),this.$input=on("<div/>").addClass("input-wrapper").append(this.$textarea),this.$el.append([this.$label,this.$input]),this},pointerclick:function(t){t.preventDefault(),t=ot(t),this.trigger("pointerclick",t)},pointerdown:function(t){t=ot(t),this.trigger("pointerdown",t),t.type==="touchstart"&&this.$textarea[0].focus()},pointerup:function(t){t=ot(t),this.trigger("pointerup",t),t.type==="touchend"&&(this.$textarea[0].click(),t.preventDefault())},pointerfocusin:function(t){t=ot(t),this.$el.addClass("is-focused"),this.trigger("pointerfocusin",t)},pointerfocusout:function(t){t=ot(t),this.$el.removeClass("is-focused"),this.trigger("pointerfocusout",t)},onInput:function(t){this.trigger("input",t.target.value,t)},onChange:function(t){this.trigger("change",t.target.value,t)},isDisabled:function(){return this.$textarea.prop("disabled")},enable:function(){this.$textarea.prop("disabled",!1)},disable:function(){this.$textarea.prop("disabled",!0)}}),YV=jn.extend({render:function(){var t=Ze(this.options,"type","group","index");return this.selectButtonGroup=new ip(t),this.selectButtonGroup.render().$el.appendTo(this.el),this},bindEvents:function(){this.selectButtonGroup.on("all",this.trigger,this)},isDisabled:function(){return this.selectButtonGroup.isDisabled()},enable:function(){this.selectButtonGroup.enable()},disable:function(){this.selectButtonGroup.disable()}}),XV=Mi.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},bindEvents:function(){if(!this.options.autoToggle)return;const{paperScroller:t}=this.getReferences();this.updateAvailability(t),this.listenTo(t.options.paper,"scale",()=>this.updateAvailability(t))},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoom(e.step,{max:e.max,grid:e.step}),Mi.prototype.pointerdown.call(this,t)},updateAvailability:function(t){t.zoom()<this.options.max?this.enable():this.disable()}}),qV=Mi.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2},bindEvents:function(){if(!this.options.autoToggle)return;const{paperScroller:t}=this.getReferences();this.updateAvailability(t),this.listenTo(t.options.paper,"scale",()=>this.updateAvailability(t))},pointerdown:function(t){var e=this.options;this.getReferences().paperScroller.zoom(-e.step,{min:e.min,grid:e.step}),Mi.prototype.pointerdown.call(this,t)},updateAvailability:function(t){t.zoom()>this.options.min?this.enable():this.disable()}}),KV=Mi.extend({references:["paperScroller"],options:{min:.2,max:5,step:.2,useModelGeometry:!1,padding:20},pointerdown:function(t){const{options:e}=this;this.getReferences().paperScroller.zoomToFit({padding:e.padding,scaleGrid:e.step,minScale:e.min,maxScale:e.max,useModelGeometry:e.useModelGeometry}),Mi.prototype.pointerdown.call(this,t)}}),ZV=_w.extend({references:["paperScroller"],options:{min:20,max:500,step:20,value:100,unit:" %"},bindEvents:function(){const{paperScroller:t}=this.getReferences();this.on("change",function(e){t.zoom(e/100,{absolute:!0,grid:this.options.step/100})},this),this.listenTo(t.options.paper,"scale",e=>{this.setValue(Math.floor(e*100),{silent:!0})})}}),JV=Mi.extend({references:["commandManager"],bindEvents:function(){if(!this.options.autoToggle)return;const{commandManager:t}=this.getReferences();this.updateAvailability(t),this.listenTo(t,"stack",()=>this.updateAvailability(t))},pointerclick:function(){this.getReferences().commandManager.undo()},updateAvailability:function(t){t.hasUndo()?this.enable():this.disable()}}),QV=Mi.extend({references:["commandManager"],bindEvents:function(){if(!this.options.autoToggle)return;const{commandManager:t}=this.getReferences();this.updateAvailability(t),this.listenTo(t,"stack",()=>this.updateAvailability(t))},pointerclick:function(){this.getReferences().commandManager.redo()},updateAvailability:function(t){t.hasRedo()?this.enable():this.disable()}}),t4=Mi.extend({onRender:function(){const[t]=on(this.options.target);this.target=t,t&&(window.top.document===t||!window.top.document.contains(t))&&(this.el.style.display="none")},pointerclick:function(){fx(this.target)}}),e4=jn.extend({events:{"change .input ":"change","input .input ":"input"},render:function(){const t=this.options,e="#FFFFFF";return this.inputEl=document.createElement("input"),this.inputEl.classList.add("input"),this.inputEl.setAttribute("type","color"),t.value?this.setValue(t.value):this.inputEl.value=e,this.el.appendChild(this.inputEl),this},_validateHexCode:function(t){return/^#(?:[0-9a-fA-F]{6})$/.test(t)},change:function(t){t=ot(t),this.trigger("change",t.target.value,t)},input:function(t){t=ot(t),this.trigger("input",t.target.value,t)},disable:function(){this.el.classList.add("disabled"),this.inputEl.disabled=!0},enable:function(){this.el.classList.remove("disabled"),this.inputEl.disabled=!1},setValue:function(t,e={}){this._validateHexCode(t)&&(this.inputEl.value=t,e.silent||this.trigger("change"))}}),Sw={checkbox:FV,toggle:VV,separator:zV,label:UV,range:_w,selectBox:HV,button:Mi,inputText:GV,inputNumber:jV,textarea:WV,selectButtonGroup:YV,zoomIn:XV,zoomOut:qV,zoomToFit:KV,zoomSlider:ZV,undo:JV,redo:QV,fullscreen:t4,colorPicker:e4},n4={Left:"left",Right:"right"},i4=ae.extend({options:{autoToggle:!1,widgetNamespace:null},align:["left","right"],className:"toolbar",defaultGroup:"default",widgets:[],groupViews:[],init:function(){this.tools=ft(this.options.tools),this.groups=this.options.groups||{}},getWidgetByName:function(t){return this.widgets.find(function(e){return e.options.name===t})},getWidgets:function(){return this.widgets},groupsWithItemsPairs:function(){var t={};this.tools.forEach(function(a){var l=a.group||this.defaultGroup;t[l]=t[l]||{items:[],group:{}},t[l].items.push(a),t[l].group=this.groups[l]||{}},this);for(var e=Object.keys(t),n=[],i=0,r=e.length;i<r;i++){var s=e[i];n.push([s,t[s]])}var o=Je(n,function(a){return a[1].group.index});return Je(o,function(a){return a[1].group.align||"left"})},render:function(){var t=this.groupsWithItemsPairs(),e=!1;return t.forEach(function(n){var i=n[0],r=n[1],s=this.renderGroup(i,r);!e&&r.group.align&&r.group.align==="right"&&(e=!0,s.addClass("group-first")),s.appendTo(this.el)},this),this},renderGroup:function(t,e){const{references:n,autoToggle:i,widgetNamespace:r}=this.options;var s=new r4({name:t,align:e.group.align,items:e.items,references:n,autoToggle:i,widgetNamespace:r});return this.groupViews.push(s),s.on("all",(function(){this.trigger.apply(this,arguments)}).bind(this)),s.render(),this.widgets=this.widgets.concat(s.widgets),s.$el},onRemove:function(){We(this.groupViews,"off"),We(this.groupViews,"remove")}},{Align:n4});var r4=ae.extend({className:"toolbar-group",init:function(){this.widgets=[]},onRender:function(){this.el.dataset.group=this.options.name,this.$el.addClass(this.options.align),this.renderItems()},renderItems:function(){ft(this.options.items).forEach(function(t){var e=this.createWidget(t);this.$el.append(e.$el)},this)},createWidget:function(t){const{references:e,autoToggle:n,widgetNamespace:i}=this.options,r=te(t)?{autoToggle:n,type:t}:U({autoToggle:n},t);var s=jn.create(r,e,i||Sw);return t.name!==void 0&&s.on("all",(function(o){var a=Array.prototype.slice.call(arguments,1);this.trigger.apply(this,[t.name+":"+o].concat(a))}).bind(this)),this.widgets.push(s),s},onRemove:function(){We(this.widgets,"off"),We(this.widgets,"remove")}});const Gi=q,s4={Left:"left",Top:"top",Bottom:"bottom",Right:"right"},o4={Left:"left",Top:"top",Bottom:"bottom",Right:"right",Auto:"auto",Off:"off"},a4=ae.extend({className:"tooltip",options:{left:void 0,right:void 0,top:void 0,bottom:void 0,position:void 0,positionSelector:void 0,direction:"auto",minResizedWidth:100,padding:0,rootTarget:null,target:null,container:null,trigger:"hover",viewport:{selector:null,padding:0},dataAttributePrefix:"tooltip",template:'<div class="tooltip-arrow"></div><div class="tooltip-arrow-mask"></div><div class="tooltip-content"></div>',animation:!1},init:function(){this.eventNamespace=("."+this.className+this.cid).replace(/ /g,"_"),this.settings={};const{trigger:t,rootTarget:e,target:n,animation:i=!1,container:r}=this.options;let s;r&&(s=Gi(r)[0]),r||(s=document.body),this.container=s;var o=t.split(" ");ln(this,"render","hide","show","toggle","isVisible","position"),e?(this.$rootTarget=Gi(e),o.forEach(function(a){switch(a){case"click":this.$rootTarget.on("click"+this.eventNamespace,this.options.target,this.toggle);break;case"hover":this.$rootTarget.on("mouseover"+this.eventNamespace,this.options.target,this.render);break;case"focus":this.$rootTarget.on("focusin"+this.eventNamespace,this.options.target,this.render);break}},this)):(this.$target=Gi(n),o.forEach(function(a){switch(a){case"click":this.$target.on("click"+this.eventNamespace,this.toggle);break;case"hover":this.$target.on("mouseover"+this.eventNamespace,this.render);break;case"focus":this.$target.on("focusin"+this.eventNamespace,this.render);break}},this)),i&&this.animate(i),this.$el.append(this.options.template)},animate:function({duration:t="500ms",delay:e="400ms",timingFunction:n="ease"}={}){this.$el.addClass("animated").css({animationDelay:e,animationDuration:t,animationTimingFunction:n})},onRemove:function(){this.options.rootTarget?this.$rootTarget.off(this.eventNamespace):this.$target.off(this.eventNamespace)},hide:function(){var t=this.settings;t&&(t.currentTarget&&this.unbindHideActions(t.currentTarget),this.$el.removeClass(t.className),this.$el.remove(),this.trigger("close"))},show:function(t){this.render(t||{target:this.options.target})},toggle:function(t){this.isVisible()?this.hide():this.show(t)},isVisible:function(){return document.body.contains(this.el)},render:function(t){let e=null;t.x!==void 0&&t.y!==void 0&&(e={x:t.x,y:t.y});let n=null;t.target&&([n]=Gi(t.target).closest(this.options.target));const i=this.settings=this.getTooltipSettings(n);this.$(".tooltip-content").html(i.calculatedContent),n?(i.currentTarget=n,this.bindHideActions(n)):i.currentTarget=null;let r;e?r={x:e.x,y:e.y,width:1,height:1}:r=Xr(n),this.el.style.display="none",this.$el.removeClass("left right top bottom"),this.$el.addClass(i.className),i.shouldRender&&Gi(this.container).append(this.$el);let s=this.$("img");s.length?s.on("load",(function(){this.position(r),this.$el.addClass("rendered")}).bind(this)):(this.position(r),this.$el.addClass("rendered"))},unbindHideActions:function(t){var e=this.eventNamespace+".remove";Gi(t).off(e),clearInterval(this.interval)},bindHideOnRemoveTarget:function(t){clearInterval(this.interval),this.interval=setInterval((function(){(document===t||!document.contains(t))&&(clearInterval(this.interval),this.hide())}).bind(this),500)},bindHideActions:function(t){var e=this.settings,n=Gi(t),i=this.eventNamespace+".remove";this.bindHideOnRemoveTarget(t),this.options.trigger.split(" ").forEach(function(r){var s={hover:["mouseout","mousedown"],focus:["focusout"]},o=s[r]||[];e.hideTrigger&&(o=e.hideTrigger.split(" ")||[]),o.forEach(function(a){n.on(a+i,this.hide)},this)},this)},getTooltipSettings:function(t){const e=this.loadDefinitionFromElementData(t);return this.evaluateOptions(t,e)},evaluateOptions:function(t,e={}){const n=this.settings=U({},e,this.options);let i=!0,r=n.dataAttributeContent;return Kt(n,(s,o)=>{if(o==="content")if(xt(s)){const a=n.content.call(this,t,this);if(a==null)return;if(a===!1){i=!1;return}r=a}else r=s;else{const a=xt(s)?s(t):s;n[o]=a??e[o]}}),n.shouldRender=i,n.calculatedContent=r,this.normalizePosition(n),n},loadDefinitionFromElementData:function(t){if(!t)return{};var e=function(r){return r==="left"||r==="bottom"||r==="top"||r==="right"},n=this.getAllAttrs(t,"data-"+this.options.dataAttributePrefix),i={};return Kt(n,function(r,s){s===""&&(s="dataAttributeContent"),e(s)||(i[s]=r)}),i},getAllAttrs:function(t,e){for(var n=e||"",i=t.attributes,r={},s=0,o=i.length;s<o;s++){var a=i[s];if(a&&a.name.startsWith(n)){var l=ja(a.name.slice(n.length));r[l]=a.value}}return r},normalizePosition:function(t){var e=t.left||t.right||t.top||t.bottom;!t.position&&e&&(t.left&&(t.position="left"),t.right&&(t.position="right"),t.top&&(t.position="top"),t.bottom&&(t.position="bottom")),!t.positionSelector&&e&&(t.positionSelector=e)},position:function(t){var e=this.settings;this.el.style.display="",this.$el.css("width","auto");var n=Xr(this.container),i=this.getTooltipBBox(t,n);this.$el.css({left:i.x,top:i.y,width:i.width||"auto"});var r={};e.position==="left"||e.position==="right"?r.top=t.y+t.height/2-i.y:e.position==="top"||e.position==="bottom"?r.left=t.x+t.width/2-i.x:r.top=t.y+t.height/2-i.y,r.top-=n.y,r.left-=n.x,this.$(".tooltip-arrow, .tooltip-arrow-mask").attr("style",null).css(r),e.direction&&e.direction!=="off"&&this.$el.addClass(e.direction==="auto"?e.position||"left":e.direction)},getViewportViewBBox:function(){const{settings:t}=this,{selector:e,padding:n=0}=t.viewport;let i;e?[i]=Gi(t.currentTarget).closest(e):i=document.documentElement;const r=Xr(i);if(!e){const{clientWidth:s,clientHeight:o}=window.document.documentElement;r.width=s+window.scrollX,r.height=o+window.scrollY}return r.x+=n,r.y+=n,r.width-=2*n,r.height-=2*n,r},basePositions:{left:function(t,e){var n={x:e.positionedBBox.x+e.positionedBBox.width+e.padding,y:e.targetBBox.y+e.targetBBox.height/2-e.tooltipBBox.height/2};if(t){var i=e.viewport.x+e.viewport.width-n.x;if(i>e.minWidth&&i<e.tooltipBBox.width+e.padding&&(n.width=i),i<e.minWidth)return this.settings.position="right",this.basePositions.right(!1,e)}return n},right:function(t,e){var n={x:e.positionedBBox.x-e.tooltipBBox.width-e.padding,y:e.targetBBox.y+e.targetBBox.height/2-e.tooltipBBox.height/2};if(t){var i=e.positionedBBox.x-e.padding-e.viewport.x;if(i>e.minWidth&&i<e.tooltipBBox.width+e.padding&&(n.width=i,n.x=e.viewport.x),i<e.minWidth)return this.settings.position="left",this.basePositions.left(!1,e)}return n},top:function(t,e){var n={x:e.targetBBox.x+e.targetBBox.width/2-e.tooltipBBox.width/2,y:e.positionedBBox.y+e.positionedBBox.height+e.padding};if(t){var i=e.viewport.y+e.viewport.height-(e.positionedBBox.y+e.positionedBBox.height+e.padding);if(i<e.tooltipBBox.height)return this.settings.position="bottom",this.basePositions.bottom(!1,e)}return n},bottom:function(t,e){var n={x:e.targetBBox.x+e.targetBBox.width/2-e.tooltipBBox.width/2,y:e.positionedBBox.y-e.tooltipBBox.height-e.padding};if(t){var i=e.positionedBBox.y-e.padding-e.viewport.y;if(i<e.tooltipBBox.height)return this.settings.position="top",this.basePositions.top(!1,e)}return n}},getTooltipBBox:function(t,e){var n=this.settings,i=Gi(n.positionSelector),r=i[0]?Xr(i[0]):t,s=this.measureTooltipElement(),o=this.getViewportViewBBox(),a=n.position||"left",l=n.padding,c=Math.min(n.minResizedWidth,s.width+l),h={padding:l,targetBBox:t,positionedBBox:r,tooltipBBox:s,viewport:o,minWidth:c},u=this.basePositions[a].call(this,c>0,h);return u.x-=e.x,u.y-=e.y,u.y<o.y?u.y=o.y:u.y+s.height>o.y+o.height&&(u.y=o.y+o.height-s.height),u.x<o.x?u.x=o.x:u.x+s.width>o.x+o.width&&(u.x=o.x+o.width-s.width),u},measureTooltipElement:function(){var t=this.el.cloneNode(!0);t.style.visibility="hidden",t.style.left="-1000px",t.style.top="-500px",document.body.appendChild(t);var e={width:t.offsetWidth,height:t.offsetHeight};return document.body.removeChild(t),e}},{TooltipPosition:s4,TooltipArrowPosition:o4}),fh=q,l4=ae.extend({MINIMAL_PREVIEW_SIZE:10,className:"tree-layout",documentEvents:{mousemove:"onPointermove",touchmove:"onPointermove",mouseup:"onPointerup",touchend:"onPointerup"},options:{previewAttrs:{parent:{rx:2,ry:2}},useModelGeometry:!1,clone:function(t){return t.clone()},canInteract:function(){return!0},validateConnection:null,validatePosition:null,paperConstructor:fi,paperOptions:null,reconnectElements:null,translateElements:null,layoutFunction:null},init:function(){this.startListening(),this.render(),this.onSetTheme(null,this.theme)},startListening:function(){this.enable()},_isEnabled:!1,_onPointerdown:null,enable:function(){const{paper:t}=this.options;this.disable();const e=this.canInteract(this.onPointerdown);this._isEnabled=!0,this.listenTo(t,"element:pointerdown",e),this._onPointerdown=e},disable:function(){const{_onPointerdown:t,options:e}=this,{paper:n}=e;this._isEnabled=!1,t&&(this.stopListening(n,"element:pointerdown",t),this._onPointerdown=null)},isDisabled:function(){return!this._isEnabled},render:function(){var t=this.options.paper;this.$activeBox=fh("<div>").addClass("tree-layout-box active hidden").appendTo(this.el);const e=this.options.paperOptions||{},n=e.model||new li({},{cellNamespace:t.model.get("cells").cellNamespace}),i=U({cellViewNamespace:t.options.cellViewNamespace},e,{interactive:!1,width:"100%",height:"100%",model:n});return this.draggingPaper=new this.options.paperConstructor(i),this.draggingPaper.undelegateEvents(),this.$translateBox=fh("<div>").addClass("tree-layout-box translate hidden").append(this.draggingPaper.render().el).appendTo(this.el),this.$mask=fh("<div>").addClass("tree-layout-mask"),this.svgViewport=k(t.cells),this.svgPreviewChild=k(this.renderChildPreview()).attr(this.options.previewAttrs.child||{}).addClass("tree-layout-preview child"),this.svgPreviewConnection=k(this.renderConnectionPreview()).attr(this.options.previewAttrs.link||{}).addClass("tree-layout-preview link"),this.svgPreviewParent=k(this.renderParentPreview()).attr(this.options.previewAttrs.parent||{}).addClass("tree-layout-preview parent"),this.svgPreview=k("g").addClass("tree-layout-preview-group").append([this.svgPreviewConnection,this.svgPreviewParent,this.svgPreviewChild]),this.$el.appendTo(t.el),this},renderChildPreview:function(){return k("circle")},renderParentPreview:function(){return k("rect")},renderConnectionPreview:function(){return k("path")},onSetTheme:function(t,e){var n=[this.svgPreview,this.$mask];n.forEach(function(i){i&&(t&&i.removeClass(this.themeClassNamePrefix+t),i.addClass(this.themeClassNamePrefix+e))},this)},onRemove:function(){this.svgPreview.remove(),this.$mask.remove()},toggleDropping:function(t){this.$mask.toggleClass("dropping-not-allowed",!t),this.$translateBox.toggleClass("no-drop",!t)},canDrop:function(){return this.isActive()&&!this.$translateBox.hasClass("no-drop")},isActive:function(){return!this.$translateBox.hasClass("hidden")},updateBox:function(t,e){t.css({width:e.width,height:e.height,left:e.x,top:e.y})},positionTranslateBox:function(t){var e=k.transformPoint(t,this.ctm);this.$translateBox.css({left:e.x,top:e.y})},prepareDraggingPaper:function(t){var e=this.options.clone(t).position(0,0);this.draggingPaper.scale(this.ctm.a,this.ctm.d),this.draggingPaper.model.resetCells([e])},dragstart:function(t,e,n){const{$translateBox:i,$activeBox:r,options:s}=this,{paper:o,useModelGeometry:a}=s;this.toggleDropping(!1),this.ctm=o.matrix();const[l]=t,c=l.findView(o);if(c){const h=c.getBBox({useModelGeometry:a});this.updateBox(i,me({x:e,y:n},h)),this.updateBox(r,h),r.removeClass("external")}else{const h=k.transformRect(l.getBBox(),this.ctm);this.updateBox(i,me({x:e,y:n},h)),r.addClass("external")}this.positionTranslateBox({x:e,y:n}),this.show(),this.prepareDraggingPaper(l)},drag:function(t,e,n){var i=this.model,r={x:e,y:n},s,o;if(this.candidate&&(this.candidate=null,this.hidePreview()),this.positionTranslateBox(r),s=i.getMinimalRootAreaByPoint(r),s&&(o=s.findMinimalAreaByPoint(r,{expandBy:Math.min(i.get("siblingGap"),i.get("gap"))/2})),o){var a=this.findDirection(o,r),l=o.getLayoutSiblings(a),c=l.getSiblingRankByPoint(r);ft(t).every(function(u){return this.isConnectionValid(u,l,c)},this)?(this.candidate={id:o.root.id,direction:a,siblingRank:c},this.updatePreview(l,c),this.showPreview(),this.toggleDropping(!0)):this.toggleDropping(!1)}else{let h=!0;const u=this.options.validatePosition;typeof u=="function"&&(h=ft(t).every(d=>u.call(this,d,e,n,this))),this.toggleDropping(h)}},dragend:function(t,e,n){var i=this.candidate,r=this.options;if(this.canDrop())if(i){var s=r.reconnectElements;typeof s=="function"?s.apply(this,[t,r.paper.getModelById(i.id),i.siblingRank,i.direction,this]):this.reconnectElements(t,i),this.candidate=null}else{var o=r.translateElements;typeof o=="function"?o.call(this,t,e,n,this):this.translateElements(t,e,n)}this.hide()},show:function(){const{$mask:t,$activeBox:e,$translateBox:n,options:i}=this,[r]=t;r&&!r.isConnected&&i.paper.el.appendChild(r),e.toggleClass("hidden",e.hasClass("external")),n.removeClass("hidden")},hide:function(){this.$mask.remove().removeClass("dropping-not-allowed"),this.$activeBox.addClass("hidden"),this.$translateBox.addClass("hidden"),this.hidePreview()},cancelDrag:function(){this.candidate=null,this.undelegateDocumentEvents(),this.hide()},reconnectElement:function(t,e){const{model:n,options:i}=this,{graph:r}=n;r.getCell(t)||(r.addCell(t),n.layoutTree(t));var s=e.siblingRank+.5,o={direction:e.direction,siblingRank:s,ui:!0,treeLayoutView:this.cid},a=n.reconnectElement(t,e.id,o);if(!a){var l=i.paper,c=l.getDefaultLink(t.findView(l));c.set({source:{id:e.id},target:{id:t.id}}),c.addTo(l.model,o),n.changeSiblingRank(t,s,o),n.changeDirection(t,e.direction,o);var h=n.getAttribute(t,"direction");n.updateDirections(t,[h,e.direction],o)}},reconnectElements:function(t,e){t.forEach(function(n){this.reconnectElement(n,e)},this),this.layout()},translateElement:function(t,e,n){const{model:i}=this,{graph:r}=i;var s=r.getConnectedLinks(t,{inbound:!0});We(s,"remove");var o=t.get("size");t.set("position",{x:e-o.width/2,y:n-o.height/2},{ui:!0,treeLayoutView:this.cid}),r.getCell(t)||r.addCell(t,{ui:!0,treeLayoutView:this.cid})},translateElements:function(t,e,n){t.forEach(function(i){this.translateElement(i,e,n)},this),this.layout()},layout:function(){xt(this.options.layoutFunction)?this.options.layoutFunction.call(this,this):this.model.layout({ui:!0,treeLayoutView:this.cid})},updatePreview:function(t,e){var n=t.parentArea.root,i=Math.max(this.model.get("siblingGap")/2,this.MINIMAL_PREVIEW_SIZE),r={width:i,height:i},s=t.getNeighborPointFromRank(e),o=t.getConnectionPoints(s,{ignoreSiblings:!0}),a=t.getParentConnectionPoint(),l=t.getChildConnectionPoint(s,r);this.updateParentPreview(n.position(),n.size(),n),this.updateChildPreview(s,r),this.updateConnectionPreview(a,l,o)},showPreview:function(){this.svgViewport.append(this.svgPreview)},hidePreview:function(){this.svgPreview.remove()},updateParentPreview:function(t,e){this.svgPreviewParent.attr({x:t.x,y:t.y,width:e.width,height:e.height})},updateChildPreview:function(t,e){this.svgPreviewChild.attr({cx:t.x,cy:t.y,r:e.width/2})},updateConnectionPreview:function(t,e,n){this.svgPreviewConnection.attr({d:kx(t,e,n,{})})},findDirection:function(t,e){var n,i=t.root.get("layout")||t.getType();switch(i){case"BL-BR":case"TL-TR":case"L-R":return n=i.split("-"),e.x>t.rootCX?n[1]:n[0];case"BL-TL":case"BR-TR":case"B-T":return n=i.split("-"),e.y>t.rootCY?n[0]:n[1];case"L":case"R":case"T":case"B":case"TR":case"TL":case"BR":case"BL":return i;default:return t.direction}},isConnectionValid:function(t,e,n){var i=e.parentArea.root;if(t.id==i.id||this.model.graph.isSuccessor(t,e.parentArea.root))return!1;var r=this.model.getLayoutArea(t);if(r&&r.parentArea&&r.parentArea==e.parentArea&&r.direction==e.direction){var s=r.siblingRank-n;if(s===0||s===1)return!1}var o=this.options.validateConnection;return typeof o=="function"?o.call(this,t,i,this,{siblingRank:n,direction:e.direction,level:e.parentArea.level+1,siblings:e.layoutAreas.map(a=>a.root)}):!0},canInteract:function(t){return(function(e,n){this.options.canInteract(e,n)&&t.apply(this,arguments)}).bind(this)},startDragging:function(t){var e=Array.isArray(t)?t:[t];xn(e)||this.delegateDocumentEvents(null,{moveCounter:0,draggedElements:e})},onPointerdown:function(t,e){t.preventDefaultInteraction(e),this.startDragging(t.model)},onPointermove:function(t){const e=ot(t);var n=e.data,i=this.options.paper,r=i.clientToLocalPoint({x:e.clientX,y:e.clientY});n.moveCounter===i.options.clickThreshold?this.dragstart(n.draggedElements,r.x,r.y):n.moveCounter>i.options.clickThreshold&&this.drag(n.draggedElements,r.x,r.y),n.moveCounter++},onPointerup:function(t){const e=ot(t);var n=e.data,i=this.options.paper;if(n.moveCounter>=i.options.clickThreshold){var r=i.clientToLocalPoint({x:e.clientX,y:e.clientY});this.dragend(n.draggedElements,r.x,r.y)}this.undelegateDocumentEvents()}}),c4=q,sp=(t,e,n)=>{if(n=n||{},t===void 0)throw new Error("The the dia.Paper is a mandatory option.");t.trigger("beforeexport",n);const{svg:i}=t,r=n.fillFormControls!==!1;r&&Array.from(i.getElementsByTagName("select")).forEach(d=>k.ensureId(d));const s=k(i).clone();let o=s.node;const a=s.findOne("."+En("layers")),l=n.area||t.getContentArea(),c=n.preserveDimensions;c&&s.attr({width:c.width||l.width,height:c.height||l.height}),s.removeAttr("style").attr("viewBox",[l.x,l.y,l.width,l.height].join(" ")),a.removeAttr("transform"),n.grid||s.findOne("."+En("grid-layer")).remove(),n.useComputedStyles!==!1&&y4(t.svg,o);const h=n.stylesheet;te(h)&&v4(s.node,h),t.trigger("afterexport",n);const u=d=>{r!==!1&&g4(o,t);const f=n.beforeSerialize;if(typeof f=="function"){const p=f.call(t,o,t);p instanceof SVGElement&&(o=p)}e(m4(o),d)};n.convertImagesToDataUris?h4(s.find("image,img")).then(()=>u()).catch(d=>{u(d)}):u()},u4=new RegExp(/^(data:)([\w\\+-]*)(;charset=[\w-]+|;base64){0,1},(.*)/gi);function h4(t){const e={};return t.forEach(n=>{let i=f4(n);i&&(i=i.trim(),!u4.test(i)&&(i in e?e[i].push(n):e[i]=[n]))}),Promise.all(Object.keys(e).map(n=>d4(n,e[n])))}function d4(t,e){return new Promise((n,i)=>{jf(t,(r,s)=>{if(r||!s){i(r);return}e.forEach(o=>p4(o,s)),n()})})}function f4(t){switch(t.tagName()){case"IMAGE":return t.attr("xlink:href")||t.attr("href");case"IMG":default:return t.attr("src")}}function p4(t,e){switch(t.tagName()){case"IMAGE":{t.attr("xlink:href",e),t.attr("href")&&t.attr("href",null);break}case"IMG":default:{t.attr("src",e);break}}}function g4(t,e){Array.from(t.getElementsByTagName("input")).forEach(n=>{switch(n.type){case"checkbox":case"radio":n.checked?n.setAttribute("checked",!0):n.removeAttribute("checked");break;default:n.setAttribute("value",n.value);break}}),Array.from(t.getElementsByTagName("textarea")).forEach(n=>{n.textContent=n.value}),Array.from(t.getElementsByTagName("select")).forEach(n=>{const i=n.id;if(!i)return;const r=e.svg.getElementById(i);r&&Array.from(n.options).forEach((s,o)=>{r.options[o].selected?s.setAttribute("selected",!0):s.removeAttribute("selected")})})}function m4(t){return new XMLSerializer().serializeToString(t).replace(/&nbsp;/g," ")}function v4(t,e){const i=t.ownerDocument.implementation.createDocument(null,"xml",null);k(t).prepend(k("style",{type:"text/css"},[i.createCDATASection(e)]))}function y4(t,e){const n=Array.from(t.querySelectorAll("*")),i=Array.from(e.querySelectorAll("*")),r=t.ownerDocument,s=r.styleSheets.length,o=[];for(let c=s-1;c>=0;c--)o[c]=r.styleSheets[c],r.styleSheets[c].disabled=!0;const a={};n.forEach((c,h)=>{const u=window.getComputedStyle(c,null),d={};Kt(u,f=>{d[f]=u.getPropertyValue(f)}),a[h]=d}),s!=r.styleSheets.length&&o.forEach((c,h)=>{r.styleSheets[h]=c});for(let c=0;c<s;c++)r.styleSheets[c].disabled=!1;const l={};n.forEach((c,h)=>{const u=window.getComputedStyle(c,null),d=a[h],f={};Kt(u,p=>{isNaN(p)&&u.getPropertyValue(p)!==d[p]&&(f[p]=u.getPropertyValue(p))}),l[h]=f}),i.forEach((c,h)=>{c4(c).css(l[h])})}const b4=(t,e)=>{const n="menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes",i=kr("svg_output");sp(t,r=>{const s=window.open("",i,n),o="data:image/svg+xml,"+encodeURIComponent(r);s.document.write('<img src="'+o+'" style="max-height:100%" />')},U({convertImagesToDataUris:!0},e))},x4=Object.freeze(Object.defineProperty({__proto__:null,openAsSVG:b4,toSVG:sp},Symbol.toStringTag,{value:"Module"})),gu=(t,e,n={})=>{if(t===void 0)throw new Error("The dia.Paper is a mandatory argument.");const i=n.canvg||(typeof canvg<"u"?canvg:void 0),r=n.area||t.paperToLocalRect(t.getContentBBox()),s=T4(r,n),o=Ot(n.width)&&Ot(n.height)?n:s,a=C4(o,A4(n.size));if(!E4(a.width,a.height))throw new Error("dia.Paper: raster size exceeded.");const l=new Image;let c,h;l.onload=function(){let u,d,f;function p(){f=document.createElement("canvas"),f.width=a.width,f.height=a.height,d=f.getContext("2d"),d.fillStyle=n.backgroundColor||"white",d.fillRect(0,0,a.width,a.height)}function g(){const S=n.type,C=n.quality;if(S==="canvas"){if(x(d))throw new Error("Canvas Tainted");e(f,h)}else u=f.toDataURL(S,C),e(u,h);v()}function v(){f.svg&&xt(f.svg.stop)&&setTimeout(f.svg.stop,1)}function x(S){try{const C=S.getImageData(0,0,1,1);return!1}catch{return}}p();try{d.drawImage(l,0,0,a.width,a.height),g()}catch{if(typeof i>"u"){console.error("Canvas tainted. Canvg library required.");return}p();const C={ignoreDimensions:!0,ignoreClear:!0,ignoreMouse:!0,ignoreAnimation:!0,offsetX:0,offsetY:0,useCORS:!0};i(f,c,U(C,{forceRedraw:(function(){return this.called?!1:(this.called=!0,!0)}).bind({called:!1}),renderCallback:function(){try{g()}catch{v(),c=I4(c),p(),i(f,c,U(C,{renderCallback:g}))}}}))}},sp(t,(u,d)=>{c=u,h=d,l.src="data:image/svg+xml,"+encodeURIComponent(u)},{convertImagesToDataUris:!0,beforeSerialize:n.beforeSerialize,area:s,grid:n.grid,useComputedStyles:n.useComputedStyles,stylesheet:n.stylesheet,fillFormControls:n.fillFormControls,preserveDimensions:{width:a.width,height:a.height}})},Ew=(t,e,n)=>{n=n||{},n.type="image/png",gu(t,e,n)},w4=(t,e,n)=>{n=n||{},n.type="image/jpeg",gu(t,e,n)},_4=(t,e,n)=>{n=n||{},n.type="canvas",gu(t,e,n)},S4=(t,e)=>{const n="menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes",i=kr("png_output");Ew(t,function(r){window.open("",i,n).document.write('<img src="'+r+'"/>')},U({padding:10},e))};function E4(t,e){const n=document.createElement("canvas");n.width=t,n.height=e;const i=t-1,r=e-1,s=n.getContext("2d");try{s.fillStyle="rgb(1,1,1)",s.fillRect(i,r,1,1);const o=s.getImageData(i,r,1,1).data;if(o[0]!==1||o[1]!==1||o[2]!==1)return!1}catch{return!1}return!0}function T4(t,e){const n=P4(e),i=J({x:-n.left,y:-n.top,width:n.left+n.right,height:n.top+n.bottom});if(e.width&&e.height){const r=t.width+n.left+n.right,s=t.height+n.top+n.bottom;i.scale(r/e.width,s/e.height)}return J(t).moveAndExpand(i)}function A4(t){let e=1;if(t!==void 0&&(e=parseFloat(t),!Number.isFinite(e)||e===0))throw new Error("dia.Paper: invalid raster size ("+t+")");return e}function C4(t,e){return{width:Math.max(Math.round(t.width*e),1),height:Math.max(Math.round(t.height*e),1)}}function P4(t){const e=Ne(t.padding);return t.width&&t.height&&(e.left+e.right>=t.width&&(e.left=e.right=0),e.top+e.bottom>=t.height&&(e.top=e.bottom=0)),e}function I4(t){return t.replace(/<image[^>]*>/g,function(e){const n=e.match(/href="([^"]*)"/),i=n&&n[1],r="data:image/svg+xml";if(i&&i.substr(0,r.length)===r){const s=atob(i.substr(i.indexOf(",")+1));return s.substr(s.indexOf("<svg"))}return e})}const O4=Object.freeze(Object.defineProperty({__proto__:null,openAsPNG:S4,toCanvas:_4,toDataURL:gu,toJPEG:w4,toPNG:Ew},Symbol.toStringTag,{value:"Module"})),k4=(t,e,n)=>{const r=new DOMParser().parseFromString(t,"text/xml");if(r.documentElement.nodeName=="parsererror")throw new Error("Error while parsing GEXF file.");const s=Array.from(r.documentElement.querySelectorAll("node")),o=Array.from(r.documentElement.querySelectorAll("edge")),a=[];return s.forEach(function(l){const c={id:l.getAttribute("id"),label:l.getAttribute("label")},h=l.querySelector("size");if(h){const g=parseFloat(h.getAttribute("value"));c.width=g,c.height=g}const u=l.querySelector("position");if(u){const g=parseFloat(u.getAttribute("x")),v=parseFloat(u.getAttribute("y")),x=parseFloat(u.getAttribute("z"));c.x=g,c.y=v,c.z=x}const d=l.querySelector("shape");if(d){const g=d.getAttribute("value");c.shape=g}const f=l.querySelector("color");if(f){const g=f.getAttribute("r"),v=f.getAttribute("g"),x=f.getAttribute("b"),S=f.getAttribute("a");S?c.color=`rgba(${g},${v},${x},${S})`:c.color=`rgb(${g},${v},${x})`}const p=e(c,l);a.push(p)}),o.forEach(function(l){const c={source:l.getAttribute("source"),target:l.getAttribute("target")},h=n(c,l);a.unshift(h)}),a},Zr=q,L4=200,M4=200;function D4(t,e){var n=F4(e),i=R4(t,n),r=function(o){N4(t,o,e)},s={sheetSizePx:Tw(n)};n.ready(i,r,s)}var Vm=function(t,e,n){t.trigger("beforeprint",n);const i=document.createElement("div");i.className="printarea";const r=document.createElement("div");r.classList.add(En("print-paper")),r.style.position="relative",n.size&&i.classList.add("printarea-size-"+n.size);var s=k(t.svg).clone(),o=s.findOne(`.${En("layers")}`);n.grid||s.findOne("."+En("grid-layer")).remove(),r.appendChild(s.node);var a=Tw(n),l=t.getArea(),{sx:c,sy:h}=t.scale(),{tx:u,ty:d}=t.translate(),f=k.createSVGMatrix().translate(u/c,d/h),{scaleToFit:p,bBox:g}=B4(l,e,a);return r.style.left="0",r.style.top="0",s.attr({width:g.width*p,height:g.height*p,style:"position:relative",viewBox:[g.x,g.y,g.width,g.height].join(" ")}),o.attr("transform",k.matrixToTransformString(f)),r.appendChild(s.node),i.appendChild(r),i.classList.add("preview"),{el:i,sheetSizePx:a}},N4=function(t,e,n){if(e){var i=Zr(document.body);i.addClass("joint-print");var r=t.$el.children().detach();e.forEach(function(a){a.classList.remove("preview"),a.classList.add("print-ready"),i.append(a)});var s=!1,o=function(){s||(s=!0,i.removeClass("joint-print"),e.forEach(function(a){a.remove()}),t.$el.append(r),Zr("#print-styles").remove(),t.trigger("afterprint",n),Zr(window).off("afterprint",o))};Zr(window).one("afterprint",o),setTimeout(o,200),window.print()}},R4=function(t,e){var n=U4(t,e),i=[],r;if(e.poster)for(var s=G4(n,e.poster),o=H4(n,s),a=0;a<o.length;a++)r=Vm(t,o[a],e),i.push(r.el);else r=Vm(t,n,e),i.push(r.el);if(r){var l={width:r.sheetSizePx.cssWidth,height:r.sheetSizePx.cssHeight};z4(l,e)}return i},$4=function(t){return Object.keys(t).map(function(e){return e+":"+t[e]}).join(";")+";"},Tw=function(t){var e=Ne(t.margin),n=t.sheet;e.unit=t.marginUnit,n.unit=t.sheetUnit;var i="calc("+n.width+n.unit+" - "+(e.left+e.right)+e.unit+")",r="calc("+n.height+n.unit+" - "+(e.top+e.bottom)+e.unit+")",s=j4.measure(i,r,"");return{cssWidth:i,cssHeight:r,width:s.width,height:s.height}},B4=function(t,e,n){var i=new J({x:e.x-t.x,y:e.y-t.y,width:e.width,height:e.height}),r=i.width/i.height,s=n.width/n.height,o;return r>s?o=n.width/i.width:o=n.height/i.height,{bBox:i,scaleToFit:o,fitHorizontal:r>s}},F4=function(t){var e=$i({},t,{area:null,poster:!1,sheet:{width:210,height:297},sheetUnit:"mm",ready:function(n,i,r){i(n)},margin:.4,marginUnit:"in",padding:5});return e.area||(e.printingAll=!0),e},V4=function(t){var e=Zr("#print-styles"),n='<style type="text/css" id="print-styles">'+t+"</style>";e.length?e.html(t):Zr("head").append(n)},z4=function(t,e){var n=$4(t),i=Ne(e.margin),r=e.marginUnit,s=[i.top+r,i.right+r,i.bottom+r,i.left+r].join(" "),o="size:"+(e.sheet.width+e.sheet.unit)+" "+(e.sheet.height+e.sheet.unit),a=["@media print {",".printarea.print-ready {",n,"}","@page {","margin:"+s+";",o,"}",".printarea.preview {",n,"}","}"];V4(a.join(""))},U4=function(t,e){var n=e.area;if(!n){var i=Ne(e.padding);n=t.getContentArea().moveAndExpand({x:-i.left,y:-i.top,width:i.left+i.right,height:i.top+i.bottom})}return n},H4=function(t,e){for(var n=e.width,i=e.height,r,s=[],o=0,a=0,l=0,c=0;o<t.height;){for(;a<t.width&&(r=J(t.x+a,t.y+o,n,i),s.push(r),a+=n,!(c>M4));)c++;if(a=0,c=0,o+=i,l>L4)break;l++}return s},G4=function(t,e){var n={width:e.width,height:e.height};return n.width||(n.width=Math.ceil(t.width/(e.columns||1))),n.height||(n.height=Math.ceil(t.height/(e.rows||1))),n},j4={supportedUnits:{px:function(t){return t},mm:function(t){return this.millimeterSize*t},cm:function(t){return this.millimeterSize*t*10},in:function(t){return this.millimeterSize*t*25.4},pt:function(t){return this.millimeterSize*(t*25.4/72)},pc:function(t){return this.millimeterSize*(t*25.4/6)}},measure:function(t,e,n){n=n||"";var i=Zr("<div/>").css({display:"inline-block",position:"absolute",left:-15e3,top:-15e3,width:t+n,height:e+n}).appendTo(document.body),r={width:i.width(),height:i.height()};return i.remove(),r},toPx:function(t,e){if(this.millimeterSize||(this.millimeterSize=this.measure(1,1,"mm").width),e=(e||"").toLowerCase(),!this.supportedUnits[e])throw new Error("Unsupported unit "+e);return this.supportedUnits[e].call(this,t)}};const W4=M3,Y4={ForceDirected:W5,GridLayout:td,StackLayout:un,TreeLayout:aV},X4={RecordScrollbar:lV,SwimlaneBoundary:cV,SwimlaneTransform:uV},q4={CommandManager:bc,Validator:hV};U({},KF,Y4);U({},qF,X4);const K4=U({},W4,s5),mu={standard:K4,bpmn2:k5,chart:B5,measurement:j5},WY=U({},Wx,q4),YY={Clipboard:dV,ColorPalette:dw,ContextToolbar:fw,Dialog:In,FlashMessage:pw,FreeTransform:gw,Halo:pV,Inspector:na,Keyboard:$n,Lightbox:yV,Navigator:bV,PaperScroller:Ea,PathDrawer:EV,PathEditor:TV,Popup:AV,RadioGroup:vw,SelectBox:Sa,SelectButtonGroup:ip,Selection:PV,Snaplines:OV,StackLayoutView:RV,Stencil:rp,TextEditor:Oo,Toolbar:i4,Tooltip:a4,TreeLayoutView:l4,Widget:jn,widgets:Sw};Object.assign({},x4,O4,{gexf:{toCellsArray:k4}},{print:D4});const Xl={PRIMARY:"primary",UNIQUE:"unique",INDEX:"index",NONE:"none"};function Z4(t,e){for(var n=-1,i=t==null?0:t.length;++n<i&&e(t[n],n,t)!==!1;);return t}var Aw=Z4,J4=bo;function Q4(t,e){return function(n,i){if(n==null)return n;if(!J4(n))return t(n,i);for(var r=n.length,s=e?r:-1,o=Object(n);(e?s--:++s<r)&&i(o[s],s,o)!==!1;);return n}}var tz=Q4,ez=ab,nz=tz,iz=nz(ez),op=iz,rz=ff;function sz(t){return typeof t=="function"?t:rz}var oz=sz,az=Aw,lz=op,cz=oz,uz=Rn;function hz(t,e){var n=uz(t)?az:lz;return n(t,cz(e))}var dz=hz;const Tn=xi(dz);class ql extends mu.standard.HeaderedRectangle{defaults(){const e={"gray-150":"#edf2f7","gray-700":"#334155","grey-darker":"#606F7B","grey-darker-lighter":"#94a3b8","cobalt-600":"#5A67D8",white:"#FFFFFF"},n=30,i=32,r=6,s=8,o=3,a=14,l=this.INDEX_HEADER_HEIGHT,c=this.INDEX_HEADER_HEIGHT/2;return $i({type:"ds.TableShape",columnUuids:[],itemHeight:n,indexItemHeight:i,indexItemSpaceY:r,iconWidth:a,iconHeight:14,iconPadding:o,indexItemXPadding:s,size:{width:270,height:80},attrs:{root:{magnet:!1,"data-testid":"canvas-table-single"},body:{stroke:"#FFF",fill:"#FFF",strokeWidth:1,filter:"url(#dropShadowMd)",rx:6,ry:6,width:"calc(w)"},tabColor:{x:-.5,y:0,width:"calc(w + 1)",height:this.TAB_COLOR_VISIBLE_HEIGHT*2,stroke:"none",fill:"#6C6C6C",strokeWidth:1,rx:6,ry:6,"data-testid":"canvas-table-single-header-color"},header:{y:8,fill:"#f1f5f9",stroke:"#f1f5f9",strokeWidth:1,height:this.HEADER_HEIGHT,width:"calc(w)"},headerLabel:{fill:e["gray-700"],fontWeight:"bold",y:32,textWrap:{ellipsis:!0,height:30,width:"calc(w - 50)"},x:"calc(w / 2)",textAnchor:"middle",textVerticalAnchor:"middle",fontSize:20,"data-testid":"canvas-table-single-header-label"},headerCommentRect:{width:34,height:28,x:"calc(w - 38)",y:16,fill:"url(#tableCommentGradientFadeOnLeft)"},headerCommentIcon:{width:20,height:28,href:"/svg/chat-bubble-bottom.svg",x:"calc(w - 28)",y:18,event:"table-shape:tooltip-button:pointerdown","data-testid":"canvas-table-has-comment","data-tooltip-class-name":"tooltip-type-table-shape","data-tooltip-type-table-shape":!0},headerDivider:{y:this.TAB_COLOR_VISIBLE_HEIGHT+this.HEADER_HEIGHT-.25,fill:"#cbd5e1",stroke:"#cbd5e1",strokeWidth:.25,height:.25,width:"calc(w)"},columnsContainer:{transform:`matrix(1,0,0,1,0,${52+this.COLUMN_CONTAINER_Y_PADDING})`,"data-testid":"canvas-columns-container"},columnWrappers:{fill:"currentColor"},columnBodies:{width:`calc(w - ${this.COLUMN_BODIES_X_PADDING*2})`,height:n,rx:6,ry:6,magnet:"passive"},columnKeyIcons:{pointerEvents:"none"},columnNames:{textAnchor:"start",textVerticalAnchor:"middle",fill:e["grey-darker"],pointerEvents:"none",fontFamily:'Inter, ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',fontSize:16,fontWeight:"Normal",letterSpacing:0},columnNames_primaryKeys:{fontWeight:"bold",pointerEvents:"none"},columnDataTypeRects:{height:n,pointerEvents:"none"},columnDataTypeLeftFades:{x:"calc(x - 24)",width:"calc(0 * w + 24)",height:n,fill:"url(#gradientFadeOnLeft)",pointerEvents:"none"},columnCommentIcons:{event:"table-shape:tooltip-button:pointerdown",x:`calc(x - ${o+a})`,"data-testid":"canvas-column-has-comment","data-tooltip-class-name":"tooltip-type-table-shape","data-tooltip-type-table-shape":!0},columnCommentDefaults:{event:"table-shape:tooltip-button:pointerdown",x:`calc(x - ${o+a})`,"data-testid":"canvas-column-has-column-attributes","data-tooltip-class-name":"tooltip-type-table-shape","data-tooltip-type-table-shape":!0},columnDataTypeTexts:{x:`calc(w - ${this.COLUMNS_CONTAINER_PADDING.right})`,textVerticalAnchor:"middle",fill:e["grey-darker-lighter"],textAnchor:"end",pointerEvents:"none"},columnIsNullables:{x:`calc(w - ${this.COLUMNS_CONTAINER_PADDING.right})`,text:"?",textVerticalAnchor:"middle",fill:e["grey-darker-lighter"],textAnchor:"end",pointerEvents:"none"},indexesSectionBody:{display:"none",ref:"columnsContainer",x:this.INDEX_SECTION_BODY_X_MARGIN,y:`calc(y + calc(h + ${this.INDEX_CONTAINER_Y_MARGIN}))`,width:`calc(w + ${this.COLUMN_BODIES_X_PADDING*2-this.INDEX_CONTAINER_X_PADDING*2})`,"data-testid":"index-columns-container",fill:e["gray-150"],rx:6,ry:6},indexesContainerLabel:{display:"none",ref:"indexesSectionBody",x:`calc(x + ${this.INDEX_SECTION_BODY_X_PADDING})`,y:`calc(y + ${c})`,fontSize:14,fontWeight:"bold",textAnchor:"start",textVerticalAnchor:"middle",fill:e["grey-darker"],text:"Indexes"},indexesContainer:{display:"none",ref:"indexesSectionBody",transform:`matrix(1,0,0,1,calc(x + ${this.INDEX_BODIES_X_PADDING}),calc(y + ${l}))`,"data-testid":"canvas-indexes-container",fill:e["gray-150"]},indexWrappers:{fill:"currentColor"},indexBodies:{event:"element:indexBodies:pointerup",width:`calc(w - ${2*(this.INDEX_CONTAINER_X_MARGIN+this.INDEX_BODIES_X_PADDING)})`,height:i,rx:4,ry:4},indexKeyIcons:{pointerEvents:"none"},indexNames:{textAnchor:"start",textVerticalAnchor:"middle",fill:e["grey-darker"],pointerEvents:"none",fontSize:16,fontWeight:"Normal",fontFamily:'Inter, ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',letterSpacing:0}},ports:{groups:{portsOutLeft:{position:{name:"left"},attrs:{portBody:{magnet:!0,r:6,fill:e["cobalt-600"],stroke:e["cobalt-600"]}},markup:[{tagName:"circle",selector:"portBody"}]},portsOutRight:{position:{name:"right"},attrs:{portBody:{magnet:!0,r:6,fill:e["cobalt-600"],stroke:e["cobalt-600"]}},markup:[{tagName:"circle",selector:"portBody"}]}}}},super.defaults)}preinitialize(){this.columnUuidsCache=[],this.indexUuidsCache=[],this.HEADER_HEIGHT=44,this.TAB_COLOR_VISIBLE_HEIGHT=8,this.COLUMN_CONTAINER_Y_PADDING=3,this.COLUMN_BODIES_X_PADDING=2,this.INDEX_BODIES_X_PADDING=8,this.INDEX_SECTION_BODY_X_MARGIN=8,this.INDEX_SECTION_BODY_X_PADDING=8,this.INDEX_CONTAINER_X_MARGIN=8,this.INDEX_CONTAINER_X_PADDING=8,this.INDEX_CONTAINER_Y_MARGIN=6,this.INDEX_CONTAINER_PADDING={top:0,bottom:8},this.INDEX_WRAPPER_X_PADDING=6,this.COLUMNS_PATH="markup/6/children",this.INDEX_HEADER_HEIGHT=28,this.COLUMNS_CONTAINER_PADDING={left:10,right:12},this.INDEXES_PATH="markup/10/children",this.markup=[{tagName:"rect",selector:"body"},{tagName:"rect",selector:"tabColor"},{tagName:"rect",selector:"header",className:"table-header"},{tagName:"text",selector:"headerLabel"},{tagName:"rect",selector:"headerCommentRect"},{tagName:"image",selector:"headerCommentIcon",className:"table-comment-icon"},{tagName:"g",selector:"columnsContainer",className:"columns-container",children:[]},{tagName:"rect",selector:"headerDivider",children:[]},{tagName:"rect",selector:"indexesSectionBody",className:"indexes-section-body"},{tagName:"text",selector:"indexesContainerLabel"},{tagName:"g",selector:"indexesContainer",className:"indexes-container",children:[]}]}initialize(...e){super.initialize(...e),this.buildMarkup()}onChange(e,n){}onColumnsChange(){this.hasChanged("columns")&&this._setColumns(this.get("columns"))}setName(e,n){return this.attr(["headerLabel","text"],e,n)}getName(){return this.attr(["headerLabel","text"])}setColor(e){return this.attr(["tabColor","fill"],e)}getColor(){return this.attr(["tabColor","fill"])}setComment(e){return this.attr("headerCommentRect/display",e?"block":"none"),this.attr(["headerCommentIcon","href"],e?"/svg/chat-bubble-bottom.svg":"")}setColumns(e){return this}autoresize(e){const n=this.getMinimalSize(),{size:i}=this.attributes,{height:r,width:s}=i,o=n.height,a=Math.max(s,n.width);this.resize(a,o,e)}getHeightOfIndexesSection(e=!1){const n=this.prop(this.INDEXES_PATH).length,i=e?this.INDEX_CONTAINER_Y_MARGIN*2:0;return n===0?0:this.INDEX_CONTAINER_PADDING.top+this.INDEX_CONTAINER_PADDING.bottom+this.INDEX_HEADER_HEIGHT+this.attributes.indexItemHeight*n+this.attributes.indexItemSpaceY*(n-1)+i}recalculateIndexesSectionHeight(){if(!this.prop(this.INDEXES_PATH))return;const e=this.getHeightOfIndexesSection();if(e===0){this.attr("indexesContainerLabel/display","none"),this.attr("indexesSectionBody/display","none"),this.attr("indexesContainer/display","none");return}this.attr("indexesContainerLabel/display","block"),this.attr("indexesSectionBody/display","block"),this.attr("indexesContainer/display","block"),this.attr("indexesSectionBody/height",e)}getMinimalSize(){const e=this.prop(this.COLUMNS_PATH).length;return{width:0,height:this.TAB_COLOR_VISIBLE_HEIGHT+this.HEADER_HEIGHT+this.attributes.itemHeight*e+this.COLUMN_CONTAINER_Y_PADDING*2+this.getHeightOfIndexesSection(!0)}}buildMarkup(e){let n=this.prop("markup")??ke(this.markup),i=U({record:this.id,dry:!0},e);this.set("markup",n,i),this.autoresize()}buildColumnKeyIconMarkup(e,n,i){return{tagName:"image",selector:`columnKeyIcon_${e.uuid}`,groupSelector:"columnKeyIcons",attributes:{"data-testid":"canvas-column-key-icon",x:this.COLUMNS_CONTAINER_PADDING.left,y:i+(this.attributes.itemHeight-this.attributes.iconHeight)/2,width:this.attributes.iconWidth,height:this.attributes.iconHeight,href:n}}}buildColumnMarkup(e,n,i){const s=i*this.attributes.itemHeight,o=[{tagName:"rect",selector:`columnBody_${e.uuid}`,groupSelector:"columnBodies",attributes:{x:0+this.COLUMN_BODIES_X_PADDING,y:s}}];e.is_primary_key?o.push(this.buildColumnKeyIconMarkup(e,"/svg/key.svg",s)):e.is_unique_key?o.push(this.buildColumnKeyIconMarkup(e,"/svg/snowflake.svg",s)):e.is_index&&o.push(this.buildColumnKeyIconMarkup(e,"/svg/neuter.svg",s));const a=["columnNames"];return e.is_primary_key&&a.push("columnNames_primaryKeys"),o.push({tagName:"text",selector:`columnName_${e.uuid}`,groupSelector:a,attributes:{"data-testid":"canvas-column-name",x:this.attributes.iconWidth+this.attributes.iconPadding+this.COLUMNS_CONTAINER_PADDING.left,y:s+this.attributes.itemHeight/2}}),o.push({tagName:"rect",selector:`columnDataTypeRect_${e.uuid}`,groupSelector:"columnDataTypeRects",attributes:{y:s}}),o.push({tagName:"rect",selector:`columnDataTypeLeftFade_${e.uuid}`,groupSelector:"columnDataTypeLeftFades",className:"column-data-type-left-fades",attributes:{y:s}}),e.comment&&o.push({tagName:"image",selector:`columnCommentIcon_${e.uuid}`,groupSelector:"columnCommentIcons",className:"column-comment-icon",attributes:{y:s+(this.attributes.itemHeight-this.attributes.iconHeight)/2,width:this.attributes.iconWidth,height:this.attributes.iconHeight,href:"/svg/chat-bubble-bottom.svg"}}),this._columnHasExtraAttributes(e)&&o.push({tagName:"image",selector:`columnCommentDefault_${e.uuid}`,groupSelector:"columnCommentDefaults",className:"column-default-icon",attributes:{y:s+(this.attributes.itemHeight-this.attributes.iconHeight)/2,width:this.attributes.iconWidth,height:this.attributes.iconHeight,href:"/svg/bookmark.svg"}}),o.push({tagName:"text",selector:`columnDataTypeText_${e.uuid}`,groupSelector:"columnDataTypeTexts",attributes:{"data-testid":"canvas-column-data-type-text",y:s+this.attributes.itemHeight/2}}),e.is_nullable&&o.push({tagName:"text",selector:`columnIsNullable_${e.uuid}`,groupSelector:"columnIsNullables",attributes:{"data-testid":"canvas-column-is-nullable",y:s+this.attributes.itemHeight/2}}),{tagName:"g",selector:`columnWrapper_${e.uuid}`,groupSelector:"columnWrappers",className:"column-wrapper column-wrapper_"+e.uuid,children:o}}setColumnAttributes(e,n){this.attr(`columnWrapper_${e.uuid}`,{"data-testid":"canvas-column-single","data-uuid":e.uuid}),this.attr(`columnName_${e.uuid}`,{text:e.name,textWrap:{width:`calc(w - calc(0.1 * w + ${this.COLUMNS_CONTAINER_PADDING.left+this.COLUMNS_CONTAINER_PADDING.right+this.attributes.iconWidth+this.attributes.iconPadding+this.attributes.iconPadding}))`,height:this.attributes.itemHeight,ellipsis:!0,hyphen:"|||"}});const i=8,r=e.is_nullable?`calc(w - ${this.COLUMNS_CONTAINER_PADDING.right+i})`:`calc(w - ${this.COLUMNS_CONTAINER_PADDING.right})`;this.attr(`columnDataTypeText_${e.uuid}`,{text:n.dataTypeColumnText,x:r,textWrap:{width:"30%",height:this.attributes.itemHeight,ellipsis:!0}});const s=this.calcColumnDataTypeShiftLeftBy(e);this.attr("columnDataTypeRect_"+e.uuid,{ref:"columnDataTypeText_"+e.uuid,width:`calc(w + ${s})`,x:`calc(x - ${s})`}),this.attr("columnDataTypeLeftFade_"+e.uuid,{ref:"columnDataTypeRect_"+e.uuid}),e.comment&&this.attr("columnCommentIcon_"+e.uuid,{ref:"columnDataTypeText_"+e.uuid}),this._columnHasExtraAttributes(e)&&(e.comment?this.attr("columnCommentDefault_"+e.uuid,{ref:"columnCommentIcon_"+e.uuid}):this.attr("columnCommentDefault_"+e.uuid,{ref:"columnDataTypeText_"+e.uuid}))}shiftColumnsYPositionBy(e,n=0){const i=this.prop(this.COLUMNS_PATH);for(let r=n;r<i.length;r++){const s=i[r];this.addYDiffDeep(s,e)}this.prop(this.COLUMNS_PATH,i)}addYDiffDeep(e,n){for(let i in e)typeof e[i]=="object"&&e[i]!==null?this.addYDiffDeep(e[i],n):i==="y"&&(e[i]+=n)}calcColumnDataTypeShiftLeftBy(e){let n=0;return e.comment&&(n+=this.attributes.iconWidth+this.attributes.iconPadding+this.attributes.iconPadding),this._columnHasExtraAttributes(e)&&(n+=this.attributes.iconWidth+this.attributes.iconPadding+this.attributes.iconPadding),n}_columnHasExtraAttributes(e){return e.default||e.enum_values&&e.enum_values.length>0}reorderColumns(e){const n=this.prop(this.COLUMNS_PATH);Tn(this.columnUuidsCache,(r,s)=>{const a=(e.indexOf(r)-s)*this.attributes.itemHeight;this.addYDiffDeep(n[s],a)});const i=[];Tn(e,(r,s)=>{const o=this.columnUuidsCache.indexOf(r);i[s]=n[o]}),this.prop(this.COLUMNS_PATH,i,U({rewrite:!0})),this.columnUuidsCache=[...e],this.resetPorts()}addColumn(e,n){return this.prop(this.COLUMNS_PATH+"/"+this.columnUuidsCache.length,this.buildColumnMarkup(e,n,this.columnUuidsCache.length)),this.setColumnAttributes(e,n),this.columnUuidsCache.push(e.uuid),this.buildMarkup(),this}updateColumn(e,n,i){const r=this.columnUuidsCache.indexOf(e.uuid);r!==-1&&e.uuid===this.columnUuidsCache[r]&&(this.prop(this.COLUMNS_PATH+"/"+r,this.buildColumnMarkup(e,n,r),{rewrite:!0}),this.setColumnAttributes(e,n))}deleteColumn(e){const n=this.columnUuidsCache.indexOf(e);if(n===-1)return;const i=this.prop(this.COLUMNS_PATH).slice();return i.splice(n,1),this.prop(this.COLUMNS_PATH,i,U({rewrite:!0})),this.columnUuidsCache.splice(n,1),this.shiftColumnsYPositionBy(-this.attributes.itemHeight,n),this.buildMarkup(),this.resetPorts(),this}buildIndexMarkup(e,n,i){const r=i*this.attributes.indexItemHeight+this.attributes.indexItemSpaceY*i,s=[{tagName:"rect",selector:`indexBody_${e.uuid}`,groupSelector:"indexBodies",ref:"indexesContainer",attributes:{y:r,x:0}}];let o=null;return e.type===Xl.PRIMARY?o="/svg/key.svg":e.type===Xl.UNIQUE?o="/svg/snowflake.svg":e.type===Xl.INDEX&&(o="/svg/neuter.svg"),o&&s.push(this.buildIndexKeyIconMarkup(e,o,r)),s.push({tagName:"text",selector:`indexNames_${e.uuid}`,groupSelector:"indexNames",attributes:{"data-testid":"canvas-index-names",x:this.attributes.iconWidth+this.attributes.iconPadding+this.INDEX_WRAPPER_X_PADDING,y:r+this.attributes.indexItemHeight/2}}),{tagName:"g",selector:`indexWrapper_${e.uuid}`,groupSelector:"indexWrappers",className:"index-wrapper index-wrapper_"+e.uuid,children:s}}buildIndexKeyIconMarkup(e,n,i){return{tagName:"image",selector:`indexKeyIcon_${e.uuid}`,groupSelector:"indexKeyIcons",attributes:{"data-testid":"canvas-index-key-icon",x:this.INDEX_WRAPPER_X_PADDING,y:i+(this.attributes.indexItemHeight-this.attributes.iconHeight)/2,width:this.attributes.iconWidth,height:this.attributes.iconHeight,href:n}}}setIndexAttributes(e,n){this.attr(`indexWrapper_${e.uuid}`,{"data-testid":"canvas-index-single","data-uuid":e.uuid,className:"index-wrapper"}),this.attr(`indexNames_${e.uuid}`,{text:n.columnNames,textWrap:{width:`calc(w - ${2*(this.INDEX_CONTAINER_X_MARGIN+this.INDEX_CONTAINER_X_PADDING)+this.attributes.iconWidth+2*this.attributes.iconPadding+this.attributes.indexItemXPadding})`,height:this.attributes.indexItemHeight,ellipsis:!0,hyphen:"|||"}})}shiftIndexesYPositionBy(e,n=0){const i=this.prop(this.INDEXES_PATH);for(let r=n;r<i.length;r++){const s=i[r];this.addYDiffDeep(s,e)}this.prop(this.INDEXES_PATH,i)}reorderIndexes(e){const n=this.prop(this.INDEXES_PATH);Tn(this.indexUuidsCache,(r,s)=>{const a=(e.indexOf(r)-s)*(this.attributes.indexItemHeight+this.attributes.indexItemSpaceY);this.addYDiffDeep(n[s],a)});const i=[];Tn(e,(r,s)=>{const o=this.indexUuidsCache.indexOf(r);i[s]=n[o]}),this.prop(this.INDEXES_PATH,i,U({rewrite:!0})),this.indexUuidsCache=e}addIndex(e,n){return this.prop(this.INDEXES_PATH+"/"+this.indexUuidsCache.length,this.buildIndexMarkup(e,n,this.indexUuidsCache.length)),this.setIndexAttributes(e,n),this.indexUuidsCache.push(e.uuid),this.recalculateIndexesSectionHeight(),this.buildMarkup(),this}updateIndex(e,n,i){const r=this.indexUuidsCache.indexOf(e.uuid);r!==-1&&e.uuid===this.indexUuidsCache[r]&&(this.prop(this.INDEXES_PATH+"/"+r,this.buildIndexMarkup(e,n,r),{rewrite:!0}),this.setIndexAttributes(e,n))}deleteIndex(e){const n=this.indexUuidsCache.indexOf(e);if(n===-1)return;const i=this.prop(this.INDEXES_PATH).slice();return i.splice(n,1),this.prop(this.INDEXES_PATH,i,U({rewrite:!0})),this.indexUuidsCache.splice(n,1),this.shiftIndexesYPositionBy(-this.attributes.indexItemHeight-this.attributes.indexItemSpaceY,n),this.recalculateIndexesSectionHeight(),this.buildMarkup(),this}showPorts(){const e=this.HEADER_HEIGHT+this.TAB_COLOR_VISIBLE_HEIGHT+this.COLUMN_CONTAINER_Y_PADDING,n=[];this.columnUuidsCache.forEach((i,r)=>{const s=e+r*this.attributes.itemHeight+this.attributes.itemHeight/2;n.push({columnUuid:i,group:"portsOutLeft",args:{y:s}}),n.push({columnUuid:i,group:"portsOutRight",args:{y:s}})}),this.addPorts(n)}hidePorts(){this.removePorts()}resetPorts(){this.hidePorts(),this.showPorts()}}Object.assign(mu,{ds:{TableShape:ql}});const di={NONE:"canvas-mode-none",EDIT:"canvas-mode-edit",MULTISELECT:"canvas-mode-multiselect",DRAW_RELATIONSHIP_PATH:"canvas-mode-draw-relationship-path"},ph={ONE_TO_ONE:"one-to-one",ONE_TO_MANY:"one-to-many",MANY_TO_ONE:"many-to-one"};class rd extends mu.standard.Link{constructor(){super(...arguments),this.markup=[{tagName:"path",selector:"wrapper",className:"relationship-shape-wrapper",attributes:{fill:"none",stroke:"transparent"}},{tagName:"path",selector:"line",attributes:{fill:"none"}}]}defaults(){return Object.assign(Object.assign({},super.defaults),{type:"ds.RelationshipShape",z:-1,attrs:{root:{"data-testid":"canvas-relationship-single"},wrapper:{connection:!0,strokeWidth:10},line:{connection:!0,stroke:"#a0a0a0",strokeWidth:2,"data-testid":"canvas-relationship-single-line"}}})}preinitialize(){this.MARKER_MANY_END={type:"path","stroke-width":2,d:"m 20 0 l -20 7.5 l 19.85 -7.5 l -19.85 -7.5 l 20 7.5"}}colorSelected(){return this.attr(["line","stroke"],"#6366f1"),this}colorUnselected(){return this.attr(["line","stroke"],"#a0a0a0"),this}setType(e){switch(e){case ph.ONE_TO_ONE:this.removeAttr(["line","sourceMarker"]),this.removeAttr(["line","targetMarker"]);break;case ph.ONE_TO_MANY:this.removeAttr(["line","sourceMarker"]),this.attr(["line","targetMarker"],this.MARKER_MANY_END);break;case ph.MANY_TO_ONE:this.attr(["line","sourceMarker"],this.MARKER_MANY_END),this.removeAttr(["line","targetMarker"]);break}return this}}Object.assign(mu,{ds:{RelationshipShape:rd}});var fz=op;function pz(t,e){var n=[];return fz(t,function(i,r,s){e(i,r,s)&&n.push(i)}),n}var gz=pz,mz=db,vz=gz,yz=Ao,bz=Rn;function xz(t,e){var n=bz(t)?mz:vz;return n(t,yz(e))}var wz=xz;const _z=xi(wz),ap=Mr("relationships",{state:()=>({relationshipShapes:kn({})}),getters:{getRelationshipShape:t=>e=>Lt().graph.getCell(e)},actions:{updateRelationshipAndShape(t,e){if(this.updateRelationship(t,e),Lt().isCanvasVersionV2AndUp){const n=this.getRelationshipShape(t);if(!n)return;e.type&&n.setType(e.type)}},deleteRelationshipAndShape(t){if(this.deleteRelationship(t),Lt().isCanvasVersionV2AndUp){const e=this.getRelationshipShape(t);if(!e)return;e.remove()}},addRelationship({uuid:t,sourceColumnUuid:e,targetColumnUuid:n,type:i}){jt.dispatch("addRelationship",{uuid:t,sourceColumnUuid:e,targetColumnUuid:n,type:i})},updateRelationship(t,e){const n=jt.state.relationships[t];n&&Tn(e,(i,r)=>{jt.dispatch("updateRelationship",{targetRelationship:n,prop:r,value:i})})},deleteRelationship(t){const e=jt.state.relationships[t];e&&jt.dispatch("deleteRelationship",{targetRelationship:e})},SET_RELATIONSHIP_SHAPES(t,e={addToGraph:!0}){e={addToGraph:!0,...e};let n=Eb(t,i=>{const r=jt.getters.getTableUuidOfColumn(i.source_column_uuid),s=pn().tableShapes[r],o=jt.getters.getTableUuidOfColumn(i.target_column_uuid),a=pn().tableShapes[o];if(!s||!a){console.error("Table not found when drawing relationship");return}return new rd({id:i.uuid,source:{id:r,selector:`columnBody_${i.source_column_uuid}`},target:{id:o,selector:`columnBody_${i.target_column_uuid}`}}).setType(i.type)});return n=_z(n,i=>!!i),this.relationshipShapes=kn(n),e.addToGraph&&this.ADD_TO_GRAPH(n),n},ADD_TO_GRAPH(t){return t instanceof rd?(Lt().graph.addCell(t),!0):(Lt().graph.addCells(Object.values(t)),!0)}}}),Lt=Mr("canvas",{state:()=>({canvasVersion:1,graph:kn({}),paper:kn({}),paperScroller:kn({}),scale:null,canvasMode:di.NONE,isPanToolActivated:!1,isLassoToolActivated:!1,isLassoing:!1,selectedTableUuid:null,isResizingTable:!1,expandedTableUuid:null,editingNameForTableUuid:null,draggingTableUuid:null,selectedRelationshipUuid:null}),getters:{isCanvasVersionV1:t=>t.canvasVersion===1,isCanvasVersionV2AndUp:t=>t.canvasVersion>=2,hasSelectedTable:t=>t.canvasVersion===1?jt.getters["diagramUI/hasSelectedTable"]:t.selectedTableUuid!==null,isSelectedTable:t=>e=>t.selectedTableUuid===e,isEditingNameForTable:t=>e=>t.editingNameForTableUuid===e,isExpandedTable:t=>e=>t.expandedTableUuid===e,isDraggingAnyTable:t=>t.draggingTableUuid!==null,isDraggingTable:t=>e=>t.draggingTableUuid===e,hasSelectedRelationship:t=>t.selectedRelationshipUuid!==null,isCanvasModeNone:t=>t.canvasMode===di.NONE,isCanvasModeEdit:t=>t.canvasMode===di.EDIT,isCanvasModeMultiselect:t=>t.canvasMode===di.MULTISELECT},actions:{setCanvasVersion(t){this.canvasVersion=t},setGraph(t){this.graph=kn(t)},setPaper(t){this.paper=kn(t)},setPaperScroller(t){this.paperScroller=kn(t)},setScale(t){this.scale=t},async resetCanvasMode(){this.canvasMode=di.NONE,setTimeout(()=>{this.activateEditMode()},0)},activateEditMode(){this.canvasMode=di.EDIT},activateMultiselectMode(){this.canvasMode=di.MULTISELECT},deactivateMultiselectMode(){this.canvasMode=di.EDIT},toggleMultiselectMode(){this.canvasMode=this.canvasMode===di.MULTISELECT?di.EDIT:di.MULTISELECT},activateCanvasPanTool(){this.isPanToolActivated=!0},deactivateCanvasPanTool(){this.isPanToolActivated=!1},toggleCanvasPanTool(){this.isPanToolActivated=!this.isPanToolActivated},activateCanvasLassoTool(){this.isLassoToolActivated=!0},deactivateCanvasLassoTool(){this.isLassoToolActivated=!1},toggleCanvasLassoTool(){this.isLassoToolActivated=!this.isLassoToolActivated},setIsLassoing(t){this.isLassoing=t},RESET_CELLS(){const t=pn().tableShapes,e=ap().relationshipShapes;this.graph.resetCells([...Object.values(t),...Object.values(e)])},selectTable(t){this.unsetDraggingTableUuid(),this.selectedTableUuid=t},unselectTable(){this.selectedTableUuid=null},setResizingTable(t){this.isResizingTable=t},enterEditingNameModeForTable(t){this.selectTable(t),this.editingNameForTableUuid=t},exitEditingNameModeForTable(){this.editingNameForTableUuid=null},expandTable(t){this.expandedTableUuid=t},collapseTable(t){this.expandedTableUuid===t&&(this.expandedTableUuid=null)},collapseAllTables(){this.expandedTableUuid=null},setDraggingTableUuid(t){this.draggingTableUuid=t},unsetDraggingTableUuid(){this.draggingTableUuid=null},resetTableStates(){this.selectedTableUuid=null,this.editingNameForTableUuid=null},setSelectedTableUuid(t){this.selectedTableUuid=t},unsetSelectedTableUuid(){this.selectedTableUuid=null},setSelectedRelationshipUuid(t){this.selectedRelationshipUuid=t},unsetSelectedRelationshipUuid(){this.selectedRelationshipUuid=null}}}),zm=Mr("canvasMultiselect",{state:()=>({jointSelection:kn({}),multiselectedTableUuids:[]}),getters:{hasMultiselectedTables:t=>t.multiselectedTableUuids.length>0},actions:{setJointSelection(t){this.jointSelection=kn(t)},setMultiselectedTableModels(t){this.jointSelection.collection.reset(t)},addMultiselectedTableModel(t){this.jointSelection.collection.add(t)},removeMultiselectedTableModel(t){this.jointSelection.collection.remove(t)},_setMultiselectedTableUuids(t){this.multiselectedTableUuids=t}}});var Sz=op,Ez=bo;function Tz(t,e){var n=-1,i=Ez(t)?Array(t.length):[];return Sz(t,function(r,s,o){i[++n]=e(r,s,o)}),i}var Cw=Tz;function Az(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}var Cz=Az,Um=Ra;function Pz(t,e){if(t!==e){var n=t!==void 0,i=t===null,r=t===t,s=Um(t),o=e!==void 0,a=e===null,l=e===e,c=Um(e);if(!a&&!c&&!s&&t>e||s&&o&&l&&!a&&!c||i&&o&&l||!n&&l||!r)return 1;if(!i&&!s&&!c&&t<e||c&&n&&r&&!i&&!s||a&&n&&r||!o&&r||!l)return-1}return 0}var Iz=Pz,Oz=Iz;function kz(t,e,n){for(var i=-1,r=t.criteria,s=e.criteria,o=r.length,a=n.length;++i<o;){var l=Oz(r[i],s[i]);if(l){if(i>=a)return l;var c=n[i];return l*(c=="desc"?-1:1)}}return t.index-e.index}var Lz=kz,gh=hf,Mz=df,Dz=Ao,Nz=Cw,Rz=Cz,$z=Vc,Bz=Lz,Fz=ff,Vz=Rn;function zz(t,e,n){e.length?e=gh(e,function(s){return Vz(s)?function(o){return Mz(o,s.length===1?s[0]:s)}:s}):e=[Fz];var i=-1;e=gh(e,$z(Dz));var r=Nz(t,function(s,o,a){var l=gh(e,function(c){return c(s)});return{criteria:l,index:++i,value:s}});return Rz(r,function(s,o){return Bz(s,o,n)})}var Uz=zz,Hz=Uz,Hm=Rn;function Gz(t,e,n,i){return t==null?[]:(Hm(e)||(e=e==null?[]:[e]),n=i?void 0:n,Hm(n)||(n=n==null?[]:[n]),Hz(t,e,n))}var jz=Gz;const xc=xi(jz),Pw=Mr("driverDataTypes",{state:()=>({}),getters:{getDriverDataTypes:t=>jt.getters["driverDataTypes/getDriverDataTypes"],getDriverDataType:t=>e=>jt.getters["driverDataTypes/getDriverDataType"](e)},actions:{}});var Wz=ob,Yz=Na,Xz=Qd,qz=Rn,Kz=bo,Zz=Fc,Jz=zc,Qz=nf,t6="[object Map]",e6="[object Set]",n6=Object.prototype,i6=n6.hasOwnProperty;function r6(t){if(t==null)return!0;if(Kz(t)&&(qz(t)||typeof t=="string"||typeof t.splice=="function"||Zz(t)||Qz(t)||Xz(t)))return!t.length;var e=Yz(t);if(e==t6||e==e6)return!t.size;if(Jz(t))return!Wz(t).length;for(var n in t)if(i6.call(t,n))return!1;return!0}var s6=r6;const Iw=xi(s6);var o6=hf,a6=Ao,l6=Cw,c6=Rn;function u6(t,e){var n=c6(t)?o6:l6;return n(t,a6(e))}var h6=u6;const d6=xi(h6),is=Mr("indexes",{state:()=>({}),getters:{getIndex:t=>e=>jt.getters["indexes/getIndex"](e),getIndexViewData:t=>function(e){return{columnNames:this.getColumnNamesForIndex(e)}},getIndexesForTable:(t,e)=>n=>{const i=pn().getTable(n).indexes,r=_.map(i,s=>globalThis.getIndex(s));return xc(r,"order")},getTableUuidOfIndex:t=>e=>jt.getters["indexes/getTableUuidOfIndex"](e),getColumnNamesForIndex:t=>function(e){const n=Ow().getColumnIndexesForIndex(e);return _.map(n,i=>Er().getColumn(i.column_uuid).name)}},actions:{addIndexAndShape(t,e={},n={focusOnCreated:!0}){const i=ki();if(this.addIndex({uuid:i,table_uuid:t}),Iw(e)||this.updateIndex(i,e),Lt().isCanvasVersionV2AndUp){const r=this.getTableUuidOfIndex(i),s=pn().tableShapes[r];if(!s)return;const o=this.getIndex(i);return o?(s.addIndex(o,this.getIndexViewData(o.uuid)),n.focusOnCreated&&this.focusIndex(r,o.uuid),o.uuid):void 0}else{const r=this.getIndex(i);return r?(this.focusIndex(t,r.uuid),r.uuid):void 0}},updateIndexAndShape(t,e){this.updateIndex(t,e),this.redrawIndexShape(t,e)},deleteIndexAndShape(t){const e=this.getTableUuidOfIndex(t);if(this.deleteIndex(t),Lt().isCanvasVersionV2AndUp){const n=pn().tableShapes[e];if(!n)return;n.deleteIndex(t)}},redrawIndexShape(t,e={}){if(Lt().isCanvasVersionV2AndUp){const n=this.getTableUuidOfIndex(t),i=pn().tableShapes[n];if(!i)return;const r=this.getIndex(t);if(!r)return;i.updateIndex(r,this.getIndexViewData(t),e)}},updateOrderOfIndexesInTableAndShape(t){const e=this.getTableUuidOfIndex(t[0]);let n=null;if(!(Lt().isCanvasVersionV2AndUp&&(n=pn().tableShapes[e],!n))&&(Tn(t,(i,r)=>{const s=r+1;this.updateIndex(i,{order:s})}),pn().updateTableAndShape(e,{indexes:t}),Lt().isCanvasVersionV2AndUp)){Lt().paper.freeze();try{n.reorderIndexes(t)}catch(i){console.error(i)}finally{Lt().paper.unfreeze()}}},addIndex(t){jt.dispatch("addIndexToTable",{uuid:t.uuid,tableUuid:t.table_uuid})},updateIndex(t,e){const n=jt.state.indexes.indexes[t];n&&Tn(e,(i,r)=>{jt.dispatch("indexes/updateIndex",{targetIndex:n,prop:r,value:i})})},deleteIndex(t){const e=jt.state.indexes.indexes[t];e&&jt.dispatch("indexes/deleteIndex",e.uuid)},SET_INDEXES_IN_TABLE_SHAPES(t){Tn(xc(t,"order"),e=>{const n=this.getTableUuidOfIndex(e.uuid),i=pn().tableShapes[n];i&&i.addIndex(e,this.getIndexViewData(e.uuid))})},focusIndex(t,e){Lt().isCanvasVersionV2AndUp?this.$emitter.emit("focus-index-v2",{tableUuid:t,indexUuid:e}):this.$emitter.emit("focus-index",{tableUuid:t,indexUuid:e})}}}),Ow=Mr("columnIndexes",{state:()=>({}),getters:{getColumnIndexesForIndex:t=>e=>jt.getters["columnIndexes/getColumnIndexesForIndex"](e),getColumnIndexesForColumn:t=>e=>jt.getters["columnIndexes/getColumnIndexesForColumn"](e)},actions:{syncColumnIndexesForIndexAndUpdateShape(t,e){if(this.syncColumnIndexesForIndex(t,e),Lt().isCanvasVersionV2AndUp){const n=is().getTableUuidOfIndex(t),i=pn().tableShapes[n];if(!i)return;const r=is().getIndex(t);if(!r)return;i.updateIndex(r,is().getIndexViewData(t))}},syncColumnIndexesForIndex(t,e){jt.dispatch("columnIndexes/syncColumnIndexesForIndex",{indexUuid:t,columnUuids:e})}}}),Er=Mr("columns",{state:()=>({}),getters:{getColumn:t=>e=>jt.getters.column(e),getColumnViewData:t=>function(e){const n=this.getColumn(e);if(!n)return;const i=Pw().getDriverDataType(n.driver_data_type_id),r=n.driver_data_type_params&&n.driver_data_type_params.length>0?"("+n.driver_data_type_params.join(",")+")":null;let s=i.name;return r&&(s+=r),{dataTypeColumnText:s}},getTableUuidOfColumn:t=>e=>{var n;return(n=jt.getters.column(e))==null?void 0:n.table_uuid}},actions:{addColumnAndShape(t,e={},n={focusOnCreated:!0}){const i=ki();if(this.addColumn({uuid:i,table_uuid:t}),Iw(e)||this.updateColumn(i,e),Lt().isCanvasVersionV2AndUp){const r=this.getTableUuidOfColumn(i),s=pn().tableShapes[r];if(!s)return;const o=this.getColumn(i);return o?(s.addColumn(o,this.getColumnViewData(o.uuid)),n.focusOnCreated&&this.focusColumn(r,o.uuid),o.uuid):void 0}else{const r=this.getColumn(i);return r?(this.focusColumn(t,r.uuid),r.uuid):void 0}},updateColumnAndShape(t,e){if(this.updateColumn(t,e),Lt().isCanvasVersionV2AndUp){const n=this.getTableUuidOfColumn(t),i=pn().tableShapes[n];if(!i)return;const r=this.getColumn(t);if(!r)return;if(i.updateColumn(r,this.getColumnViewData(t),e),e.name){const s=Ow().getColumnIndexesForColumn(t),o=d6(s,"index_uuid");Tn(o,a=>{is().redrawIndexShape(a)})}}},deleteColumnAndShape(t){if(this.deleteColumn(t),Lt().isCanvasVersionV2AndUp){const e=this.getTableUuidOfColumn(t),n=pn().tableShapes[e];if(!n)return;n.deleteColumn(t)}},updateOrderOfColumnsInTableAndShape(t){const e=this.getTableUuidOfColumn(t[0]);let n=null;if(!(Lt().isCanvasVersionV2AndUp&&(n=pn().tableShapes[e],!n))&&(Tn(t,(i,r)=>{const s=r+1;this.updateColumn(i,{order:s})}),pn().updateTableAndShape(e,{columns:t}),Lt().isCanvasVersionV2AndUp)){Lt().paper.freeze();try{n.reorderColumns(t)}catch(i){console.error(i)}finally{Lt().paper.unfreeze()}}},addColumn(t){jt.dispatch("addColumnToTable",{uuid:t.uuid,tableUuid:t.table_uuid})},updateColumn(t,e){const n=jt.state.columns[t];n&&Tn(e,(i,r)=>{jt.dispatch("updateColumn",{targetColumn:n,prop:r,value:i})})},deleteColumn(t){const e=jt.state.columns[t];e&&jt.dispatch("deleteColumn",e)},SET_COLUMNS_IN_TABLE_SHAPES(t){Tn(xc(t,"order"),e=>{const n=jt.getters.getTableUuidOfColumn(e.uuid),i=pn().tableShapes[n];i&&i.addColumn(e,this.getColumnViewData(e.uuid))})},focusColumn(t,e){Lt().isCanvasVersionV2AndUp?this.$emitter.emit("focus-column-v2",{tableUuid:t,columnUuid:e}):this.$emitter.emit("focus-column",{tableUuid:t,columnUuid:e})}}}),f6={MYSQL:"mysql",PGSQL:"pgsql",SQLSRV:"sqlsrv"},pn=Mr("tables",{state:()=>({tableShapes:kn({})}),getters:{getTableShape:t=>e=>Lt().graph.getCell(e),getTable:t=>e=>jt.state.tables[e]},actions:{addTableAndShape(t){if(this.addTable(t),Lt().isCanvasVersionV2AndUp){const e=Lt().paperScroller.getVisibleArea(),n=10,i=50;this.updateTable(t,{left:e.x+n/Lt().paper.scale().sx,top:e.y+i/Lt().paper.scale().sy});const r=this.getTable(t);this.ADD_TABLE_SHAPE(r);const s=Er().addColumnAndShape(t,{name:"id",is_primary_key:!0},{focusOnCreated:!1}),o=Er().getColumn(s),a=Pw().getDriverDataType(o.driver_data_type_id);a.driver===f6.MYSQL&&["int","bigint"].includes(a.name)&&Er().updateColumn(s,{is_auto_increment:!0,is_unsigned:!0}),Lt().expandTable(t),Lt().enterEditingNameModeForTable(t)}},updateTableAndShape(t,e){if(this.updateTable(t,e),Lt().isCanvasVersionV2AndUp){const n=this.getTableShape(t);if(!n)return;"name"in e&&n.setName(e.name),"color"in e&&n.setColor(e.color),"comment"in e&&n.setComment(e.comment)}},deleteTableAndShape(t){if(this.deleteTable(t),Lt().isCanvasVersionV2AndUp){const e=this.getTableShape(t);if(!e)return;e.remove(),Lt().selectedTableUuid===t&&(Lt().selectedTableUuid=null),zm().multiselectedTableUuids.includes(t)&&zm().removeMultiselectedTableModel(t)}},deleteTablesAndShapes(t){Lt().paper.freeze();try{t.forEach(e=>{this.deleteTableAndShape(e)})}catch(e){console.error(e)}finally{Lt().paper.unfreeze()}},duplicateTableAndShape(t){const e=this.duplicateTable(t),n=this.getTable(e);return Lt().isCanvasVersionV2AndUp&&(this.ADD_TABLE_SHAPE(n,{includeChildrenShapes:!0}),Lt().selectTable(e)),e},addTable(t){jt.dispatch("addTable",t)},updateTable(t,e){const n=jt.state.tables[t];n&&Tn(e,(i,r)=>{jt.dispatch("updateTable",{targetTable:n,prop:r,value:i})})},deleteTable(t){const e=jt.state.tables[t];e&&jt.dispatch("deleteTable",e)},deleteTables(t){t.forEach(e=>{this.deleteTable(e)})},duplicateTable(t){const e=jt.state.tables[t];if(!e)return;const n=ki(),i={[t]:n};return jt.dispatch("duplicateTable",{originTable:e,uuidMappings:i}),n},ADD_TABLE_SHAPE(t,e={addToGraph:!0,includeChildrenShapes:!1}){e={addToGraph:!0,includeChildrenShapes:!1,...e};const n=new ql({id:t.uuid,uuid:t.uuid});return n.setName(t.name).setColor(t.color).setComment(t.comment).position(t.left,t.top),t.width&&n.size(t.width),this.tableShapes[t.uuid]=kn(n),e.includeChildrenShapes&&(Tn(t.columns,i=>{const r=Er().getColumn(i);n.addColumn(r,Er().getColumnViewData(r.uuid))}),Tn(t.indexes,i=>{const r=jt.getters["indexes/getIndex"](i);n.addIndex(r,is().getIndexViewData(r.uuid))})),e.addToGraph&&this.ADD_TO_GRAPH(n),n},SET_TABLE_SHAPES(t,e={addToGraph:!0}){e={addToGraph:!0,...e};const n=Eb(t,i=>{const r=new ql({id:i.uuid,uuid:i.uuid});return r.setName(i.name).setColor(i.color).setComment(i.comment).position(i.left,i.top),i.width&&r.size(i.width),r});return this.tableShapes=kn(n),e.addToGraph&&this.ADD_TO_GRAPH(n),n},ADD_TO_GRAPH(t){return t instanceof ql?(Lt().graph.addCell(t),!0):(Lt().graph.addCells(Object.values(t)),!0)}}}),p6={isPanMode:!1,isMultiselectMode:!1,multiselectedTables:[],selectedTable:null,expandedTable:null,hoveredTable:null,isHoverEventsDisabled:!1,editingNameForTable:null,hoveredRow:null,selectedRelationship:null},g6={isInPanMode:t=>t.isPanMode,isInMultiselectMode:t=>t.isMultiselectMode,isInMultiselectReady:(t,e)=>e.isInMultiselectMode&&!e.hasMultiselectedTable,isInMultiselectDone:(t,e)=>e.isInMultiselectMode&&e.hasMultiselectedTable,getMultiselectedTableUuids:t=>t.multiselectedTables,hasMultiselectedTable:t=>!_.isEmpty(t.multiselectedTables),isTableMultiselected:(t,e)=>n=>e.isInMultiselectMode?e.getMultiselectedTableUuids.includes(n):!1,getSelectedTableUuid:t=>t.selectedTable,hasSelectedTable:t=>!!t.selectedTable,isTableSelected:(t,e)=>n=>e.getSelectedTableUuid===n,getExpandedTableUuid:t=>t.expandedTable,isTableExpanded:(t,e)=>n=>e.getExpandedTableUuid===n,getHoveredTableUuid:t=>t.hoveredTable,isTableHovered:(t,e)=>n=>e.getHoveredTableUuid===n,getEditingNameForTableUuid:t=>t.editingNameForTable,isEditingNameForTable:(t,e)=>n=>e.getEditingNameForTableUuid===n,getHoveredRowUuid:t=>t.hoveredRow,isRowHovered:(t,e)=>n=>e.getHoveredRowUuid===n,getSelectedRelationshipUuid:t=>t.selectedRelationship,isRelationshipSelected:(t,e)=>n=>e.getSelectedRelationshipUuid===n},m6={reset({dispatch:t},e=!0){t("unsetSelectedTable"),t("unsetHoveredTable"),t("exitTableNameEditModeForTable"),t("unsetSelectedRelationship"),e&&t("unsetHoveredRow")},resetMode({dispatch:t}){t("deactivatePanMode"),t("deactivateMultiselectMode")},activatePanMode({commit:t,dispatch:e}){e("deactivateMultiselectMode"),t("ACTIVATE_PAN_MODE")},deactivatePanMode({commit:t}){t("DEACTIVATE_PAN_MODE")},activateMultiselectMode({commit:t,dispatch:e}){e("deactivatePanMode"),t("ACTIVATE_MULTISELECT_MODE")},deactivateMultiselectMode({commit:t,dispatch:e}){e("unsetMultiselectedTables"),t("DEACTIVATE_MULTISELECT_MODE")},setMultiselectedTables({commit:t},e){t("SET_MULTISELECTED_TABLES",e)},unsetMultiselectedTables({commit:t}){t("SET_MULTISELECTED_TABLES",[])},setSelectedTable({commit:t},e){Lt().setSelectedTableUuid(e),t("SET_SELECTED_TABLE",e)},unsetSelectedTable({commit:t,getters:e},n=null){n&&!e.isTableSelected(n)||(Lt().unsetSelectedTableUuid(),t("SET_SELECTED_TABLE",null))},expandTable({commit:t},e){t("SET_EXPANDED_TABLE",e)},collapseTable({commit:t},e){t("REMOVE_EXPANDED_TABLE",e)},toggleTableExpansion({dispatch:t,getters:e},n){e.isTableExpanded(n)?t("collapseTable",n):t("expandTable",n)},enableHoverEvents({commit:t}){t("SET_IS_HOVERED_EVENTS_DISABLED",!1)},disableHoverEvents({commit:t}){t("SET_IS_HOVERED_EVENTS_DISABLED",!0)},setHoveredTable({commit:t,getters:e,state:n},i){n.isHoverEventsDisabled||e.isTableHovered(i)||t("SET_HOVERED_TABLE",i)},unsetHoveredTable({commit:t,getters:e},n=null){n&&!e.isTableHovered(n)||t("SET_HOVERED_TABLE",null)},enterTableNameEditModeForTable({commit:t,dispatch:e},n){t("SET_EDITING_NAME_FOR_TABLE",n),e("setSelectedTable",n)},exitTableNameEditModeForTable({commit:t,getters:e},n){n&&!e.isEditingNameForTable(n)||t("SET_EDITING_NAME_FOR_TABLE",null)},setHoveredRow({commit:t,getters:e,state:n},i){n.isHoverEventsDisabled||e.isRowHovered(i)||t("SET_HOVERED_ROW",i)},unsetHoveredRow({commit:t,getters:e},n=null){n&&!e.isRowHovered(n)||t("SET_HOVERED_ROW",null)},setSelectedRelationship({commit:t},e){t("SET_SELECTED_RELATIONSHIP",e)},unsetSelectedRelationship({commit:t,getters:e},n=null){n&&!e.isRelationshipSelected(n)||t("SET_SELECTED_RELATIONSHIP",null)}},v6={ACTIVATE_PAN_MODE(t){t.isPanMode=!0},DEACTIVATE_PAN_MODE(t){t.isPanMode=!1},ACTIVATE_MULTISELECT_MODE(t){t.isMultiselectMode=!0},DEACTIVATE_MULTISELECT_MODE(t){t.isMultiselectMode=!1},SET_MULTISELECTED_TABLES(t,e){t.multiselectedTables=e},SET_SELECTED_TABLE(t,e){t.selectedTable=e},SET_EXPANDED_TABLE(t,e){t.expandedTable=e},REMOVE_EXPANDED_TABLE(t,e){t.expandedTable=null},SET_IS_HOVERED_EVENTS_DISABLED(t,e){t.isHoverEventsDisabled=e},SET_HOVERED_TABLE(t,e){t.hoveredTable=e},SET_EDITING_NAME_FOR_TABLE(t,e){t.editingNameForTable=e},SET_HOVERED_ROW(t,e){t.hoveredRow=e},SET_SELECTED_RELATIONSHIP(t,e){t.selectedRelationship=e}},y6={namespaced:!0,state:p6,getters:g6,actions:m6,mutations:v6},b6={canManageDiagram:!1,canUpdateDiagram:!1,canViewAccessSettingsDiagram:!1,teamAdminsCount:null},x6={canManageDiagram:t=>t.canManageDiagram,canViewAccessSettingsDiagram:t=>t.canViewAccessSettingsDiagram,teamAdminsCount:t=>t.teamAdminsCount},w6={setDiagramAccess({commit:t},e){t("SET_DIAGRAM_ACCESS",e)}},_6={SET_DIAGRAM_ACCESS(t,{canManageDiagram:e,canUpdateDiagram:n,canViewAccessSettingsDiagram:i,teamAdminsCount:r}){t.canManageDiagram=e,t.canUpdateDiagram=n,t.canViewAccessSettingsDiagram=i,t.teamAdminsCount=r}},S6={namespaced:!0,state:b6,getters:x6,actions:w6,mutations:_6},E6={tableColors:[]},T6={tableColors:t=>t.tableColors,nextTableColor:(t,e,n,i)=>i["diagram/getDiagram"].default_table_color?i["diagram/getDiagram"].default_table_color:t.tableColors[i.tables.length%t.tableColors.length]},A6={setTableColors({commit:t},e){t("SET_TABLE_COLORS",e)}},C6={SET_TABLE_COLORS(t,e){t.tableColors=e}},P6={namespaced:!0,state:E6,getters:T6,actions:A6,mutations:C6},I6={diagram:null},O6={getDiagram:t=>t.diagram},k6={setDiagram({commit:t},e){t("SET_DIAGRAM",e)},updateDiagram({commit:t,dispatch:e},{prop:n,value:i}){t("UPDATE_DIAGRAM",{prop:n,value:i})}},L6={SET_DIAGRAM(t,e){t.diagram=e},UPDATE_DIAGRAM(t,{prop:e,value:n}){Object.assign(t.diagram,{[e]:n})}},M6={namespaced:!0,state:I6,getters:O6,actions:k6,mutations:L6},D6={team:null},N6={getTeam:t=>t.team},R6={setTeam({commit:t},e){t("SET_TEAM",e)}},$6={SET_TEAM(t,e){t.team=e}},B6={namespaced:!0,state:D6,getters:N6,actions:R6,mutations:$6};var F6=Ao,V6=bo,z6=xo;function U6(t){return function(e,n,i){var r=Object(e);if(!V6(e)){var s=F6(n);e=z6(e),n=function(a){return s(r[a],a,r)}}var o=t(e,n,i);return o>-1?r[s?e[o]:o]:void 0}}var H6=U6;function G6(t,e,n,i){for(var r=t.length,s=n+(i?1:-1);i?s--:++s<r;)if(e(t[s],s,t))return s;return-1}var j6=G6,W6=/\s/;function Y6(t){for(var e=t.length;e--&&W6.test(t.charAt(e)););return e}var X6=Y6,q6=X6,K6=/^\s+/;function Z6(t){return t&&t.slice(0,q6(t)+1).replace(K6,"")}var J6=Z6,Q6=J6,Gm=ds,t8=Ra,jm=0/0,e8=/^[-+]0x[0-9a-f]+$/i,n8=/^0b[01]+$/i,i8=/^0o[0-7]+$/i,r8=parseInt;function s8(t){if(typeof t=="number")return t;if(t8(t))return jm;if(Gm(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Gm(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Q6(t);var n=n8.test(t);return n||i8.test(t)?r8(t.slice(2),n?2:8):e8.test(t)?jm:+t}var o8=s8,a8=o8,Wm=1/0,l8=17976931348623157e292;function c8(t){if(!t)return t===0?t:0;if(t=a8(t),t===Wm||t===-Wm){var e=t<0?-1:1;return e*l8}return t===t?t:0}var u8=c8,h8=u8;function d8(t){var e=h8(t),n=e%1;return e===e?n?e-n:e:0}var f8=d8,p8=j6,g8=Ao,m8=f8,v8=Math.max;function y8(t,e,n){var i=t==null?0:t.length;if(!i)return-1;var r=n==null?0:m8(n);return r<0&&(r=v8(i+r,0)),p8(t,g8(e),r)}var b8=y8,x8=H6,w8=b8,_8=x8(w8),S8=_8;const E8=xi(S8),T8=new yo.Entity("driverDataTypes"),A8={driverDataTypes:{}},C8={getDriverDataTypes:t=>t.driverDataTypes,getDriverDataType:t=>e=>t.driverDataTypes[e],getDriverDataTypeByName:t=>e=>E8(t.driverDataTypes,n=>n.name.toLowerCase()===e.toLowerCase())},P8={setDriverDataTypes({commit:t},e){const n=eC(e,[T8]),i=_.has(n.entities,"driverDataTypes")?n.entities.driverDataTypes:{};t("SET_DRIVER_DATA_TYPES",i)}},I8={SET_DRIVER_DATA_TYPES(t,e){t.driverDataTypes=e}},O8={namespaced:!0,state:A8,getters:C8,actions:P8,mutations:I8};var k8=Jd,L8=rf,M8=Object.prototype,D8=M8.hasOwnProperty;function N8(t,e,n){var i=t[e];(!(D8.call(t,e)&&L8(i,n))||n===void 0&&!(e in t))&&k8(t,e,n)}var kw=N8,R8=kw,$8=Jd;function B8(t,e,n,i){var r=!n;n||(n={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=i?i(n[a],t[a],a,n,t):void 0;l===void 0&&(l=t[a]),r?$8(n,a,l):R8(n,a,l)}return n}var vu=B8,F8=vu,V8=xo;function z8(t,e){return t&&F8(e,V8(e),t)}var U8=z8;function H8(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var G8=H8,j8=ds,W8=zc,Y8=G8,X8=Object.prototype,q8=X8.hasOwnProperty;function K8(t){if(!j8(t))return Y8(t);var e=W8(t),n=[];for(var i in t)i=="constructor"&&(e||!q8.call(t,i))||n.push(i);return n}var Z8=K8,J8=rb,Q8=Z8,tU=bo;function eU(t){return tU(t)?J8(t,!0):Q8(t)}var lp=eU,nU=vu,iU=lp;function rU(t,e){return t&&nU(e,iU(e),t)}var sU=rU,wc={exports:{}};wc.exports;(function(t,e){var n=Ri,i=e&&!e.nodeType&&e,r=i&&!0&&t&&!t.nodeType&&t,s=r&&r.exports===i,o=s?n.Buffer:void 0,a=o?o.allocUnsafe:void 0;function l(c,h){if(h)return c.slice();var u=c.length,d=a?a(u):new c.constructor(u);return c.copy(d),d}t.exports=l})(wc,wc.exports);var oU=wc.exports;function aU(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}var lU=aU,cU=vu,uU=lf;function hU(t,e){return cU(t,uU(t),e)}var dU=hU,fU=sb,pU=fU(Object.getPrototypeOf,Object),Lw=pU,gU=ub,mU=Lw,vU=lf,yU=fb,bU=Object.getOwnPropertySymbols,xU=bU?function(t){for(var e=[];t;)gU(e,vU(t)),t=mU(t);return e}:yU,Mw=xU,wU=vu,_U=Mw;function SU(t,e){return wU(t,_U(t),e)}var EU=SU,TU=hb,AU=Mw,CU=lp;function PU(t){return TU(t,CU,AU)}var IU=PU,OU=Object.prototype,kU=OU.hasOwnProperty;function LU(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&kU.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var MU=LU,Ym=cb;function DU(t){var e=new t.constructor(t.byteLength);return new Ym(e).set(new Ym(t)),e}var cp=DU,NU=cp;function RU(t,e){var n=e?NU(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var $U=RU,BU=/\w*$/;function FU(t){var e=new t.constructor(t.source,BU.exec(t));return e.lastIndex=t.lastIndex,e}var VU=FU,Xm=Ma,qm=Xm?Xm.prototype:void 0,Km=qm?qm.valueOf:void 0;function zU(t){return Km?Object(Km.call(t)):{}}var UU=zU,HU=cp;function GU(t,e){var n=e?HU(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var jU=GU,WU=cp,YU=$U,XU=VU,qU=UU,KU=jU,ZU="[object Boolean]",JU="[object Date]",QU="[object Map]",tH="[object Number]",eH="[object RegExp]",nH="[object Set]",iH="[object String]",rH="[object Symbol]",sH="[object ArrayBuffer]",oH="[object DataView]",aH="[object Float32Array]",lH="[object Float64Array]",cH="[object Int8Array]",uH="[object Int16Array]",hH="[object Int32Array]",dH="[object Uint8Array]",fH="[object Uint8ClampedArray]",pH="[object Uint16Array]",gH="[object Uint32Array]";function mH(t,e,n){var i=t.constructor;switch(e){case sH:return WU(t);case ZU:case JU:return new i(+t);case oH:return YU(t,n);case aH:case lH:case cH:case uH:case hH:case dH:case fH:case pH:case gH:return KU(t,n);case QU:return new i;case tH:case iH:return new i(t);case eH:return XU(t);case nH:return new i;case rH:return qU(t)}}var vH=mH,yH=ds,Zm=Object.create,bH=function(){function t(){}return function(e){if(!yH(e))return{};if(Zm)return Zm(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),xH=bH,wH=xH,_H=Lw,SH=zc;function EH(t){return typeof t.constructor=="function"&&!SH(t)?wH(_H(t)):{}}var TH=EH,AH=Na,CH=ps,PH="[object Map]";function IH(t){return CH(t)&&AH(t)==PH}var OH=IH,kH=OH,LH=Vc,Jm=ef,Qm=Jm&&Jm.isMap,MH=Qm?LH(Qm):kH,DH=MH,NH=Na,RH=ps,$H="[object Set]";function BH(t){return RH(t)&&NH(t)==$H}var FH=BH,VH=FH,zH=Vc,tv=ef,ev=tv&&tv.isSet,UH=ev?zH(ev):VH,HH=UH,GH=af,jH=Aw,WH=kw,YH=U8,XH=sU,qH=oU,KH=lU,ZH=dU,JH=EU,QH=pb,tG=IU,eG=Na,nG=MU,iG=vH,rG=TH,sG=Rn,oG=Fc,aG=DH,lG=ds,cG=HH,uG=xo,hG=lp,dG=1,fG=2,pG=4,Dw="[object Arguments]",gG="[object Array]",mG="[object Boolean]",vG="[object Date]",yG="[object Error]",Nw="[object Function]",bG="[object GeneratorFunction]",xG="[object Map]",wG="[object Number]",Rw="[object Object]",_G="[object RegExp]",SG="[object Set]",EG="[object String]",TG="[object Symbol]",AG="[object WeakMap]",CG="[object ArrayBuffer]",PG="[object DataView]",IG="[object Float32Array]",OG="[object Float64Array]",kG="[object Int8Array]",LG="[object Int16Array]",MG="[object Int32Array]",DG="[object Uint8Array]",NG="[object Uint8ClampedArray]",RG="[object Uint16Array]",$G="[object Uint32Array]",Pe={};Pe[Dw]=Pe[gG]=Pe[CG]=Pe[PG]=Pe[mG]=Pe[vG]=Pe[IG]=Pe[OG]=Pe[kG]=Pe[LG]=Pe[MG]=Pe[xG]=Pe[wG]=Pe[Rw]=Pe[_G]=Pe[SG]=Pe[EG]=Pe[TG]=Pe[DG]=Pe[NG]=Pe[RG]=Pe[$G]=!0;Pe[yG]=Pe[Nw]=Pe[AG]=!1;function Kl(t,e,n,i,r,s){var o,a=e&dG,l=e&fG,c=e&pG;if(n&&(o=r?n(t,i,r,s):n(t)),o!==void 0)return o;if(!lG(t))return t;var h=sG(t);if(h){if(o=nG(t),!a)return KH(t,o)}else{var u=eG(t),d=u==Nw||u==bG;if(oG(t))return qH(t,a);if(u==Rw||u==Dw||d&&!r){if(o=l||d?{}:rG(t),!a)return l?JH(t,XH(o,t)):ZH(t,YH(o,t))}else{if(!Pe[u])return r?t:{};o=iG(t,u,a)}}s||(s=new GH);var f=s.get(t);if(f)return f;s.set(t,o),cG(t)?t.forEach(function(v){o.add(Kl(v,e,n,v,t,s))}):aG(t)&&t.forEach(function(v,x){o.set(x,Kl(v,e,n,x,t,s))});var p=c?l?tG:QH:l?hG:uG,g=h?void 0:p(t);return jH(g||t,function(v,x){g&&(x=v,v=t[x]),WH(o,x,Kl(v,e,n,x,t,s))}),o}var BG=Kl,FG=BG,VG=1,zG=4;function UG(t,e){return e=typeof e=="function"?e:void 0,FG(t,VG|zG,e)}var HG=UG;const GG=xi(HG);function _c(t,e={},n=[]){return GG(t,i=>{if(HS(i)&&!n.includes(i)){let r=e[i];return r||(r=ki(),e[i]=r),r}})}function XY(t,e){return t.includes(e)||t.includes("*")||e.endsWith(":create")&&t.includes("*:create")||e.endsWith(":update")&&t.includes("*:update")||e.endsWith(":admin")&&t.includes("*:admin")}function jG(){return navigator.userAgent.indexOf("Win")!==-1?"os-windows":navigator.userAgent.indexOf("Mac")!==-1?"os-mac":navigator.userAgent.indexOf("X11")!==-1?"os-unix":navigator.userAgent.indexOf("Linux")!==-1?"os-linux":"os-windows"}function qY(t,e){const n=jG();return n in t?t[n]:e}class KY{constructor({autoStart:e=!1}={}){this.autoStart=e,this._queue=[],this._running=!1,this._results=[],this._resolves=[],this._rejects=[],this._runId=0}get length(){return this._queue.length}addJob(e){this._queue.push(()=>{try{const n=this._runId,i=e(()=>{n===this._runId&&(this._results.push(i),this._next())})}catch(n){this._reject(n)}}),this.autoStart&&this.length===1&&this.start()}clear(){this._running=!1,this._queue.length=0,this._resolves.length=0,this._rejects.length=0,this._results.length=0,this._runId++}cancel(){this._resolve(),this.clear()}start(){return new Promise((e,n)=>{!this._running&&this.length>0?(this._running=!0,this._queue[0](),this._resolves.push(e),this._rejects.push(n)):e()})}_next(){this._running&&this.length>0&&(this._queue.shift(),this.length===0?this._resolve():this._queue[0]())}_resolve(){this._resolves.forEach(e=>e(this._results)),this.clear()}_reject(e){this._rejects.forEach(n=>n(e)),this.clear()}}const WG={indexes:{}},YG={getIndexes:t=>t.indexes,getIndex:t=>e=>t.indexes[e],getColumnNamesForIndex:(t,e,n,i)=>r=>{const s=i["columnIndexes/getColumnIndexesForIndex"](r);return _.map(s,o=>i.column(o.column_uuid).name)},getTableUuidOfIndex:(t,e)=>n=>e.getIndex(n).table_uuid},XG={markTableDirtyViaIndex({dispatch:t,getters:e},n){t("markTableDirty",e.getTableUuidOfIndex(n),{root:!0})},setIndexes({commit:t},e){t("SET_INDEXES",e)},createIndex({commit:t,dispatch:e},{uuid:n,tableUuid:i,order:r}){const s=n||ki(),o={uuid:s,name:s,order:r,type:Xl.INDEX,column_indexes:[],table_uuid:i};t("CREATE_INDEX",o),e("markTableDirtyViaIndex",o.uuid)},updateIndex({commit:t,dispatch:e,getters:n},{targetIndex:i,prop:r,value:s}){t("UPDATE_INDEX",{targetIndex:i,prop:r,value:s}),e("markTableDirtyViaIndex",i.uuid)},deleteIndex({commit:t,dispatch:e,getters:n},i){const r=n.getIndex(i);e("columnIndexes/deleteColumnIndexesForIndex",i,{root:!0}),e("removeIndexFromTable",{uuid:r.uuid,tableUuid:r.table_uuid},{root:!0}),e("markTableDirtyViaIndex",i),t("DELETE_INDEX",i)},duplicateIndex({commit:t,dispatch:e,getters:n,state:i,rootGetters:r},{originIndex:s,uuidMappings:o={},updateOrder:a=!0}){const l=[s.schema_uuid],c=_c(s,o,l);a&&(c.order=s.order+1),t("CREATE_INDEX",c),t("ADD_INDEX_TO_TABLE",{tableUuid:c.table_uuid,indexUuid:c.uuid},{root:!0}),e("columnIndexes/duplicateColumnIndexesForIndex",{originalIndexUuid:s.uuid,uuidMappings:o},{root:!0}),e("markTableDirtyViaIndex",c.uuid)},addColumnIndexToIndex({commit:t,dispatch:e},{columnIndexUuid:n,indexUuid:i}){t("ADD_COLUMN_INDEX_TO_INDEX",{columnIndexUuid:n,indexUuid:i}),e("markTableDirtyViaIndex",i)},removeColumnIndexFromIndex({commit:t,dispatch:e},{columnIndexUuid:n,indexUuid:i}){t("REMOVE_COLUMN_INDEX_FROM_INDEX",{columnIndexUuid:n,indexUuid:i}),e("markTableDirtyViaIndex",i)}},qG={SET_INDEXES(t,e){t.indexes=e,Lt().isCanvasVersionV2AndUp&&is().SET_INDEXES_IN_TABLE_SHAPES(e)},CREATE_INDEX(t,e){t.indexes[e.uuid]=e},UPDATE_INDEX(t,{targetIndex:e,prop:n,value:i}){Object.assign(e,{[n]:i})},DELETE_INDEX(t,e){delete t.indexes[e]},ADD_COLUMN_INDEX_TO_INDEX(t,{columnIndexUuid:e,indexUuid:n}){t.indexes[n].column_indexes.includes(e)&&t.indexes[n].column_indexes.splice(_.indexOf(t.indexes[n].column_indexes,e),1),t.indexes[n].column_indexes.push(e)},REMOVE_COLUMN_INDEX_FROM_INDEX(t,{columnIndexUuid:e,indexUuid:n}){t.indexes[n].column_indexes.splice(_.indexOf(t.indexes[n].column_indexes,e),1)}},KG={namespaced:!0,state:WG,getters:YG,actions:XG,mutations:qG},ZG={columnIndexes:{}},JG={getColumnIndexes:t=>t.columnIndexes,getColumnIndex:t=>e=>t.columnIndexes[e],getColumnIndexesForIndex:t=>e=>xc(_.filter(t.columnIndexes,{index_uuid:e}),"order"),getColumnIndexesForColumn:t=>e=>_.filter(t.columnIndexes,{column_uuid:e})},QG={setColumnIndexes({commit:t},e){t("SET_COLUMN_INDEXES",e)},syncColumnIndexesForIndex({commit:t,dispatch:e,getters:n},{indexUuid:i,columnUuids:r}){const s=_.filter(n.getColumnIndexesForIndex(i),a=>!_.includes(r,a.column_uuid));e("deleteColumnIndexes",_.map(s,"uuid"));const o=n.getColumnIndexesForIndex(i);_.forEach(r,(a,l)=>{const c=_.find(o,{column_uuid:a});c===void 0?e("createColumnIndex",{indexUuid:i,columnUuid:a,order:l}):t("UPDATE_COLUMN_INDEX",{targetColumnIndexUuid:c.uuid,newProps:{order:l}})}),e("indexes/markTableDirtyViaIndex",i,{root:!0})},createColumnIndex({commit:t,dispatch:e,getters:n},{indexUuid:i,columnUuid:r,order:s}){const o=ki();t("CREATE_COLUMN_INDEX",{uuid:o,indexUuid:i,columnUuid:r,order:s}),e("indexes/addColumnIndexToIndex",{columnIndexUuid:o,indexUuid:i},{root:!0})},deleteColumnIndexes({commit:t,dispatch:e,getters:n},i){_.forEach(i,r=>{const s=n.getColumnIndex(r);e("indexes/removeColumnIndexFromIndex",{columnIndexUuid:r,indexUuid:s.index_uuid},{root:!0})}),t("DELETE_COLUMN_INDEXES",i)},deleteColumnIndexesForIndex({commit:t,dispatch:e,getters:n},i){const r=n.getColumnIndexesForIndex(i);e("deleteColumnIndexes",_.map(r,"uuid"))},duplicateColumnIndexesForIndex({commit:t,dispatch:e,getters:n,state:i,rootGetters:r},{originalIndexUuid:s,uuidMappings:o={}}){const a=n.getColumnIndexesForIndex(s);Tn(a,l=>{const c=[l.schema_uuid],h=_c(l,o,c);t("CREATE_COLUMN_INDEX",{uuid:h.uuid,indexUuid:h.index_uuid,columnUuid:h.column_uuid,order:h.order}),e("indexes/addColumnIndexToIndex",{columnIndexUuid:h.uuid,indexUuid:h.index_uuid},{root:!0})})}},t7={SET_COLUMN_INDEXES(t,e){t.columnIndexes=e},CREATE_COLUMN_INDEX(t,{uuid:e,indexUuid:n,columnUuid:i,order:r}){const s={id:null,uuid:e||ki(),order:r,index_id:null,index_uuid:n,column_id:null,column_uuid:i};t.columnIndexes[s.uuid]=s},UPDATE_COLUMN_INDEX(t,{targetColumnIndexUuid:e,newProps:n}){t.columnIndexes[e]=Object.assign(t.columnIndexes[e],n)},DELETE_COLUMN_INDEXES(t,e){_.forEach(e,n=>{delete t.columnIndexes[n]})}},e7={namespaced:!0,state:ZG,getters:JG,actions:QG,mutations:t7},$w=new yo.Entity("columns",{},{idAttribute:"uuid",processStrategy:(t,e,n)=>Object.assign(t,{deletedAt:null,table_uuid:e.uuid})}),up=new yo.Entity("indexes",{},{idAttribute:"uuid",processStrategy:(t,e,n)=>Object.assign(t,{table_uuid:e.uuid})}),Bw=new yo.Entity("columnIndexes",{},{idAttribute:"uuid"});up.define({column_indexes:[Bw]});Bw.define({columns:[$w],indexes:[up]});const n7=new yo.Entity("tables",{columns:[$w],indexes:[up]},{idAttribute:"uuid",processStrategy:(t,e,n)=>Object.assign(t,{isDirty:!1,deletedAt:null,columns:_.orderBy(t.columns,"order")})});new yo.Entity("relationships",{},{idAttribute:"uuid",processStrategy:(t,e,n)=>Object.assign(t,{isDirty:!1,deletedAt:null})});/*!
 * vuex v4.1.0
 * (c) 2022 Evan You
 * @license MIT
 */var Fw="store";function ZY(t){return t===void 0&&(t=null),Wv(t!==null?t:Fw)}function ko(t,e){Object.keys(t).forEach(function(n){return e(t[n],n)})}function Vw(t){return t!==null&&typeof t=="object"}function i7(t){return t&&typeof t.then=="function"}function r7(t,e){return function(){return t(e)}}function zw(t,e,n){return e.indexOf(t)<0&&(n&&n.prepend?e.unshift(t):e.push(t)),function(){var i=e.indexOf(t);i>-1&&e.splice(i,1)}}function Uw(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var n=t.state;yu(t,n,[],t._modules.root,!0),hp(t,n,e)}function hp(t,e,n){var i=t._state,r=t._scope;t.getters={},t._makeLocalGettersCache=Object.create(null);var s=t._wrappedGetters,o={},a={},l=Td(!0);l.run(function(){ko(s,function(c,h){o[h]=r7(c,t),a[h]=qv(function(){return o[h]()}),Object.defineProperty(t.getters,h,{get:function(){return a[h].value},enumerable:!0})})}),t._state=Yv({data:e}),t._scope=l,t.strict&&c7(t),i&&n&&t._withCommit(function(){i.data=null}),r&&r.stop()}function yu(t,e,n,i,r){var s=!n.length,o=t._modules.getNamespace(n);if(i.namespaced&&(t._modulesNamespaceMap[o],t._modulesNamespaceMap[o]=i),!s&&!r){var a=dp(e,n.slice(0,-1)),l=n[n.length-1];t._withCommit(function(){a[l]=i.state})}var c=i.context=s7(t,o,n);i.forEachMutation(function(h,u){var d=o+u;o7(t,d,h,c)}),i.forEachAction(function(h,u){var d=h.root?u:o+u,f=h.handler||h;a7(t,d,f,c)}),i.forEachGetter(function(h,u){var d=o+u;l7(t,d,h,c)}),i.forEachChild(function(h,u){yu(t,e,n.concat(u),h,r)})}function s7(t,e,n){var i=e==="",r={dispatch:i?t.dispatch:function(s,o,a){var l=Sc(s,o,a),c=l.payload,h=l.options,u=l.type;return(!h||!h.root)&&(u=e+u),t.dispatch(u,c)},commit:i?t.commit:function(s,o,a){var l=Sc(s,o,a),c=l.payload,h=l.options,u=l.type;(!h||!h.root)&&(u=e+u),t.commit(u,c,h)}};return Object.defineProperties(r,{getters:{get:i?function(){return t.getters}:function(){return Hw(t,e)}},state:{get:function(){return dp(t.state,n)}}}),r}function Hw(t,e){if(!t._makeLocalGettersCache[e]){var n={},i=e.length;Object.keys(t.getters).forEach(function(r){if(r.slice(0,i)===e){var s=r.slice(i);Object.defineProperty(n,s,{get:function(){return t.getters[r]},enumerable:!0})}}),t._makeLocalGettersCache[e]=n}return t._makeLocalGettersCache[e]}function o7(t,e,n,i){var r=t._mutations[e]||(t._mutations[e]=[]);r.push(function(o){n.call(t,i.state,o)})}function a7(t,e,n,i){var r=t._actions[e]||(t._actions[e]=[]);r.push(function(o){var a=n.call(t,{dispatch:i.dispatch,commit:i.commit,getters:i.getters,state:i.state,rootGetters:t.getters,rootState:t.state},o);return i7(a)||(a=Promise.resolve(a)),t._devtoolHook?a.catch(function(l){throw t._devtoolHook.emit("vuex:error",l),l}):a})}function l7(t,e,n,i){t._wrappedGetters[e]||(t._wrappedGetters[e]=function(s){return n(i.state,i.getters,s.state,s.getters)})}function c7(t){Ad(function(){return t._state.data},function(){},{deep:!0,flush:"sync"})}function dp(t,e){return e.reduce(function(n,i){return n[i]},t)}function Sc(t,e,n){return Vw(t)&&t.type&&(n=e,e=t,t=t.type),{type:t,payload:e,options:n}}var u7="vuex bindings",nv="vuex:mutations",mh="vuex:actions",Ns="vuex",h7=0;function d7(t,e){LS({id:"org.vuejs.vuex",app:t,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[u7]},function(n){n.addTimelineLayer({id:nv,label:"Vuex Mutations",color:iv}),n.addTimelineLayer({id:mh,label:"Vuex Actions",color:iv}),n.addInspector({id:Ns,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),n.on.getInspectorTree(function(i){if(i.app===t&&i.inspectorId===Ns)if(i.filter){var r=[];Yw(r,e._modules.root,i.filter,""),i.rootNodes=r}else i.rootNodes=[Ww(e._modules.root,"")]}),n.on.getInspectorState(function(i){if(i.app===t&&i.inspectorId===Ns){var r=i.nodeId;Hw(e,r),i.state=g7(v7(e._modules,r),r==="root"?e.getters:e._makeLocalGettersCache,r)}}),n.on.editInspectorState(function(i){if(i.app===t&&i.inspectorId===Ns){var r=i.nodeId,s=i.path;r!=="root"&&(s=r.split("/").filter(Boolean).concat(s)),e._withCommit(function(){i.set(e._state.data,s,i.state.value)})}}),e.subscribe(function(i,r){var s={};i.payload&&(s.payload=i.payload),s.state=r,n.notifyComponentUpdate(),n.sendInspectorTree(Ns),n.sendInspectorState(Ns),n.addTimelineEvent({layerId:nv,event:{time:Date.now(),title:i.type,data:s}})}),e.subscribeAction({before:function(i,r){var s={};i.payload&&(s.payload=i.payload),i._id=h7++,i._time=Date.now(),s.state=r,n.addTimelineEvent({layerId:mh,event:{time:i._time,title:i.type,groupId:i._id,subtitle:"start",data:s}})},after:function(i,r){var s={},o=Date.now()-i._time;s.duration={_custom:{type:"duration",display:o+"ms",tooltip:"Action duration",value:o}},i.payload&&(s.payload=i.payload),s.state=r,n.addTimelineEvent({layerId:mh,event:{time:Date.now(),title:i.type,groupId:i._id,subtitle:"end",data:s}})}})})}var iv=8702998,f7=6710886,p7=16777215,Gw={label:"namespaced",textColor:p7,backgroundColor:f7};function jw(t){return t&&t!=="root"?t.split("/").slice(-2,-1)[0]:"Root"}function Ww(t,e){return{id:e||"root",label:jw(e),tags:t.namespaced?[Gw]:[],children:Object.keys(t._children).map(function(n){return Ww(t._children[n],e+n+"/")})}}function Yw(t,e,n,i){i.includes(n)&&t.push({id:i||"root",label:i.endsWith("/")?i.slice(0,i.length-1):i||"Root",tags:e.namespaced?[Gw]:[]}),Object.keys(e._children).forEach(function(r){Yw(t,e._children[r],n,i+r+"/")})}function g7(t,e,n){e=n==="root"?e:e[n];var i=Object.keys(e),r={state:Object.keys(t.state).map(function(o){return{key:o,editable:!0,value:t.state[o]}})};if(i.length){var s=m7(e);r.getters=Object.keys(s).map(function(o){return{key:o.endsWith("/")?jw(o):o,editable:!1,value:sd(function(){return s[o]})}})}return r}function m7(t){var e={};return Object.keys(t).forEach(function(n){var i=n.split("/");if(i.length>1){var r=e,s=i.pop();i.forEach(function(o){r[o]||(r[o]={_custom:{value:{},display:o,tooltip:"Module",abstract:!0}}),r=r[o]._custom.value}),r[s]=sd(function(){return t[n]})}else e[n]=sd(function(){return t[n]})}),e}function v7(t,e){var n=e.split("/").filter(function(i){return i});return n.reduce(function(i,r,s){var o=i[r];if(!o)throw new Error('Missing module "'+r+'" for path "'+e+'".');return s===n.length-1?o:o._children},e==="root"?t:t.root._children)}function sd(t){try{return t()}catch(e){return e}}var _i=function(e,n){this.runtime=n,this._children=Object.create(null),this._rawModule=e;var i=e.state;this.state=(typeof i=="function"?i():i)||{}},Xw={namespaced:{configurable:!0}};Xw.namespaced.get=function(){return!!this._rawModule.namespaced};_i.prototype.addChild=function(e,n){this._children[e]=n};_i.prototype.removeChild=function(e){delete this._children[e]};_i.prototype.getChild=function(e){return this._children[e]};_i.prototype.hasChild=function(e){return e in this._children};_i.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)};_i.prototype.forEachChild=function(e){ko(this._children,e)};_i.prototype.forEachGetter=function(e){this._rawModule.getters&&ko(this._rawModule.getters,e)};_i.prototype.forEachAction=function(e){this._rawModule.actions&&ko(this._rawModule.actions,e)};_i.prototype.forEachMutation=function(e){this._rawModule.mutations&&ko(this._rawModule.mutations,e)};Object.defineProperties(_i.prototype,Xw);var ws=function(e){this.register([],e,!1)};ws.prototype.get=function(e){return e.reduce(function(n,i){return n.getChild(i)},this.root)};ws.prototype.getNamespace=function(e){var n=this.root;return e.reduce(function(i,r){return n=n.getChild(r),i+(n.namespaced?r+"/":"")},"")};ws.prototype.update=function(e){qw([],this.root,e)};ws.prototype.register=function(e,n,i){var r=this;i===void 0&&(i=!0);var s=new _i(n,i);if(e.length===0)this.root=s;else{var o=this.get(e.slice(0,-1));o.addChild(e[e.length-1],s)}n.modules&&ko(n.modules,function(a,l){r.register(e.concat(l),a,i)})};ws.prototype.unregister=function(e){var n=this.get(e.slice(0,-1)),i=e[e.length-1],r=n.getChild(i);r&&r.runtime&&n.removeChild(i)};ws.prototype.isRegistered=function(e){var n=this.get(e.slice(0,-1)),i=e[e.length-1];return n?n.hasChild(i):!1};function qw(t,e,n){if(e.update(n),n.modules)for(var i in n.modules){if(!e.getChild(i))return;qw(t.concat(i),e.getChild(i),n.modules[i])}}function y7(t){return new Wn(t)}var Wn=function(e){var n=this;e===void 0&&(e={});var i=e.plugins;i===void 0&&(i=[]);var r=e.strict;r===void 0&&(r=!1);var s=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new ws(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=s;var o=this,a=this,l=a.dispatch,c=a.commit;this.dispatch=function(d,f){return l.call(o,d,f)},this.commit=function(d,f,p){return c.call(o,d,f,p)},this.strict=r;var h=this._modules.root.state;yu(this,h,[],this._modules.root),hp(this,h),i.forEach(function(u){return u(n)})},fp={state:{configurable:!0}};Wn.prototype.install=function(e,n){e.provide(n||Fw,this),e.config.globalProperties.$store=this;var i=this._devtools!==void 0?this._devtools:!1;i&&d7(e,this)};fp.state.get=function(){return this._state.data};fp.state.set=function(t){};Wn.prototype.commit=function(e,n,i){var r=this,s=Sc(e,n,i),o=s.type,a=s.payload,l={type:o,payload:a},c=this._mutations[o];c&&(this._withCommit(function(){c.forEach(function(u){u(a)})}),this._subscribers.slice().forEach(function(h){return h(l,r.state)}))};Wn.prototype.dispatch=function(e,n){var i=this,r=Sc(e,n),s=r.type,o=r.payload,a={type:s,payload:o},l=this._actions[s];if(l){try{this._actionSubscribers.slice().filter(function(h){return h.before}).forEach(function(h){return h.before(a,i.state)})}catch{}var c=l.length>1?Promise.all(l.map(function(h){return h(o)})):l[0](o);return new Promise(function(h,u){c.then(function(d){try{i._actionSubscribers.filter(function(f){return f.after}).forEach(function(f){return f.after(a,i.state)})}catch{}h(d)},function(d){try{i._actionSubscribers.filter(function(f){return f.error}).forEach(function(f){return f.error(a,i.state,d)})}catch{}u(d)})})}};Wn.prototype.subscribe=function(e,n){return zw(e,this._subscribers,n)};Wn.prototype.subscribeAction=function(e,n){var i=typeof e=="function"?{before:e}:e;return zw(i,this._actionSubscribers,n)};Wn.prototype.watch=function(e,n,i){var r=this;return Ad(function(){return e(r.state,r.getters)},n,Object.assign({},i))};Wn.prototype.replaceState=function(e){var n=this;this._withCommit(function(){n._state.data=e})};Wn.prototype.registerModule=function(e,n,i){i===void 0&&(i={}),typeof e=="string"&&(e=[e]),this._modules.register(e,n),yu(this,this.state,e,this._modules.get(e),i.preserveState),hp(this,this.state)};Wn.prototype.unregisterModule=function(e){var n=this;typeof e=="string"&&(e=[e]),this._modules.unregister(e),this._withCommit(function(){var i=dp(n.state,e.slice(0,-1));delete i[e[e.length-1]]}),Uw(this)};Wn.prototype.hasModule=function(e){return typeof e=="string"&&(e=[e]),this._modules.isRegistered(e)};Wn.prototype.hotUpdate=function(e){this._modules.update(e),Uw(this,!0)};Wn.prototype._withCommit=function(e){var n=this._committing;this._committing=!0,e(),this._committing=n};Object.defineProperties(Wn.prototype,fp);var JY=gp(function(t,e){var n={};return pp(e).forEach(function(i){var r=i.key,s=i.val;n[r]=function(){var a=this.$store.state,l=this.$store.getters;if(t){var c=mp(this.$store,"mapState",t);if(!c)return;a=c.context.state,l=c.context.getters}return typeof s=="function"?s.call(this,a,l):a[s]},n[r].vuex=!0}),n}),QY=gp(function(t,e){var n={};return pp(e).forEach(function(i){var r=i.key,s=i.val;s=t+s,n[r]=function(){if(!(t&&!mp(this.$store,"mapGetters",t)))return this.$store.getters[s]},n[r].vuex=!0}),n}),tX=gp(function(t,e){var n={};return pp(e).forEach(function(i){var r=i.key,s=i.val;n[r]=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var c=this.$store.dispatch;if(t){var h=mp(this.$store,"mapActions",t);if(!h)return;c=h.context.dispatch}return typeof s=="function"?s.apply(this,[c].concat(a)):c.apply(this.$store,[s].concat(a))}}),n});function pp(t){return b7(t)?Array.isArray(t)?t.map(function(e){return{key:e,val:e}}):Object.keys(t).map(function(e){return{key:e,val:t[e]}}):[]}function b7(t){return Array.isArray(t)||Vw(t)}function gp(t){return function(e,n){return typeof e!="string"?(n=e,e=""):e.charAt(e.length-1)!=="/"&&(e+="/"),t(e,n)}}function mp(t,e,n){var i=t._modulesNamespaceMap[n];return i}var Kw={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(Gr,function(){function n(I){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(y){return typeof y}:n=function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},n(I)}function i(I,y,T){return y in I?Object.defineProperty(I,y,{value:T,enumerable:!0,configurable:!0,writable:!0}):I[y]=T,I}function r(I){for(var y=1;y<arguments.length;y++){var T=arguments[y]!=null?arguments[y]:{},D=Object.keys(T);typeof Object.getOwnPropertySymbols=="function"&&(D=D.concat(Object.getOwnPropertySymbols(T).filter(function(V){return Object.getOwnPropertyDescriptor(T,V).enumerable}))),D.forEach(function(V){i(I,V,T[V])})}return I}var s={DEFAULT_INSTANCE:"$default_instance",API_VERSION:2,MAX_STRING_LENGTH:4096,MAX_PROPERTY_KEYS:1e3,IDENTIFY_EVENT:"$identify",GROUP_IDENTIFY_EVENT:"$groupidentify",LAST_EVENT_ID:"amplitude_lastEventId",LAST_EVENT_TIME:"amplitude_lastEventTime",LAST_IDENTIFY_ID:"amplitude_lastIdentifyId",LAST_SEQUENCE_NUMBER:"amplitude_lastSequenceNumber",SESSION_ID:"amplitude_sessionId",DEVICE_ID:"amplitude_deviceId",OPT_OUT:"amplitude_optOut",USER_ID:"amplitude_userId",COOKIE_TEST:"amplitude_cookie_test",REVENUE_EVENT:"revenue_amount",REVENUE_PRODUCT_ID:"$productId",REVENUE_QUANTITY:"$quantity",REVENUE_PRICE:"$price",REVENUE_REVENUE_TYPE:"$revenueType",AMP_DEVICE_ID_PARAM:"amp_device_id",REFERRER:"referrer",UTM_SOURCE:"utm_source",UTM_MEDIUM:"utm_medium",UTM_CAMPAIGN:"utm_campaign",UTM_TERM:"utm_term",UTM_CONTENT:"utm_content"},o={encode:function(y){for(var T="",D=0;D<y.length;D++){var V=y.charCodeAt(D);V<128?T+=String.fromCharCode(V):V>127&&V<2048?(T+=String.fromCharCode(V>>6|192),T+=String.fromCharCode(V&63|128)):(T+=String.fromCharCode(V>>12|224),T+=String.fromCharCode(V>>6&63|128),T+=String.fromCharCode(V&63|128))}return T},decode:function(y){for(var T="",D=0,V=0,G=0,tt=0;D<y.length;)V=y.charCodeAt(D),V<128?(T+=String.fromCharCode(V),D++):V>191&&V<224?(G=y.charCodeAt(D+1),T+=String.fromCharCode((V&31)<<6|G&63),D+=2):(G=y.charCodeAt(D+1),tt=y.charCodeAt(D+2),T+=String.fromCharCode((V&15)<<12|(G&63)<<6|tt&63),D+=3);return T}},a={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(y){try{if(window.btoa&&window.atob)return window.btoa(unescape(encodeURIComponent(y)))}catch{}return a._encode(y)},_encode:function(y){var T="",D,V,G,tt,it,Tt,Yt,ve=0;for(y=o.encode(y);ve<y.length;)D=y.charCodeAt(ve++),V=y.charCodeAt(ve++),G=y.charCodeAt(ve++),tt=D>>2,it=(D&3)<<4|V>>4,Tt=(V&15)<<2|G>>6,Yt=G&63,isNaN(V)?Tt=Yt=64:isNaN(G)&&(Yt=64),T=T+a._keyStr.charAt(tt)+a._keyStr.charAt(it)+a._keyStr.charAt(Tt)+a._keyStr.charAt(Yt);return T},decode:function(y){try{if(window.btoa&&window.atob)return decodeURIComponent(escape(window.atob(y)))}catch{}return a._decode(y)},_decode:function(y){var T="",D,V,G,tt,it,Tt,Yt,ve=0;for(y=y.replace(/[^A-Za-z0-9\+\/\=]/g,"");ve<y.length;)tt=a._keyStr.indexOf(y.charAt(ve++)),it=a._keyStr.indexOf(y.charAt(ve++)),Tt=a._keyStr.indexOf(y.charAt(ve++)),Yt=a._keyStr.indexOf(y.charAt(ve++)),D=tt<<2|it>>4,V=(it&15)<<4|Tt>>2,G=(Tt&3)<<6|Yt,T=T+String.fromCharCode(D),Tt!==64&&(T=T+String.fromCharCode(V)),Yt!==64&&(T=T+String.fromCharCode(G));return T=o.decode(T),T}},l=Object.prototype.toString;function c(I){switch(l.call(I)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return I===null?"null":I===void 0?"undefined":I!==I?"nan":I&&I.nodeType===1?"element":typeof Buffer<"u"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(I)?"buffer":(I=I.valueOf?I.valueOf():Object.prototype.valueOf.apply(I),n(I))}var h={DISABLE:0,ERROR:1,WARN:2,INFO:3},u=h.WARN,d=function(y){h.hasOwnProperty(y)&&(u=h[y])},f=function(){return u},p={error:function(y){u>=h.ERROR&&g(y)},warn:function(y){u>=h.WARN&&g(y)},info:function(y){u>=h.INFO&&g(y)}},g=function(y){try{console.log("[Amplitude] "+y)}catch{}},v=function(y){return!y||y.length===0},x=function(){try{if(window.sessionStorage)return!0}catch{}return!1},S=function I(y){if(c(y)==="array")for(var T=0;T<y.length;T++)y[T]=I(y[T]);else if(c(y)==="object")for(var D in y)y.hasOwnProperty(D)&&(y[D]=I(y[D]));else y=C(y);return y},C=function(y){return c(y)==="string"&&y.length>s.MAX_STRING_LENGTH?y.substring(0,s.MAX_STRING_LENGTH):y},P=function(y,T,D){return c(y)!==D?(p.error("Invalid "+T+" input type. Expected "+D+" but received "+c(y)),!1):!0},O=function(y){var T=c(y);if(T!=="object")return p.error("Error: invalid properties format. Expecting Javascript object, received "+T+", ignoring"),{};if(Object.keys(y).length>s.MAX_PROPERTY_KEYS)return p.error("Error: too many properties (more than 1000), ignoring"),{};var D={};for(var V in y)if(y.hasOwnProperty(V)){var G=V,tt=c(G);tt!=="string"&&(G=String(G),p.warn("WARNING: Non-string property key, received type "+tt+', coercing to string "'+G+'"'));var it=m(G,y[V]);it!==null&&(D[G]=it)}return D},N=["nan","function","arguments","regexp","element"],m=function I(y,T){var D=c(T);if(N.indexOf(D)!==-1)p.warn('WARNING: Property key "'+y+'" with invalid value type '+D+", ignoring"),T=null;else if(D==="undefined")T=null;else if(D==="error")T=String(T),p.warn('WARNING: Property key "'+y+'" with value type error, coercing to '+T);else if(D==="array"){for(var V=[],G=0;G<T.length;G++){var tt=T[G],it=c(tt);if(it==="array"){p.warn("WARNING: Cannot have "+it+" nested in an array property value, skipping");continue}else it==="object"?V.push(O(tt)):V.push(I(y,tt))}T=V}else D==="object"&&(T=O(T));return T},b=function(y){var T=c(y);if(T!=="object")return p.error("Error: invalid groups format. Expecting Javascript object, received "+T+", ignoring"),{};var D={};for(var V in y)if(y.hasOwnProperty(V)){var G=V,tt=c(G);tt!=="string"&&(G=String(G),p.warn("WARNING: Non-string groupType, received type "+tt+', coercing to string "'+G+'"'));var it=w(G,y[V]);it!==null&&(D[G]=it)}return D},w=function(y,T){var D=c(T);if(D==="string")return T;if(D==="date"||D==="number"||D==="boolean")return T=String(T),p.warn("WARNING: Non-string groupName, received type "+D+', coercing to string "'+T+'"'),T;if(D==="array"){for(var V=[],G=0;G<T.length;G++){var tt=T[G],it=c(tt);if(it==="array"||it==="object"){p.warn("WARNING: Skipping nested "+it+" in array groupName");continue}else it==="string"?V.push(tt):(it==="date"||it==="number"||it==="boolean")&&(tt=String(tt),p.warn("WARNING: Non-string groupName, received type "+it+', coercing to string "'+tt+'"'),V.push(tt))}return V}p.warn("WARNING: Non-string groupName, received type "+D+". Please use strings or array of strings for groupName")},A=function(y,T){y=y.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var D=new RegExp("[\\?&]"+y+"=([^&#]*)"),V=D.exec(T);return V===null?void 0:decodeURIComponent(V[1].replace(/\+/g," "))},E={setLogLevel:d,getLogLevel:f,logLevels:h,log:p,isEmptyString:v,getQueryParam:A,sessionStorageEnabled:x,truncate:S,validateGroups:b,validateInput:P,validateProperties:O},M=function(){return window.location},$=function(y){try{for(var T=document.cookie.split(";"),D=null,V=0;V<T.length;V++){for(var G=T[V];G.charAt(0)===" ";)G=G.substring(1,G.length);if(G.indexOf(y)===0){D=G.substring(y.length,G.length);break}}return D}catch{return null}},F=function(y,T,D){var V=T!==null?D.expirationDays:-1;if(V){var G=new Date;G.setTime(G.getTime()+V*24*60*60*1e3),V=G}var tt=y+"="+T;V&&(tt+="; expires="+V.toUTCString()),tt+="; path=/",D.domain&&(tt+="; domain="+D.domain),D.secure&&(tt+="; Secure"),D.sameSite&&(tt+="; SameSite="+D.sameSite),document.cookie=tt},j={set:F,get:$},R={expirationDays:void 0,domain:void 0},H=function(){R={expirationDays:void 0,domain:void 0}},z=function(y){var T=document.createElement("a");return T.href=y,T.hostname||location.hostname},B=function(y){var T=z(y),D=T.split("."),V=D[D.length-1],G=[];if(D.length===4&&V===parseInt(V,10)||D.length<=1)return G;for(var tt=D.length-2;tt>=0;--tt)G.push(D.slice(tt).join("."));for(var it=0;it<G.length;++it){var Tt="__tld_test__",Yt=G[it],ve={domain:"."+Yt};if(j.set(Tt,1,ve),j.get(Tt))return j.set(Tt,null,ve),Yt}return""},_t=function(y){if(arguments.length===0)return R;y=y||{},R.expirationDays=y.expirationDays,R.secure=y.secure,R.sameSite=y.sameSite;var T=E.isEmptyString(y.domain)?"."+B(M().href):y.domain,D=Math.random();R.domain=T,ne("amplitude_test",D);var V=Rt("amplitude_test");return(!V||V!==D)&&(T=null),bt("amplitude_test"),R.domain=T,R},gt=function(y){var T="";return R.domain&&(T=R.domain.charAt(0)==="."?R.domain.substring(1):R.domain),y+T},Rt=function(y){var T=gt(y)+"=",D=j.get(T);try{if(D)return JSON.parse(a.decode(D))}catch{return null}return null},ne=function(y,T){try{return j.set(gt(y),a.encode(JSON.stringify(T)),R),!0}catch{return!1}},bt=function(y){try{return j.set(gt(y),null,R),!0}catch{return!1}},St={reset:H,options:_t,get:Rt,set:ne,remove:bt},Y;{var W=function(){var y=new Date,T;try{return window.localStorage.setItem(y,y),T=window.localStorage.getItem(y)===String(y),window.localStorage.removeItem(y),T}catch{}return!1};if(W())Y=window.localStorage;else if(window.globalStorage)try{Y=window.globalStorage[window.location.hostname]}catch{}else if(typeof document<"u"){var Q=document.createElement("div"),$t="localStorage";Q.style.display="none",document.getElementsByTagName("head")[0].appendChild(Q),Q.addBehavior&&(Q.addBehavior("#default#userdata"),Y={length:0,setItem:function(y,T){Q.load($t),Q.getAttribute(y)||this.length++,Q.setAttribute(y,T),Q.save($t)},getItem:function(y){return Q.load($t),Q.getAttribute(y)},removeItem:function(y){Q.load($t),Q.getAttribute(y)&&this.length--,Q.removeAttribute(y),Q.save($t)},clear:function(){Q.load($t);for(var y=0,T;T=Q.XMLDocument.documentElement.attributes[y++];)Q.removeAttribute(T.name);Q.save($t),this.length=0},key:function(y){return Q.load($t),Q.XMLDocument.documentElement.attributes[y]}},Q.load($t),Y.length=Q.XMLDocument.documentElement.attributes.length)}Y||(Y={length:0,setItem:function(y,T){},getItem:function(y){},removeItem:function(y){},clear:function(){},key:function(y){}})}var Bt=Y,kt=function(){this.storage=null};kt.prototype._cookiesEnabled=function(){var I=String(new Date),y;try{return St.set(s.COOKIE_TEST,I),y=St.get(s.COOKIE_TEST)===I,St.remove(s.COOKIE_TEST),y}catch{}return!1},kt.prototype.getStorage=function(){if(this.storage!==null)return this.storage;if(this._cookiesEnabled())this.storage=St;else{var I="amp_cookiestore_";this.storage={_options:{expirationDays:void 0,domain:void 0,secure:!1},reset:function(){this._options={expirationDays:void 0,domain:void 0,secure:!1}},options:function(T){return arguments.length===0?this._options:(T=T||{},this._options.expirationDays=T.expirationDays||this._options.expirationDays,this._options.domain=T.domain||this._options.domain||window&&window.location&&window.location.hostname,this._options.secure=T.secure||!1)},get:function(T){try{return JSON.parse(Bt.getItem(I+T))}catch{}return null},set:function(T,D){try{return Bt.setItem(I+T,JSON.stringify(D)),!0}catch{}return!1},remove:function(T){try{Bt.removeItem(I+T)}catch{return!1}}}}return this.storage};var Ce=function(y,T){var D=y?"?"+y.split(".").slice(-1)[0].replace(/\|/g,"&"):"",V=function(dt,ct,st,yt){return E.getQueryParam(dt,ct)||E.getQueryParam(st,yt)},G=V(s.UTM_SOURCE,T,"utmcsr",D),tt=V(s.UTM_MEDIUM,T,"utmcmd",D),it=V(s.UTM_CAMPAIGN,T,"utmccn",D),Tt=V(s.UTM_TERM,T,"utmctr",D),Yt=V(s.UTM_CONTENT,T,"utmcct",D),ve={},ue=function(dt,ct){E.isEmptyString(ct)||(ve[dt]=ct)};return ue(s.UTM_SOURCE,G),ue(s.UTM_MEDIUM,tt),ue(s.UTM_CAMPAIGN,it),ue(s.UTM_TERM,Tt),ue(s.UTM_CONTENT,Yt),ve},Wt="$add",Dt="$append",ie="$clearAll",Pt="$prepend",mt="$set",Le="$setOnce",He="$unset",ce=function(){this.userPropertiesOperations={},this.properties=[]};ce.prototype.add=function(I,y){return c(y)==="number"||c(y)==="string"?this._addOperation(Wt,I,y):E.log.error("Unsupported type for value: "+c(y)+", expecting number or string"),this},ce.prototype.append=function(I,y){return this._addOperation(Dt,I,y),this},ce.prototype.clearAll=function(){return Object.keys(this.userPropertiesOperations).length>0?(this.userPropertiesOperations.hasOwnProperty(ie)||E.log.error("Need to send $clearAll on its own Identify object without any other operations, skipping $clearAll"),this):(this.userPropertiesOperations[ie]="-",this)},ce.prototype.prepend=function(I,y){return this._addOperation(Pt,I,y),this},ce.prototype.set=function(I,y){return this._addOperation(mt,I,y),this},ce.prototype.setOnce=function(I,y){return this._addOperation(Le,I,y),this},ce.prototype.unset=function(I){return this._addOperation(He,I,"-"),this},ce.prototype._addOperation=function(I,y,T){if(this.userPropertiesOperations.hasOwnProperty(ie)){E.log.error("This identify already contains a $clearAll operation, skipping operation "+I);return}if(this.properties.indexOf(y)!==-1){E.log.error('User property "'+y+'" already used in this identify, skipping operation '+I);return}this.userPropertiesOperations.hasOwnProperty(I)||(this.userPropertiesOperations[I]={}),this.userPropertiesOperations[I][y]=T,this.properties.push(y)};var Fi=typeof window<"u"?window:typeof Gr<"u"?Gr:typeof self<"u"?self:{};function As(I,y){return y={exports:{}},I(y,y.exports),y.exports}var Ja=As(function(I){(function(y){function T(X,Et){var nt=(X&65535)+(Et&65535),Ht=(X>>16)+(Et>>16)+(nt>>16);return Ht<<16|nt&65535}function D(X,Et){return X<<Et|X>>>32-Et}function V(X,Et,nt,Ht,se,Be){return T(D(T(T(Et,X),T(Ht,Be)),se),nt)}function G(X,Et,nt,Ht,se,Be,_n){return V(Et&nt|~Et&Ht,X,Et,se,Be,_n)}function tt(X,Et,nt,Ht,se,Be,_n){return V(Et&Ht|nt&~Ht,X,Et,se,Be,_n)}function it(X,Et,nt,Ht,se,Be,_n){return V(Et^nt^Ht,X,Et,se,Be,_n)}function Tt(X,Et,nt,Ht,se,Be,_n){return V(nt^(Et|~Ht),X,Et,se,Be,_n)}function Yt(X,Et){X[Et>>5]|=128<<Et%32,X[(Et+64>>>9<<4)+14]=Et;var nt,Ht,se,Be,_n,at=1732584193,ut=-271733879,ht=-1732584194,Z=271733878;for(nt=0;nt<X.length;nt+=16)Ht=at,se=ut,Be=ht,_n=Z,at=G(at,ut,ht,Z,X[nt],7,-680876936),Z=G(Z,at,ut,ht,X[nt+1],12,-389564586),ht=G(ht,Z,at,ut,X[nt+2],17,606105819),ut=G(ut,ht,Z,at,X[nt+3],22,-1044525330),at=G(at,ut,ht,Z,X[nt+4],7,-176418897),Z=G(Z,at,ut,ht,X[nt+5],12,1200080426),ht=G(ht,Z,at,ut,X[nt+6],17,-1473231341),ut=G(ut,ht,Z,at,X[nt+7],22,-45705983),at=G(at,ut,ht,Z,X[nt+8],7,1770035416),Z=G(Z,at,ut,ht,X[nt+9],12,-1958414417),ht=G(ht,Z,at,ut,X[nt+10],17,-42063),ut=G(ut,ht,Z,at,X[nt+11],22,-1990404162),at=G(at,ut,ht,Z,X[nt+12],7,1804603682),Z=G(Z,at,ut,ht,X[nt+13],12,-40341101),ht=G(ht,Z,at,ut,X[nt+14],17,-1502002290),ut=G(ut,ht,Z,at,X[nt+15],22,1236535329),at=tt(at,ut,ht,Z,X[nt+1],5,-165796510),Z=tt(Z,at,ut,ht,X[nt+6],9,-1069501632),ht=tt(ht,Z,at,ut,X[nt+11],14,643717713),ut=tt(ut,ht,Z,at,X[nt],20,-373897302),at=tt(at,ut,ht,Z,X[nt+5],5,-701558691),Z=tt(Z,at,ut,ht,X[nt+10],9,38016083),ht=tt(ht,Z,at,ut,X[nt+15],14,-660478335),ut=tt(ut,ht,Z,at,X[nt+4],20,-405537848),at=tt(at,ut,ht,Z,X[nt+9],5,568446438),Z=tt(Z,at,ut,ht,X[nt+14],9,-1019803690),ht=tt(ht,Z,at,ut,X[nt+3],14,-187363961),ut=tt(ut,ht,Z,at,X[nt+8],20,1163531501),at=tt(at,ut,ht,Z,X[nt+13],5,-1444681467),Z=tt(Z,at,ut,ht,X[nt+2],9,-51403784),ht=tt(ht,Z,at,ut,X[nt+7],14,1735328473),ut=tt(ut,ht,Z,at,X[nt+12],20,-1926607734),at=it(at,ut,ht,Z,X[nt+5],4,-378558),Z=it(Z,at,ut,ht,X[nt+8],11,-2022574463),ht=it(ht,Z,at,ut,X[nt+11],16,1839030562),ut=it(ut,ht,Z,at,X[nt+14],23,-35309556),at=it(at,ut,ht,Z,X[nt+1],4,-1530992060),Z=it(Z,at,ut,ht,X[nt+4],11,1272893353),ht=it(ht,Z,at,ut,X[nt+7],16,-155497632),ut=it(ut,ht,Z,at,X[nt+10],23,-1094730640),at=it(at,ut,ht,Z,X[nt+13],4,681279174),Z=it(Z,at,ut,ht,X[nt],11,-358537222),ht=it(ht,Z,at,ut,X[nt+3],16,-722521979),ut=it(ut,ht,Z,at,X[nt+6],23,76029189),at=it(at,ut,ht,Z,X[nt+9],4,-640364487),Z=it(Z,at,ut,ht,X[nt+12],11,-421815835),ht=it(ht,Z,at,ut,X[nt+15],16,530742520),ut=it(ut,ht,Z,at,X[nt+2],23,-995338651),at=Tt(at,ut,ht,Z,X[nt],6,-198630844),Z=Tt(Z,at,ut,ht,X[nt+7],10,1126891415),ht=Tt(ht,Z,at,ut,X[nt+14],15,-1416354905),ut=Tt(ut,ht,Z,at,X[nt+5],21,-57434055),at=Tt(at,ut,ht,Z,X[nt+12],6,1700485571),Z=Tt(Z,at,ut,ht,X[nt+3],10,-1894986606),ht=Tt(ht,Z,at,ut,X[nt+10],15,-1051523),ut=Tt(ut,ht,Z,at,X[nt+1],21,-2054922799),at=Tt(at,ut,ht,Z,X[nt+8],6,1873313359),Z=Tt(Z,at,ut,ht,X[nt+15],10,-30611744),ht=Tt(ht,Z,at,ut,X[nt+6],15,-1560198380),ut=Tt(ut,ht,Z,at,X[nt+13],21,1309151649),at=Tt(at,ut,ht,Z,X[nt+4],6,-145523070),Z=Tt(Z,at,ut,ht,X[nt+11],10,-1120210379),ht=Tt(ht,Z,at,ut,X[nt+2],15,718787259),ut=Tt(ut,ht,Z,at,X[nt+9],21,-343485551),at=T(at,Ht),ut=T(ut,se),ht=T(ht,Be),Z=T(Z,_n);return[at,ut,ht,Z]}function ve(X){var Et,nt="",Ht=X.length*32;for(Et=0;Et<Ht;Et+=8)nt+=String.fromCharCode(X[Et>>5]>>>Et%32&255);return nt}function ue(X){var Et,nt=[];for(nt[(X.length>>2)-1]=void 0,Et=0;Et<nt.length;Et+=1)nt[Et]=0;var Ht=X.length*8;for(Et=0;Et<Ht;Et+=8)nt[Et>>5]|=(X.charCodeAt(Et/8)&255)<<Et%32;return nt}function rt(X){return ve(Yt(ue(X),X.length*8))}function dt(X,Et){var nt,Ht=ue(X),se=[],Be=[],_n;for(se[15]=Be[15]=void 0,Ht.length>16&&(Ht=Yt(Ht,X.length*8)),nt=0;nt<16;nt+=1)se[nt]=Ht[nt]^909522486,Be[nt]=Ht[nt]^1549556828;return _n=Yt(se.concat(ue(Et)),512+Et.length*8),ve(Yt(Be.concat(_n),512+128))}function ct(X){var Et="0123456789abcdef",nt="",Ht,se;for(se=0;se<X.length;se+=1)Ht=X.charCodeAt(se),nt+=Et.charAt(Ht>>>4&15)+Et.charAt(Ht&15);return nt}function st(X){return unescape(encodeURIComponent(X))}function yt(X){return rt(st(X))}function Fn(X){return ct(yt(X))}function Vn(X,Et){return dt(st(X),st(Et))}function he(X,Et){return ct(Vn(X,Et))}function Vt(X,Et,nt){return Et?nt?Vn(Et,X):he(Et,X):nt?yt(X):Fn(X)}I.exports?I.exports=Vt:y.md5=Vt})(Fi)}),$r=function(I){return encodeURIComponent(I).replace(/[!'()*]/g,function(y){return"%"+y.charCodeAt(0).toString(16).toUpperCase()})};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var gr=Object.getOwnPropertySymbols,cn=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable;function Do(I){if(I==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(I)}function Au(){try{if(!Object.assign)return!1;var I=new String("abc");if(I[5]="de",Object.getOwnPropertyNames(I)[0]==="5")return!1;for(var y={},T=0;T<10;T++)y["_"+String.fromCharCode(T)]=T;var D=Object.getOwnPropertyNames(y).map(function(G){return y[G]});if(D.join("")!=="0123456789")return!1;var V={};return"abcdefghijklmnopqrst".split("").forEach(function(G){V[G]=G}),Object.keys(Object.assign({},V)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var Qa=Au()?Object.assign:function(I,y){for(var T,D=Do(I),V,G=1;G<arguments.length;G++){T=Object(arguments[G]);for(var tt in T)cn.call(T,tt)&&(D[tt]=T[tt]);if(gr){V=gr(T);for(var it=0;it<V.length;it++)ze.call(T,V[it])&&(D[V[it]]=T[V[it]])}}return D},tl="%[a-f0-9]{2}",el=new RegExp(tl,"gi"),nl=new RegExp("("+tl+")+","gi");function No(I,y){try{return decodeURIComponent(I.join(""))}catch{}if(I.length===1)return I;y=y||1;var T=I.slice(0,y),D=I.slice(y);return Array.prototype.concat.call([],No(T),No(D))}function Cu(I){try{return decodeURIComponent(I)}catch{for(var y=I.match(el),T=1;T<y.length;T++)I=No(y,T).join(""),y=I.match(el);return I}}function il(I){for(var y={"%FE%FF":"��","%FF%FE":"��"},T=nl.exec(I);T;){try{y[T[0]]=decodeURIComponent(T[0])}catch{var D=Cu(T[0]);D!==T[0]&&(y[T[0]]=D)}T=nl.exec(I)}y["%C2"]="�";for(var V=Object.keys(y),G=0;G<V.length;G++){var tt=V[G];I=I.replace(new RegExp(tt,"g"),y[tt])}return I}var Ro=function(I){if(typeof I!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof I+"`");try{return I=I.replace(/\+/g," "),decodeURIComponent(I)}catch{return il(I)}};function rl(I){switch(I.arrayFormat){case"index":return function(y,T,D){return T===null?[en(y,I),"[",D,"]"].join(""):[en(y,I),"[",en(D,I),"]=",en(T,I)].join("")};case"bracket":return function(y,T){return T===null?en(y,I):[en(y,I),"[]=",en(T,I)].join("")};default:return function(y,T){return T===null?en(y,I):[en(y,I),"=",en(T,I)].join("")}}}function sl(I){var y;switch(I.arrayFormat){case"index":return function(T,D,V){if(y=/\[(\d*)\]$/.exec(T),T=T.replace(/\[\d*\]$/,""),!y){V[T]=D;return}V[T]===void 0&&(V[T]={}),V[T][y[1]]=D};case"bracket":return function(T,D,V){if(y=/(\[\])$/.exec(T),T=T.replace(/\[\]$/,""),y){if(V[T]===void 0){V[T]=[D];return}}else{V[T]=D;return}V[T]=[].concat(V[T],D)};default:return function(T,D,V){if(V[T]===void 0){V[T]=D;return}V[T]=[].concat(V[T],D)}}}function en(I,y){return y.encode?y.strict?$r(I):encodeURIComponent(I):I}function $o(I){return Array.isArray(I)?I.sort():typeof I=="object"?$o(Object.keys(I)).sort(function(y,T){return Number(y)-Number(T)}).map(function(y){return I[y]}):I}function Bo(I){var y=I.indexOf("?");return y===-1?"":I.slice(y+1)}function Fo(I,y){y=Qa({arrayFormat:"none"},y);var T=sl(y),D=Object.create(null);return typeof I!="string"||(I=I.trim().replace(/^[?#&]/,""),!I)?D:(I.split("&").forEach(function(V){var G=V.replace(/\+/g," ").split("="),tt=G.shift(),it=G.length>0?G.join("="):void 0;it=it===void 0?null:Ro(it),T(Ro(tt),it,D)}),Object.keys(D).sort().reduce(function(V,G){var tt=D[G];return tt&&typeof tt=="object"&&!Array.isArray(tt)?V[G]=$o(tt):V[G]=tt,V},Object.create(null)))}var Pu=Bo,Si=Fo,oS=function(I,y){var T={encode:!0,strict:!0,arrayFormat:"none"};y=Qa(T,y),y.sort===!1&&(y.sort=function(){});var D=rl(y);return I?Object.keys(I).sort(y.sort).map(function(V){var G=I[V];if(G===void 0)return"";if(G===null)return en(V,y);if(Array.isArray(G)){var tt=[];return G.slice().forEach(function(it){it!==void 0&&tt.push(D(V,it,tt.length))}),tt.join("&")}return en(V,y)+"="+en(G,y)}).filter(function(V){return V.length>0}).join("&"):""},aS=function(I,y){return{url:I.split("?")[0]||"",query:Fo(Bo(I),y)}},Op={extract:Pu,parse:Si,stringify:oS,parseUrl:aS},kp=function(y,T){this.url=y,this.data=T||{}};kp.prototype.send=function(I){var y=!!window.XDomainRequest;if(y){var T=new window.XDomainRequest;T.open("POST",this.url,!0),T.onload=function(){I(200,T.responseText)},T.onerror=function(){T.responseText==="Request Entity Too Large"?I(413,T.responseText):I(500,T.responseText)},T.ontimeout=function(){},T.onprogress=function(){},T.send(Op.stringify(this.data))}else{var D=new XMLHttpRequest;D.open("POST",this.url,!0),D.onreadystatechange=function(){D.readyState===4&&I(D.status,D.responseText)},D.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),D.send(Op.stringify(this.data))}};var hi=function(){this._price=null,this._productId=null,this._quantity=1,this._revenueType=null,this._properties=null};hi.prototype.setProductId=function(y){return c(y)!=="string"?E.log.error("Unsupported type for productId: "+c(y)+", expecting string"):E.isEmptyString(y)?E.log.error("Invalid empty productId"):this._productId=y,this},hi.prototype.setQuantity=function(y){return c(y)!=="number"?E.log.error("Unsupported type for quantity: "+c(y)+", expecting number"):this._quantity=parseInt(y),this},hi.prototype.setPrice=function(y){return c(y)!=="number"?E.log.error("Unsupported type for price: "+c(y)+", expecting number"):this._price=y,this},hi.prototype.setRevenueType=function(y){return c(y)!=="string"?E.log.error("Unsupported type for revenueType: "+c(y)+", expecting string"):this._revenueType=y,this},hi.prototype.setEventProperties=function(y){return c(y)!=="object"?E.log.error("Unsupported type for eventProperties: "+c(y)+", expecting object"):this._properties=E.validateProperties(y),this},hi.prototype._isValidRevenue=function(){return c(this._price)!=="number"?(E.log.error("Invalid revenue, need to set price field"),!1):!0},hi.prototype._toJSONObject=function(){var y=c(this._properties)==="object"?this._properties:{};return this._productId!==null&&(y[s.REVENUE_PRODUCT_ID]=this._productId),this._quantity!==null&&(y[s.REVENUE_QUANTITY]=this._quantity),this._price!==null&&(y[s.REVENUE_PRICE]=this._price),this._revenueType!==null&&(y[s.REVENUE_REVENUE_TYPE]=this._revenueType),y};var Lp=As(function(I,y){/*!
 * UAParser.js v0.7.19
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright © 2012-2016 Faisal Salman <fyzlman@gmail.com>
 * Dual licensed under GPLv2 or MIT
 */(function(T,D){var V="0.7.19",G="",tt="?",it="function",Tt="undefined",Yt="object",ve="string",ue="major",rt="model",dt="name",ct="type",st="vendor",yt="version",Fn="architecture",Vn="console",he="mobile",Vt="tablet",X="smarttv",Et="wearable",nt="embedded",Ht={extend:function(Z,Fe){var ye={};for(var Ye in Z)Fe[Ye]&&Fe[Ye].length%2===0?ye[Ye]=Fe[Ye].concat(Z[Ye]):ye[Ye]=Z[Ye];return ye},has:function(Z,Fe){return typeof Z=="string"?Fe.toLowerCase().indexOf(Z.toLowerCase())!==-1:!1},lowerize:function(Z){return Z.toLowerCase()},major:function(Z){return typeof Z===ve?Z.replace(/[^\d\.]/g,"").split(".")[0]:D},trim:function(Z){return Z.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},se={rgx:function(Z,Fe){for(var ye=0,Ye,Xe,ll,Me,Vo,Ei;ye<Fe.length&&!Vo;){var Rp=Fe[ye],$p=Fe[ye+1];for(Ye=Xe=0;Ye<Rp.length&&!Vo;)if(Vo=Rp[Ye++].exec(Z),Vo)for(ll=0;ll<$p.length;ll++)Ei=Vo[++Xe],Me=$p[ll],typeof Me===Yt&&Me.length>0?Me.length==2?typeof Me[1]==it?this[Me[0]]=Me[1].call(this,Ei):this[Me[0]]=Me[1]:Me.length==3?typeof Me[1]===it&&!(Me[1].exec&&Me[1].test)?this[Me[0]]=Ei?Me[1].call(this,Ei,Me[2]):D:this[Me[0]]=Ei?Ei.replace(Me[1],Me[2]):D:Me.length==4&&(this[Me[0]]=Ei?Me[3].call(this,Ei.replace(Me[1],Me[2])):D):this[Me]=Ei||D;ye+=2}},str:function(Z,Fe){for(var ye in Fe)if(typeof Fe[ye]===Yt&&Fe[ye].length>0){for(var Ye=0;Ye<Fe[ye].length;Ye++)if(Ht.has(Fe[ye][Ye],Z))return ye===tt?D:ye}else if(Ht.has(Fe[ye],Z))return ye===tt?D:ye;return Z}},Be={browser:{oldsafari:{version:{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},name:{"Opera Mobile":"Opera Mobi","IE Mobile":"IEMobile"}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},name:{"Windows Phone":"Windows Phone OS"}}}},_n={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[dt,yt],[/(opios)[\/\s]+([\w\.]+)/i],[[dt,"Opera Mini"],yt],[/\s(opr)\/([\w\.]+)/i],[[dt,"Opera"],yt],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[dt,yt],[/(konqueror)\/([\w\.]+)/i],[[dt,"Konqueror"],yt],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[dt,"IE"],yt],[/(edge|edgios|edga)\/((\d+)?[\w\.]+)/i],[[dt,"Edge"],yt],[/(yabrowser)\/([\w\.]+)/i],[[dt,"Yandex"],yt],[/(puffin)\/([\w\.]+)/i],[[dt,"Puffin"],yt],[/(focus)\/([\w\.]+)/i],[[dt,"Firefox Focus"],yt],[/(opt)\/([\w\.]+)/i],[[dt,"Opera Touch"],yt],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[dt,"UCBrowser"],yt],[/(comodo_dragon)\/([\w\.]+)/i],[[dt,/_/g," "],yt],[/((?:android.+)crmo|crios)\/([\w\.]+)/i,/android.+(chrome)\/([\w\.]+)\s+(?:mobile\s?safari)/i],[[dt,"Chrome Mobile"],yt],[/(micromessenger)\/([\w\.]+)/i],[[dt,"WeChat"],yt],[/(brave)\/([\w\.]+)/i],[[dt,"Brave"],yt],[/(qqbrowserlite)\/([\w\.]+)/i],[dt,yt],[/(QQ)\/([\d\.]+)/i],[dt,yt],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[dt,yt],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[dt,yt],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[dt,yt],[/(MetaSr)[\/\s]?([\w\.]+)/i],[dt],[/(LBBROWSER)/i],[dt],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[yt,[dt,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[yt,[dt,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[dt,yt],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[yt,[dt,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[dt,/(.+)/,"$1 WebView"],yt],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[dt,/(.+(?:g|us))(.+)/,"$1 $2"],yt],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[yt,[dt,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[dt,yt],[/(dolfin)\/([\w\.]+)/i],[[dt,"Dolphin"],yt],[/(coast)\/([\w\.]+)/i],[[dt,"Opera Coast"],yt],[/fxios\/([\w\.-]+)/i],[yt,[dt,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[yt,[dt,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[yt,dt],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[dt,"GSA"],yt],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[dt,[yt,se.str,Be.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[dt,yt],[/(navigator|netscape)\/([\w\.-]+)/i],[[dt,"Netscape"],yt],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[dt,yt]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[Fn,"amd64"]],[/(ia32(?=;))/i],[[Fn,Ht.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[Fn,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[Fn,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[Fn,/ower/,"",Ht.lowerize]],[/(sun4\w)[;\)]/i],[[Fn,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[Fn,Ht.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[rt,st,[ct,Vt]],[/applecoremedia\/[\w\.]+ \((ipad)/],[rt,[st,"Apple"],[ct,Vt]],[/(apple\s{0,1}tv)/i],[[rt,"Apple TV"],[st,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[st,rt,[ct,Vt]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[rt,[st,"Amazon"],[ct,Vt]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[rt,se.str,Be.device.amazon.model],[st,"Amazon"],[ct,he]],[/android.+aft([bms])\sbuild/i],[rt,[st,"Amazon"],[ct,X]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[rt,st,[ct,he]],[/\((ip[honed|\s\w*]+);/i],[rt,[st,"Apple"],[ct,he]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[st,rt,[ct,he]],[/\(bb10;\s(\w+)/i],[rt,[st,"BlackBerry"],[ct,he]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[rt,[st,"Asus"],[ct,Vt]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[st,"Sony"],[rt,"Xperia Tablet"],[ct,Vt]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[rt,[st,"Sony"],[ct,he]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[st,rt,[ct,Vn]],[/android.+;\s(shield)\sbuild/i],[rt,[st,"Nvidia"],[ct,Vn]],[/(playstation\s[34portablevi]+)/i],[rt,[st,"Sony"],[ct,Vn]],[/(sprint\s(\w+))/i],[[st,se.str,Be.device.sprint.vendor],[rt,se.str,Be.device.sprint.model],[ct,he]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[st,rt,[ct,Vt]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[st,[rt,/_/g," "],[ct,he]],[/(nexus\s9)/i],[rt,[st,"HTC"],[ct,Vt]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[rt,[st,"Huawei"],[ct,he]],[/(microsoft);\s(lumia[\s\w]+)/i],[st,rt,[ct,he]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[rt,[st,"Microsoft"],[ct,Vn]],[/(kin\.[onetw]{3})/i],[[rt,/\./g," "],[st,"Microsoft"],[ct,he]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[rt,[st,"Motorola"],[ct,he]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[rt,[st,"Motorola"],[ct,Vt]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[st,Ht.trim],[rt,Ht.trim],[ct,X]],[/hbbtv.+maple;(\d+)/i],[[rt,/^/,"SmartTV"],[st,"Samsung"],[ct,X]],[/\(dtv[\);].+(aquos)/i],[rt,[st,"Sharp"],[ct,X]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[st,"Samsung"],rt,[ct,Vt]],[/smart-tv.+(samsung)/i],[st,[ct,X],rt],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[st,"Samsung"],rt,[ct,he]],[/sie-(\w*)/i],[rt,[st,"Siemens"],[ct,he]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[st,"Nokia"],rt,[ct,he]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[rt,[st,"Acer"],[ct,Vt]],[/android.+([vl]k\-?\d{3})\s+build/i],[rt,[st,"LG"],[ct,Vt]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[st,"LG"],rt,[ct,Vt]],[/(lg) netcast\.tv/i],[st,rt,[ct,X]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[rt,[st,"LG"],[ct,he]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[rt,[st,"Lenovo"],[ct,Vt]],[/linux;.+((jolla));/i],[st,rt,[ct,he]],[/((pebble))app\/[\d\.]+\s/i],[st,rt,[ct,Et]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[st,rt,[ct,he]],[/crkey/i],[[rt,"Chromecast"],[st,"Google"]],[/android.+;\s(glass)\s\d/i],[rt,[st,"Google"],[ct,Et]],[/android.+;\s(pixel c)[\s)]/i],[rt,[st,"Google"],[ct,Vt]],[/android.+;\s(pixel( [23])?( xl)?)\s/i],[rt,[st,"Google"],[ct,he]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[rt,/_/g," "],[st,"Xiaomi"],[ct,he]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[rt,/_/g," "],[st,"Xiaomi"],[ct,Vt]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[rt,[st,"Meizu"],[ct,Vt]],[/(mz)-([\w-]{2,})/i],[[st,"Meizu"],rt,[ct,he]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[rt,[st,"OnePlus"],[ct,he]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[rt,[st,"RCA"],[ct,Vt]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[rt,[st,"Dell"],[ct,Vt]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[rt,[st,"Verizon"],[ct,Vt]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[st,"Barnes & Noble"],rt,[ct,Vt]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[rt,[st,"NuVision"],[ct,Vt]],[/android.+;\s(k88)\sbuild/i],[rt,[st,"ZTE"],[ct,Vt]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[rt,[st,"Swiss"],[ct,he]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[rt,[st,"Swiss"],[ct,Vt]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[rt,[st,"Zeki"],[ct,Vt]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[st,"Dragon Touch"],rt,[ct,Vt]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[rt,[st,"Insignia"],[ct,Vt]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[rt,[st,"NextBook"],[ct,Vt]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[st,"Voice"],rt,[ct,he]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[st,"LvTel"],rt,[ct,he]],[/android.+;\s(PH-1)\s/i],[rt,[st,"Essential"],[ct,he]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[rt,[st,"Envizen"],[ct,Vt]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[st,rt,[ct,Vt]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[rt,[st,"MachSpeed"],[ct,Vt]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[st,rt,[ct,Vt]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[rt,[st,"Rotor"],[ct,Vt]],[/android.+(KS(.+))\s+build/i],[rt,[st,"Amazon"],[ct,Vt]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[st,rt,[ct,Vt]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[ct,Ht.lowerize],st,rt],[/[\s\/\(](smart-?tv)[;\)]/i],[[ct,X]],[/(android[\w\.\s\-]{0,9});.+build/i],[rt,[st,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[yt,[dt,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)/i],[[dt,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[dt,yt],[/rv\:([\w\.]{1,9}).+(gecko)/i],[yt,dt]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[dt,yt],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[[dt,se.str,Be.os.windows.name],[yt,se.str,Be.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[dt,"Windows"],[yt,se.str,Be.os.windows.version]],[/\((bb)(10);/i],[[dt,"BlackBerry"],yt],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]*)/i,/linux;.+(sailfish);/i],[dt,yt],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[dt,"Symbian"],yt],[/\((series40);/i],[dt],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[dt,"Firefox OS"],yt],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[[dt,"Linux"],yt],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[dt,"Chromium OS"],yt],[/(sunos)\s?([\w\.\d]*)/i],[[dt,"Solaris"],yt],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[[dt,"Linux"],yt],[/(iphone)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[dt,"iPhone"],[yt,/_/g,"."]],[/(ipad)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[dt,"iPad"],[yt,/_/g,"."]],[/(haiku)\s(\w+)/i],[dt,yt],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[yt,/_/g,"."],[dt,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[dt,"Mac"],[yt,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[dt,yt]]},at=function(Z,Fe){if(typeof Z=="object"&&(Fe=Z,Z=D),!(this instanceof at))return new at(Z,Fe).getResult();var ye=Z||(T&&T.navigator&&T.navigator.userAgent?T.navigator.userAgent:G),Ye=Fe?Ht.extend(_n,Fe):_n;return this.getBrowser=function(){var Xe={name:D,version:D};return se.rgx.call(Xe,ye,Ye.browser),Xe.major=Ht.major(Xe.version),Xe},this.getCPU=function(){var Xe={architecture:D};return se.rgx.call(Xe,ye,Ye.cpu),Xe},this.getDevice=function(){var Xe={vendor:D,model:D,type:D};return se.rgx.call(Xe,ye,Ye.device),Xe},this.getEngine=function(){var Xe={name:D,version:D};return se.rgx.call(Xe,ye,Ye.engine),Xe},this.getOS=function(){var Xe={name:D,version:D};return se.rgx.call(Xe,ye,Ye.os),Xe},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return ye},this.setUA=function(Xe){return ye=Xe,this},this};at.VERSION=V,at.BROWSER={NAME:dt,MAJOR:ue,VERSION:yt},at.CPU={ARCHITECTURE:Fn},at.DEVICE={MODEL:rt,VENDOR:st,TYPE:ct,CONSOLE:Vn,MOBILE:he,SMARTTV:X,TABLET:Vt,WEARABLE:Et,EMBEDDED:nt},at.ENGINE={NAME:dt,VERSION:yt},at.OS={NAME:dt,VERSION:yt},I.exports&&(y=I.exports=at),y.UAParser=at;var ut=T&&(T.jQuery||T.Zepto);if(typeof ut!==Tt&&!ut.ua){var ht=new at;ut.ua=ht.getResult(),ut.ua.get=function(){return ht.getUA()},ut.ua.set=function(Z){ht.setUA(Z);var Fe=ht.getResult();for(var ye in Fe)ut.ua[ye]=Fe[ye]}}})(typeof window=="object"?window:Fi)});Lp.UAParser;var Iu=function I(y){return y?(y^Math.random()*16>>y/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,I)},Ou="5.11.0",lS=function(){return navigator&&(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage)||void 0},cS={language:lS()},uS="Web",ku={apiEndpoint:"api.amplitude.com",batchEvents:!1,cookieExpiration:365*10,cookieName:"amplitude_id",sameSiteCookie:"None",deviceIdFromUrlParam:!1,domain:"",eventUploadPeriodMillis:30*1e3,eventUploadThreshold:30,forceHttps:!0,includeGclid:!1,includeReferrer:!1,includeUtm:!1,language:cS.language,logLevel:"WARN",optOut:!1,onError:function(){},platform:uS,savedMaxCount:1e3,saveEvents:!0,saveParamsReferrerOncePerSession:!0,secureCookie:!1,sessionTimeout:30*60*1e3,trackingOptions:{city:!0,country:!0,carrier:!0,device_manufacturer:!0,device_model:!0,dma:!0,ip_address:!0,language:!0,os_name:!0,os_version:!0,platform:!0,region:!0,version_name:!0},unsetParamsReferrerOnNewSession:!1,unsentKey:"amplitude_unsent",unsentIdentifyKey:"amplitude_unsent_identify",uploadBatchSize:100},Vi,zY,Ct=function(y){this._instanceName=E.isEmptyString(y)?s.DEFAULT_INSTANCE:y.toLowerCase(),this._legacyStorageSuffix=this._instanceName===s.DEFAULT_INSTANCE?"":"_"+this._instanceName,this._unsentEvents=[],this._unsentIdentifys=[],this._ua=new Lp(navigator.userAgent).getResult(),this.options=r({},ku,{trackingOptions:r({},ku.trackingOptions)}),this.cookieStorage=new kt().getStorage(),this._q=[],this._sending=!1,this._updateScheduled=!1,this._onInit=[],this._eventId=0,this._identifyId=0,this._lastEventTime=null,this._newSession=!1,this._sequenceNumber=0,this._sessionId=null,this._isInitialized=!1,this._userAgent=navigator&&navigator.userAgent||null};Ct.prototype.Identify=ce,Ct.prototype.Revenue=hi,Ct.prototype.init=function(y,T,D,V){var G=this;if(c(y)!=="string"||E.isEmptyString(y)){E.log.error("Invalid apiKey. Please re-initialize with a valid apiKey");return}try{this.options.apiKey=y,this._storageSuffix="_"+y+this._legacyStorageSuffix;var tt=!!this.cookieStorage.get(this.options.cookieName+this._storageSuffix);if(D&&D.deferInitialization&&!tt){this._deferInitialization(y,T,D,V);return}hS(this.options,D),c(this.options.logLevel)==="string"&&E.setLogLevel(this.options.logLevel);var it=fS(this);this._apiPropertiesTrackingOptions=Object.keys(it).length>0?{tracking_options:it}:{},this.cookieStorage.options({expirationDays:this.options.cookieExpiration,domain:this.options.domain,secure:this.options.secureCookie,sameSite:this.options.sameSiteCookie}),this.options.domain=this.cookieStorage.options().domain,this._instanceName===s.DEFAULT_INSTANCE&&dS(this),Lu(this),this._pendingReadStorage=!0;var Tt=function(ve){G.options.deviceId=c(D)==="object"&&c(D.deviceId)==="string"&&!E.isEmptyString(D.deviceId)&&D.deviceId||G.options.deviceIdFromUrlParam&&G._getDeviceIdFromUrlParam(G._getUrlParams())||G.options.deviceId||ve||Iu()+"R",G.options.userId=c(T)==="string"&&!E.isEmptyString(T)&&T||c(T)==="number"&&T.toString()||G.options.userId||null;var ue=new Date().getTime();if((!G._sessionId||!G._lastEventTime||ue-G._lastEventTime>G.options.sessionTimeout)&&(G.options.unsetParamsReferrerOnNewSession&&G._unsetUTMParams(),G._newSession=!0,G._sessionId=ue,G.options.saveParamsReferrerOncePerSession&&G._trackParamsAndReferrer()),G.options.saveParamsReferrerOncePerSession||G._trackParamsAndReferrer(),G.options.saveEvents){for(var rt=0;rt<G._unsentEvents.length;rt++){var dt=G._unsentEvents[rt].event_properties,ct=G._unsentEvents[rt].groups;G._unsentEvents[rt].event_properties=E.validateProperties(dt),G._unsentEvents[rt].groups=E.validateGroups(ct)}for(var st=0;st<G._unsentIdentifys.length;st++){var yt=G._unsentIdentifys[st].user_properties,Fn=G._unsentIdentifys[st].groups;G._unsentIdentifys[st].user_properties=E.validateProperties(yt),G._unsentIdentifys[st].groups=E.validateGroups(Fn)}}G._lastEventTime=ue,zi(G),G._pendingReadStorage=!1,G._sendEventsIfReady();for(var Vn=0;Vn<G._onInit.length;Vn++)G._onInit[Vn]();G._onInit=[],G._isInitialized=!0};Vi||(this.options.saveEvents&&(this._unsentEvents=this._loadSavedUnsentEvents(this.options.unsentKey).concat(this._unsentEvents),this._unsentIdentifys=this._loadSavedUnsentEvents(this.options.unsentIdentifyKey).concat(this._unsentIdentifys)),Tt(),this.runQueuedFunctions(),c(V)==="function"&&V(this))}catch(Yt){E.log.error(Yt),this.options.onError(Yt)}},Ct.prototype._migrateUnsentEvents=function(y){var T=this;Promise.all([Vi.getItem(this.options.unsentKey),Vi.getItem(this.options.unsentIdentifyKey)]).then(function(D){if(T.options.saveEvents){var V=D[0],G=D[1],tt=[],it=[];V&&(tt.push(Vi.setItem(T.options.unsentKey+T._storageSuffix,JSON.stringify(V))),it.push(Vi.removeItem(T.options.unsentKey))),G&&(tt.push(Vi.setItem(T.options.unsentIdentifyKey+T._storageSuffix,JSON.stringify(G))),it.push(Vi.removeItem(T.options.unsentIdentifyKey))),tt.length>0&&Promise.all(tt).then(function(){}).catch(function(Tt){T.options.onError(Tt)})}}).then(y).catch(function(D){T.options.onError(D)})},Ct.prototype._trackParamsAndReferrer=function(){this.options.includeUtm&&this._initUtmData(),this.options.includeReferrer&&this._saveReferrer(this._getReferrer()),this.options.includeGclid&&this._saveGclid(this._getUrlParams())};var hS=function I(y,T){if(c(T)==="object"){var D=function(tt){if(y.hasOwnProperty(tt)){var it=T[tt],Tt=c(y[tt]);E.validateInput(it,tt+" option",Tt)&&(Tt==="boolean"?y[tt]=!!it:Tt==="string"&&!E.isEmptyString(it)||Tt==="number"&&it>0?y[tt]=it:Tt==="object"&&I(y[tt],it))}};for(var V in T)T.hasOwnProperty(V)&&D(V)}};Ct.prototype.runQueuedFunctions=function(){var I=this._q;this._q=[];for(var y=0;y<I.length;y++){var T=this[I[y][0]];c(T)==="function"&&T.apply(this,I[y].slice(1))}},Ct.prototype._apiKeySet=function(y){return E.isEmptyString(this.options.apiKey)?(E.log.error("Invalid apiKey. Please set a valid apiKey with init() before calling "+y),!1):!0},Ct.prototype._loadSavedUnsentEvents=function(y){var T=this._getFromStorage(Bt,y),D=this._parseSavedUnsentEventsString(T,y);return this._setInStorage(Bt,y,JSON.stringify(D)),D},Ct.prototype._parseSavedUnsentEventsString=function(y,T){if(E.isEmptyString(y))return[];if(c(y)==="string")try{var D=JSON.parse(y);if(c(D)==="array")return D}catch{}return E.log.error("Unable to load "+T+" events. Restart with a new empty queue."),[]},Ct.prototype.isNewSession=function(){return this._newSession},Ct.prototype.onInit=function(I){this._isInitialized?I():this._onInit.push(I)},Ct.prototype.getSessionId=function(){return this._sessionId},Ct.prototype.nextEventId=function(){return this._eventId++,this._eventId},Ct.prototype.nextIdentifyId=function(){return this._identifyId++,this._identifyId},Ct.prototype.nextSequenceNumber=function(){return this._sequenceNumber++,this._sequenceNumber},Ct.prototype._unsentCount=function(){return this._unsentEvents.length+this._unsentIdentifys.length},Ct.prototype._sendEventsIfReady=function(y){return this._unsentCount()===0?!1:this.options.batchEvents?this._unsentCount()>=this.options.eventUploadThreshold?(this.sendEvents(y),!0):(this._updateScheduled||(this._updateScheduled=!0,setTimeout((function(){this._updateScheduled=!1,this.sendEvents()}).bind(this),this.options.eventUploadPeriodMillis)),!1):(this.sendEvents(y),!0)},Ct.prototype._getFromStorage=function(y,T){return y.getItem(T+this._storageSuffix)},Ct.prototype._setInStorage=function(y,T,D){y.setItem(T+this._storageSuffix,D)};var dS=function(y){var T=y.cookieStorage.get(y.options.cookieName+y._storageSuffix);if(c(T)!=="object"&&(T=y.cookieStorage.get(y.options.cookieName+y._legacyStorageSuffix),!(c(T)==="object"&&T.deviceId&&T.sessionId&&T.lastEventTime))){var D=function(st){var yt=Bt.getItem(st);return Bt.removeItem(st),yt},V=c(y.options.apiKey)==="string"&&"_"+y.options.apiKey.slice(0,6)||"",G=D(s.DEVICE_ID+V),tt=D(s.USER_ID+V),it=D(s.OPT_OUT+V);it!=null&&(it=String(it)==="true");var Tt=parseInt(D(s.SESSION_ID)),Yt=parseInt(D(s.LAST_EVENT_TIME)),ve=parseInt(D(s.LAST_EVENT_ID)),ue=parseInt(D(s.LAST_IDENTIFY_ID)),rt=parseInt(D(s.LAST_SEQUENCE_NUMBER)),dt=function(st){return c(T)==="object"&&T[st]};y.options.deviceId=dt("deviceId")||G,y.options.userId=dt("userId")||tt,y._sessionId=dt("sessionId")||Tt||y._sessionId,y._lastEventTime=dt("lastEventTime")||Yt||y._lastEventTime,y._eventId=dt("eventId")||ve||y._eventId,y._identifyId=dt("identifyId")||ue||y._identifyId,y._sequenceNumber=dt("sequenceNumber")||rt||y._sequenceNumber,y.options.optOut=it||!1,T&&T.optOut!==void 0&&T.optOut!==null&&(y.options.optOut=String(T.optOut)==="true"),zi(y)}},Lu=function(y){var T=y.cookieStorage.get(y.options.cookieName+y._storageSuffix);if(c(T)==="object")Mp(y,T);else{var D=y.cookieStorage.get(y.options.cookieName+y._legacyStorageSuffix);c(D)==="object"&&(y.cookieStorage.remove(y.options.cookieName+y._legacyStorageSuffix),Mp(y,D))}},Mp=function(y,T){T.deviceId&&(y.options.deviceId=T.deviceId),T.userId&&(y.options.userId=T.userId),T.optOut!==null&&T.optOut!==void 0&&T.optOut!==!1&&(y.options.optOut=T.optOut),T.sessionId&&(y._sessionId=parseInt(T.sessionId)),T.lastEventTime&&(y._lastEventTime=parseInt(T.lastEventTime)),T.eventId&&(y._eventId=parseInt(T.eventId)),T.identifyId&&(y._identifyId=parseInt(T.identifyId)),T.sequenceNumber&&(y._sequenceNumber=parseInt(T.sequenceNumber))},zi=function(y){var T={deviceId:y.options.deviceId,userId:y.options.userId,optOut:y.options.optOut,sessionId:y._sessionId,lastEventTime:y._lastEventTime,eventId:y._eventId,identifyId:y._identifyId,sequenceNumber:y._sequenceNumber};y.cookieStorage.set(y.options.cookieName+y._storageSuffix,T)};Ct.prototype._initUtmData=function(y,T){y=y||this._getUrlParams(),T=T||this.cookieStorage.get("__utmz");var D=Ce(T,y);Mu(this,D)},Ct.prototype._unsetUTMParams=function(){var y=new ce;y.unset(s.REFERRER),y.unset(s.UTM_SOURCE),y.unset(s.UTM_MEDIUM),y.unset(s.UTM_CAMPAIGN),y.unset(s.UTM_TERM),y.unset(s.UTM_CONTENT),this.identify(y)};var Mu=function(y,T){if(!(c(T)!=="object"||Object.keys(T).length===0)){var D=new ce;for(var V in T)T.hasOwnProperty(V)&&(D.setOnce("initial_"+V,T[V]),D.set(V,T[V]));y.identify(D)}};Ct.prototype._getReferrer=function(){return document.referrer},Ct.prototype._getUrlParams=function(){return location.search},Ct.prototype._saveGclid=function(y){var T=E.getQueryParam("gclid",y);if(!E.isEmptyString(T)){var D={gclid:T};Mu(this,D)}},Ct.prototype._getDeviceIdFromUrlParam=function(y){return E.getQueryParam(s.AMP_DEVICE_ID_PARAM,y)},Ct.prototype._getReferringDomain=function(y){if(E.isEmptyString(y))return null;var T=y.split("/");return T.length>=3?T[2]:null},Ct.prototype._saveReferrer=function(y){if(!E.isEmptyString(y)){var T={referrer:y,referring_domain:this._getReferringDomain(y)};Mu(this,T)}},Ct.prototype.saveEvents=function(){try{Vi||this._setInStorage(Bt,this.options.unsentKey,JSON.stringify(this._unsentEvents))}catch{}try{Vi||this._setInStorage(Bt,this.options.unsentIdentifyKey,JSON.stringify(this._unsentIdentifys))}catch{}},Ct.prototype.setDomain=function(y){if(this._shouldDeferCall())return this._q.push(["setDomain"].concat(Array.prototype.slice.call(arguments,0)));if(E.validateInput(y,"domain","string"))try{this.cookieStorage.options({expirationDays:this.options.cookieExpiration,secure:this.options.secureCookie,domain:y,sameSite:this.options.sameSiteCookie}),this.options.domain=this.cookieStorage.options().domain,Lu(this),zi(this)}catch(T){E.log.error(T)}},Ct.prototype.setUserId=function(y){if(this._shouldDeferCall())return this._q.push(["setUserId"].concat(Array.prototype.slice.call(arguments,0)));try{this.options.userId=y!=null&&""+y||null,zi(this)}catch(T){E.log.error(T)}},Ct.prototype.setGroup=function(I,y){if(this._shouldDeferCall())return this._q.push(["setGroup"].concat(Array.prototype.slice.call(arguments,0)));if(!(!this._apiKeySet("setGroup()")||!E.validateInput(I,"groupType","string")||E.isEmptyString(I))){var T={};T[I]=y;var D=new ce().set(I,y);this._logEvent(s.IDENTIFY_EVENT,null,null,D.userPropertiesOperations,T,null,null,null)}},Ct.prototype.setOptOut=function(y){if(this._shouldDeferCall())return this._q.push(["setOptOut"].concat(Array.prototype.slice.call(arguments,0)));if(E.validateInput(y,"enable","boolean"))try{this.options.optOut=y,zi(this)}catch(T){E.log.error(T)}},Ct.prototype.setSessionId=function(y){if(E.validateInput(y,"sessionId","number"))try{this._sessionId=y,zi(this)}catch(T){E.log.error(T)}},Ct.prototype.resetSessionId=function(){this.setSessionId(new Date().getTime())},Ct.prototype.regenerateDeviceId=function(){if(this._shouldDeferCall())return this._q.push(["regenerateDeviceId"].concat(Array.prototype.slice.call(arguments,0)));this.setDeviceId(Iu()+"R")},Ct.prototype.setDeviceId=function(y){if(this._shouldDeferCall())return this._q.push(["setDeviceId"].concat(Array.prototype.slice.call(arguments,0)));if(E.validateInput(y,"deviceId","string"))try{E.isEmptyString(y)||(this.options.deviceId=""+y,zi(this))}catch(T){E.log.error(T)}},Ct.prototype.setUserProperties=function(y){if(this._shouldDeferCall())return this._q.push(["setUserProperties"].concat(Array.prototype.slice.call(arguments,0)));if(!(!this._apiKeySet("setUserProperties()")||!E.validateInput(y,"userProperties","object"))){var T=E.truncate(E.validateProperties(y));if(Object.keys(T).length!==0){var D=new ce;for(var V in T)T.hasOwnProperty(V)&&D.set(V,T[V]);this.identify(D)}}},Ct.prototype.clearUserProperties=function(){if(this._shouldDeferCall())return this._q.push(["clearUserProperties"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("clearUserProperties()")){var y=new ce;y.clearAll(),this.identify(y)}};var Du=function(y,T){for(var D=0;D<T._q.length;D++){var V=y[T._q[D][0]];c(V)==="function"&&V.apply(y,T._q[D].slice(1))}return y};Ct.prototype.identify=function(I,y){if(this._shouldDeferCall())return this._q.push(["identify"].concat(Array.prototype.slice.call(arguments,0)));if(!this._apiKeySet("identify()")){c(y)==="function"&&y(0,"No request sent",{reason:"API key is not set"});return}if(c(I)==="object"&&I.hasOwnProperty("_q")&&(I=Du(new ce,I)),I instanceof ce){if(Object.keys(I.userPropertiesOperations).length>0)return this._logEvent(s.IDENTIFY_EVENT,null,null,I.userPropertiesOperations,null,null,null,y);c(y)==="function"&&y(0,"No request sent",{reason:"No user property operations"})}else E.log.error("Invalid identify input type. Expected Identify object but saw "+c(I)),c(y)==="function"&&y(0,"No request sent",{reason:"Invalid identify input type"})},Ct.prototype.groupIdentify=function(I,y,T,D){if(this._shouldDeferCall())return this._q.push(["groupIdentify"].concat(Array.prototype.slice.call(arguments,0)));if(!this._apiKeySet("groupIdentify()")){c(D)==="function"&&D(0,"No request sent",{reason:"API key is not set"});return}if(!E.validateInput(I,"group_type","string")||E.isEmptyString(I)){c(D)==="function"&&D(0,"No request sent",{reason:"Invalid group type"});return}if(y==null){c(D)==="function"&&D(0,"No request sent",{reason:"Invalid group name"});return}if(c(T)==="object"&&T.hasOwnProperty("_q")&&(T=Du(new ce,T)),T instanceof ce){if(Object.keys(T.userPropertiesOperations).length>0)return this._logEvent(s.GROUP_IDENTIFY_EVENT,null,null,null,i({},I,y),T.userPropertiesOperations,null,D);c(D)==="function"&&D(0,"No request sent",{reason:"No group property operations"})}else E.log.error("Invalid identify input type. Expected Identify object but saw "+c(T)),c(D)==="function"&&D(0,"No request sent",{reason:"Invalid identify input type"})},Ct.prototype.setVersionName=function(y){if(this._shouldDeferCall())return this._q.push(["setVersionName"].concat(Array.prototype.slice.call(arguments,0)));E.validateInput(y,"versionName","string")&&(this.options.versionName=y)},Ct.prototype._logEvent=function(y,T,D,V,G,tt,it,Tt){if(Lu(this),!y){c(Tt)==="function"&&Tt(0,"No request sent",{reason:"Missing eventType"});return}if(this.options.optOut){c(Tt)==="function"&&Tt(0,"No request sent",{reason:"optOut is set to true"});return}try{var Yt;y===s.IDENTIFY_EVENT||y===s.GROUP_IDENTIFY_EVENT?Yt=this.nextIdentifyId():Yt=this.nextEventId();var ve=this.nextSequenceNumber(),ue=c(it)==="number"?it:new Date().getTime();(!this._sessionId||!this._lastEventTime||ue-this._lastEventTime>this.options.sessionTimeout)&&(this._sessionId=ue),this._lastEventTime=ue,zi(this);var rt=this._ua.browser.name,dt=this._ua.browser.major,ct=this._ua.device.model,st=this._ua.device.vendor,yt,Fn;V=V||{};var Vn=r({},this._apiPropertiesTrackingOptions);D=r({},D||{},Vn),T=T||{},G=G||{},tt=tt||{};var he={device_id:this.options.deviceId,user_id:this.options.userId,timestamp:ue,event_id:Yt,session_id:this._sessionId||-1,event_type:y,version_name:Ui(this,"version_name")&&(this.options.versionName||yt)||null,platform:Ui(this,"platform")?this.options.platform:null,os_name:Ui(this,"os_name")&&rt||null,os_version:Ui(this,"os_version")&&dt||null,device_model:Ui(this,"device_model")&&ct||null,device_manufacturer:Ui(this,"device_manufacturer")&&st||null,language:Ui(this,"language")?this.options.language:null,carrier:Ui(this,"carrier")&&Fn||null,api_properties:D,event_properties:E.truncate(E.validateProperties(T)),user_properties:E.truncate(E.validateProperties(V)),uuid:Iu(),library:{name:"amplitude-js",version:Ou},sequence_number:ve,groups:E.truncate(E.validateGroups(G)),group_properties:E.truncate(E.validateProperties(tt)),user_agent:this._userAgent};return y===s.IDENTIFY_EVENT||y===s.GROUP_IDENTIFY_EVENT?(this._unsentIdentifys.push(he),this._limitEventsQueued(this._unsentIdentifys)):(this._unsentEvents.push(he),this._limitEventsQueued(this._unsentEvents)),this.options.saveEvents&&this.saveEvents(),!this._sendEventsIfReady(Tt)&&c(Tt)==="function"&&Tt(0,"No request sent",{reason:"No events to send or upload queued"}),Yt}catch(Vt){E.log.error(Vt)}};var Ui=function(y,T){return!!y.options.trackingOptions[T]},fS=function(y){for(var T=["city","country","dma","ip_address","region"],D={},V=0;V<T.length;V++){var G=T[V];Ui(y,G)||(D[G]=!1)}return D};Ct.prototype._limitEventsQueued=function(y){y.length>this.options.savedMaxCount&&y.splice(0,y.length-this.options.savedMaxCount)},Ct.prototype.logEvent=function(y,T,D){return this._shouldDeferCall()?this._q.push(["logEvent"].concat(Array.prototype.slice.call(arguments,0))):this.logEventWithTimestamp(y,T,null,D)},Ct.prototype.logEventWithTimestamp=function(y,T,D,V){return this._shouldDeferCall()?this._q.push(["logEventWithTimestamp"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logEvent()")?E.validateInput(y,"eventType","string")?E.isEmptyString(y)?(c(V)==="function"&&V(0,"No request sent",{reason:"Missing eventType"}),-1):this._logEvent(y,T,null,null,null,null,D,V):(c(V)==="function"&&V(0,"No request sent",{reason:"Invalid type for eventType"}),-1):(c(V)==="function"&&V(0,"No request sent",{reason:"API key not set"}),-1)},Ct.prototype.logEventWithGroups=function(I,y,T,D){return this._shouldDeferCall()?this._q.push(["logEventWithGroups"].concat(Array.prototype.slice.call(arguments,0))):this._apiKeySet("logEventWithGroups()")?E.validateInput(I,"eventType","string")?this._logEvent(I,y,null,null,T,null,null,D):(c(D)==="function"&&D(0,"No request sent",{reason:"Invalid type for eventType"}),-1):(c(D)==="function"&&D(0,"No request sent",{reason:"API key not set"}),-1)};var Dp=function(y){return!isNaN(parseFloat(y))&&isFinite(y)};Ct.prototype.logRevenueV2=function(y){if(this._shouldDeferCall())return this._q.push(["logRevenueV2"].concat(Array.prototype.slice.call(arguments,0)));if(this._apiKeySet("logRevenueV2()"))if(c(y)==="object"&&y.hasOwnProperty("_q")&&(y=Du(new hi,y)),y instanceof hi){if(y&&y._isValidRevenue())return this.logEvent(s.REVENUE_EVENT,y._toJSONObject())}else E.log.error("Invalid revenue input type. Expected Revenue object but saw "+c(y))},Ct.prototype.logRevenue=function(y,T,D){return this._shouldDeferCall()?this._q.push(["logRevenue"].concat(Array.prototype.slice.call(arguments,0))):!this._apiKeySet("logRevenue()")||!Dp(y)||T!==void 0&&!Dp(T)?-1:this._logEvent(s.REVENUE_EVENT,{},{productId:D,special:"revenue_amount",quantity:T||1,price:y},null,null,null,null,null)},Ct.prototype.removeEvents=function(y,T){Np(this,"_unsentEvents",y),Np(this,"_unsentIdentifys",T)};var Np=function(y,T,D){if(!(D<0)){for(var V=[],G=0;G<y[T].length;G++)y[T][G].event_id>D&&V.push(y[T][G]);y[T]=V}};Ct.prototype.sendEvents=function(y){if(!this._apiKeySet("sendEvents()")){c(y)==="function"&&y(0,"No request sent",{reason:"API key not set"});return}if(this.options.optOut){c(y)==="function"&&y(0,"No request sent",{reason:"optOut is set to true"});return}if(this._unsentCount()===0){c(y)==="function"&&y(0,"No request sent",{reason:"No events to send"});return}if(this._sending){c(y)==="function"&&y(0,"No request sent",{reason:"Request already in progress. Events will be sent once this request is complete"});return}this._sending=!0;var T=this.options.forceHttps||window.location.protocol==="https:"?"https":"http",D=T+"://"+this.options.apiEndpoint,V=Math.min(this._unsentCount(),this.options.uploadBatchSize),G=this._mergeEventsAndIdentifys(V),tt=G.maxEventId,it=G.maxIdentifyId,Tt=JSON.stringify(G.eventsToSend),Yt=new Date().getTime(),ve={client:this.options.apiKey,e:Tt,v:s.API_VERSION,upload_time:Yt,checksum:Ja(s.API_VERSION+this.options.apiKey+Tt+Yt)},ue=this;new kp(D,ve).send(function(rt,dt){ue._sending=!1;try{rt===200&&dt==="success"?(ue.removeEvents(tt,it),ue.options.saveEvents&&ue.saveEvents(),!ue._sendEventsIfReady(y)&&c(y)==="function"&&y(rt,dt)):rt===413?(ue.options.uploadBatchSize===1&&ue.removeEvents(tt,it),ue.options.uploadBatchSize=Math.ceil(V/2),ue.sendEvents(y)):c(y)==="function"&&y(rt,dt)}catch{}})},Ct.prototype._mergeEventsAndIdentifys=function(y){for(var T=[],D=0,V=-1,G=0,tt=-1;T.length<y;){var it,Tt=G>=this._unsentIdentifys.length,Yt=D>=this._unsentEvents.length;if(Yt&&Tt){E.log.error("Merging Events and Identifys, less events and identifys than expected");break}else Tt?(it=this._unsentEvents[D++],V=it.event_id):Yt?(it=this._unsentIdentifys[G++],tt=it.event_id):!("sequence_number"in this._unsentEvents[D])||this._unsentEvents[D].sequence_number<this._unsentIdentifys[G].sequence_number?(it=this._unsentEvents[D++],V=it.event_id):(it=this._unsentIdentifys[G++],tt=it.event_id);T.push(it)}return{eventsToSend:T,maxEventId:V,maxIdentifyId:tt}},Ct.prototype.setGlobalUserProperties=function(y){this.setUserProperties(y)},Ct.prototype.__VERSION__=Ou,Ct.prototype._shouldDeferCall=function(){return this._pendingReadStorage||this._initializationDeferred},Ct.prototype._deferInitialization=function(){this._initializationDeferred=!0,this._q.push(["init"].concat(Array.prototype.slice.call(arguments,0)))},Ct.prototype.enableTracking=function(){this._initializationDeferred=!1,zi(this),this.runQueuedFunctions()};var ge=function(){this.options=r({},ku),this._q=[],this._instances={}};ge.prototype.Identify=ce,ge.prototype.Revenue=hi,ge.prototype.getInstance=function(y){y=E.isEmptyString(y)?s.DEFAULT_INSTANCE:y.toLowerCase();var T=this._instances[y];return T===void 0&&(T=new Ct(y),this._instances[y]=T),T},ge.prototype.runQueuedFunctions=function(){for(var I=0;I<this._q.length;I++){var y=this[this._q[I][0]];c(y)==="function"&&y.apply(this,this._q[I].slice(1))}this._q=[];for(var T in this._instances)this._instances.hasOwnProperty(T)&&this._instances[T].runQueuedFunctions()},ge.prototype.init=function(y,T,D,V){this.getInstance().init(y,T,D,(function(G){this.options=G.options,c(V)==="function"&&V(G)}).bind(this))},ge.prototype.isNewSession=function(){return this.getInstance().isNewSession()},ge.prototype.getSessionId=function(){return this.getInstance().getSessionId()},ge.prototype.nextEventId=function(){return this.getInstance().nextEventId()},ge.prototype.nextIdentifyId=function(){return this.getInstance().nextIdentifyId()},ge.prototype.nextSequenceNumber=function(){return this.getInstance().nextSequenceNumber()},ge.prototype.saveEvents=function(){this.getInstance().saveEvents()},ge.prototype.setDomain=function(y){this.getInstance().setDomain(y)},ge.prototype.setUserId=function(y){this.getInstance().setUserId(y)},ge.prototype.setGroup=function(I,y){this.getInstance().setGroup(I,y)},ge.prototype.setOptOut=function(y){this.getInstance().setOptOut(y)},ge.prototype.regenerateDeviceId=function(){this.getInstance().regenerateDeviceId()},ge.prototype.setDeviceId=function(y){this.getInstance().setDeviceId(y)},ge.prototype.setUserProperties=function(y){this.getInstance().setUserProperties(y)},ge.prototype.clearUserProperties=function(){this.getInstance().clearUserProperties()},ge.prototype.identify=function(I,y){this.getInstance().identify(I,y)},ge.prototype.setVersionName=function(y){this.getInstance().setVersionName(y)},ge.prototype.logEvent=function(y,T,D){return this.getInstance().logEvent(y,T,D)},ge.prototype.logEventWithGroups=function(I,y,T,D){return this.getInstance().logEventWithGroups(I,y,T,D)},ge.prototype.logRevenueV2=function(y){return this.getInstance().logRevenueV2(y)},ge.prototype.logRevenue=function(y,T,D){return this.getInstance().logRevenue(y,T,D)},ge.prototype.removeEvents=function(y,T){this.getInstance().removeEvents(y,T)},ge.prototype.sendEvents=function(y){this.getInstance().sendEvents(y)},ge.prototype.setGlobalUserProperties=function(y){this.getInstance().setUserProperties(y)},ge.prototype.__VERSION__=Ou;var ol=window.amplitude||{},al=new ge;al._q=ol._q||[];for(var Nu in ol._iq)ol._iq.hasOwnProperty(Nu)&&(al.getInstance(Nu)._q=ol._iq[Nu]._q||[]);return al.runQueuedFunctions(),al})})(Kw);var x7=Kw.exports;const Zw=xi(x7);function w7(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var _7=w7;const rv=xi(_7),Jw=Object.prototype.toString;function Qw(t){switch(Jw.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return as(t,Error)}}function Lo(t,e){return Jw.call(t)===`[object ${e}]`}function vp(t){return Lo(t,"ErrorEvent")}function sv(t){return Lo(t,"DOMError")}function S7(t){return Lo(t,"DOMException")}function rr(t){return Lo(t,"String")}function yp(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function bp(t){return t===null||yp(t)||typeof t!="object"&&typeof t!="function"}function ho(t){return Lo(t,"Object")}function bu(t){return typeof Event<"u"&&as(t,Event)}function E7(t){return typeof Element<"u"&&as(t,Element)}function T7(t){return Lo(t,"RegExp")}function xu(t){return!!(t&&t.then&&typeof t.then=="function")}function A7(t){return ho(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function C7(t){return typeof t=="number"&&t!==t}function as(t,e){try{return t instanceof e}catch{return!1}}function t_(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}function Js(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:`${t.slice(0,e)}...`}function ov(t,e){if(!Array.isArray(t))return"";const n=[];for(let i=0;i<t.length;i++){const r=t[i];try{t_(r)?n.push("[VueViewModel]"):n.push(String(r))}catch{n.push("[value cannot be serialized]")}}return n.join(e)}function P7(t,e,n=!1){return rr(t)?T7(e)?e.test(t):rr(e)?n?t===e:t.includes(e):!1:!1}function wu(t,e=[],n=!1){return e.some(i=>P7(t,i,n))}function I7(t,e,n=250,i,r,s,o){if(!s.exception||!s.exception.values||!o||!as(o.originalException,Error))return;const a=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;a&&(s.exception.values=O7(od(t,e,r,o.originalException,i,s.exception.values,a,0),n))}function od(t,e,n,i,r,s,o,a){if(s.length>=n+1)return s;let l=[...s];if(as(i[r],Error)){av(o,a);const c=t(e,i[r]),h=l.length;lv(c,r,h,a),l=od(t,e,n,i[r],r,[c,...l],c,h)}return Array.isArray(i.errors)&&i.errors.forEach((c,h)=>{if(as(c,Error)){av(o,a);const u=t(e,c),d=l.length;lv(u,`errors[${h}]`,d,a),l=od(t,e,n,c,r,[u,...l],u,d)}}),l}function av(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,is_exception_group:!0,exception_id:e}}function lv(t,e,n,i){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:n,parent_id:i}}function O7(t,e){return t.map(n=>(n.value&&(n.value=Js(n.value,e)),n))}function Ml(t){return t&&t.Math==Math?t:void 0}const pe=typeof globalThis=="object"&&Ml(globalThis)||typeof window=="object"&&Ml(window)||typeof self=="object"&&Ml(self)||typeof global=="object"&&Ml(global)||function(){return this}()||{};function xp(){return pe}function e_(t,e,n){const i=n||pe,r=i.__SENTRY__=i.__SENTRY__||{};return r[t]||(r[t]=e())}const wp=xp(),k7=80;function n_(t,e={}){if(!t)return"<unknown>";try{let n=t;const i=5,r=[];let s=0,o=0;const a=" > ",l=a.length;let c;const h=Array.isArray(e)?e:e.keyAttrs,u=!Array.isArray(e)&&e.maxStringLength||k7;for(;n&&s++<i&&(c=L7(n,h),!(c==="html"||s>1&&o+r.length*l+c.length>=u));)r.push(c),o+=c.length,n=n.parentNode;return r.reverse().join(a)}catch{return"<unknown>"}}function L7(t,e){const n=t,i=[];let r,s,o,a,l;if(!n||!n.tagName)return"";if(wp.HTMLElement&&n instanceof HTMLElement&&n.dataset&&n.dataset.sentryComponent)return n.dataset.sentryComponent;i.push(n.tagName.toLowerCase());const c=e&&e.length?e.filter(u=>n.getAttribute(u)).map(u=>[u,n.getAttribute(u)]):null;if(c&&c.length)c.forEach(u=>{i.push(`[${u[0]}="${u[1]}"]`)});else if(n.id&&i.push(`#${n.id}`),r=n.className,r&&rr(r))for(s=r.split(/\s+/),l=0;l<s.length;l++)i.push(`.${s[l]}`);const h=["aria-label","type","name","title","alt"];for(l=0;l<h.length;l++)o=h[l],a=n.getAttribute(o),a&&i.push(`[${o}="${a}"]`);return i.join("")}function M7(){try{return wp.document.location.href}catch{return""}}function D7(t){if(!wp.HTMLElement)return null;let e=t;const n=5;for(let i=0;i<n;i++){if(!e)return null;if(e instanceof HTMLElement&&e.dataset.sentryComponent)return e.dataset.sentryComponent;e=e.parentNode}return null}const Xa=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,N7="Sentry Logger ",ad=["debug","info","warn","error","log","assert","trace"],Ec={};function _s(t){if(!("console"in pe))return t();const e=pe.console,n={},i=Object.keys(Ec);i.forEach(r=>{const s=Ec[r];n[r]=e[r],e[r]=s});try{return t()}finally{i.forEach(r=>{e[r]=n[r]})}}function R7(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return Xa?ad.forEach(n=>{e[n]=(...i)=>{t&&_s(()=>{pe.console[n](`${N7}[${n}]:`,...i)})}}):ad.forEach(n=>{e[n]=()=>{}}),e}const Mt=R7(),$7=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function B7(t){return t==="http"||t==="https"}function qa(t,e=!1){const{host:n,path:i,pass:r,port:s,projectId:o,protocol:a,publicKey:l}=t;return`${a}://${l}${e&&r?`:${r}`:""}@${n}${s?`:${s}`:""}/${i&&`${i}/`}${o}`}function F7(t){const e=$7.exec(t);if(!e){_s(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}const[n,i,r="",s,o="",a]=e.slice(1);let l="",c=a;const h=c.split("/");if(h.length>1&&(l=h.slice(0,-1).join("/"),c=h.pop()),c){const u=c.match(/^\d+/);u&&(c=u[0])}return i_({host:s,pass:r,path:l,projectId:c,port:o,protocol:n,publicKey:i})}function i_(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function V7(t){if(!Xa)return!0;const{port:e,projectId:n,protocol:i}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:(Mt.error(`Invalid Sentry Dsn: ${o} missing`),!0))?!1:n.match(/^\d+$/)?B7(i)?e&&isNaN(parseInt(e,10))?(Mt.error(`Invalid Sentry Dsn: Invalid port ${e}`),!1):!0:(Mt.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),!1):(Mt.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1)}function z7(t){const e=typeof t=="string"?F7(t):i_(t);if(!(!e||!V7(e)))return e}class Pi extends Error{constructor(e,n="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=n}}function wn(t,e,n){if(!(e in t))return;const i=t[e],r=n(i);typeof r=="function"&&r_(r,i),t[e]=r}function ls(t,e,n){try{Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0})}catch{Xa&&Mt.log(`Failed to add non-enumerable property "${e}" to object`,t)}}function r_(t,e){try{const n=e.prototype||{};t.prototype=e.prototype=n,ls(t,"__sentry_original__",e)}catch{}}function _p(t){return t.__sentry_original__}function U7(t){return Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&")}function s_(t){if(Qw(t))return{message:t.message,name:t.name,stack:t.stack,...uv(t)};if(bu(t)){const e={type:t.type,target:cv(t.target),currentTarget:cv(t.currentTarget),...uv(t)};return typeof CustomEvent<"u"&&as(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function cv(t){try{return E7(t)?n_(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function uv(t){if(typeof t=="object"&&t!==null){const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}else return{}}function H7(t,e=40){const n=Object.keys(s_(t));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=e)return Js(n[0],e);for(let i=n.length;i>0;i--){const r=n.slice(0,i).join(", ");if(!(r.length>e))return i===n.length?r:Js(r,e)}return""}function Qi(t){return ld(t,new Map)}function ld(t,e){if(G7(t)){const n=e.get(t);if(n!==void 0)return n;const i={};e.set(t,i);for(const r of Object.keys(t))typeof t[r]<"u"&&(i[r]=ld(t[r],e));return i}if(Array.isArray(t)){const n=e.get(t);if(n!==void 0)return n;const i=[];return e.set(t,i),t.forEach(r=>{i.push(ld(r,e))}),i}return t}function G7(t){if(!ho(t))return!1;try{const e=Object.getPrototypeOf(t).constructor.name;return!e||e==="Object"}catch{return!0}}const o_=50,hv=/\(error: (.*)\)/,dv=/captureMessage|captureException/;function a_(...t){const e=t.sort((n,i)=>n[0]-i[0]).map(n=>n[1]);return(n,i=0)=>{const r=[],s=n.split(`
`);for(let o=i;o<s.length;o++){const a=s[o];if(a.length>1024)continue;const l=hv.test(a)?a.replace(hv,"$1"):a;if(!l.match(/\S*Error: /)){for(const c of e){const h=c(l);if(h){r.push(h);break}}if(r.length>=o_)break}}return W7(r)}}function j7(t){return Array.isArray(t)?a_(...t):t}function W7(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(e[e.length-1].function||"")&&e.pop(),e.reverse(),dv.test(e[e.length-1].function||"")&&(e.pop(),dv.test(e[e.length-1].function||"")&&e.pop()),e.slice(0,o_).map(n=>({...n,filename:n.filename||e[e.length-1].filename,function:n.function||"?"}))}const vh="<anonymous>";function Lr(t){try{return!t||typeof t!="function"?vh:t.name||vh}catch{return vh}}const Zl={},fv={};function Ss(t,e){Zl[t]=Zl[t]||[],Zl[t].push(e)}function Es(t,e){fv[t]||(e(),fv[t]=!0)}function vi(t,e){const n=t&&Zl[t];if(n)for(const i of n)try{i(e)}catch(r){Xa&&Mt.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${Lr(i)}
Error:`,r)}}function Y7(t){const e="console";Ss(e,t),Es(e,X7)}function X7(){"console"in pe&&ad.forEach(function(t){t in pe.console&&wn(pe.console,t,function(e){return Ec[t]=e,function(...n){vi("console",{args:n,level:t});const r=Ec[t];r&&r.apply(pe.console,n)}})})}function si(){const t=pe,e=t.crypto||t.msCrypto;let n=()=>Math.random()*16;try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(n=()=>{const i=new Uint8Array(1);return e.getRandomValues(i),i[0]})}catch{}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,i=>(i^(n()&15)>>i/4).toString(16))}function l_(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function Tr(t){const{message:e,event_id:n}=t;if(e)return e;const i=l_(t);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||n||"<unknown>":n||"<unknown>"}function cd(t,e,n){const i=t.exception=t.exception||{},r=i.values=i.values||[],s=r[0]=r[0]||{};s.value||(s.value=e||""),s.type||(s.type=n||"Error")}function Ta(t,e){const n=l_(t);if(!n)return;const i={type:"generic",handled:!0},r=n.mechanism;if(n.mechanism={...i,...r,...e},e&&"data"in e){const s={...r&&r.data,...e.data};n.mechanism.data=s}}function pv(t){if(t&&t.__sentry_captured__)return!0;try{ls(t,"__sentry_captured__",!0)}catch{}return!1}function Sp(t){return Array.isArray(t)?t:[t]}const Fs=pe,q7=1e3;let gv,ud,hd;function K7(t){const e="dom";Ss(e,t),Es(e,Z7)}function Z7(){if(!Fs.document)return;const t=vi.bind(null,"dom"),e=mv(t,!0);Fs.document.addEventListener("click",e,!1),Fs.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(n=>{const i=Fs[n]&&Fs[n].prototype;!i||!i.hasOwnProperty||!i.hasOwnProperty("addEventListener")||(wn(i,"addEventListener",function(r){return function(s,o,a){if(s==="click"||s=="keypress")try{const l=this,c=l.__sentry_instrumentation_handlers__=l.__sentry_instrumentation_handlers__||{},h=c[s]=c[s]||{refCount:0};if(!h.handler){const u=mv(t);h.handler=u,r.call(this,s,u,a)}h.refCount++}catch{}return r.call(this,s,o,a)}}),wn(i,"removeEventListener",function(r){return function(s,o,a){if(s==="click"||s=="keypress")try{const l=this,c=l.__sentry_instrumentation_handlers__||{},h=c[s];h&&(h.refCount--,h.refCount<=0&&(r.call(this,s,h.handler,a),h.handler=void 0,delete c[s]),Object.keys(c).length===0&&delete l.__sentry_instrumentation_handlers__)}catch{}return r.call(this,s,o,a)}}))})}function J7(t){if(t.type!==ud)return!1;try{if(!t.target||t.target._sentryId!==hd)return!1}catch{}return!0}function Q7(t,e){return t!=="keypress"?!1:!e||!e.tagName?!0:!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)}function mv(t,e=!1){return n=>{if(!n||n._sentryCaptured)return;const i=t9(n);if(Q7(n.type,i))return;ls(n,"_sentryCaptured",!0),i&&!i._sentryId&&ls(i,"_sentryId",si());const r=n.type==="keypress"?"input":n.type;J7(n)||(t({event:n,name:r,global:e}),ud=n.type,hd=i?i._sentryId:void 0),clearTimeout(gv),gv=Fs.setTimeout(()=>{hd=void 0,ud=void 0},q7)}}function t9(t){try{return t.target}catch{return null}}const dd=xp();function c_(){if(!("fetch"in dd))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function fd(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function e9(){if(typeof EdgeRuntime=="string")return!0;if(!c_())return!1;if(fd(dd.fetch))return!0;let t=!1;const e=dd.document;if(e&&typeof e.createElement=="function")try{const n=e.createElement("iframe");n.hidden=!0,e.head.appendChild(n),n.contentWindow&&n.contentWindow.fetch&&(t=fd(n.contentWindow.fetch)),e.head.removeChild(n)}catch(n){Xa&&Mt.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return t}function n9(t){const e="fetch";Ss(e,t),Es(e,i9)}function i9(){e9()&&wn(pe,"fetch",function(t){return function(...e){const{method:n,url:i}=r9(e),r={args:e,fetchData:{method:n,url:i},startTimestamp:Date.now()};return vi("fetch",{...r}),t.apply(pe,e).then(s=>{const o={...r,endTimestamp:Date.now(),response:s};return vi("fetch",o),s},s=>{const o={...r,endTimestamp:Date.now(),error:s};throw vi("fetch",o),s})}})}function pd(t,e){return!!t&&typeof t=="object"&&!!t[e]}function vv(t){return typeof t=="string"?t:t?pd(t,"url")?t.url:t.toString?t.toString():"":""}function r9(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[n,i]=t;return{url:vv(n),method:pd(i,"method")?String(i.method).toUpperCase():"GET"}}const e=t[0];return{url:vv(e),method:pd(e,"method")?String(e.method).toUpperCase():"GET"}}let Dl=null;function s9(t){const e="error";Ss(e,t),Es(e,o9)}function o9(){Dl=pe.onerror,pe.onerror=function(t,e,n,i,r){return vi("error",{column:i,error:r,line:n,msg:t,url:e}),Dl&&!Dl.__SENTRY_LOADER__?Dl.apply(this,arguments):!1},pe.onerror.__SENTRY_INSTRUMENTED__=!0}let Nl=null;function a9(t){const e="unhandledrejection";Ss(e,t),Es(e,l9)}function l9(){Nl=pe.onunhandledrejection,pe.onunhandledrejection=function(t){return vi("unhandledrejection",t),Nl&&!Nl.__SENTRY_LOADER__?Nl.apply(this,arguments):!0},pe.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}const Rl=xp();function c9(){const t=Rl.chrome,e=t&&t.app&&t.app.runtime,n="history"in Rl&&!!Rl.history.pushState&&!!Rl.history.replaceState;return!e&&n}const Zo=pe;let $l;function u_(t){const e="history";Ss(e,t),Es(e,u9)}function u9(){if(!c9())return;const t=Zo.onpopstate;Zo.onpopstate=function(...n){const i=Zo.location.href,r=$l;if($l=i,vi("history",{from:r,to:i}),t)try{return t.apply(this,n)}catch{}};function e(n){return function(...i){const r=i.length>2?i[2]:void 0;if(r){const s=$l,o=String(r);$l=o,vi("history",{from:s,to:o})}return n.apply(this,i)}}wn(Zo.history,"pushState",e),wn(Zo.history,"replaceState",e)}const h9=pe,ia="__sentry_xhr_v3__";function d9(t){const e="xhr";Ss(e,t),Es(e,f9)}function f9(){if(!h9.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;wn(t,"open",function(e){return function(...n){const i=Date.now(),r=rr(n[0])?n[0].toUpperCase():void 0,s=p9(n[1]);if(!r||!s)return e.apply(this,n);this[ia]={method:r,url:s,request_headers:{}},r==="POST"&&s.match(/sentry_key/)&&(this.__sentry_own_request__=!0);const o=()=>{const a=this[ia];if(a&&this.readyState===4){try{a.status_code=this.status}catch{}const l={args:[r,s],endTimestamp:Date.now(),startTimestamp:i,xhr:this};vi("xhr",l)}};return"onreadystatechange"in this&&typeof this.onreadystatechange=="function"?wn(this,"onreadystatechange",function(a){return function(...l){return o(),a.apply(this,l)}}):this.addEventListener("readystatechange",o),wn(this,"setRequestHeader",function(a){return function(...l){const[c,h]=l,u=this[ia];return u&&rr(c)&&rr(h)&&(u.request_headers[c.toLowerCase()]=h),a.apply(this,l)}}),e.apply(this,n)}}),wn(t,"send",function(e){return function(...n){const i=this[ia];if(!i)return e.apply(this,n);n[0]!==void 0&&(i.body=n[0]);const r={args:[i.method,i.url],startTimestamp:Date.now(),xhr:this};return vi("xhr",r),e.apply(this,n)}})}function p9(t){if(rr(t))return t;try{return t.toString()}catch{}}function g9(){return"npm"}function m9(){const t=typeof WeakSet=="function",e=t?new WeakSet:[];function n(r){if(t)return e.has(r)?!0:(e.add(r),!1);for(let s=0;s<e.length;s++)if(e[s]===r)return!0;return e.push(r),!1}function i(r){if(t)e.delete(r);else for(let s=0;s<e.length;s++)if(e[s]===r){e.splice(s,1);break}}return[n,i]}function wr(t,e=100,n=1/0){try{return gd("",t,e,n)}catch(i){return{ERROR:`**non-serializable** (${i})`}}}function h_(t,e=3,n=100*1024){const i=wr(t,e);return x9(i)>n?h_(t,e-1,n):i}function gd(t,e,n=1/0,i=1/0,r=m9()){const[s,o]=r;if(e==null||["number","boolean","string"].includes(typeof e)&&!C7(e))return e;const a=v9(t,e);if(!a.startsWith("[object "))return a;if(e.__sentry_skip_normalization__)return e;const l=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:n;if(l===0)return a.replace("object ","");if(s(e))return"[Circular ~]";const c=e;if(c&&typeof c.toJSON=="function")try{const f=c.toJSON();return gd("",f,l-1,i,r)}catch{}const h=Array.isArray(e)?[]:{};let u=0;const d=s_(e);for(const f in d){if(!Object.prototype.hasOwnProperty.call(d,f))continue;if(u>=i){h[f]="[MaxProperties ~]";break}const p=d[f];h[f]=gd(f,p,l-1,i,r),u++}return o(e),h}function v9(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(t_(e))return"[VueViewModel]";if(A7(e))return"[SyntheticEvent]";if(typeof e=="number"&&e!==e)return"[NaN]";if(typeof e=="function")return`[Function: ${Lr(e)}]`;if(typeof e=="symbol")return`[${String(e)}]`;if(typeof e=="bigint")return`[BigInt: ${String(e)}]`;const n=y9(e);return/^HTML(\w*)Element$/.test(n)?`[HTMLElement: ${n}]`:`[object ${n}]`}catch(n){return`**non-serializable** (${n})`}}function y9(t){const e=Object.getPrototypeOf(t);return e?e.constructor.name:"null prototype"}function b9(t){return~-encodeURI(t).split(/%..|./).length}function x9(t){return b9(JSON.stringify(t))}var Yi;(function(t){t[t.PENDING=0]="PENDING";const n=1;t[t.RESOLVED=n]="RESOLVED";const i=2;t[t.REJECTED=i]="REJECTED"})(Yi||(Yi={}));function fo(t){return new qn(e=>{e(t)})}function Ep(t){return new qn((e,n)=>{n(t)})}class qn{constructor(e){qn.prototype.__init.call(this),qn.prototype.__init2.call(this),qn.prototype.__init3.call(this),qn.prototype.__init4.call(this),this._state=Yi.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(n){this._reject(n)}}then(e,n){return new qn((i,r)=>{this._handlers.push([!1,s=>{if(!e)i(s);else try{i(e(s))}catch(o){r(o)}},s=>{if(!n)r(s);else try{i(n(s))}catch(o){r(o)}}]),this._executeHandlers()})}catch(e){return this.then(n=>n,e)}finally(e){return new qn((n,i)=>{let r,s;return this.then(o=>{s=!1,r=o,e&&e()},o=>{s=!0,r=o,e&&e()}).then(()=>{if(s){i(r);return}n(r)})})}__init(){this._resolve=e=>{this._setResult(Yi.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(Yi.REJECTED,e)}}__init3(){this._setResult=(e,n)=>{if(this._state===Yi.PENDING){if(xu(n)){n.then(this._resolve,this._reject);return}this._state=e,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===Yi.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(n=>{n[0]||(this._state===Yi.RESOLVED&&n[1](this._value),this._state===Yi.REJECTED&&n[2](this._value),n[0]=!0)})}}}function w9(t){const e=[];function n(){return t===void 0||e.length<t}function i(o){return e.splice(e.indexOf(o),1)[0]}function r(o){if(!n())return Ep(new Pi("Not adding Promise because buffer limit was reached."));const a=o();return e.indexOf(a)===-1&&e.push(a),a.then(()=>i(a)).then(null,()=>i(a).then(null,()=>{})),a}function s(o){return new qn((a,l)=>{let c=e.length;if(!c)return a(!0);const h=setTimeout(()=>{o&&o>0&&a(!1)},o);e.forEach(u=>{fo(u).then(()=>{--c||(clearTimeout(h),a(!0))},l)})})}return{$:e,add:r,drain:s}}function yh(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const n=e[6]||"",i=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:n,hash:i,relative:e[5]+n+i}}const _9=["fatal","error","warning","log","info","debug"];function S9(t){return t==="warn"?"warning":_9.includes(t)?t:"log"}const d_=1e3;function Ka(){return Date.now()/d_}function E9(){const{performance:t}=pe;if(!t||!t.now)return Ka;const e=Date.now()-t.now(),n=t.timeOrigin==null?e:t.timeOrigin;return()=>(n+t.now())/d_}const _u=E9();(()=>{const{performance:t}=pe;if(!t||!t.now)return;const e=3600*1e3,n=t.now(),i=Date.now(),r=t.timeOrigin?Math.abs(t.timeOrigin+n-i):e,s=r<e,o=t.timing&&t.timing.navigationStart,l=typeof o=="number"?Math.abs(o+n-i):e,c=l<e;return s||c?r<=l?t.timeOrigin:o:i})();function Mo(t,e=[]){return[t,e]}function T9(t,e){const[n,i]=t;return[n,[...i,e]]}function yv(t,e){const n=t[1];for(const i of n){const r=i[0].type;if(e(i,r))return!0}return!1}function md(t,e){return(e||new TextEncoder).encode(t)}function A9(t,e){const[n,i]=t;let r=JSON.stringify(n);function s(o){typeof r=="string"?r=typeof o=="string"?r+o:[md(r,e),o]:r.push(typeof o=="string"?md(o,e):o)}for(const o of i){const[a,l]=o;if(s(`
${JSON.stringify(a)}
`),typeof l=="string"||l instanceof Uint8Array)s(l);else{let c;try{c=JSON.stringify(l)}catch{c=JSON.stringify(wr(l))}s(c)}}return typeof r=="string"?r:C9(r)}function C9(t){const e=t.reduce((r,s)=>r+s.length,0),n=new Uint8Array(e);let i=0;for(const r of t)n.set(r,i),i+=r.length;return n}function P9(t,e){const n=typeof t.data=="string"?md(t.data,e):t.data;return[Qi({type:"attachment",length:n.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),n]}const I9={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",statsd:"unknown"};function bv(t){return I9[t]}function f_(t){if(!t||!t.sdk)return;const{name:e,version:n}=t.sdk;return{name:e,version:n}}function O9(t,e,n,i){const r=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!n&&i&&{dsn:qa(i)},...r&&{trace:Qi({...r})}}}function k9(t,e,n){const i=[{type:"client_report"},{timestamp:n||Ka(),discarded_events:t}];return Mo(e?{dsn:e}:{},[i])}const L9=60*1e3;function M9(t,e=Date.now()){const n=parseInt(`${t}`,10);if(!isNaN(n))return n*1e3;const i=Date.parse(`${t}`);return isNaN(i)?L9:i-e}function D9(t,e){return t[e]||t.all||0}function N9(t,e,n=Date.now()){return D9(t,e)>n}function R9(t,{statusCode:e,headers:n},i=Date.now()){const r={...t},s=n&&n["x-sentry-rate-limits"],o=n&&n["retry-after"];if(s)for(const a of s.trim().split(",")){const[l,c]=a.split(":",2),h=parseInt(l,10),u=(isNaN(h)?60:h)*1e3;if(!c)r.all=i+u;else for(const d of c.split(";"))r[d]=i+u}else o?r.all=i+M9(o,i):e===429&&(r.all=i+60*1e3);return r}const Oe=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Su="production";function Tp(){return e_("globalEventProcessors",()=>[])}function $9(t){Tp().push(t)}function Tc(t,e,n,i=0){return new qn((r,s)=>{const o=t[i];if(e===null||typeof o!="function")r(e);else{const a=o({...e},n);Oe&&o.id&&a===null&&Mt.log(`Event processor "${o.id}" dropped event`),xu(a)?a.then(l=>Tc(t,l,n,i+1).then(r)).then(null,s):Tc(t,a,n,i+1).then(r).then(null,s)}})}function p_(t){const e=_u(),n={sid:si(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>B9(n)};return t&&cs(n,t),n}function cs(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||_u(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:si()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did=`${e.did}`),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const n=t.timestamp-t.started;t.duration=n>=0?n:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function g_(t,e){let n={};e?n={status:e}:t.status==="ok"&&(n={status:"exited"}),cs(t,n)}function B9(t){return Qi({sid:`${t.sid}`,init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?`${t.did}`:void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}const F9=1;function V9(t){const{spanId:e,traceId:n}=t.spanContext(),{data:i,op:r,parent_span_id:s,status:o,tags:a,origin:l}=Aa(t);return Qi({data:i,op:r,parent_span_id:s,span_id:e,status:o,tags:a,trace_id:n,origin:l})}function z9(t){return typeof t=="number"?xv(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?xv(t.getTime()):_u()}function xv(t){return t>9999999999?t/1e3:t}function Aa(t){return U9(t)?t.getSpanJSON():typeof t.toJSON=="function"?t.toJSON():{}}function U9(t){return typeof t.getSpanJSON=="function"}function H9(t){const{traceFlags:e}=t.spanContext();return!!(e&F9)}function G9(t,e,n,i,r,s){const{normalizeDepth:o=3,normalizeMaxBreadth:a=1e3}=t,l={...e,event_id:e.event_id||n.event_id||si(),timestamp:e.timestamp||Ka()},c=n.integrations||t.integrations.map(v=>v.name);j9(l,t),X9(l,c),e.type===void 0&&W9(l,t.stackParser);const h=K9(i,n.captureContext);n.mechanism&&Ta(l,n.mechanism);const u=r&&r.getEventProcessors?r.getEventProcessors():[],d=cj().getScopeData();if(s){const v=s.getScopeData();Ev(d,v)}if(h){const v=h.getScopeData();Ev(d,v)}const f=[...n.attachments||[],...d.attachments];f.length&&(n.attachments=f),w_(l,d);const p=[...u,...Tp(),...d.eventProcessors];return Tc(p,l,n).then(v=>(v&&Y9(v),typeof o=="number"&&o>0?q9(v,o,a):v))}function j9(t,e){const{environment:n,release:i,dist:r,maxValueLength:s=250}=e;"environment"in t||(t.environment="environment"in e?n:Su),t.release===void 0&&i!==void 0&&(t.release=i),t.dist===void 0&&r!==void 0&&(t.dist=r),t.message&&(t.message=Js(t.message,s));const o=t.exception&&t.exception.values&&t.exception.values[0];o&&o.value&&(o.value=Js(o.value,s));const a=t.request;a&&a.url&&(a.url=Js(a.url,s))}const wv=new WeakMap;function W9(t,e){const n=pe._sentryDebugIds;if(!n)return;let i;const r=wv.get(e);r?i=r:(i=new Map,wv.set(e,i));const s=Object.keys(n).reduce((o,a)=>{let l;const c=i.get(a);c?l=c:(l=e(a),i.set(a,l));for(let h=l.length-1;h>=0;h--){const u=l[h];if(u.filename){o[u.filename]=n[a];break}}return o},{});try{t.exception.values.forEach(o=>{o.stacktrace.frames.forEach(a=>{a.filename&&(a.debug_id=s[a.filename])})})}catch{}}function Y9(t){const e={};try{t.exception.values.forEach(i=>{i.stacktrace.frames.forEach(r=>{r.debug_id&&(r.abs_path?e[r.abs_path]=r.debug_id:r.filename&&(e[r.filename]=r.debug_id),delete r.debug_id)})})}catch{}if(Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const n=t.debug_meta.images;Object.keys(e).forEach(i=>{n.push({type:"sourcemap",code_file:i,debug_id:e[i]})})}function X9(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function q9(t,e,n){if(!t)return null;const i={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(r=>({...r,...r.data&&{data:wr(r.data,e,n)}}))},...t.user&&{user:wr(t.user,e,n)},...t.contexts&&{contexts:wr(t.contexts,e,n)},...t.extra&&{extra:wr(t.extra,e,n)}};return t.contexts&&t.contexts.trace&&i.contexts&&(i.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(i.contexts.trace.data=wr(t.contexts.trace.data,e,n))),t.spans&&(i.spans=t.spans.map(r=>{const s=Aa(r).data;return s&&(r.data=wr(s,e,n)),r})),i}function K9(t,e){if(!e)return t;const n=t?t.clone():new Ii;return n.update(e),n}function Z9(t){if(t)return J9(t)?{captureContext:t}:tj(t)?{captureContext:t}:t}function J9(t){return t instanceof Ii||typeof t=="function"}const Q9=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];function tj(t){return Object.keys(t).some(e=>Q9.includes(e))}function Ap(t,e){return Bi().captureException(t,Z9(e))}function m_(t,e){return Bi().captureEvent(t,e)}function us(t,e){Bi().addBreadcrumb(t,e)}function ej(...t){const e=Bi();if(t.length===2){const[n,i]=t;return n?e.withScope(()=>(e.getStackTop().scope=n,i(n))):e.withScope(i)}return e.withScope(t[0])}function Bn(){return Bi().getClient()}function Ts(){return Bi().getScope()}function _v(t){const e=Bn(),n=Za(),i=Ts(),{release:r,environment:s=Su}=e&&e.getOptions()||{},{userAgent:o}=pe.navigator||{},a=p_({release:r,environment:s,user:i.getUser()||n.getUser(),...o&&{userAgent:o},...t}),l=n.getSession();return l&&l.status==="ok"&&cs(l,{status:"exited"}),v_(),n.setSession(a),i.setSession(a),a}function v_(){const t=Za(),e=Ts(),n=e.getSession()||t.getSession();n&&g_(n),y_(),t.setSession(),e.setSession()}function y_(){const t=Za(),e=Ts(),n=Bn(),i=e.getSession()||t.getSession();i&&n&&n.captureSession&&n.captureSession(i)}function Sv(t=!1){if(t){v_();return}y_()}function b_(t){return t.transaction}function x_(t,e,n){const i=e.getOptions(),{publicKey:r}=e.getDsn()||{},{segment:s}=n&&n.getUser()||{},o=Qi({environment:i.environment||Su,release:i.release,user_segment:s,public_key:r,trace_id:t});return e.emit&&e.emit("createDsc",o),o}function nj(t){const e=Bn();if(!e)return{};const n=x_(Aa(t).trace_id||"",e,Ts()),i=b_(t);if(!i)return n;const r=i&&i._frozenDynamicSamplingContext;if(r)return r;const{sampleRate:s,source:o}=i.metadata;s!=null&&(n.sample_rate=`${s}`);const a=Aa(i);return o&&o!=="url"&&(n.transaction=a.description),n.sampled=String(H9(i)),e.emit&&e.emit("createDsc",n),n}function w_(t,e){const{fingerprint:n,span:i,breadcrumbs:r,sdkProcessingMetadata:s}=e;ij(t,e),i&&oj(t,i),aj(t,n),rj(t,r),sj(t,s)}function Ev(t,e){const{extra:n,tags:i,user:r,contexts:s,level:o,sdkProcessingMetadata:a,breadcrumbs:l,fingerprint:c,eventProcessors:h,attachments:u,propagationContext:d,transactionName:f,span:p}=e;Jo(t,"extra",n),Jo(t,"tags",i),Jo(t,"user",r),Jo(t,"contexts",s),Jo(t,"sdkProcessingMetadata",a),o&&(t.level=o),f&&(t.transactionName=f),p&&(t.span=p),l.length&&(t.breadcrumbs=[...t.breadcrumbs,...l]),c.length&&(t.fingerprint=[...t.fingerprint,...c]),h.length&&(t.eventProcessors=[...t.eventProcessors,...h]),u.length&&(t.attachments=[...t.attachments,...u]),t.propagationContext={...t.propagationContext,...d}}function Jo(t,e,n){if(n&&Object.keys(n).length){t[e]={...t[e]};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[e][i]=n[i])}}function ij(t,e){const{extra:n,tags:i,user:r,contexts:s,level:o,transactionName:a}=e,l=Qi(n);l&&Object.keys(l).length&&(t.extra={...l,...t.extra});const c=Qi(i);c&&Object.keys(c).length&&(t.tags={...c,...t.tags});const h=Qi(r);h&&Object.keys(h).length&&(t.user={...h,...t.user});const u=Qi(s);u&&Object.keys(u).length&&(t.contexts={...u,...t.contexts}),o&&(t.level=o),a&&(t.transaction=a)}function rj(t,e){const n=[...t.breadcrumbs||[],...e];t.breadcrumbs=n.length?n:void 0}function sj(t,e){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e}}function oj(t,e){t.contexts={trace:V9(e),...t.contexts};const n=b_(e);if(n){t.sdkProcessingMetadata={dynamicSamplingContext:nj(e),...t.sdkProcessingMetadata};const i=Aa(n).description;i&&(t.tags={transaction:i,...t.tags})}}function aj(t,e){t.fingerprint=t.fingerprint?Sp(t.fingerprint):[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}const lj=100;let bh;class Ii{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=Tv()}static clone(e){return e?e.clone():new Ii}clone(){const e=new Ii;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._span=this._span,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e}setClient(e){this._client=e}getClient(){return this._client}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&cs(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,n){return this._tags={...this._tags,[e]:n},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,n){return this._extra={...this._extra,[e]:n},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,n){return n===null?delete this._contexts[e]:this._contexts[e]=n,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){const e=this._span;return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;if(typeof e=="function"){const n=e(this);return n instanceof Ii?n:this}return e instanceof Ii?(this._tags={...this._tags,...e._tags},this._extra={...this._extra,...e._extra},this._contexts={...this._contexts,...e._contexts},e._user&&Object.keys(e._user).length&&(this._user=e._user),e._level&&(this._level=e._level),e._fingerprint&&(this._fingerprint=e._fingerprint),e._requestSession&&(this._requestSession=e._requestSession),e._propagationContext&&(this._propagationContext=e._propagationContext)):ho(e)&&(e=e,this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession),e.propagationContext&&(this._propagationContext=e.propagationContext)),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=Tv(),this}addBreadcrumb(e,n){const i=typeof n=="number"?n:lj;if(i<=0)return this;const r={timestamp:Ka(),...e},s=this._breadcrumbs;return s.push(r),this._breadcrumbs=s.length>i?s.slice(-i):s,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){const{_breadcrumbs:e,_attachments:n,_contexts:i,_tags:r,_extra:s,_user:o,_level:a,_fingerprint:l,_eventProcessors:c,_propagationContext:h,_sdkProcessingMetadata:u,_transactionName:d,_span:f}=this;return{breadcrumbs:e,attachments:n,contexts:i,tags:r,extra:s,user:o,level:a,fingerprint:l||[],eventProcessors:c,propagationContext:h,sdkProcessingMetadata:u,transactionName:d,span:f}}applyToEvent(e,n={},i=[]){w_(e,this.getScopeData());const r=[...i,...Tp(),...this._eventProcessors];return Tc(r,e,n)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,n){const i=n&&n.event_id?n.event_id:si();if(!this._client)return Mt.warn("No client configured on scope - will not capture exception!"),i;const r=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:r,...n,event_id:i},this),i}captureMessage(e,n,i){const r=i&&i.event_id?i.event_id:si();if(!this._client)return Mt.warn("No client configured on scope - will not capture message!"),r;const s=new Error(e);return this._client.captureMessage(e,n,{originalException:e,syntheticException:s,...i,event_id:r},this),r}captureEvent(e,n){const i=n&&n.event_id?n.event_id:si();return this._client?(this._client.captureEvent(e,{...n,event_id:i},this),i):(Mt.warn("No client configured on scope - will not capture event!"),i)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function cj(){return bh||(bh=new Ii),bh}function Tv(){return{traceId:si(),spanId:si().substring(16)}}const Ca="7.101.1",__=parseFloat(Ca),uj=100;class S_{constructor(e,n,i,r=__){this._version=r;let s;n?s=n:(s=new Ii,s.setClient(e));let o;i?o=i:(o=new Ii,o.setClient(e)),this._stack=[{scope:s}],e&&this.bindClient(e),this._isolationScope=o}isOlderThan(e){return this._version<e}bindClient(e){const n=this.getStackTop();n.client=e,n.scope.setClient(e),e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){const e=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return this.getStack().length<=1?!1:!!this.getStack().pop()}withScope(e){const n=this.pushScope();let i;try{i=e(n)}catch(r){throw this.popScope(),r}return xu(i)?i.then(r=>(this.popScope(),r),r=>{throw this.popScope(),r}):(this.popScope(),i)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,n){const i=this._lastEventId=n&&n.event_id?n.event_id:si(),r=new Error("Sentry syntheticException");return this.getScope().captureException(e,{originalException:e,syntheticException:r,...n,event_id:i}),i}captureMessage(e,n,i){const r=this._lastEventId=i&&i.event_id?i.event_id:si(),s=new Error(e);return this.getScope().captureMessage(e,n,{originalException:e,syntheticException:s,...i,event_id:r}),r}captureEvent(e,n){const i=n&&n.event_id?n.event_id:si();return e.type||(this._lastEventId=i),this.getScope().captureEvent(e,{...n,event_id:i}),i}lastEventId(){return this._lastEventId}addBreadcrumb(e,n){const{scope:i,client:r}=this.getStackTop();if(!r)return;const{beforeBreadcrumb:s=null,maxBreadcrumbs:o=uj}=r.getOptions&&r.getOptions()||{};if(o<=0)return;const l={timestamp:Ka(),...e},c=s?_s(()=>s(l,n)):l;c!==null&&(r.emit&&r.emit("beforeAddBreadcrumb",c,n),i.addBreadcrumb(c,o))}setUser(e){this.getScope().setUser(e),this.getIsolationScope().setUser(e)}setTags(e){this.getScope().setTags(e),this.getIsolationScope().setTags(e)}setExtras(e){this.getScope().setExtras(e),this.getIsolationScope().setExtras(e)}setTag(e,n){this.getScope().setTag(e,n),this.getIsolationScope().setTag(e,n)}setExtra(e,n){this.getScope().setExtra(e,n),this.getIsolationScope().setExtra(e,n)}setContext(e,n){this.getScope().setContext(e,n),this.getIsolationScope().setContext(e,n)}configureScope(e){const{scope:n,client:i}=this.getStackTop();i&&e(n)}run(e){const n=Av(this);try{e(this)}finally{Av(n)}}getIntegration(e){const n=this.getClient();if(!n)return null;try{return n.getIntegration(e)}catch{return Oe&&Mt.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,n){const i=this._callExtensionMethod("startTransaction",e,n);return Oe&&!i&&(this.getClient()?Mt.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):Mt.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),i}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){const n=this.getStackTop().scope,i=n.getSession();i&&g_(i),this._sendSessionUpdate(),n.setSession()}startSession(e){const{scope:n,client:i}=this.getStackTop(),{release:r,environment:s=Su}=i&&i.getOptions()||{},{userAgent:o}=pe.navigator||{},a=p_({release:r,environment:s,user:n.getUser(),...o&&{userAgent:o},...e}),l=n.getSession&&n.getSession();return l&&l.status==="ok"&&cs(l,{status:"exited"}),this.endSession(),n.setSession(a),a}shouldSendDefaultPii(){const e=this.getClient(),n=e&&e.getOptions();return!!(n&&n.sendDefaultPii)}_sendSessionUpdate(){const{scope:e,client:n}=this.getStackTop(),i=e.getSession();i&&n&&n.captureSession&&n.captureSession(i)}_callExtensionMethod(e,...n){const r=Eu().__SENTRY__;if(r&&r.extensions&&typeof r.extensions[e]=="function")return r.extensions[e].apply(this,n);Oe&&Mt.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function Eu(){return pe.__SENTRY__=pe.__SENTRY__||{extensions:{},hub:void 0},pe}function Av(t){const e=Eu(),n=vd(e);return E_(e,t),n}function Bi(){const t=Eu();if(t.__SENTRY__&&t.__SENTRY__.acs){const e=t.__SENTRY__.acs.getCurrentHub();if(e)return e}return hj(t)}function Za(){return Bi().getIsolationScope()}function hj(t=Eu()){return(!dj(t)||vd(t).isOlderThan(__))&&E_(t,new S_),vd(t)}function dj(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function vd(t){return e_("hub",()=>new S_,t)}function E_(t,e){if(!t)return!1;const n=t.__SENTRY__=t.__SENTRY__||{};return n.hub=e,!0}function T_(t){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=Bn(),n=t||e&&e.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}function Cv(t){if(!T_())return;const e=fj(t),n=Bi(),i=t.scope?t.scope.getSpan():yd();if(t.onlyIfParent&&!i)return;const s=Za(),o=Ts();let a;if(i)a=i.startChild(e);else{const{traceId:l,dsc:c,parentSpanId:h,sampled:u}={...s.getPropagationContext(),...o.getPropagationContext()};a=n.startTransaction({traceId:l,parentSpanId:h,parentSampled:u,...e,metadata:{dynamicSamplingContext:c,...e.metadata}})}return mj(a,o,s),a}function yd(){return Ts().getSpan()}function fj(t){if(t.startTime){const e={...t};return e.startTimestamp=z9(t.startTime),delete e.startTime,e}return t}const pj="_sentryScope",gj="_sentryIsolationScope";function mj(t,e,n){t&&(ls(t,gj,n),ls(t,pj,e))}function vj(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function yj(t,e,n,i){const r=f_(n),s={sent_at:new Date().toISOString(),...r&&{sdk:r},...!!i&&e&&{dsn:qa(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return Mo(s,[o])}function bj(t,e,n,i){const r=f_(n),s=t.type&&t.type!=="replay_event"?t.type:"event";vj(t,n&&n.sdk);const o=O9(t,r,i,e);return delete t.sdkProcessingMetadata,Mo(o,[[{type:s},t]])}const xj="7";function wj(t){const e=t.protocol?`${t.protocol}:`:"",n=t.port?`:${t.port}`:"";return`${e}//${t.host}${n}${t.path?`/${t.path}`:""}/api/`}function _j(t){return`${wj(t)}${t.projectId}/envelope/`}function Sj(t,e){return U7({sentry_key:t.publicKey,sentry_version:xj,...e&&{sentry_client:`${e.name}/${e.version}`}})}function Ej(t,e={}){const n=typeof e=="string"?e:e.tunnel,i=typeof e=="string"||!e._metadata?void 0:e._metadata.sdk;return n||`${_j(t)}?${Sj(t,i)}`}const Pv=[];function Tj(t){const e={};return t.forEach(n=>{const{name:i}=n,r=e[i];r&&!r.isDefaultInstance&&n.isDefaultInstance||(e[i]=n)}),Object.keys(e).map(n=>e[n])}function Aj(t){const e=t.defaultIntegrations||[],n=t.integrations;e.forEach(o=>{o.isDefaultInstance=!0});let i;Array.isArray(n)?i=[...e,...n]:typeof n=="function"?i=Sp(n(e)):i=e;const r=Tj(i),s=Pj(r,o=>o.name==="Debug");if(s!==-1){const[o]=r.splice(s,1);r.push(o)}return r}function Cj(t,e){const n={};return e.forEach(i=>{i&&A_(t,i,n)}),n}function Iv(t,e){for(const n of e)n&&n.afterAllSetup&&n.afterAllSetup(t)}function A_(t,e,n){if(n[e.name]){Oe&&Mt.log(`Integration skipped because it was already installed: ${e.name}`);return}if(n[e.name]=e,Pv.indexOf(e.name)===-1&&(e.setupOnce($9,Bi),Pv.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),t.on&&typeof e.preprocessEvent=="function"){const i=e.preprocessEvent.bind(e);t.on("preprocessEvent",(r,s)=>i(r,s,t))}if(t.addEventProcessor&&typeof e.processEvent=="function"){const i=e.processEvent.bind(e),r=Object.assign((s,o)=>i(s,o,t),{id:e.name});t.addEventProcessor(r)}Oe&&Mt.log(`Integration installed: ${e.name}`)}function Pj(t,e){for(let n=0;n<t.length;n++)if(e(t[n])===!0)return n;return-1}function pr(t,e){return Object.assign(function(...i){return e(...i)},{id:t})}function Ij(t){let e="";for(const n of t){const i=Object.entries(n.tags),r=i.length>0?`|#${i.map(([s,o])=>`${s}:${o}`).join(",")}`:"";e+=`${n.name}@${n.unit}:${n.metric}|${n.metricType}${r}|T${n.timestamp}
`}return e}function Oj(t,e,n,i){const r={sent_at:new Date().toISOString()};n&&n.sdk&&(r.sdk={name:n.sdk.name,version:n.sdk.version}),i&&e&&(r.dsn=qa(e));const s=kj(t);return Mo(r,[s])}function kj(t){const e=Ij(t);return[{type:"statsd",length:e.length},e]}const Ov="Not capturing exception because it's already been captured.";class Lj{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=z7(e.dsn):Oe&&Mt.warn("No DSN provided, client will not send events."),this._dsn){const n=Ej(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:n})}}captureException(e,n,i){if(pv(e)){Oe&&Mt.log(Ov);return}let r=n&&n.event_id;return this._process(this.eventFromException(e,n).then(s=>this._captureEvent(s,n,i)).then(s=>{r=s})),r}captureMessage(e,n,i,r){let s=i&&i.event_id;const o=yp(e)?e:String(e),a=bp(e)?this.eventFromMessage(o,n,i):this.eventFromException(e,i);return this._process(a.then(l=>this._captureEvent(l,i,r)).then(l=>{s=l})),s}captureEvent(e,n,i){if(n&&n.originalException&&pv(n.originalException)){Oe&&Mt.log(Ov);return}let r=n&&n.event_id;const o=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,n,o||i).then(a=>{r=a})),r}captureSession(e){typeof e.release!="string"?Oe&&Mt.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),cs(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const n=this._transport;return n?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(e).then(i=>n.flush(e).then(r=>i&&r))):fo(!0)}close(e){return this.flush(e).then(n=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),n))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&this._setupIntegrations()}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationById(e){return this.getIntegrationByName(e)}getIntegrationByName(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch{return Oe&&Mt.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){const n=this._integrations[e.name];A_(this,e,this._integrations),n||Iv(this,[e])}sendEvent(e,n={}){this.emit("beforeSendEvent",e,n);let i=bj(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of n.attachments||[])i=T9(i,P9(s,this._options.transportOptions&&this._options.transportOptions.textEncoder));const r=this._sendEnvelope(i);r&&r.then(s=>this.emit("afterSendEvent",e,s),null)}sendSession(e){const n=yj(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}recordDroppedEvent(e,n,i){if(this._options.sendClientReports){const r=`${e}:${n}`;Oe&&Mt.log(`Adding outcome: "${r}"`),this._outcomes[r]=this._outcomes[r]+1||1}}captureAggregateMetrics(e){Oe&&Mt.log(`Flushing aggregated metrics, number of metrics: ${e.length}`);const n=Oj(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}on(e,n){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(n)}emit(e,...n){this._hooks[e]&&this._hooks[e].forEach(i=>i(...n))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=Cj(this,e),Iv(this,e),this._integrationsInitialized=!0}_updateSessionFromEvent(e,n){let i=!1,r=!1;const s=n.exception&&n.exception.values;if(s){r=!0;for(const l of s){const c=l.mechanism;if(c&&c.handled===!1){i=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&i)&&(cs(e,{...i&&{status:"crashed"},errors:e.errors||Number(r||i)}),this.captureSession(e))}_isClientDoneProcessing(e){return new qn(n=>{let i=0;const r=1,s=setInterval(()=>{this._numProcessing==0?(clearInterval(s),n(!0)):(i+=r,e&&i>=e&&(clearInterval(s),n(!1)))},r)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,n,i,r=Za()){const s=this.getOptions(),o=Object.keys(this._integrations);return!n.integrations&&o.length>0&&(n.integrations=o),this.emit("preprocessEvent",e,n),G9(s,e,n,i,this,r).then(a=>{if(a===null)return a;const l={...r.getPropagationContext(),...i?i.getPropagationContext():void 0};if(!(a.contexts&&a.contexts.trace)&&l){const{traceId:h,spanId:u,parentSpanId:d,dsc:f}=l;a.contexts={trace:{trace_id:h,span_id:u,parent_span_id:d},...a.contexts};const p=f||x_(h,this,i);a.sdkProcessingMetadata={dynamicSamplingContext:p,...a.sdkProcessingMetadata}}return a})}_captureEvent(e,n={},i){return this._processEvent(e,n,i).then(r=>r.event_id,r=>{if(Oe){const s=r;s.logLevel==="log"?Mt.log(s.message):Mt.warn(s)}})}_processEvent(e,n,i){const r=this.getOptions(),{sampleRate:s}=r,o=P_(e),a=C_(e),l=e.type||"error",c=`before send for type \`${l}\``;if(a&&typeof s=="number"&&Math.random()>s)return this.recordDroppedEvent("sample_rate","error",e),Ep(new Pi(`Discarding event because it's not included in the random sample (sampling rate = ${s})`,"log"));const h=l==="replay_event"?"replay":l,d=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,n,i,d).then(f=>{if(f===null)throw this.recordDroppedEvent("event_processor",h,e),new Pi("An event processor returned `null`, will not send event.","log");if(n.data&&n.data.__sentry__===!0)return f;const g=Dj(r,f,n);return Mj(g,c)}).then(f=>{if(f===null)throw this.recordDroppedEvent("before_send",h,e),new Pi(`${c} returned \`null\`, will not send event.`,"log");const p=i&&i.getSession();!o&&p&&this._updateSessionFromEvent(p,f);const g=f.transaction_info;if(o&&g&&f.transaction!==e.transaction){const v="custom";f.transaction_info={...g,source:v}}return this.sendEvent(f,n),f}).then(null,f=>{throw f instanceof Pi?f:(this.captureException(f,{data:{__sentry__:!0},originalException:f}),new Pi(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${f}`))})}_process(e){this._numProcessing++,e.then(n=>(this._numProcessing--,n),n=>(this._numProcessing--,n))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,n=>{Oe&&Mt.error("Error while sending event:",n)});Oe&&Mt.error("Transport disabled")}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.keys(e).map(n=>{const[i,r]=n.split(":");return{reason:i,category:r,quantity:e[n]}})}}function Mj(t,e){const n=`${e} must return \`null\` or a valid event.`;if(xu(t))return t.then(i=>{if(!ho(i)&&i!==null)throw new Pi(n);return i},i=>{throw new Pi(`${e} rejected with ${i}`)});if(!ho(t)&&t!==null)throw new Pi(n);return t}function Dj(t,e,n){const{beforeSend:i,beforeSendTransaction:r}=t;return C_(e)&&i?i(e,n):P_(e)&&r?r(e,n):e}function C_(t){return t.type===void 0}function P_(t){return t.type==="transaction"}function Nj(t,e){e.debug===!0&&(Oe?Mt.enable():_s(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),Ts().update(e.initialScope);const i=new t(e);Rj(i),$j(i)}function Rj(t){const n=Bi().getStackTop();n.client=t,n.scope.setClient(t)}function $j(t){t.init?t.init():t.setupIntegrations&&t.setupIntegrations()}const Bj=30;function I_(t,e,n=w9(t.bufferSize||Bj)){let i={};const r=o=>n.drain(o);function s(o){const a=[];if(yv(o,(u,d)=>{const f=bv(d);if(N9(i,f)){const p=kv(u,d);t.recordDroppedEvent("ratelimit_backoff",f,p)}else a.push(u)}),a.length===0)return fo();const l=Mo(o[0],a),c=u=>{yv(l,(d,f)=>{const p=kv(d,f);t.recordDroppedEvent(u,bv(f),p)})},h=()=>e({body:A9(l,t.textEncoder)}).then(u=>(u.statusCode!==void 0&&(u.statusCode<200||u.statusCode>=300)&&Oe&&Mt.warn(`Sentry responded with status code ${u.statusCode} to sent event.`),i=R9(i,u),u),u=>{throw c("network_error"),u});return n.add(h).then(u=>u,u=>{if(u instanceof Pi)return Oe&&Mt.error("Skipped sending event because buffer is full."),c("queue_overflow"),fo();throw u})}return s.__sentry__baseTransport__=!0,{send:s,flush:r}}function kv(t,e){if(!(e!=="event"&&e!=="transaction"))return Array.isArray(t)?t[1]:void 0}function Fj(t,e,n=[e],i="npm"){const r=t._metadata||{};r.sdk||(r.sdk={name:`sentry.javascript.${e}`,packages:n.map(s=>({name:`${i}:@sentry/${s}`,version:Ca})),version:Ca}),t._metadata=r}const Vj=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],zj=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],O_="InboundFilters",Uj=(t={})=>({name:O_,setupOnce(){},processEvent(e,n,i){const r=i.getOptions(),s=Hj(t,r);return Gj(e,s)?null:e}}),k_=Uj;pr(O_,k_);function Hj(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:Vj],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[],...t.disableTransactionDefaults?[]:zj],ignoreInternal:t.ignoreInternal!==void 0?t.ignoreInternal:!0}}function Gj(t,e){return e.ignoreInternal&&Kj(t)?(Oe&&Mt.warn(`Event dropped due to being internal Sentry Error.
Event: ${Tr(t)}`),!0):jj(t,e.ignoreErrors)?(Oe&&Mt.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${Tr(t)}`),!0):Wj(t,e.ignoreTransactions)?(Oe&&Mt.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${Tr(t)}`),!0):Yj(t,e.denyUrls)?(Oe&&Mt.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${Tr(t)}.
Url: ${Ac(t)}`),!0):Xj(t,e.allowUrls)?!1:(Oe&&Mt.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${Tr(t)}.
Url: ${Ac(t)}`),!0)}function jj(t,e){return t.type||!e||!e.length?!1:qj(t).some(n=>wu(n,e))}function Wj(t,e){if(t.type!=="transaction"||!e||!e.length)return!1;const n=t.transaction;return n?wu(n,e):!1}function Yj(t,e){if(!e||!e.length)return!1;const n=Ac(t);return n?wu(n,e):!1}function Xj(t,e){if(!e||!e.length)return!0;const n=Ac(t);return n?wu(n,e):!0}function qj(t){const e=[];t.message&&e.push(t.message);let n;try{n=t.exception.values[t.exception.values.length-1]}catch{}return n&&n.value&&(e.push(n.value),n.type&&e.push(`${n.type}: ${n.value}`)),Oe&&e.length===0&&Mt.error(`Could not extract message for event ${Tr(t)}`),e}function Kj(t){try{return t.exception.values[0].type==="SentryError"}catch{}return!1}function Zj(t=[]){for(let e=t.length-1;e>=0;e--){const n=t[e];if(n&&n.filename!=="<anonymous>"&&n.filename!=="[native code]")return n.filename||null}return null}function Ac(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?Zj(e):null}catch{return Oe&&Mt.error(`Cannot extract url for event ${Tr(t)}`),null}}let Lv;const L_="FunctionToString",Mv=new WeakMap,Jj=()=>({name:L_,setupOnce(){Lv=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=_p(this),n=Mv.has(Bn())&&e!==void 0?e:this;return Lv.apply(n,t)}}catch{}},setup(t){Mv.set(t,!0)}}),M_=Jj;pr(L_,M_);const Se=pe;let bd=0;function D_(){return bd>0}function Qj(){bd++,setTimeout(()=>{bd--})}function po(t,e={},n){if(typeof t!="function")return t;try{const r=t.__sentry_wrapped__;if(r)return r;if(_p(t))return t}catch{return t}const i=function(){const r=Array.prototype.slice.call(arguments);try{n&&typeof n=="function"&&n.apply(this,arguments);const s=r.map(o=>po(o,e));return t.apply(this,s)}catch(s){throw Qj(),ej(o=>{o.addEventProcessor(a=>(e.mechanism&&(cd(a,void 0,void 0),Ta(a,e.mechanism)),a.extra={...a.extra,arguments:r},a)),Ap(s)}),s}};try{for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}catch{}r_(i,t),ls(t,"__sentry_wrapped__",i);try{Object.getOwnPropertyDescriptor(i,"name").configurable&&Object.defineProperty(i,"name",{get(){return t.name}})}catch{}return i}const tr=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function N_(t,e){const n=Cp(t,e),i={type:e&&e.name,value:iW(e)};return n.length&&(i.stacktrace={frames:n}),i.type===void 0&&i.value===""&&(i.value="Unrecoverable error caught"),i}function tW(t,e,n,i){const r=Bn(),s=r&&r.getOptions().normalizeDepth,o={exception:{values:[{type:bu(e)?e.constructor.name:i?"UnhandledRejection":"Error",value:oW(e,{isUnhandledRejection:i})}]},extra:{__serialized__:h_(e,s)}};if(n){const a=Cp(t,n);a.length&&(o.exception.values[0].stacktrace={frames:a})}return o}function xh(t,e){return{exception:{values:[N_(t,e)]}}}function Cp(t,e){const n=e.stacktrace||e.stack||"",i=nW(e);try{return t(n,i)}catch{}return[]}const eW=/Minified React error #\d+;/i;function nW(t){if(t){if(typeof t.framesToPop=="number")return t.framesToPop;if(eW.test(t.message))return 1}return 0}function iW(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:e:"No error message"}function rW(t,e,n,i){const r=n&&n.syntheticException||void 0,s=Pp(t,e,r,i);return Ta(s),s.level="error",n&&n.event_id&&(s.event_id=n.event_id),fo(s)}function sW(t,e,n="info",i,r){const s=i&&i.syntheticException||void 0,o=xd(t,e,s,r);return o.level=n,i&&i.event_id&&(o.event_id=i.event_id),fo(o)}function Pp(t,e,n,i,r){let s;if(vp(e)&&e.error)return xh(t,e.error);if(sv(e)||S7(e)){const o=e;if("stack"in e)s=xh(t,e);else{const a=o.name||(sv(o)?"DOMError":"DOMException"),l=o.message?`${a}: ${o.message}`:a;s=xd(t,l,n,i),cd(s,l)}return"code"in o&&(s.tags={...s.tags,"DOMException.code":`${o.code}`}),s}return Qw(e)?xh(t,e):ho(e)||bu(e)?(s=tW(t,e,n,r),Ta(s,{synthetic:!0}),s):(s=xd(t,e,n,i),cd(s,`${e}`,void 0),Ta(s,{synthetic:!0}),s)}function xd(t,e,n,i){const r={};if(i&&n){const s=Cp(t,n);s.length&&(r.exception={values:[{value:e,stacktrace:{frames:s}}]})}if(yp(e)){const{__sentry_template_string__:s,__sentry_template_values__:o}=e;return r.logentry={message:s,params:o},r}return r.message=e,r}function oW(t,{isUnhandledRejection:e}){const n=H7(t),i=e?"promise rejection":"exception";return vp(t)?`Event \`ErrorEvent\` captured as ${i} with message \`${t.message}\``:bu(t)?`Event \`${aW(t)}\` (type=${t.type}) captured as ${i}`:`Object captured as ${i} with keys: ${n}`}function aW(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function lW(t,{metadata:e,tunnel:n,dsn:i}){const r={event_id:t.event_id,sent_at:new Date().toISOString(),...e&&e.sdk&&{sdk:{name:e.sdk.name,version:e.sdk.version}},...!!n&&!!i&&{dsn:qa(i)}},s=cW(t);return Mo(r,[s])}function cW(t){return[{type:"user_report"},t]}class uW extends Lj{constructor(e){const n=Se.SENTRY_SDK_SOURCE||g9();Fj(e,"browser",["browser"],n),super(e),e.sendClientReports&&Se.document&&Se.document.addEventListener("visibilitychange",()=>{Se.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,n){return rW(this._options.stackParser,e,n,this._options.attachStacktrace)}eventFromMessage(e,n="info",i){return sW(this._options.stackParser,e,n,i,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled()){tr&&Mt.warn("SDK not enabled, will not capture user feedback.");return}const n=lW(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this._sendEnvelope(n)}_prepareEvent(e,n,i){return e.platform=e.platform||"javascript",super._prepareEvent(e,n,i)}_flushOutcomes(){const e=this._clearOutcomes();if(e.length===0){tr&&Mt.log("No outcomes to send");return}if(!this._dsn){tr&&Mt.log("No dsn provided, will not send outcomes");return}tr&&Mt.log("Sending outcomes:",e);const n=k9(e,this._options.tunnel&&qa(this._dsn));this._sendEnvelope(n)}}let ra;function hW(){if(ra)return ra;if(fd(Se.fetch))return ra=Se.fetch.bind(Se);const t=Se.document;let e=Se.fetch;if(t&&typeof t.createElement=="function")try{const n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n);const i=n.contentWindow;i&&i.fetch&&(e=i.fetch),t.head.removeChild(n)}catch(n){tr&&Mt.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",n)}return ra=e.bind(Se)}function dW(){ra=void 0}function fW(t,e=hW()){let n=0,i=0;function r(s){const o=s.body.length;n+=o,i++;const a={body:s.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:n<=6e4&&i<15,...t.fetchOptions};try{return e(t.url,a).then(l=>(n-=o,i--,{statusCode:l.status,headers:{"x-sentry-rate-limits":l.headers.get("X-Sentry-Rate-Limits"),"retry-after":l.headers.get("Retry-After")}}))}catch(l){return dW(),n-=o,i--,Ep(l)}}return I_(t,r)}const pW=4;function gW(t){function e(n){return new qn((i,r)=>{const s=new XMLHttpRequest;s.onerror=r,s.onreadystatechange=()=>{s.readyState===pW&&i({statusCode:s.status,headers:{"x-sentry-rate-limits":s.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":s.getResponseHeader("Retry-After")}})},s.open("POST",t.url);for(const o in t.headers)Object.prototype.hasOwnProperty.call(t.headers,o)&&s.setRequestHeader(o,t.headers[o]);s.send(n.body)})}return I_(t,e)}const Tu="?",mW=30,vW=40,yW=50;function Ip(t,e,n,i){const r={filename:t,function:e,in_app:!0};return n!==void 0&&(r.lineno=n),i!==void 0&&(r.colno=i),r}const bW=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,xW=/\((\S*)(?::(\d+))(?::(\d+))\)/,wW=t=>{const e=bW.exec(t);if(e){if(e[2]&&e[2].indexOf("eval")===0){const s=xW.exec(e[2]);s&&(e[2]=s[1],e[3]=s[2],e[4]=s[3])}const[i,r]=R_(e[1]||Tu,e[2]);return Ip(r,i,e[3]?+e[3]:void 0,e[4]?+e[4]:void 0)}},_W=[mW,wW],SW=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,EW=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,TW=t=>{const e=SW.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const s=EW.exec(e[3]);s&&(e[1]=e[1]||"eval",e[3]=s[1],e[4]=s[2],e[5]="")}let i=e[3],r=e[1]||Tu;return[r,i]=R_(r,i),Ip(i,r,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},AW=[yW,TW],CW=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:[-a-z]+):.*?):(\d+)(?::(\d+))?\)?\s*$/i,PW=t=>{const e=CW.exec(t);return e?Ip(e[2],e[1]||Tu,+e[3],e[4]?+e[4]:void 0):void 0},IW=[vW,PW],OW=[_W,AW,IW],kW=a_(...OW),R_=(t,e)=>{const n=t.indexOf("safari-extension")!==-1,i=t.indexOf("safari-web-extension")!==-1;return n||i?[t.indexOf("@")!==-1?t.split("@")[0]:Tu,n?`safari-extension:${e}`:`safari-web-extension:${e}`]:[t,e]},Bl=1024,$_="Breadcrumbs",LW=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:$_,setupOnce(){},setup(n){e.console&&Y7(NW(n)),e.dom&&K7(DW(n,e.dom)),e.xhr&&d9(RW(n)),e.fetch&&n9($W(n)),e.history&&u_(BW(n)),e.sentry&&n.on&&n.on("beforeSendEvent",MW(n))}}},B_=LW;pr($_,B_);function MW(t){return function(n){Bn()===t&&us({category:`sentry.${n.type==="transaction"?"transaction":"event"}`,event_id:n.event_id,level:n.level,message:Tr(n)},{event:n})}}function DW(t,e){return function(i){if(Bn()!==t)return;let r,s,o=typeof e=="object"?e.serializeAttribute:void 0,a=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;a&&a>Bl&&(tr&&Mt.warn(`\`dom.maxStringLength\` cannot exceed ${Bl}, but a value of ${a} was configured. Sentry will use ${Bl} instead.`),a=Bl),typeof o=="string"&&(o=[o]);try{const c=i.event,h=FW(c)?c.target:c;r=n_(h,{keyAttrs:o,maxStringLength:a}),s=D7(h)}catch{r="<unknown>"}if(r.length===0)return;const l={category:`ui.${i.name}`,message:r};s&&(l.data={"ui.component_name":s}),us(l,{event:i.event,name:i.name,global:i.global})}}function NW(t){return function(n){if(Bn()!==t)return;const i={category:"console",data:{arguments:n.args,logger:"console"},level:S9(n.level),message:ov(n.args," ")};if(n.level==="assert")if(n.args[0]===!1)i.message=`Assertion failed: ${ov(n.args.slice(1)," ")||"console.assert"}`,i.data.arguments=n.args.slice(1);else return;us(i,{input:n.args,level:n.level})}}function RW(t){return function(n){if(Bn()!==t)return;const{startTimestamp:i,endTimestamp:r}=n,s=n.xhr[ia];if(!i||!r||!s)return;const{method:o,url:a,status_code:l,body:c}=s,h={method:o,url:a,status_code:l},u={xhr:n.xhr,input:c,startTimestamp:i,endTimestamp:r};us({category:"xhr",data:h,type:"http"},u)}}function $W(t){return function(n){if(Bn()!==t)return;const{startTimestamp:i,endTimestamp:r}=n;if(r&&!(n.fetchData.url.match(/sentry_key/)&&n.fetchData.method==="POST"))if(n.error){const s=n.fetchData,o={data:n.error,input:n.args,startTimestamp:i,endTimestamp:r};us({category:"fetch",data:s,level:"error",type:"http"},o)}else{const s=n.response,o={...n.fetchData,status_code:s&&s.status},a={input:n.args,response:s,startTimestamp:i,endTimestamp:r};us({category:"fetch",data:o,type:"http"},a)}}}function BW(t){return function(n){if(Bn()!==t)return;let i=n.from,r=n.to;const s=yh(Se.location.href);let o=i?yh(i):void 0;const a=yh(r);(!o||!o.path)&&(o=s),s.protocol===a.protocol&&s.host===a.host&&(r=a.relative),s.protocol===o.protocol&&s.host===o.host&&(i=o.relative),us({category:"navigation",data:{from:i,to:r}})}}function FW(t){return!!t&&!!t.target}const F_="Dedupe",VW=()=>{let t;return{name:F_,setupOnce(){},processEvent(e){if(e.type)return e;try{if(zW(e,t))return tr&&Mt.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}},V_=VW;pr(F_,V_);function zW(t,e){return e?!!(UW(t,e)||HW(t,e)):!1}function UW(t,e){const n=t.message,i=e.message;return!(!n&&!i||n&&!i||!n&&i||n!==i||!U_(t,e)||!z_(t,e))}function HW(t,e){const n=Dv(e),i=Dv(t);return!(!n||!i||n.type!==i.type||n.value!==i.value||!U_(t,e)||!z_(t,e))}function z_(t,e){let n=Nv(t),i=Nv(e);if(!n&&!i)return!0;if(n&&!i||!n&&i||(n=n,i=i,i.length!==n.length))return!1;for(let r=0;r<i.length;r++){const s=i[r],o=n[r];if(s.filename!==o.filename||s.lineno!==o.lineno||s.colno!==o.colno||s.function!==o.function)return!1}return!0}function U_(t,e){let n=t.fingerprint,i=e.fingerprint;if(!n&&!i)return!0;if(n&&!i||!n&&i)return!1;n=n,i=i;try{return n.join("")===i.join("")}catch{return!1}}function Dv(t){return t.exception&&t.exception.values&&t.exception.values[0]}function Nv(t){const e=t.exception;if(e)try{return e.values[0].stacktrace.frames}catch{return}}const H_="GlobalHandlers",GW=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:H_,setupOnce(){Error.stackTraceLimit=50},setup(n){e.onerror&&(jW(n),Rv("onerror")),e.onunhandledrejection&&(WW(n),Rv("onunhandledrejection"))}}},G_=GW;pr(H_,G_);function jW(t){s9(e=>{const{stackParser:n,attachStacktrace:i}=W_();if(Bn()!==t||D_())return;const{msg:r,url:s,line:o,column:a,error:l}=e,c=l===void 0&&rr(r)?qW(r,s,o,a):j_(Pp(n,l||r,void 0,i,!1),s,o,a);c.level="error",m_(c,{originalException:l,mechanism:{handled:!1,type:"onerror"}})})}function WW(t){a9(e=>{const{stackParser:n,attachStacktrace:i}=W_();if(Bn()!==t||D_())return;const r=YW(e),s=bp(r)?XW(r):Pp(n,r,void 0,i,!0);s.level="error",m_(s,{originalException:r,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function YW(t){if(bp(t))return t;const e=t;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch{}return t}function XW(t){return{exception:{values:[{type:"UnhandledRejection",value:`Non-Error promise rejection captured with value: ${String(t)}`}]}}}function qW(t,e,n,i){const r=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;let s=vp(t)?t.message:t,o="Error";const a=s.match(r);return a&&(o=a[1],s=a[2]),j_({exception:{values:[{type:o,value:s}]}},e,n,i)}function j_(t,e,n,i){const r=t.exception=t.exception||{},s=r.values=r.values||[],o=s[0]=s[0]||{},a=o.stacktrace=o.stacktrace||{},l=a.frames=a.frames||[],c=isNaN(parseInt(i,10))?void 0:i,h=isNaN(parseInt(n,10))?void 0:n,u=rr(e)&&e.length>0?e:M7();return l.length===0&&l.push({colno:c,filename:u,function:"?",in_app:!0,lineno:h}),t}function Rv(t){tr&&Mt.log(`Global Handler attached: ${t}`)}function W_(){const t=Bn();return t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const Y_="HttpContext",KW=()=>({name:Y_,setupOnce(){},preprocessEvent(t){if(!Se.navigator&&!Se.location&&!Se.document)return;const e=t.request&&t.request.url||Se.location&&Se.location.href,{referrer:n}=Se.document||{},{userAgent:i}=Se.navigator||{},r={...t.request&&t.request.headers,...n&&{Referer:n},...i&&{"User-Agent":i}},s={...t.request,...e&&{url:e},headers:r};t.request=s}}),X_=KW;pr(Y_,X_);const ZW="cause",JW=5,q_="LinkedErrors",QW=(t={})=>{const e=t.limit||JW,n=t.key||ZW;return{name:q_,setupOnce(){},preprocessEvent(i,r,s){const o=s.getOptions();I7(N_,o.stackParser,o.maxValueLength,n,e,i,r)}}},K_=QW;pr(q_,K_);const tY=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Z_="TryCatch",eY=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t};return{name:Z_,setupOnce(){e.setTimeout&&wn(Se,"setTimeout",$v),e.setInterval&&wn(Se,"setInterval",$v),e.requestAnimationFrame&&wn(Se,"requestAnimationFrame",nY),e.XMLHttpRequest&&"XMLHttpRequest"in Se&&wn(XMLHttpRequest.prototype,"send",iY);const n=e.eventTarget;n&&(Array.isArray(n)?n:tY).forEach(rY)}}},J_=eY;pr(Z_,J_);function $v(t){return function(...e){const n=e[0];return e[0]=po(n,{mechanism:{data:{function:Lr(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function nY(t){return function(e){return t.apply(this,[po(e,{mechanism:{data:{function:"requestAnimationFrame",handler:Lr(t)},handled:!1,type:"instrument"}})])}}function iY(t){return function(...e){const n=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(r=>{r in n&&typeof n[r]=="function"&&wn(n,r,function(s){const o={mechanism:{data:{function:r,handler:Lr(s)},handled:!1,type:"instrument"}},a=_p(s);return a&&(o.mechanism.data.handler=Lr(a)),po(s,o)})}),t.apply(this,e)}}function rY(t){const e=Se,n=e[t]&&e[t].prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(wn(n,"addEventListener",function(i){return function(r,s,o){try{typeof s.handleEvent=="function"&&(s.handleEvent=po(s.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Lr(s),target:t},handled:!1,type:"instrument"}}))}catch{}return i.apply(this,[r,po(s,{mechanism:{data:{function:"addEventListener",handler:Lr(s),target:t},handled:!1,type:"instrument"}}),o])}}),wn(n,"removeEventListener",function(i){return function(r,s,o){const a=s;try{const l=a&&a.__sentry_wrapped__;l&&i.call(this,r,l,o)}catch{}return i.call(this,r,a,o)}}))}const sY=[k_(),M_(),J_(),B_(),G_(),K_(),V_(),X_()];function Q_(t){return[...sY]}function oY(t={}){t.defaultIntegrations===void 0&&(t.defaultIntegrations=Q_()),t.release===void 0&&(typeof __SENTRY_RELEASE__=="string"&&(t.release=__SENTRY_RELEASE__),Se.SENTRY_RELEASE&&Se.SENTRY_RELEASE.id&&(t.release=Se.SENTRY_RELEASE.id)),t.autoSessionTracking===void 0&&(t.autoSessionTracking=!0),t.sendClientReports===void 0&&(t.sendClientReports=!0);const e={...t,stackParser:j7(t.stackParser||kW),integrations:Aj(t),transport:t.transport||(c_()?fW:gW)};Nj(uW,e),t.autoSessionTracking&&aY()}function aY(){if(typeof Se.document>"u"){tr&&Mt.warn("Session tracking in non-browser environment with @sentry/browser is not supported.");return}_v({ignoreDuration:!0}),Sv(),u_(({from:t,to:e})=>{t!==void 0&&t!==e&&(_v({ignoreDuration:!0}),Sv())})}const tS=["activate","mount","update"],lY=/(?:^|[-_])(\w)/g,cY=t=>t.replace(lY,e=>e.toUpperCase()).replace(/[-_]/g,""),uY="<Root>",wh="<Anonymous>",hY=(t,e)=>t.repeat?t.repeat(e):t,ua=(t,e)=>{if(!t)return wh;if(t.$root===t)return uY;if(!t.$options)return wh;const n=t.$options;let i=n.name||n._componentTag;const r=n.__file;if(!i&&r){const s=r.match(/([^/\\]+)\.vue$/);s&&(i=s[1])}return(i?`<${cY(i)}>`:wh)+(r&&e!==!1?` at ${r}`:"")},dY=t=>{if(t&&(t._isVue||t.__isVue)&&t.$parent){const e=[];let n=0;for(;t;){if(e.length>0){const r=e[e.length-1];if(r.constructor===t.constructor){n++,t=t.$parent;continue}else n>0&&(e[e.length-1]=[r,n],n=0)}e.push(t),t=t.$parent}return`

found in

${e.map((r,s)=>`${(s===0?"---> ":hY(" ",5+s*2))+(Array.isArray(r)?`${ua(r[0])}... (${r[1]} recursive calls)`:ua(r))}`).join(`
`)}`}return`

(found in ${ua(t)})`},fY=(t,e)=>{const{errorHandler:n,warnHandler:i,silent:r}=t.config;t.config.errorHandler=(s,o,a)=>{const l=ua(o,!1),c=o?dY(o):"",h={componentName:l,lifecycleHook:a,trace:c};if(e.attachProps&&o&&(o.$options&&o.$options.propsData?h.propsData=o.$options.propsData:o.$props&&(h.propsData=o.$props)),setTimeout(()=>{Ap(s,{captureContext:{contexts:{vue:h}},mechanism:{handled:!1}})}),typeof n=="function"&&n.call(t,s,o,a),e.logErrors){const u=typeof console<"u",d=`Error in ${a}: "${s&&s.toString()}"`;i?i.call(null,d,o,c):u&&!r&&_s(()=>{console.error(`[Vue warn]: ${d}${c}`)})}}},pY=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Bv="ui.vue",gY={activate:["activated","deactivated"],create:["beforeCreate","created"],unmount:["beforeUnmount","unmounted"],destroy:["beforeDestroy","destroyed"],mount:["beforeMount","mounted"],update:["beforeUpdate","updated"]};function mY(t,e,n){t.$_sentryRootSpanTimer&&clearTimeout(t.$_sentryRootSpanTimer),t.$_sentryRootSpanTimer=setTimeout(()=>{t.$root&&t.$root.$_sentryRootSpan&&(t.$root.$_sentryRootSpan.end(e),t.$root.$_sentryRootSpan=void 0)},n)}const vY=t=>{const e=(t.hooks||[]).concat(tS).filter((i,r,s)=>s.indexOf(i)===r),n={};for(const i of e){const r=gY[i];if(!r){pY&&Mt.warn(`Unknown hook: ${i}`);continue}for(const s of r)n[s]=function(){const o=this.$root===this;o&&yd()&&(this.$_sentryRootSpan=this.$_sentryRootSpan||Cv({name:"Application Render",op:`${Bv}.render`,origin:"auto.ui.vue"}));const a=ua(this,!1),l=Array.isArray(t.trackComponents)?t.trackComponents.indexOf(a)>-1:t.trackComponents;if(!(!o&&!l))if(this.$_sentrySpans=this.$_sentrySpans||{},s==r[0]){if(this.$root&&this.$root.$_sentryRootSpan||yd()){const h=this.$_sentrySpans[i];h&&h.end(),this.$_sentrySpans[i]=Cv({name:`Vue <${a}>`,op:`${Bv}.${i}`,origin:"auto.ui.vue"})}}else{const c=this.$_sentrySpans[i];if(!c)return;c.end(),mY(this,_u(),t.timeout)}}}return n},yY=pe,bY={Vue:yY.Vue,attachProps:!0,logErrors:!0,hooks:tS,timeout:2e3,trackComponents:!1},eS="Vue",xY=(t={})=>({name:eS,setupOnce(){},setup(e){wY(e,t)}}),nS=xY;pr(eS,nS);function wY(t,e){const n={...bY,...t.getOptions(),...e};if(!n.Vue&&!n.app){_s(()=>{console.warn("[@sentry/vue]: Misconfigured SDK. Vue specific errors will not be captured.\nUpdate your `Sentry.init` call with an appropriate config option:\n`app` (Application Instance - Vue 3) or `Vue` (Vue Constructor - Vue 2).")});return}n.app?Sp(n.app).forEach(r=>Fv(r,n)):n.Vue&&Fv(n.Vue,n)}const Fv=(t,e)=>{const n=t;(n._instance&&n._instance.isMounted)===!0&&_s(()=>{console.warn("[@sentry/vue]: Misconfigured SDK. Vue app is already mounted. Make sure to call `app.mount()` after `Sentry.init()`.")}),fY(t,e),T_(e)&&t.mixin(vY({...e,...e.tracingOptions}))};function _Y(t={}){const e={_metadata:{sdk:{name:"sentry.javascript.vue",packages:[{name:"npm:@sentry/vue",version:Ca}],version:Ca}},defaultIntegrations:[...Q_(),nS()],...t};oY(e)}const Hr={lastSavedAt:null,isViewOnly:!0,isSaving:!1,shouldRedraw:!1,shouldReloadCanvas:!1,blueprint:null,tables:{},columns:{},relationships:{}},SY={isViewOnly:t=>t.isViewOnly,shouldRedraw:t=>t.shouldRedraw,shouldReloadCanvas:t=>t.shouldReloadCanvas,blueprint:t=>t.blueprint,isTableCommentsCollapsed:t=>t.blueprint.is_table_comments_collapsed,isAutosaveEnabled:t=>{var e;return(e=t.blueprint)==null?void 0:e.is_autosave_enabled},schema:(t,e,n,i)=>{let r=1;return Lt().isCanvasVersionV2AndUp&&(r=2),{version:r,tables:e.tablesObjArray,columns:e.columnsObjArray,indexes:i["indexes/getIndexes"],column_indexes:i["columnIndexes/getColumnIndexes"],relationships:e.relationshipsObjArray}},tables:t=>_.chain(t.tables).filter({deletedAt:null}).orderBy("order").value(),tablesObjArray:t=>_.pickBy(t.tables,{deletedAt:null}),totalUnsavedTables:(t,e)=>e.unsavedTables.length,unsavedTables:(t,e)=>_.union(_.filter(e.tables,{isDirty:!0}),_.filter(e.deletedTables,{isDirty:!0})),table:t=>e=>t.tables[e],indexOfTable:t=>e=>Object.keys(t.tables).indexOf(e),denormalizeTable:(t,e,n,i)=>r=>sC(r,n7,{tables:t.tables,columns:t.columns,indexes:i["indexes/getIndexes"],columnIndexes:i["columnIndexes/getColumnIndexes"]}),deletedTables:t=>_.reject(t.tables,{deletedAt:null}),columnsForTable:(t,e)=>n=>{const i=e.table(n).columns,r=_.map(i,s=>e.column(s));return _.orderBy(r,"order")},columns:t=>_.filter(t.columns,{deletedAt:null}),columnsObjArray:t=>_.pickBy(t.columns,{deletedAt:null}),column:t=>e=>t.columns[e],indexOfColumnInTable:(t,e)=>n=>e.table(e.getTableUuidOfColumn(n)).columns.indexOf(n),relationships:t=>_.filter(t.relationships,{deletedAt:null}),relationshipsObjArray:t=>_.pickBy(t.relationships,{deletedAt:null}),totalUnsavedRelationships:(t,e)=>e.unsavedRelationships.length,unsavedRelationships:(t,e)=>_.union(_.filter(e.relationships,{isDirty:!0}),_.filter(e.deletedRelationships,{isDirty:!0})),deletedRelationships:t=>_.reject(t.relationships,{deletedAt:null}),relationship:t=>e=>t.relationships[e],relationshipsOfTable:(t,e)=>n=>{let i=[];return _.forEach(e.table(n).columns,r=>{const s=_.filter(e.relationships,{target_column_uuid:r}),o=_.filter(e.relationships,{source_column_uuid:r});i=_.unionBy(i,s,o,"uuid")}),i},totalUnsavedUpdates:(t,e)=>e.totalUnsavedTables+e.totalUnsavedRelationships,isSaving:t=>t.isSaving,getTableUuidOfColumn:(t,e)=>n=>{const i=e.column(n);return i==null?void 0:i.table_uuid},isTableDirty:(t,e)=>n=>e.table(n).isDirty},EY={setIsViewOnly({commit:t},e){t("SET_IS_VIEW_ONLY",e)},setBlueprint({commit:t},e){t("SET_BLUEPRINT",e)},setShouldRedraw({commit:t}){t("SET_SHOULD_REDRAW")},unsetShouldRedraw({commit:t}){t("UNSET_SHOULD_REDRAW")},reloadCanvas({commit:t,dispatch:e,getters:n,state:i}){t("SET_SHOULD_RELOAD_CANVAS")},unsetShouldReloadCanvas({commit:t}){t("UNSET_SHOULD_RELOAD_CANVAS")},async saveBlueprint(){await axios.patch(`/api/blueprints/${Hr.blueprint.id}`)},async saveDiagram({commit:t,dispatch:e,getters:n,state:i,rootGetters:r},{shouldRefetchDiagram:s=!1,shouldToast:o=!1,amplitudeTag:a=null,shouldSkipIfRecentlySaved:l=!1}){var c;t("SET_IS_SAVING");try{if(l&&i.lastSavedAt&&new Date-i.lastSavedAt<2.5*60*1e3)return;try{await e("saveSchema"),t("SET_LAST_SAVED_AT_TO_NOW")}catch(h){throw Ap(h),console.error(h),h}s?(await e("loadSchema"),e("setShouldRedraw")):await e("markSchemaClean"),o&&this.$emitter.emit("toast-success","Diagram saved!"),a&&Zw.getInstance().logEvent(a,{blueprint_id:i.blueprint.id,team_id:(c=r["team/getTeam"])==null?void 0:c.id,driver:n.blueprint.driver,total_tables:n.tables.length,total_columns:n.columns.length,total_relationships:n.relationships.length})}catch(h){console.error(h),this.$emitter.emit("toast-error","Oops.. something went wrong while saving.")}finally{t("UNSET_IS_SAVING")}},hydrateAndCommitSchema({commit:t,dispatch:e,getters:n,state:i},r){const s=_.mapValues(r,(o,a)=>["tables","relationships"].includes(a)?_.mapValues(o,(l,c)=>(l.isDirty=null,l.deletedAt=null,l)):["columns","indexes","column_indexes"].includes(a)?_.mapValues(o,(l,c)=>(l.deletedAt=null,l)):o);t("SET_TABLES",s.tables),t("SET_COLUMNS",s.columns),e("columnIndexes/setColumnIndexes",s.column_indexes,{root:!0}),e("indexes/setIndexes",s.indexes,{root:!0}),t("SET_RELATIONSHIPS",s.relationships),Lt().isCanvasVersionV2AndUp&&Lt().RESET_CELLS()},async loadSchema({commit:t,dispatch:e,rootGetters:n}){n["team/getTeam"]||console.error("Cannot load schema, no team detected");const i=await axios.get(`/api/teams/${n["team/getTeam"].slug}/blueprints/${Hr.blueprint.id}/schemas`);e("hydrateAndCommitSchema",i.data.data.schema)},markSchemaClean({commit:t,dispatch:e,getters:n}){const i=_.filter(n.tables,{isDirty:!0});for(const s of i)t("MARK_TABLE_CLEAN",s.uuid);const r=_.filter(n.relationships,{isDirty:!0});for(const s of r)t("MARK_RELATIONSHIP_CLEAN",s.uuid)},async saveSchema({commit:t,dispatch:e,getters:n,state:i,rootGetters:r}){return axios.post(`/api/blueprints/${i.blueprint.id}/schemas`,{schema:n.schema})},addTable({commit:t,dispatch:e,getters:n,state:i,rootGetters:r},s){s=s||ki();let o=1;_.maxBy(n.tables,"order")!==void 0&&(o=_.maxBy(n.tables,"order").order+1);const a={id:null,blueprint_id:i.blueprint.id,uuid:s,name:`table_${n.tables.length+1}`,order:o,color:r["constants/nextTableColor"],comment:"",left:0,top:0,columns:[],indexes:[],isDirty:!0,deletedAt:null};t("ADD_TABLE",a)},updateTable({commit:t,dispatch:e},{targetTable:n,prop:i,value:r}){t("UPDATE_TABLE",{targetTable:n,prop:i,value:r}),e("markTableDirty",n.uuid)},deleteTables({commit:t,dispatch:e,getters:n},i){_.forEach(i,r=>{e("deleteTable",n.table(r))})},deleteTable({commit:t,dispatch:e,getters:n},i){const r=n.columnsForTable(i.uuid),s=r.length-1;for(let o=s;o>=0;o--)e("deleteColumn",r[o]);t("DELETE_TABLE",i),e("markTableDirty",i.uuid)},duplicateTable({commit:t,dispatch:e,getters:n,state:i,rootGetters:r},{originTable:s,uuidMappings:o={}}){const a=[s.schema_uuid],l=_c(s,o,a);l.name=`${s.name}_copy`,l.top+=30,l.left+=50,l.isDirty=!0,l.order=s.order+1,t("ADD_TABLE",l),_.forEach(s.columns,c=>{const h=n.column(c);e("duplicateColumn",{originColumn:h,uuidMappings:o,updateOrder:!1})}),_.forEach(s.indexes,c=>{const h=r["indexes/getIndex"](c);e("indexes/duplicateIndex",{originIndex:h,uuidMappings:o,updateOrder:!1},{root:!0})})},markTableDirty({commit:t,getters:e},n){e.isTableDirty(n)||t("MARK_TABLE_DIRTY",n)},autoTableName({dispatch:t,getters:e},n){t("updateTable",{targetTable:e.table(n),prop:"name",value:"unnamed_table_"+(e.indexOfTable(n)+1)})},updateOrderOfTables({dispatch:t,getters:e},n){_.forEach(n,(r,s)=>{const o=s+1,a=e.table(r);a.order!==o&&t("updateTable",{targetTable:a,prop:"order",value:o})});const i=_.filter(Hr.tables,r=>!_.includes(n,r.uuid));_.forEach(i,(r,s)=>{const o=n.length+s+1;r.order!==o&&t("updateTable",{targetTable:r,prop:"order",value:o})})},async saveTables({commit:t,dispatch:e,getters:n}){const r=_.chain(n.unsavedTables).differenceBy(n.deletedTables,"uuid").reject({id:null}).value().map(c=>axios.patch(`/api/tables/${c.uuid}`,n.denormalizeTable(c))),o=_.chain(n.unsavedTables).differenceBy(n.deletedTables,"uuid").filter({id:null}).value().map(c=>axios.post(`/api/blueprints/${Hr.blueprint.id}/tables`,n.denormalizeTable(c))),l=_.reject(n.deletedTables,{id:null}).map(c=>axios.delete(`/api/tables/${c.uuid}`));try{await Promise.all(l)}catch(c){console.error("Error deleting tables",c)}await Promise.all(_.union(r,o))},addColumnToTable({commit:t,dispatch:e,getters:n,rootGetters:i},{uuid:r,tableUuid:s}){const o=n.table(s),a={uuid:r||ki(),name:"",is_primary_key:!1,is_unique_key:!1,is_index:!1,is_nullable:!1,is_auto_increment:!1,is_unsigned:!1,default:"",comment:"",driver_data_type_id:i["diagram/getDiagram"].default_column_driver_data_type_id,driver_data_type_params:i["diagram/getDiagram"].default_column_driver_data_type_id&&i["diagram/getDiagram"].default_column_driver_data_type_params?i["diagram/getDiagram"].default_column_driver_data_type_params:[],order:o.columns.length>0?n.column(rv(o.columns)).order+1:1,table_uuid:s,deletedAt:null};t("ADD_COLUMN_TO_TABLE",{column:a,table:o}),e("markTableDirty",o.uuid)},updateColumn({commit:t,dispatch:e},{targetColumn:n,prop:i,value:r}){t("UPDATE_COLUMN",{targetColumn:n,prop:i,value:r}),e("markTableDirtyViaColumn",n.uuid)},deleteColumn({commit:t,getters:e,state:n,dispatch:i,rootGetters:r},s){const o=e.table(e.getTableUuidOfColumn(s.uuid));t("DELETE_COLUMN",{column:s,table:o}),i("markTableDirty",o.uuid);const a=_.union(_.filter(n.relationships,{source_column_uuid:s.uuid}),_.filter(n.relationships,{target_column_uuid:s.uuid}));_.forEach(a,h=>{ap().deleteRelationshipAndShape(h.uuid)});const l=r["columnIndexes/getColumnIndexesForColumn"](s.uuid),c=_.map(_.uniqBy(l,"index_uuid"),"index_uuid");_.forEach(c,h=>{is().deleteIndexAndShape(h)})},duplicateColumn({commit:t,dispatch:e,getters:n,state:i,rootGetters:r},{originColumn:s,uuidMappings:o={},updateOrder:a=!0}){const l=[s.schema_uuid],c=_c(s,o,l);a&&(c.order=s.order+1),t("ADD_COLUMN_TO_TABLE",{column:c,table:n.table(c.table_uuid)}),e("markTableDirtyViaColumn",c.uuid)},markTableDirtyViaColumn({dispatch:t,getters:e},n){const i=e.getTableUuidOfColumn(n);t("markTableDirty",i)},autoColumnName({dispatch:t,getters:e},n){Er().updateColumnAndShape(n,{name:"column_"+(e.indexOfColumnInTable(n)+1)})},addIndexToTable({commit:t,getters:e,state:n,dispatch:i,rootGetters:r},{uuid:s,tableUuid:o}){const a=e.table(o);a&&(i("indexes/createIndex",{uuid:s,tableUuid:o,order:a.indexes.length>0?r["indexes/getIndex"](rv(a.indexes)).order+1:1},{root:!0}),t("ADD_INDEX_TO_TABLE",{tableUuid:o,indexUuid:s}))},removeIndexFromTable({commit:t,dispatch:e,getters:n},{uuid:i,tableUuid:r}){t("REMOVE_INDEX_FROM_TABLE",{tableUuid:r,indexUuid:i})},addRelationship({commit:t},{uuid:e,sourceColumnUuid:n,targetColumnUuid:i,type:r}){t("ADD_RELATIONSHIP",{uuid:e,sourceColumnUuid:n,targetColumnUuid:i,type:r})},updateRelationship({commit:t},{targetRelationship:e,prop:n,value:i}){t("UPDATE_RELATIONSHIP",{targetRelationship:e,prop:n,value:i}),t("MARK_RELATIONSHIP_DIRTY",e.uuid)},setRelationshipConnectionId({commit:t},{targetRelationship:e,value:n}){t("UPDATE_RELATIONSHIP",{targetRelationship:e,prop:"connectionId",value:n})},updateRelationshipType({dispatch:t},{targetRelationship:e,value:n}){t("updateRelationship",{targetRelationship:e,prop:"type",value:n})},deleteRelationship({commit:t},{targetRelationship:e}){t("DELETE_RELATIONSHIP",e),t("MARK_RELATIONSHIP_DIRTY",e.uuid)},resetConnectionOfRelationship({commit:t}){t("RESET_CONNECTION_OF_RELATIONSHIPS")},async saveRelationships({commit:t,dispatch:e,getters:n}){const r=_.chain(n.unsavedRelationships).differenceBy(n.deletedRelationships,"uuid").reject({id:null}).value().map(c=>(c=_.omit(c,["connectionId"]),axios.patch(`/api/relationships/${c.uuid}`,c))),o=_.chain(n.unsavedRelationships).differenceBy(n.deletedRelationships,"uuid").filter({id:null}).value().map(c=>(c=_.omit(c,["connectionId"]),axios.post(`/api/blueprints/${Hr.blueprint.id}/relationships`,c))),l=n.deletedRelationships.map(c=>(c=_.omit(c,["connectionId"]),axios.delete(`/api/relationships/${c.uuid}`,c)));try{await Promise.all(_.union(r,o,l))}catch(c){if(c.response.status===404)console.info("Relationship already deleted, probably when the attached column was deleted");else throw c}}},TY={SET_LAST_SAVED_AT_TO_NOW(t){t.lastSavedAt=new Date},SET_IS_VIEW_ONLY(t,e){t.isViewOnly=e},SET_BLUEPRINT(t,e){t.blueprint=e},SET_CANVAS_VERSION(t,e){t.canvasVersion=e},SET_TABLES(t,e){t.tables=e,Lt().isCanvasVersionV2AndUp&&pn().SET_TABLE_SHAPES(e,{addToGraph:!1})},SET_IS_SAVING(t){t.isSaving=!0},UNSET_IS_SAVING(t){t.isSaving=!1},SET_SHOULD_REDRAW(t){t.shouldRedraw=!0},UNSET_SHOULD_REDRAW(t){t.shouldRedraw=!1},SET_SHOULD_RELOAD_CANVAS(t){t.shouldReloadCanvas=!0},UNSET_SHOULD_RELOAD_CANVAS(t){t.shouldReloadCanvas=!1},ADD_TABLE(t,e){t.tables[e.uuid]=e},UPDATE_TABLE(t,{targetTable:e,prop:n,value:i}){Object.assign(e,{[n]:i})},DELETE_TABLE(t,e){Object.assign(e,{deletedAt:vt().format()})},ADD_COLUMN_TO_TABLE(t,{column:e,table:n}){t.columns[e.uuid]=e,n.columns.includes(e.uuid)&&n.columns.splice(_.indexOf(n.columns,e.uuid),1),n.columns.push(e.uuid)},SET_COLUMNS(t,e){t.columns=e,Lt().isCanvasVersionV2AndUp&&Er().SET_COLUMNS_IN_TABLE_SHAPES(e)},UPDATE_COLUMN(t,{targetColumn:e,prop:n,value:i}){i===void 0&&delete e[n],Object.assign(e,{[n]:i})},DELETE_COLUMN(t,{column:e,table:n}){n.columns.splice(_.indexOf(n.columns,e.uuid),1),Object.assign(e,{deletedAt:vt().format()})},MARK_TABLE_DIRTY(t,e){const n=t.tables[e];n.isDirty=!0},MARK_TABLE_CLEAN(t,e){const n=t.tables[e];n.isDirty=!1},ADD_INDEX_TO_TABLE(t,{tableUuid:e,indexUuid:n}){t.tables[e].indexes.includes(n)&&t.tables[e].indexes.splice(_.indexOf(t.tables[e].indexes,n),1),t.tables[e].indexes.push(n)},REMOVE_INDEX_FROM_TABLE(t,{tableUuid:e,indexUuid:n}){t.tables[e].indexes.splice(_.indexOf(t.tables[e].indexes,n),1)},ADD_RELATIONSHIP(t,{uuid:e,sourceColumnUuid:n,targetColumnUuid:i,type:r}){const s={id:null,uuid:e||ki(),source_column_uuid:n,target_column_uuid:i,type:r,isDirty:!0,deletedAt:null};t.relationships[s.uuid]=s},UPDATE_RELATIONSHIP(t,{targetRelationship:e,prop:n,value:i}){const r=t.relationships[e.uuid];Object.assign(r,{[n]:i})},SET_RELATIONSHIPS(t,e){t.relationships=e,Lt().isCanvasVersionV2AndUp&&ap().SET_RELATIONSHIP_SHAPES(e,{addToGraph:!1})},MARK_RELATIONSHIP_DIRTY(t,e){const n=t.relationships[e];n.isDirty=!0},MARK_RELATIONSHIP_CLEAN(t,e){const n=t.relationships[e];n.isDirty=!1},DELETE_RELATIONSHIP(t,e){Object.assign(e,{deletedAt:vt().format()})},RESET_CONNECTION_OF_RELATIONSHIPS(){_.forEach(Hr.relationships,t=>{t.connectionId=null})}},jt=y7({modules:{constants:P6,diagramUI:y6,diagramAccess:S6,diagram:M6,driverDataTypes:O8,indexes:KG,team:B6,columnIndexes:e7},state:Hr,getters:SY,mutations:TY,actions:EY,strict:!1}),AY={install:(t,{apiKey:e,userId:n,config:i})=>{Zw.getInstance().init(e,n,i)}};async function CY(t,e){const n=e[t];if(typeof n>"u")throw new Error(`Page not found: ${t}`);return typeof n=="function"?n():n}function Vv(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,typeof(r=function(s,o){if(typeof s!="object"||s===null)return s;var a=s[Symbol.toPrimitive];if(a!==void 0){var l=a.call(s,"string");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}(i.key))=="symbol"?r:String(r),i)}var r}function iS(t,e,n){return e&&Vv(t.prototype,e),n&&Vv(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Yn(){return Yn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Yn.apply(this,arguments)}function wd(t){return wd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wd(t)}function Pa(t,e){return Pa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Pa(t,e)}function _d(t,e,n){return _d=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}()?Reflect.construct.bind():function(i,r,s){var o=[null];o.push.apply(o,r);var a=new(Function.bind.apply(i,o));return s&&Pa(a,s.prototype),a},_d.apply(null,arguments)}function Sd(t){var e=typeof Map=="function"?new Map:void 0;return Sd=function(n){if(n===null||Function.toString.call(n).indexOf("[native code]")===-1)return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(e!==void 0){if(e.has(n))return e.get(n);e.set(n,i)}function i(){return _d(n,arguments,wd(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Pa(i,n)},Sd(t)}var PY=String.prototype.replace,IY=/%20/g,zv="RFC3986",Qs={default:zv,formatters:{RFC1738:function(t){return PY.call(t,IY,"+")},RFC3986:function(t){return String(t)}},RFC1738:"RFC1738",RFC3986:zv},_h=Object.prototype.hasOwnProperty,zr=Array.isArray,Ti=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),Uv=function(t,e){for(var n=e&&e.plainObjects?Object.create(null):{},i=0;i<t.length;++i)t[i]!==void 0&&(n[i]=t[i]);return n},qi={arrayToObject:Uv,assign:function(t,e){return Object.keys(e).reduce(function(n,i){return n[i]=e[i],n},t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],n=[],i=0;i<e.length;++i)for(var r=e[i],s=r.obj[r.prop],o=Object.keys(s),a=0;a<o.length;++a){var l=o[a],c=s[l];typeof c=="object"&&c!==null&&n.indexOf(c)===-1&&(e.push({obj:s,prop:l}),n.push(c))}return function(h){for(;h.length>1;){var u=h.pop(),d=u.obj[u.prop];if(zr(d)){for(var f=[],p=0;p<d.length;++p)d[p]!==void 0&&f.push(d[p]);u.obj[u.prop]=f}}}(e),t},decode:function(t,e,n){var i=t.replace(/\+/g," ");if(n==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},encode:function(t,e,n,i,r){if(t.length===0)return t;var s=t;if(typeof t=="symbol"?s=Symbol.prototype.toString.call(t):typeof t!="string"&&(s=String(t)),n==="iso-8859-1")return escape(s).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var o="",a=0;a<s.length;++a){var l=s.charCodeAt(a);l===45||l===46||l===95||l===126||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||r===Qs.RFC1738&&(l===40||l===41)?o+=s.charAt(a):l<128?o+=Ti[l]:l<2048?o+=Ti[192|l>>6]+Ti[128|63&l]:l<55296||l>=57344?o+=Ti[224|l>>12]+Ti[128|l>>6&63]+Ti[128|63&l]:(l=65536+((1023&l)<<10|1023&s.charCodeAt(a+=1)),o+=Ti[240|l>>18]+Ti[128|l>>12&63]+Ti[128|l>>6&63]+Ti[128|63&l])}return o},isBuffer:function(t){return!(!t||typeof t!="object"||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))},isRegExp:function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},maybeMap:function(t,e){if(zr(t)){for(var n=[],i=0;i<t.length;i+=1)n.push(e(t[i]));return n}return e(t)},merge:function t(e,n,i){if(!n)return e;if(typeof n!="object"){if(zr(e))e.push(n);else{if(!e||typeof e!="object")return[e,n];(i&&(i.plainObjects||i.allowPrototypes)||!_h.call(Object.prototype,n))&&(e[n]=!0)}return e}if(!e||typeof e!="object")return[e].concat(n);var r=e;return zr(e)&&!zr(n)&&(r=Uv(e,i)),zr(e)&&zr(n)?(n.forEach(function(s,o){if(_h.call(e,o)){var a=e[o];a&&typeof a=="object"&&s&&typeof s=="object"?e[o]=t(a,s,i):e.push(s)}else e[o]=s}),e):Object.keys(n).reduce(function(s,o){var a=n[o];return s[o]=_h.call(s,o)?t(s[o],a,i):a,s},r)}},OY=Object.prototype.hasOwnProperty,Hv={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},Jr=Array.isArray,kY=String.prototype.split,LY=Array.prototype.push,rS=function(t,e){LY.apply(t,Jr(e)?e:[e])},MY=Date.prototype.toISOString,Gv=Qs.default,vn={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:qi.encode,encodeValuesOnly:!1,format:Gv,formatter:Qs.formatters[Gv],indices:!1,serializeDate:function(t){return MY.call(t)},skipNulls:!1,strictNullHandling:!1},DY=function t(e,n,i,r,s,o,a,l,c,h,u,d,f,p){var g,v=e;if(typeof a=="function"?v=a(n,v):v instanceof Date?v=h(v):i==="comma"&&Jr(v)&&(v=qi.maybeMap(v,function(M){return M instanceof Date?h(M):M})),v===null){if(r)return o&&!f?o(n,vn.encoder,p,"key",u):n;v=""}if(typeof(g=v)=="string"||typeof g=="number"||typeof g=="boolean"||typeof g=="symbol"||typeof g=="bigint"||qi.isBuffer(v)){if(o){var x=f?n:o(n,vn.encoder,p,"key",u);if(i==="comma"&&f){for(var S=kY.call(String(v),","),C="",P=0;P<S.length;++P)C+=(P===0?"":",")+d(o(S[P],vn.encoder,p,"value",u));return[d(x)+"="+C]}return[d(x)+"="+d(o(v,vn.encoder,p,"value",u))]}return[d(n)+"="+d(String(v))]}var O,N=[];if(v===void 0)return N;if(i==="comma"&&Jr(v))O=[{value:v.length>0?v.join(",")||null:void 0}];else if(Jr(a))O=a;else{var m=Object.keys(v);O=l?m.sort(l):m}for(var b=0;b<O.length;++b){var w=O[b],A=typeof w=="object"&&w.value!==void 0?w.value:v[w];if(!s||A!==null){var E=Jr(v)?typeof i=="function"?i(n,w):n:n+(c?"."+w:"["+w+"]");rS(N,t(A,E,i,r,s,o,a,l,c,h,u,d,f,p))}}return N},Ed=Object.prototype.hasOwnProperty,NY=Array.isArray,gn={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:qi.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},RY=function(t){return t.replace(/&#(\d+);/g,function(e,n){return String.fromCharCode(parseInt(n,10))})},sS=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},$Y=function(t,e,n,i){if(t){var r=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,s=/(\[[^[\]]*])/g,o=n.depth>0&&/(\[[^[\]]*])/.exec(r),a=o?r.slice(0,o.index):r,l=[];if(a){if(!n.plainObjects&&Ed.call(Object.prototype,a)&&!n.allowPrototypes)return;l.push(a)}for(var c=0;n.depth>0&&(o=s.exec(r))!==null&&c<n.depth;){if(c+=1,!n.plainObjects&&Ed.call(Object.prototype,o[1].slice(1,-1))&&!n.allowPrototypes)return;l.push(o[1])}return o&&l.push("["+r.slice(o.index)+"]"),function(h,u,d,f){for(var p=f?u:sS(u,d),g=h.length-1;g>=0;--g){var v,x=h[g];if(x==="[]"&&d.parseArrays)v=[].concat(p);else{v=d.plainObjects?Object.create(null):{};var S=x.charAt(0)==="["&&x.charAt(x.length-1)==="]"?x.slice(1,-1):x,C=parseInt(S,10);d.parseArrays||S!==""?!isNaN(C)&&x!==S&&String(C)===S&&C>=0&&d.parseArrays&&C<=d.arrayLimit?(v=[])[C]=p:S!=="__proto__"&&(v[S]=p):v={0:p}}p=v}return p}(l,e,n,i)}},BY=function(t,e){var n=function(c){if(!c)return gn;if(c.decoder!=null&&typeof c.decoder!="function")throw new TypeError("Decoder has to be a function.");if(c.charset!==void 0&&c.charset!=="utf-8"&&c.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");return{allowDots:c.allowDots===void 0?gn.allowDots:!!c.allowDots,allowPrototypes:typeof c.allowPrototypes=="boolean"?c.allowPrototypes:gn.allowPrototypes,arrayLimit:typeof c.arrayLimit=="number"?c.arrayLimit:gn.arrayLimit,charset:c.charset===void 0?gn.charset:c.charset,charsetSentinel:typeof c.charsetSentinel=="boolean"?c.charsetSentinel:gn.charsetSentinel,comma:typeof c.comma=="boolean"?c.comma:gn.comma,decoder:typeof c.decoder=="function"?c.decoder:gn.decoder,delimiter:typeof c.delimiter=="string"||qi.isRegExp(c.delimiter)?c.delimiter:gn.delimiter,depth:typeof c.depth=="number"||c.depth===!1?+c.depth:gn.depth,ignoreQueryPrefix:c.ignoreQueryPrefix===!0,interpretNumericEntities:typeof c.interpretNumericEntities=="boolean"?c.interpretNumericEntities:gn.interpretNumericEntities,parameterLimit:typeof c.parameterLimit=="number"?c.parameterLimit:gn.parameterLimit,parseArrays:c.parseArrays!==!1,plainObjects:typeof c.plainObjects=="boolean"?c.plainObjects:gn.plainObjects,strictNullHandling:typeof c.strictNullHandling=="boolean"?c.strictNullHandling:gn.strictNullHandling}}(e);if(t===""||t==null)return n.plainObjects?Object.create(null):{};for(var i=typeof t=="string"?function(c,h){var u,d={},f=(h.ignoreQueryPrefix?c.replace(/^\?/,""):c).split(h.delimiter,h.parameterLimit===1/0?void 0:h.parameterLimit),p=-1,g=h.charset;if(h.charsetSentinel)for(u=0;u<f.length;++u)f[u].indexOf("utf8=")===0&&(f[u]==="utf8=%E2%9C%93"?g="utf-8":f[u]==="utf8=%26%2310003%3B"&&(g="iso-8859-1"),p=u,u=f.length);for(u=0;u<f.length;++u)if(u!==p){var v,x,S=f[u],C=S.indexOf("]="),P=C===-1?S.indexOf("="):C+1;P===-1?(v=h.decoder(S,gn.decoder,g,"key"),x=h.strictNullHandling?null:""):(v=h.decoder(S.slice(0,P),gn.decoder,g,"key"),x=qi.maybeMap(sS(S.slice(P+1),h),function(O){return h.decoder(O,gn.decoder,g,"value")})),x&&h.interpretNumericEntities&&g==="iso-8859-1"&&(x=RY(x)),S.indexOf("[]=")>-1&&(x=NY(x)?[x]:x),d[v]=Ed.call(d,v)?qi.combine(d[v],x):x}return d}(t,n):t,r=n.plainObjects?Object.create(null):{},s=Object.keys(i),o=0;o<s.length;++o){var a=s[o],l=$Y(a,i[a],n,typeof t=="string");r=qi.merge(r,l,n)}return qi.compact(r)},Sh=function(){function t(n,i,r){var s,o;this.name=n,this.definition=i,this.bindings=(s=i.bindings)!=null?s:{},this.wheres=(o=i.wheres)!=null?o:{},this.config=r}var e=t.prototype;return e.matchesUrl=function(n){var i=this;if(!this.definition.methods.includes("GET"))return!1;var r=this.template.replace(/(\/?){([^}?]*)(\??)}/g,function(h,u,d,f){var p,g="(?<"+d+">"+(((p=i.wheres[d])==null?void 0:p.replace(/(^\^)|(\$$)/g,""))||"[^/?]+")+")";return f?"("+u+g+")?":""+u+g}).replace(/^\w+:\/\//,""),s=n.replace(/^\w+:\/\//,"").split("?"),o=s[0],a=s[1],l=new RegExp("^"+r+"/?$").exec(decodeURI(o));if(l){for(var c in l.groups)l.groups[c]=typeof l.groups[c]=="string"?decodeURIComponent(l.groups[c]):l.groups[c];return{params:l.groups,query:BY(a)}}return!1},e.compile=function(n){var i=this;return this.parameterSegments.length?this.template.replace(/{([^}?]+)(\??)}/g,function(r,s,o){var a,l;if(!o&&[null,void 0].includes(n[s]))throw new Error("Ziggy error: '"+s+"' parameter is required for route '"+i.name+"'.");if(i.wheres[s]&&!new RegExp("^"+(o?"("+i.wheres[s]+")?":i.wheres[s])+"$").test((l=n[s])!=null?l:""))throw new Error("Ziggy error: '"+s+"' parameter does not match required format '"+i.wheres[s]+"' for route '"+i.name+"'.");return encodeURI((a=n[s])!=null?a:"").replace(/%7C/g,"|").replace(/%25/g,"%").replace(/\$/g,"%24")}).replace(this.origin+"//",this.origin+"/").replace(/\/+$/,""):this.template},iS(t,[{key:"template",get:function(){var n=(this.origin+"/"+this.definition.uri).replace(/\/+$/,"");return n===""?"/":n}},{key:"origin",get:function(){return this.config.absolute?this.definition.domain?""+this.config.url.match(/^\w+:\/\//)[0]+this.definition.domain+(this.config.port?":"+this.config.port:""):this.config.url:""}},{key:"parameterSegments",get:function(){var n,i;return(n=(i=this.template.match(/{[^}?]+\??}/g))==null?void 0:i.map(function(r){return{name:r.replace(/{|\??}/g,""),required:!/\?}$/.test(r)}}))!=null?n:[]}}]),t}(),FY=function(t){var e,n;function i(s,o,a,l){var c;if(a===void 0&&(a=!0),(c=t.call(this)||this).t=l??(typeof Ziggy<"u"?Ziggy:globalThis==null?void 0:globalThis.Ziggy),c.t=Yn({},c.t,{absolute:a}),s){if(!c.t.routes[s])throw new Error("Ziggy error: route '"+s+"' is not in the route list.");c.i=new Sh(s,c.t.routes[s],c.t),c.u=c.l(o)}return c}n=t,(e=i).prototype=Object.create(n.prototype),e.prototype.constructor=e,Pa(e,n);var r=i.prototype;return r.toString=function(){var s=this,o=Object.keys(this.u).filter(function(a){return!s.i.parameterSegments.some(function(l){return l.name===a})}).filter(function(a){return a!=="_query"}).reduce(function(a,l){var c;return Yn({},a,((c={})[l]=s.u[l],c))},{});return this.i.compile(this.u)+function(a,l){var c,h=a,u=function(S){if(!S)return vn;if(S.encoder!=null&&typeof S.encoder!="function")throw new TypeError("Encoder has to be a function.");var C=S.charset||vn.charset;if(S.charset!==void 0&&S.charset!=="utf-8"&&S.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var P=Qs.default;if(S.format!==void 0){if(!OY.call(Qs.formatters,S.format))throw new TypeError("Unknown format option provided.");P=S.format}var O=Qs.formatters[P],N=vn.filter;return(typeof S.filter=="function"||Jr(S.filter))&&(N=S.filter),{addQueryPrefix:typeof S.addQueryPrefix=="boolean"?S.addQueryPrefix:vn.addQueryPrefix,allowDots:S.allowDots===void 0?vn.allowDots:!!S.allowDots,charset:C,charsetSentinel:typeof S.charsetSentinel=="boolean"?S.charsetSentinel:vn.charsetSentinel,delimiter:S.delimiter===void 0?vn.delimiter:S.delimiter,encode:typeof S.encode=="boolean"?S.encode:vn.encode,encoder:typeof S.encoder=="function"?S.encoder:vn.encoder,encodeValuesOnly:typeof S.encodeValuesOnly=="boolean"?S.encodeValuesOnly:vn.encodeValuesOnly,filter:N,format:P,formatter:O,serializeDate:typeof S.serializeDate=="function"?S.serializeDate:vn.serializeDate,skipNulls:typeof S.skipNulls=="boolean"?S.skipNulls:vn.skipNulls,sort:typeof S.sort=="function"?S.sort:null,strictNullHandling:typeof S.strictNullHandling=="boolean"?S.strictNullHandling:vn.strictNullHandling}}(l);typeof u.filter=="function"?h=(0,u.filter)("",h):Jr(u.filter)&&(c=u.filter);var d=[];if(typeof h!="object"||h===null)return"";var f=Hv[l&&l.arrayFormat in Hv?l.arrayFormat:l&&"indices"in l?l.indices?"indices":"repeat":"indices"];c||(c=Object.keys(h)),u.sort&&c.sort(u.sort);for(var p=0;p<c.length;++p){var g=c[p];u.skipNulls&&h[g]===null||rS(d,DY(h[g],g,f,u.strictNullHandling,u.skipNulls,u.encode?u.encoder:null,u.filter,u.sort,u.allowDots,u.serializeDate,u.format,u.formatter,u.encodeValuesOnly,u.charset))}var v=d.join(u.delimiter),x=u.addQueryPrefix===!0?"?":"";return u.charsetSentinel&&(x+=u.charset==="iso-8859-1"?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),v.length>0?x+v:""}(Yn({},o,this.u._query),{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0,encoder:function(a,l){return typeof a=="boolean"?Number(a):l(a)}})},r.v=function(s){var o=this;s?this.t.absolute&&s.startsWith("/")&&(s=this.p().host+s):s=this.h();var a={},l=Object.entries(this.t.routes).find(function(c){return a=new Sh(c[0],c[1],o.t).matchesUrl(s)})||[void 0,void 0];return Yn({name:l[0]},a,{route:l[1]})},r.h=function(){var s=this.p(),o=s.pathname,a=s.search;return(this.t.absolute?s.host+o:o.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"))+a},r.current=function(s,o){var a=this.v(),l=a.name,c=a.params,h=a.query,u=a.route;if(!s)return l;var d=new RegExp("^"+s.replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(l);if([null,void 0].includes(o)||!d)return d;var f=new Sh(l,u,this.t);o=this.l(o,f);var p=Yn({},c,h);return!(!Object.values(o).every(function(g){return!g})||Object.values(p).some(function(g){return g!==void 0}))||function g(v,x){return Object.entries(v).every(function(S){var C=S[0],P=S[1];return Array.isArray(P)&&Array.isArray(x[C])?P.every(function(O){return x[C].includes(O)}):typeof P=="object"&&typeof x[C]=="object"&&P!==null&&x[C]!==null?g(P,x[C]):x[C]==P})}(o,p)},r.p=function(){var s,o,a,l,c,h,u=typeof window<"u"?window.location:{},d=u.host,f=u.pathname,p=u.search;return{host:(s=(o=this.t.location)==null?void 0:o.host)!=null?s:d===void 0?"":d,pathname:(a=(l=this.t.location)==null?void 0:l.pathname)!=null?a:f===void 0?"":f,search:(c=(h=this.t.location)==null?void 0:h.search)!=null?c:p===void 0?"":p}},r.has=function(s){return Object.keys(this.t.routes).includes(s)},r.l=function(s,o){var a=this;s===void 0&&(s={}),o===void 0&&(o=this.i),s!=null||(s={}),s=["string","number"].includes(typeof s)?[s]:s;var l=o.parameterSegments.filter(function(h){return!a.t.defaults[h.name]});if(Array.isArray(s))s=s.reduce(function(h,u,d){var f,p;return Yn({},h,l[d]?((f={})[l[d].name]=u,f):typeof u=="object"?u:((p={})[u]="",p))},{});else if(l.length===1&&!s[l[0].name]&&(s.hasOwnProperty(Object.values(o.bindings)[0])||s.hasOwnProperty("id"))){var c;(c={})[l[0].name]=s,s=c}return Yn({},this.g(o),this.m(s,o))},r.g=function(s){var o=this;return s.parameterSegments.filter(function(a){return o.t.defaults[a.name]}).reduce(function(a,l,c){var h,u=l.name;return Yn({},a,((h={})[u]=o.t.defaults[u],h))},{})},r.m=function(s,o){var a=o.bindings,l=o.parameterSegments;return Object.entries(s).reduce(function(c,h){var u,d,f=h[0],p=h[1];if(!p||typeof p!="object"||Array.isArray(p)||!l.some(function(g){return g.name===f}))return Yn({},c,((d={})[f]=p,d));if(!p.hasOwnProperty(a[f])){if(!p.hasOwnProperty("id"))throw new Error("Ziggy error: object passed as '"+f+"' parameter is missing route model binding key '"+a[f]+"'.");a[f]="id"}return Yn({},c,((u={})[f]=p[a[f]],u))},{})},r.valueOf=function(){return this.toString()},r.check=function(s){return this.has(s)},iS(i,[{key:"params",get:function(){var s=this.v();return Yn({},s.params,s.query)}}]),i}(Sd(String)),VY={install:function(t,e){var n=function(i,r,s,o){return o===void 0&&(o=e),function(a,l,c,h){var u=new FY(a,l,c,h);return a?u.toString():u}(i,r,s,o)};t.mixin({methods:{route:n}}),parseInt(t.version)>2&&t.provide("route",n)}};xS({title:t=>`${t}`,resolve:t=>CY(`./Pages/${t}.vue`,Object.assign({"./Pages/API/Index.vue":()=>qt(()=>import("./Index-0a12e10f.js"),["assets/Index-0a12e10f.js","assets/ApiTokenManager-cf34b00d.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/Button-b6ac3cc7.js","assets/ConfirmationModal-0404b796.js","assets/Modal-314ef996.js","assets/DangerButton-32bddeba.js","assets/DialogModal-9b5ebd4e.js","assets/FormSection-75543a33.js","assets/Input-d5846cb4.js","assets/Checkbox-06b54ec2.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js","assets/SecondaryButton-603e6d8d.js","assets/SectionBorder-7a20332b.js","assets/AppLayout-3068279a.js","assets/BaseLayout-99d2db20.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/ValidationErrors-ccdf439b.js","assets/Banner-7ef5394f.js","assets/BaseMenu-342036cd.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/isArrayLikeObject-ed91f3c8.js","assets/NavbarUserDropdown-bf509c60.js","assets/use-current-team-7ee0795b.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js"]),"./Pages/API/Partials/ApiTokenManager.vue":()=>qt(()=>import("./ApiTokenManager-cf34b00d.js"),["assets/ApiTokenManager-cf34b00d.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/Button-b6ac3cc7.js","assets/ConfirmationModal-0404b796.js","assets/Modal-314ef996.js","assets/DangerButton-32bddeba.js","assets/DialogModal-9b5ebd4e.js","assets/FormSection-75543a33.js","assets/Input-d5846cb4.js","assets/Checkbox-06b54ec2.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js","assets/SecondaryButton-603e6d8d.js","assets/SectionBorder-7a20332b.js"]),"./Pages/Auth/ConfirmPassword.vue":()=>qt(()=>import("./ConfirmPassword-f9918542.js"),["assets/ConfirmPassword-f9918542.js","assets/index.esm-4dcaccf3.js","assets/AuthenticationCard-e906a4e2.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/AuthenticationCardLogo-3e1c173c.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js"]),"./Pages/Auth/ForgotPassword.vue":()=>qt(()=>import("./ForgotPassword-09aa8560.js"),["assets/ForgotPassword-09aa8560.js","assets/index.esm-4dcaccf3.js","assets/AuthenticationCard-e906a4e2.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/AuthenticationCardLogo-3e1c173c.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js"]),"./Pages/Auth/Login.vue":()=>qt(()=>import("./Login-1d6dd44a.js"),["assets/Login-1d6dd44a.js","assets/index.esm-4dcaccf3.js","assets/Button-b6ac3cc7.js","assets/BaseInput-fcb7e685.js","assets/Input-d5846cb4.js","assets/BaseFieldErrors-601b2e42.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/Checkbox-06b54ec2.js","assets/Label-43647b22.js","assets/TwoPaneLayout-53c49c3a.js","assets/Banner-7ef5394f.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseAlert-a328c715.js"]),"./Pages/Auth/Register.vue":()=>qt(()=>import("./Register-20ede7dd.js"),["assets/Register-20ede7dd.js","assets/index.esm-4dcaccf3.js","assets/Button-b6ac3cc7.js","assets/BaseInput-fcb7e685.js","assets/Input-d5846cb4.js","assets/BaseFieldErrors-601b2e42.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/Checkbox-06b54ec2.js","assets/Label-43647b22.js","assets/TwoPaneLayout-53c49c3a.js","assets/Banner-7ef5394f.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseAlert-a328c715.js","assets/InputError-5bc69726.js"]),"./Pages/Auth/ResetPassword.vue":()=>qt(()=>import("./ResetPassword-ab2c76c9.js"),["assets/ResetPassword-ab2c76c9.js","assets/index.esm-4dcaccf3.js","assets/AuthenticationCard-e906a4e2.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/AuthenticationCardLogo-3e1c173c.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js"]),"./Pages/Auth/TwoFactorChallenge.vue":()=>qt(()=>import("./TwoFactorChallenge-d1f05eca.js"),["assets/TwoFactorChallenge-d1f05eca.js","assets/index.esm-4dcaccf3.js","assets/AuthenticationCard-e906a4e2.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/AuthenticationCardLogo-3e1c173c.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js"]),"./Pages/Auth/VerifyEmail.vue":()=>qt(()=>import("./VerifyEmail-e595c616.js"),["assets/VerifyEmail-e595c616.js","assets/index.esm-4dcaccf3.js","assets/AuthenticationCard-e906a4e2.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/AuthenticationCardLogo-3e1c173c.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-b6ac3cc7.js"]),"./Pages/Dashboard.vue":()=>qt(()=>import("./Dashboard-015d9362.js"),["assets/Dashboard-015d9362.js","assets/AppLayout-3068279a.js","assets/BaseLayout-99d2db20.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-7ef5394f.js","assets/BaseMenu-342036cd.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/isArrayLikeObject-ed91f3c8.js","assets/NavbarUserDropdown-bf509c60.js","assets/use-current-team-7ee0795b.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js"]),"./Pages/Diagrams/DiagramsIndex.vue":()=>qt(()=>import("./DiagramsIndex-1b6b4463.js"),["assets/DiagramsIndex-1b6b4463.js","assets/AppLayout-3068279a.js","assets/BaseLayout-99d2db20.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-7ef5394f.js","assets/BaseMenu-342036cd.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/isArrayLikeObject-ed91f3c8.js","assets/NavbarUserDropdown-bf509c60.js","assets/use-current-team-7ee0795b.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js","assets/BaseSpinner-45530dc1.js","assets/BasePopover-22de608c.js","assets/_isIterateeCall-4e0e0f6e.js","assets/BaseListboxDataDriven-0da3894d.js","assets/form-a9b2eced.js","assets/BaseInput-fcb7e685.js","assets/statamic-urls-f2da1c03.js","assets/DiagramsIndex-25e3eefc.css"]),"./Pages/FirstTeams/FirstTeamsCreate.vue":()=>qt(()=>import("./FirstTeamsCreate-b14b3cf1.js"),["assets/FirstTeamsCreate-b14b3cf1.js","assets/index.esm-4dcaccf3.js","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/TwoPaneLayout-53c49c3a.js","assets/Banner-7ef5394f.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css"]),"./Pages/PrivacyPolicy.vue":()=>qt(()=>import("./PrivacyPolicy-7bb498b9.js"),["assets/PrivacyPolicy-7bb498b9.js","assets/index.esm-4dcaccf3.js","assets/AuthenticationCardLogo-3e1c173c.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css"]),"./Pages/Profile/Partials/DeleteUserForm.vue":()=>qt(()=>import("./DeleteUserForm-a8ef3d0c.js"),["assets/DeleteUserForm-a8ef3d0c.js","assets/index.esm-4dcaccf3.js","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/DialogModal-9b5ebd4e.js","assets/Modal-314ef996.js","assets/DangerButton-32bddeba.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/SecondaryButton-603e6d8d.js"]),"./Pages/Profile/Partials/LogoutOtherBrowserSessionsForm.vue":()=>qt(()=>import("./LogoutOtherBrowserSessionsForm-9a8b6b5a.js"),["assets/LogoutOtherBrowserSessionsForm-9a8b6b5a.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/Button-b6ac3cc7.js","assets/DialogModal-9b5ebd4e.js","assets/Modal-314ef996.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/SecondaryButton-603e6d8d.js"]),"./Pages/Profile/Partials/TwoFactorAuthenticationForm.vue":()=>qt(()=>import("./TwoFactorAuthenticationForm-90ebd486.js"),["assets/TwoFactorAuthenticationForm-90ebd486.js","assets/index.esm-4dcaccf3.js","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/Button-b6ac3cc7.js","assets/DialogModal-9b5ebd4e.js","assets/Modal-314ef996.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/SecondaryButton-603e6d8d.js","assets/DangerButton-32bddeba.js","assets/Label-43647b22.js"]),"./Pages/Profile/Partials/UpdatePasswordForm.vue":()=>qt(()=>import("./UpdatePasswordForm-6b6c019b.js"),["assets/UpdatePasswordForm-6b6c019b.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-b6ac3cc7.js","assets/FormSection-75543a33.js","assets/SectionTitle-b985e920.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js"]),"./Pages/Profile/Partials/UpdateProfileInformationForm.vue":()=>qt(()=>import("./UpdateProfileInformationForm-1b81ac5f.js"),["assets/UpdateProfileInformationForm-1b81ac5f.js","assets/index.esm-4dcaccf3.js","assets/Button-b6ac3cc7.js","assets/FormSection-75543a33.js","assets/SectionTitle-b985e920.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/SecondaryButton-603e6d8d.js"]),"./Pages/Profile/Show.vue":()=>qt(()=>import("./Show-cec24a48.js"),["assets/Show-cec24a48.js","assets/AppLayout-3068279a.js","assets/BaseLayout-99d2db20.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-7ef5394f.js","assets/BaseMenu-342036cd.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/isArrayLikeObject-ed91f3c8.js","assets/NavbarUserDropdown-bf509c60.js","assets/use-current-team-7ee0795b.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js","assets/DeleteUserForm-a8ef3d0c.js","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/DialogModal-9b5ebd4e.js","assets/Modal-314ef996.js","assets/DangerButton-32bddeba.js","assets/InputError-5bc69726.js","assets/SecondaryButton-603e6d8d.js","assets/SectionBorder-7a20332b.js","assets/LogoutOtherBrowserSessionsForm-9a8b6b5a.js","assets/TwoFactorAuthenticationForm-90ebd486.js","assets/UpdatePasswordForm-6b6c019b.js","assets/FormSection-75543a33.js","assets/UpdateProfileInformationForm-1b81ac5f.js"]),"./Pages/SandboxShow.vue":()=>qt(()=>import("./SandboxShow-a2ba1ee0.js"),["assets/SandboxShow-a2ba1ee0.js","assets/joint-plus-bfa9d41c.js","assets/index.esm-4dcaccf3.js","assets/headlessui-float-afd6f717.js","assets/BaseButtonSolid-7d99f2a9.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-3b58455f.js","assets/BaseSvgIcon-85f8ed51.css","assets/isArrayLikeObject-ed91f3c8.js","assets/combobox-ddd1a678.js","assets/form-a9b2eced.js","assets/joint-plus-a18d037f.css","assets/BasePopover-22de608c.js","assets/SandboxShow-b636d36a.css"]),"./Pages/TeamDiagramClones/TeamDiagramClonesShow.vue":()=>qt(()=>import("./TeamDiagramClonesShow-b4f19995.js"),["assets/TeamDiagramClonesShow-b4f19995.js","assets/BaseLayout-99d2db20.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-7ef5394f.js","assets/BaseCardStatus-84fdebd4.js","assets/BaseSpinner-45530dc1.js","assets/use-current-team-7ee0795b.js","assets/role-permissions-feb7b1ca.js"]),"./Pages/TeamDiagramEmbeds/TeamDiagramEmbedsShow.vue":()=>qt(()=>import("./TeamDiagramEmbedsShow-bad5559b.js"),["assets/TeamDiagramEmbedsShow-bad5559b.js","assets/Editor-7d191421.js","assets/BaseLayout-99d2db20.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-7ef5394f.js","assets/BasePopover-22de608c.js","assets/headlessui-float-afd6f717.js","assets/vue-resize.esm-903d13a9.js","assets/vue-resize-ed4cdaec.css","assets/_isIterateeCall-4e0e0f6e.js","assets/BaseSpinner-45530dc1.js","assets/joint-plus-bfa9d41c.js","assets/isArrayLikeObject-ed91f3c8.js","assets/combobox-ddd1a678.js","assets/form-a9b2eced.js","assets/joint-plus-a18d037f.css","assets/Checkbox-06b54ec2.js","assets/BaseInput-fcb7e685.js","assets/BaseListboxDataDriven-0da3894d.js","assets/use-text-value-460f9583.js","assets/BaseMenu-342036cd.js","assets/BaseButtonSecondary-80093306.js","assets/Editor-4bd9bb3a.css","assets/BaseHead-6693fba2.js"]),"./Pages/TeamDiagramPreviews/TeamDiagramPreviewsShow.vue":()=>qt(()=>import("./TeamDiagramPreviewsShow-cc6ca099.js"),["assets/TeamDiagramPreviewsShow-cc6ca099.js","assets/Editor-7d191421.js","assets/BaseLayout-99d2db20.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-7ef5394f.js","assets/BasePopover-22de608c.js","assets/headlessui-float-afd6f717.js","assets/vue-resize.esm-903d13a9.js","assets/vue-resize-ed4cdaec.css","assets/_isIterateeCall-4e0e0f6e.js","assets/BaseSpinner-45530dc1.js","assets/joint-plus-bfa9d41c.js","assets/isArrayLikeObject-ed91f3c8.js","assets/combobox-ddd1a678.js","assets/form-a9b2eced.js","assets/joint-plus-a18d037f.css","assets/Checkbox-06b54ec2.js","assets/BaseInput-fcb7e685.js","assets/BaseListboxDataDriven-0da3894d.js","assets/use-text-value-460f9583.js","assets/BaseMenu-342036cd.js","assets/BaseButtonSecondary-80093306.js","assets/Editor-4bd9bb3a.css"]),"./Pages/TeamDiagramVersions/TeamDiagramVersionsShow.vue":()=>qt(()=>import("./TeamDiagramVersionsShow-e3d0f45a.js"),["assets/TeamDiagramVersionsShow-e3d0f45a.js","assets/Editor-7d191421.js","assets/BaseLayout-99d2db20.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-7ef5394f.js","assets/BasePopover-22de608c.js","assets/headlessui-float-afd6f717.js","assets/vue-resize.esm-903d13a9.js","assets/vue-resize-ed4cdaec.css","assets/_isIterateeCall-4e0e0f6e.js","assets/BaseSpinner-45530dc1.js","assets/joint-plus-bfa9d41c.js","assets/isArrayLikeObject-ed91f3c8.js","assets/combobox-ddd1a678.js","assets/form-a9b2eced.js","assets/joint-plus-a18d037f.css","assets/Checkbox-06b54ec2.js","assets/BaseInput-fcb7e685.js","assets/BaseListboxDataDriven-0da3894d.js","assets/use-text-value-460f9583.js","assets/BaseMenu-342036cd.js","assets/BaseButtonSecondary-80093306.js","assets/Editor-4bd9bb3a.css","assets/BaseHead-6693fba2.js"]),"./Pages/TeamDiagrams/TeamDiagramsShow.vue":()=>qt(()=>import("./TeamDiagramsShow-9e16b783.js"),["assets/TeamDiagramsShow-9e16b783.js","assets/Editor-7d191421.js","assets/BaseLayout-99d2db20.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-7ef5394f.js","assets/BasePopover-22de608c.js","assets/headlessui-float-afd6f717.js","assets/vue-resize.esm-903d13a9.js","assets/vue-resize-ed4cdaec.css","assets/_isIterateeCall-4e0e0f6e.js","assets/BaseSpinner-45530dc1.js","assets/joint-plus-bfa9d41c.js","assets/isArrayLikeObject-ed91f3c8.js","assets/combobox-ddd1a678.js","assets/form-a9b2eced.js","assets/joint-plus-a18d037f.css","assets/Checkbox-06b54ec2.js","assets/BaseInput-fcb7e685.js","assets/BaseListboxDataDriven-0da3894d.js","assets/use-text-value-460f9583.js","assets/BaseMenu-342036cd.js","assets/BaseButtonSecondary-80093306.js","assets/Editor-4bd9bb3a.css","assets/BaseHead-6693fba2.js","assets/BaseCardStatus-84fdebd4.js","assets/statamic-urls-f2da1c03.js","assets/BaseAlertError-5c13e689.js","assets/use-current-team-7ee0795b.js","assets/NavbarUserDropdown-bf509c60.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/ComboboxTeamMembershipsAndGroups-b391c683.js","assets/LabelGuest-94fd857d.js","assets/TeamDiagramsShow-2bd5a406.css"]),"./Pages/TeamMemberships/TeamMembershipsShow.vue":()=>qt(()=>import("./TeamMembershipsShow-583c03b9.js"),["assets/TeamMembershipsShow-583c03b9.js","assets/index.esm-4dcaccf3.js","assets/AppLayout-3068279a.js","assets/BaseLayout-99d2db20.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-7ef5394f.js","assets/BaseMenu-342036cd.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/isArrayLikeObject-ed91f3c8.js","assets/NavbarUserDropdown-bf509c60.js","assets/use-current-team-7ee0795b.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js","assets/TeamMemberManager-0429dd52.js","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/ConfirmationModal-0404b796.js","assets/Modal-314ef996.js","assets/DangerButton-32bddeba.js","assets/DialogModal-9b5ebd4e.js","assets/FormSection-75543a33.js","assets/InputError-5bc69726.js","assets/SecondaryButton-603e6d8d.js","assets/SectionBorder-7a20332b.js","assets/AlertFreePlan-45864c1b.js","assets/BaseAlert-a328c715.js","assets/TeamMemberOrGroupTabs-0d1385df.js","assets/TeamGroupManager-c2472b52.js","assets/BaseListboxDataDriven-0da3894d.js","assets/form-a9b2eced.js","assets/ComboboxTeamMembershipsAndGroups-b391c683.js","assets/combobox-ddd1a678.js","assets/BaseButtonSecondary-80093306.js","assets/BaseInput-fcb7e685.js","assets/BaseSpinner-45530dc1.js","assets/TeamGuestUserManager-4e992a8f.js"]),"./Pages/Teams/Create.vue":()=>qt(()=>import("./Create-7eb977ba.js"),["assets/Create-7eb977ba.js","assets/AppLayout-3068279a.js","assets/BaseLayout-99d2db20.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-7ef5394f.js","assets/BaseMenu-342036cd.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/isArrayLikeObject-ed91f3c8.js","assets/NavbarUserDropdown-bf509c60.js","assets/use-current-team-7ee0795b.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js","assets/CreateTeamForm-bfc62248.js","assets/FormSection-75543a33.js","assets/SectionTitle-b985e920.js","assets/InputError-5bc69726.js"]),"./Pages/Teams/Partials/CreateTeamForm.vue":()=>qt(()=>import("./CreateTeamForm-bfc62248.js"),["assets/CreateTeamForm-bfc62248.js","assets/index.esm-4dcaccf3.js","assets/Button-b6ac3cc7.js","assets/FormSection-75543a33.js","assets/SectionTitle-b985e920.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js"]),"./Pages/Teams/Partials/DeleteTeamForm.vue":()=>qt(()=>import("./DeleteTeamForm-de1fdbb2.js"),["assets/DeleteTeamForm-de1fdbb2.js","assets/index.esm-4dcaccf3.js","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/ConfirmationModal-0404b796.js","assets/Modal-314ef996.js","assets/DangerButton-32bddeba.js","assets/SecondaryButton-603e6d8d.js"]),"./Pages/Teams/Partials/TeamGroupManager.vue":()=>qt(()=>import("./TeamGroupManager-c2472b52.js"),["assets/TeamGroupManager-c2472b52.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/Button-b6ac3cc7.js","assets/FormSection-75543a33.js","assets/Label-43647b22.js","assets/SectionBorder-7a20332b.js","assets/BaseListboxDataDriven-0da3894d.js","assets/BaseButtonSolid-7d99f2a9.js","assets/headlessui-float-afd6f717.js","assets/form-a9b2eced.js","assets/use-text-value-460f9583.js","assets/ComboboxTeamMembershipsAndGroups-b391c683.js","assets/combobox-ddd1a678.js","assets/BaseModal-90243189.js","assets/BaseButtonSecondary-80093306.js","assets/BaseInput-fcb7e685.js","assets/Input-d5846cb4.js","assets/BaseFieldErrors-601b2e42.js","assets/use-current-team-7ee0795b.js","assets/BaseSpinner-45530dc1.js","assets/ConfirmationModal-0404b796.js","assets/Modal-314ef996.js"]),"./Pages/Teams/Partials/TeamGuestUserManager.vue":()=>qt(()=>import("./TeamGuestUserManager-4e992a8f.js"),["assets/TeamGuestUserManager-4e992a8f.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/LabelGuest-94fd857d.js"]),"./Pages/Teams/Partials/TeamMemberManager.vue":()=>qt(()=>import("./TeamMemberManager-0429dd52.js"),["assets/TeamMemberManager-0429dd52.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/Button-b6ac3cc7.js","assets/ConfirmationModal-0404b796.js","assets/Modal-314ef996.js","assets/DangerButton-32bddeba.js","assets/DialogModal-9b5ebd4e.js","assets/FormSection-75543a33.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js","assets/SecondaryButton-603e6d8d.js","assets/SectionBorder-7a20332b.js"]),"./Pages/Teams/Partials/TeamMemberOrGroupTabs.vue":()=>qt(()=>import("./TeamMemberOrGroupTabs-0d1385df.js"),["assets/TeamMemberOrGroupTabs-0d1385df.js","assets/index.esm-4dcaccf3.js"]),"./Pages/Teams/Partials/UpdateTeamNameForm.vue":()=>qt(()=>import("./UpdateTeamNameForm-074a7004.js"),["assets/UpdateTeamNameForm-074a7004.js","assets/index.esm-4dcaccf3.js","assets/ActionMessage-b254b993.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/Button-b6ac3cc7.js","assets/FormSection-75543a33.js","assets/SectionTitle-b985e920.js","assets/Input-d5846cb4.js","assets/InputError-5bc69726.js","assets/Label-43647b22.js","assets/SecondaryButton-603e6d8d.js"]),"./Pages/Teams/Show.vue":()=>qt(()=>import("./Show-21867e16.js"),["assets/Show-21867e16.js","assets/AppLayout-3068279a.js","assets/BaseLayout-99d2db20.js","assets/index.esm-4dcaccf3.js","assets/BaseSvgImage-7cdda525.js","assets/BaseModal-90243189.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css","assets/BaseButtonSolid-7d99f2a9.js","assets/BaseFieldErrors-601b2e42.js","assets/Button-b6ac3cc7.js","assets/Input-d5846cb4.js","assets/Label-43647b22.js","assets/ValidationErrors-ccdf439b.js","assets/ActionMessage-b254b993.js","assets/Banner-7ef5394f.js","assets/BaseMenu-342036cd.js","assets/headlessui-float-afd6f717.js","assets/use-text-value-460f9583.js","assets/isArrayLikeObject-ed91f3c8.js","assets/NavbarUserDropdown-bf509c60.js","assets/use-current-team-7ee0795b.js","assets/NavbarUserDropdown-17654387.css","assets/role-permissions-feb7b1ca.js","assets/LabelGuest-94fd857d.js","assets/DeleteTeamForm-de1fdbb2.js","assets/ActionSection-4abc9db7.js","assets/SectionTitle-b985e920.js","assets/ConfirmationModal-0404b796.js","assets/Modal-314ef996.js","assets/DangerButton-32bddeba.js","assets/SecondaryButton-603e6d8d.js","assets/SectionBorder-7a20332b.js","assets/UpdateTeamNameForm-074a7004.js","assets/FormSection-75543a33.js","assets/InputError-5bc69726.js","assets/AlertFreePlan-45864c1b.js","assets/BaseAlert-a328c715.js"]),"./Pages/TermsOfService.vue":()=>qt(()=>import("./TermsOfService-302b5532.js"),["assets/TermsOfService-302b5532.js","assets/index.esm-4dcaccf3.js","assets/LogoLink-3510e286.js","assets/BaseSvgIcon-3b58455f.js","assets/_plugin-vue_export-helper-c27b6911.js","assets/BaseSvgIcon-85f8ed51.css"]),"./Pages/Welcome.vue":()=>qt(()=>import("./Welcome-2ac4666c.js"),["assets/Welcome-2ac4666c.js","assets/index.esm-4dcaccf3.js","assets/Welcome-665689a9.css"])})),setup({el:t,App:e,props:n,plugin:i}){const r=n.initialPage.props,s=r.appEnv==="production"?"5e6ccd208487d71e0c6584a192bbfc01":"b62074847b1530362bc463c118af0194",o=r!=null&&r.auth.user?r==null?void 0:r.auth.user.id:null,a=MS(),l=_S({render:()=>SS(e,n)}).use(a).use(i).use(VY,Ziggy).use(AY,{apiKey:s,userId:o,config:{includeReferrer:!0,includeUtm:!0}}),c=FS();l.provide("emitter",c),l.use(jt),jt.$emitter=c,a.use(({store:h})=>{h.$emitter=c}),(r==null?void 0:r.appEnv)!=="local"&&(r==null?void 0:r.appEnv)!=="testing"&&_Y({vueApp:l,dsn:"https://122e9a3f8f63486bab36d5da8bb72d9e@o167571.ingest.sentry.io/1273092",environment:r==null?void 0:r.appEnv,trackComponents:!0}),l.mount(t)},progress:{color:"#00e5b7"}});window.Cypress&&(window.$store=jt);wS.on("navigate",t=>{t.detail.page.props.auth.user?($crisp.push(["set","user:email",t.detail.page.props.auth.user.email]),$crisp.push(["set","user:nickname",t.detail.page.props.auth.user.name])):$crisp.push(["do","session:reset"])});export{TH as $,OF as A,f6 as B,lF as C,Ae as D,Qe as E,J as F,zm as G,Ri as H,Xl as I,KY as J,o8 as K,pt as L,fM as M,Jd as N,rf as O,L as P,Da as Q,ph as R,Lw as S,Rr as T,ps as U,k as V,vu as W,lp as X,oU as Y,jU as Z,E8 as _,mu as a,Qd as a0,Fc as a1,tb as a2,ds as a3,nf as a4,af as a5,fP as a6,ap as a7,oL as a8,ff as a9,xH as aa,Aw as ab,ib as ac,oz as ad,jY as ae,rd as af,ql as ag,Yx as ah,HY as ai,bo as aj,Ao as ak,_7 as al,xc as am,JY as an,eD as ao,ob as ap,Na as aq,_z as ar,Ma as as,aP as at,j6 as au,nL as av,s2 as aw,Hk as ax,Yk as ay,WY as b,XY as c,$i as d,Lt as e,tX as f,Zw as g,vt as h,ZY as i,ae as j,qY as k,pn as l,QY as m,ot as n,Er as o,d6 as p,ub as q,lU as r,jt as s,f8 as t,YY as u,ki as v,Rn as w,Ow as x,is as y,HS as z};
